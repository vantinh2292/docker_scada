[{"id":"67bf0d5d2a1fcf16","type":"tab","label":"Build Package","disabled":false,"info":"","env":[]},{"id":"78560ab9ca2b5d16","type":"tab","label":"Communication","disabled":false,"info":"","env":[]},{"id":"dc9cf18bb9eee563","type":"tab","label":"OMRON TRAINING","disabled":false,"info":"","env":[]},{"id":"3928bff73625841e","type":"tab","label":"MobileRobotApplication","disabled":true,"info":"","env":[]},{"id":"583e03b8225471bf","type":"tab","label":"MobileRobot - SV","disabled":true,"info":"","env":[]},{"id":"56f47a6a1f08d3ac","type":"tab","label":"Modbus-NodeRed-TM","disabled":true,"info":"","env":[]},{"id":"a933b5fd7ed9762b","type":"tab","label":"Scale-Cui","disabled":true,"info":"","env":[]},{"id":"7168a62b46319832","type":"tab","label":"Scale-Monitor-Che","disabled":true,"info":"","env":[]},{"id":"30ede05c4a2bcbbc","type":"tab","label":"Scale-Monitor-Cui","disabled":true,"info":"","env":[]},{"id":"67999b1b4961f212","type":"tab","label":"Isuzu-OHV","disabled":true,"info":"","env":[]},{"id":"d31a96bcefded53b","type":"tab","label":"Campuchia","disabled":true,"info":"","env":[]},{"id":"740cb21391be927b","type":"tab","label":"Sanofi-Line2","disabled":true,"info":"","env":[]},{"id":"05ce970d4b4430dd","type":"subflow","name":"Subflow 1","info":"","category":"","in":[{"x":50,"y":30.80000001192093,"wires":[]}],"out":[],"env":[],"meta":{},"color":"#DDAA99","status":{"x":400,"y":140,"wires":[]}},{"id":"158869de576da004","type":"group","z":"dc9cf18bb9eee563","name":"CONFIG PROJECT","style":{"label":true},"nodes":["cbc011a13d215ced","6cd0bf8f4be83aa1","2196ba820f1cf182","73bba3dc402ce220"],"x":54,"y":19,"w":532,"h":122},{"id":"a3e9061bc91ca8d3","type":"group","z":"56f47a6a1f08d3ac","name":"1.76.6300","style":{"label":true},"nodes":["435dfaf01403b27b","462cf6f09d95d156","2b084b90fdf0dd13","be87d783f6300c75","defefb9cc7b35b45","153ff944ef3f9858","90bcdfc8f275ba06","1c425391676b27d0","28073598bdbf9ae8","06ddf6059a064a57","a43469162e2b8ea8","88ec72b302e19b2f","4b243b5c4e48dd44","0b3114fbd5796dbe","257cf9bcd379f2aa","4d3037469d50f3ed","c3c839a8095d38a9","f241f251d7b88b93","a38fb289d50b48ee","c64a3610e1289305","fa50a0efed7f98c0","3c3ade5172fb5755","e6ec2a31c85c99c9","472de6ddcd3af5af","c13af66195e2f633","73ec91254211a901"],"x":34,"y":59,"w":1332,"h":402},{"id":"db7fcfe8cfc3b1d9","type":"group","z":"a933b5fd7ed9762b","name":"Cân Bì - Lưu","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["eaab9bac830c948d","b68262b7147275f6","af18cbf80880f626","61fec996e9b5b32c","b8bd14c219163e98","6ff62200659d4a8e","b77df33afc185bf5","5602c5851b844178","d09f7bc096076c78","9c0cfe03cdafa5fc","c9eba5393c64f384","7ef7f302259ea232","894957abc544b791","51c3d0d153bbe548","de01f5436ae9309b","ebb6fd626a9c2f01","72b1873ff4460d1e","ddffb78c1789f34f","3019a472568dba57","8c53efc6084ffd8f","6b7f8f0d810d4512","c2a96eed5083d1db","713ca261378171f2","38edd92f1b2506c6","16293824c6077ddc","1d06c21cfc82e001","c7d54b2f3381bf08","d96446a6537e1edb","dea13e90796f2068","0a8d057fe6c550b0","68f77e6a18417403"],"x":24,"y":399,"w":3012,"h":302},{"id":"554f2bec755372c0","type":"group","z":"a933b5fd7ed9762b","name":"Thêm Phiếu Cân","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["68be07131e38a12a","9fa6f5429a64ab1a","c8f0832fd5657c22","46747aee71a9cd73","944a97e7fa69e0c7","3e620a9abdefb620","a19bc1ee27f26f1b","29e77c5a92372dba","83a5f99825028b1c","161c753392696654","d310ce3159704b04","a6d0c984d21fb267"],"x":24,"y":719,"w":1812,"h":282},{"id":"936960f4ecf6c946","type":"group","z":"a933b5fd7ed9762b","name":"Xóa Tìm Kiếm","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["849aee0a36ee7c38","dcde6444849d9f0a"],"x":24,"y":1299,"w":672,"h":82},{"id":"c0a138530eb94ba5","type":"group","z":"a933b5fd7ed9762b","name":"Check Tick ","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["a37be8022d9b276b","48be13151be0031c","5410445df29b6393","30999262fe95fb47","fc21403cf7e54863","12982c8860aa763d"],"x":24,"y":1399,"w":532,"h":202},{"id":"341d7cefad79a087","type":"group","z":"a933b5fd7ed9762b","name":"Lần Cân Trong Ngày","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["c8bb4e655f92271e","50184f745af805d3","61f898d96564e6bc","fadf620ce8a025bc","5ea69969efe695f1"],"x":24,"y":1619,"w":1092,"h":122},{"id":"1647607299efe37a","type":"group","z":"a933b5fd7ed9762b","name":"Export Excel","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["32f6799c5ff7914f","f7de4c3ab33066b4","6ab8cf910c8b73d5"],"x":24,"y":1759,"w":832,"h":82},{"id":"343e4d693aad4da1","type":"group","z":"a933b5fd7ed9762b","name":"Select Row In Table","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["4758ebf86864563d","130cfebffc37fda5","7d0295dedb5c3b4b","601c6b4574734c02","e8f0298b36317021","2c7c75570942ae5c","af002674d4a8f7b4"],"x":24,"y":2039,"w":1252,"h":162},{"id":"5fb38034229b6b33","type":"group","z":"a933b5fd7ed9762b","name":"Xem Phiếu","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["098fe07b93acdf12","e9ab32ecdef2b943","eb256d1c52115f86","dcd51f6325fba9a8"],"x":24,"y":1879,"w":732,"h":142},{"id":"d257f860d200adb1","type":"group","z":"a933b5fd7ed9762b","name":"Save List User Data","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["692201b5db091437","8c23a02463ca7568","8a07b987198e054b","85a22348714e5b2b","30defd625dd79ec3","0c4a8ddbc019c465","bd91dd83c5efa4e3","bc3dc82a597b7d18","6be45720c107a486","7ed1d0041cf83a6a"],"x":24,"y":2219,"w":1622,"h":142},{"id":"29c775ceaa71eb73","type":"group","z":"a933b5fd7ed9762b","name":"Load List User Data","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["43ae846607c1338b","54759c40cb2a47d0","97b5f3ed2d485f81","c530411bbb3264c0","dd2db33389dde591","541588db6122d9a8","e9d5b6a822b289a5","28e3a7c335961674","68ef2489b7f55a3c","2f6f8f4d419457a6","a7232d34054f77ee"],"x":24,"y":2379,"w":1252,"h":302},{"id":"e0f5c7de1a97f706","type":"group","z":"a933b5fd7ed9762b","name":"Plate car check","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["ed268bbaffb0d252","90fe11f2a85265be","1c1c6c0716fcce3e","f150476a8fd185e7","be9bdf0c3faa8093"],"x":24,"y":2699,"w":1012,"h":82},{"id":"e745699e9bf3f6e0","type":"group","z":"a933b5fd7ed9762b","name":"Cân Tổng - Lưu","style":{"label":true,"color":"#ffff00","fill":"#a4a4a4"},"nodes":["6d47e75b4fdba777","d5122ff53b0e51b6","554179bcf518c11b","7e80a295aef8f76a","5f1104e22d43d5f9","b8c8a47aac88d62e","2686a9cd55bdd59f","a24d81d2c7ff998c","76a574bf82434ae1","1a6d6f0203a7da4a","b7793ce1433628a2","15021452cf4d1f36","3c5bb67d535946cb","4638593038e23d53","4907652656ea0a29","3d62f1b014ea2542","196534adc840c302","0d8a42fb931c08ac","7739d617873d7901","4e57ea9db37bc990","bc5cc4c5f675e8dc","4041e787ebbbbf31","2dfc0f9febbac860","469d6905b31b3cd6","faa97c144836d350","26d9760d440f2131","8f93f3952cf9a602","6993cc339bb2b9fa","c48f2e9008b7c03b","07b06be20d4af512","95aa02d925d08af8","500f8ae4139e699d"],"x":24,"y":79,"w":3012,"h":302},{"id":"b0f6064afcacdb86","type":"group","z":"a933b5fd7ed9762b","name":"Tìm Phiếu Cân","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["fdf3cae4bdce29d1","9099851a13b54b6b","cf97846dcc4d2dcb","0673b64b0bf10526","1e94ce493695505f","34df104c6c1972fb","9ea401eef34fb016","bf43dbe3f523ab77","da4448a7407fb7d3","6ae6f09b2856a4f9","28edca8f3474988e","bbef2de2fbc5401c"],"x":24,"y":1019,"w":952,"h":262},{"id":"3690273b0bdef213","type":"group","z":"a933b5fd7ed9762b","name":"Lần Cân Trong Ngày - Đánh Giá Củi","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["f3ec12f70da1758a","02f1b120385188ee","30e686d55a5a84ce","04251c98d97eb308","2f3a6c71a5a737a0","56f7a1daf1ce8017"],"x":34,"y":3059,"w":1482,"h":162},{"id":"807926c678ce52c6","type":"group","z":"7168a62b46319832","name":"Tìm Phiếu Cân","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["82927573c29f30f3","d54edfc8a3541aed","a41c2c61ff2a4d0b","134e3d16c90c39d7","5b0d5926567ed0aa","0e0ac98171259bad","fba71ac808c3dce7","55806c535c6021e5","6a4bada7a1f80962","dace1637b5f99d13","0f561a2a8aadf63a","9d214199d5f73edd"],"x":24,"y":19,"w":952,"h":262},{"id":"a0ae0a6f6a73176c","type":"group","z":"7168a62b46319832","name":"Xóa Tìm Kiếm","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["e164fcf39dd744cd","61ce87e6193f74f3"],"x":24,"y":299,"w":672,"h":82},{"id":"05f42549fc5b28af","type":"group","z":"7168a62b46319832","name":"Check Tick ","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["bfabc4152cb7e69e","a4743d75207e37ef","b59b5b2bbca2d0fc","0c37073e1675086d","0402696a6393f795","2d7f93a821034675"],"x":14,"y":399,"w":542,"h":202},{"id":"8e0b4d610b7d21e0","type":"group","z":"7168a62b46319832","name":"Lần Cân Trong Ngày","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["93f9065f57830dbe","337f77872445aacc","d39eaa9be9566c27","d08d532747632164","0cb8c190329ba3f9"],"x":24,"y":619,"w":1092,"h":122},{"id":"f2be9b36b3a5153d","type":"group","z":"7168a62b46319832","name":"Export Excel","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["e30d0ffcb247519f","0eea6b74a0bc21f5","33f16849951e6b40"],"x":24,"y":759,"w":892,"h":82},{"id":"625c62fffb738971","type":"group","z":"7168a62b46319832","name":"Select Row In Table","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["e18583aad6643ebd","6a18da8244c4c225","e21c7bd934ebb743","d1173ef87404f0f2","23073acf2ac69b65","f85f899191469e22"],"x":24,"y":999,"w":1092,"h":142},{"id":"67dd845a8177ff20","type":"group","z":"7168a62b46319832","name":"Xem Phiếu","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["59f72150a0f24ba1","57f7f1f8b92b30c7","f9485e5a2541f965"],"x":24,"y":859,"w":732,"h":82},{"id":"abd82c3f30e9608d","type":"group","z":"30ede05c4a2bcbbc","name":"Tìm Phiếu Cân","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["d78811bd8b880154","b7a628e8c4f7b7aa","28bbd4c1982ef2f4","377a7bcd3a3a5a14","cf126be0701ea591","627121881939311a","2cd7d757f59fea65","43d6e7115584daa6","957171f76dcb450c","1fb34dc5801aad67","092f063c63315a9d","5680c9f3f1ac1015"],"x":24,"y":19,"w":952,"h":262},{"id":"44434626bc9ac8f2","type":"group","z":"30ede05c4a2bcbbc","name":"Xóa Tìm Kiếm","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["c8d5ceac4a39cfe4","48cb516c008e0b7b"],"x":24,"y":299,"w":672,"h":82},{"id":"34de929a3139f5a5","type":"group","z":"30ede05c4a2bcbbc","name":"Check Tick ","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["95c4ab3c9bc4c113","da91b118563e2f87","ffcce35ddef5e5b7","e6ca3384d59fbd5d","13da34727aa8c046","9ab1b5b2f774aac7"],"x":14,"y":399,"w":542,"h":202},{"id":"698caf96aff53ebc","type":"group","z":"30ede05c4a2bcbbc","name":"Lần Cân Trong Ngày","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["6c35c485fdc6cd6d","f9a108a50a9b838e","d86d4b38c4a6fb09","a7b5257b3be1a9b1","4e2f4fd013f9a228"],"x":24,"y":619,"w":1092,"h":122},{"id":"5bc96253944fe7e8","type":"group","z":"30ede05c4a2bcbbc","name":"Export Excel","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["4a4895ab66c4c20c","0fe051786f512bb3","8be832f1b317064b"],"x":24,"y":759,"w":892,"h":82},{"id":"45c86fcef02882e7","type":"group","z":"30ede05c4a2bcbbc","name":"Select Row In Table","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["3a79e0a6666a5b0a","72d0e0001b24eb22","fca01e639cb14a53","60bf45a68b0b8a1a","30700496f1c7bbc2","7b99864a1a079f4b"],"x":24,"y":999,"w":1072,"h":142},{"id":"58180124e6c51634","type":"group","z":"30ede05c4a2bcbbc","name":"Xem Phiếu","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["de209f14f6d7ff06","7412508079f5b166","5992461f56380894"],"x":24,"y":859,"w":732,"h":82},{"id":"4e740f5c1234b749","type":"group","z":"3928bff73625841e","name":"Create Table Report MobileRobot Product ","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["bd0d832173890e86","bb7187974bead65f","cc94f19aa37af4c5"],"x":44,"y":3019,"w":682,"h":82},{"id":"c4aeb9aef2f19fbd","type":"group","z":"3928bff73625841e","name":"PAGE MANAGE PRODUCT","style":{"label":true,"color":"#ffff3f","fill":"#0070c0"},"nodes":["ae8b240d474576c5","81c0c7c96d5e8d54","5cdc3c172281b826","a347ffb88ad5a9b8","b854373501e32bf8"],"x":8,"y":113,"w":1394,"h":594},{"id":"d43bcb37597acc50","type":"group","z":"3928bff73625841e","name":"PAGE PRODUCTION LINE","style":{"fill":"#3f93cf","label":true,"color":"#ffff3f"},"nodes":["76df519ef3b34873","13f5fe45664f45e3","fe6c0f600e5af025","64aa486c10a3ee94","d33172349a68edc9"],"x":8,"y":733,"w":1434,"h":594},{"id":"aa69a3c37198d7c9","type":"group","z":"3928bff73625841e","name":"PAGE WAREHOUSE","style":{"fill":"#3f93cf","label":true,"color":"#ffff3f"},"nodes":["c1c185a1647b1f03","0a32e22db6a654c6","124efc52554c0181"],"x":22,"y":1353,"w":2196,"h":1620},{"id":"d8edaa67eed5c1ea","type":"group","z":"3928bff73625841e","name":"Initial Data","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["7fd0ea077dd451bf","fc8ce8bb62c42a6d","3a516dec94f8b372"],"x":24,"y":19,"w":462,"h":82},{"id":"d96a71a16749c22d","type":"group","z":"78560ab9ca2b5d16","name":"MQTT handle client request","style":{"label":true},"nodes":["b95c81f2978a9167","bab0278084f9c369","20279a9a2202dcd0","c2ed1cb639b00da8","e279206013139dcd","3e5260e168b09096","9b21fb82ac7b710f","67c65820a4bec1b9","e5e5c868b8c3169a","7b6793508f3b8cc2"],"x":54,"y":19,"w":592,"h":362},{"id":"ac517e0cad9b6025","type":"group","z":"67999b1b4961f212","name":"CONFIG PROJECT","style":{"label":true},"nodes":["301247b91708fa7e","25eff11bc9c33081","37902e2711d71c89","502c8c85d858de38"],"x":74,"y":19,"w":452,"h":122},{"id":"06ab24c9391def6c","type":"group","z":"740cb21391be927b","name":"CONFIG PROJECT","style":{"label":true},"nodes":["db96e2d02dbc9439","850a53c0a9541179","bc4963e68281385b","533b8bfb6022db93"],"x":54,"y":19,"w":512,"h":122},{"id":"934ddc593056ce42","type":"group","z":"67999b1b4961f212","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["99f95b233c1e1df5","4844c10ed85e1d2b","e45a353be274e1e7","c3b5e61d5adc146f","0befd9af502471d7","53d2398750967bf7","f92421bc8092cd49","c81ea12a9fd7fed0","800c693427b5f4a9"],"x":74,"y":1019,"w":792,"h":202},{"id":"de62ff23920eeb88","type":"group","z":"583e03b8225471bf","name":"PAGE MANAGE PRODUCT","style":{"label":true,"color":"#ffff3f","fill":"#0070c0"},"nodes":["ca01791b8537f946","826fcfb4a5a91c04","9852a62420369795","55f19dc2ad605535","2f7bd3de11cd564c","7219f9264f0db306"],"x":28,"y":113,"w":1394,"h":634},{"id":"50b8285984be6801","type":"group","z":"583e03b8225471bf","name":"PAGE PRODUCTION LINE","style":{"fill":"#3f93cf","label":true,"color":"#ffff3f"},"nodes":["a6e4b5904e322695","d16994cdd3e3bf9c","6b4375add90794fa","eeaf1a99ef2628c1","9e3cde1b8a5194b4"],"x":28,"y":793,"w":1434,"h":594},{"id":"2c8c4d62a366b5f0","type":"group","z":"583e03b8225471bf","name":"PAGE WAREHOUSE","style":{"fill":"#3f93cf","label":true,"color":"#ffff3f"},"nodes":["8940b92ed89dd58d","0d6b7315a7598035","ae15653616c4bed0"],"x":18,"y":1473,"w":2260,"h":1720},{"id":"1b60f0ae1b8ca709","type":"group","z":"583e03b8225471bf","name":"Initial Data","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["0d97febabcf3abb4","09099a866e64c973","c712f2a8c80b5cfb"],"x":44,"y":19,"w":462,"h":82},{"id":"d10aea083f072808","type":"group","z":"583e03b8225471bf","name":"Add & Update History","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["ef4b3c3ef0b0f3bb","ebfef4bf98f97f61","4f6de5e1260c8dab","018db42f62c3f3d2","be239a5ae1879a4b"],"x":28,"y":3273,"w":1304,"h":754},{"id":"eb9b2abdd2aa4897","type":"group","z":"583e03b8225471bf","name":"Delivery History","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["acf3a13119310e75","4ff18ed4e648bf4d","2b49833b8323ca77","2966b017c1c3d1a6"],"x":38,"y":4713,"w":1344,"h":714},{"id":"bd48917a789185be","type":"group","z":"583e03b8225471bf","name":"Line History","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["07a98b92274e9bcb","d14b8d5ffae8fe27","1eb3015757ffc51d","040a30817def961b"],"x":48,"y":4073,"w":1244,"h":594},{"id":"b1ddab9950f391b1","type":"group","z":"740cb21391be927b","name":"","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["44aaf28bdab96e43","541a6631cb259df0","3e09eb7001c26f7a","3d6d9dd586ea055e","f58316c1359e5791","e3a065ec2ee797c1","d08c5bea8f497984","8116ef1dbc696eb6","b87bdcbde205570b","451efcfab6142f00","ae3581a7e9744c6f","cbc1ae33833e474f","88ed6de0ef9fe38e","b42794c4ceb1a4b6","89c9b4a00d9005ab","cc8142c727422b7f","350e73805a7f9eab","9093a7e03e67a79d","fb8f5044f91677b3","3ca0d6de8940b365"],"x":54,"y":159,"w":972,"h":402},{"id":"2616ecf5c6a8dfdb","type":"group","z":"dc9cf18bb9eee563","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["439df5510f8b7859","8fdbbb2b275fa32d","c6862ae55330b2db","da792e477ecfa9e0","bb27f69b159c3f02","c5e0539cf3a7dc86","c165e8f8551a24b3","e862786273c2c715","c2046126a48ff072"],"x":94,"y":1279,"w":792,"h":202},{"id":"04f7ad02178e0f9f","type":"group","z":"67bf0d5d2a1fcf16","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["b1eed42acb7e7bb6"],"x":28,"y":13,"w":904,"h":774},{"id":"eeb9418b742f7b21","type":"group","z":"67999b1b4961f212","name":"WEB SCADA","style":{"label":true},"nodes":["776c07c18bf1d337","07932b804d90fb1d","dc7437e2487c517a","d447fcf0151bc46c","7d16a5dbf24706eb","48f465887ee74f07","663794cae69f2dc9","6168279b7105182f","d4987891d11ae519","fa950d1ee7f78146","b24d6e65c477ec1c","cbfd04613518d292","b4b73431a8c802cc","3ac79b30c9339c67","bb1b3e1af86b0a20","29fb38df8a686859","89c2edc78a914198","4b0c0561567d8568","5599c3f563951148","7768009fd03eed3d","b54ea242671d944e","96910ec25800b225","7da0cea37c37c16b","b3c756fcf338ed52","436c6123ed3da4e9","8ff736f07756119d","33affa111ccac192","dc83b70a56b31d50","d478b3a85f447902","5176536b248d5c01","326983c477c65328","ca1a1456c98d09ec","ee38413a2c5b1fc0","f3f3fd883529b8c8","b1b4806c1a2fcc55","51d8226bc36ea976","5a8ca271d3e08d33","4c2821678526c17f","98a79b8bbfb980e7"],"x":34,"y":179,"w":1452,"h":702},{"id":"593332529bf305f5","type":"group","z":"78560ab9ca2b5d16","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["daaddeeb656fd7e1","db0496c4e9f7da3b","b20a3b2554f3b99b","aef952cd9b882e16"],"x":34,"y":439,"w":732,"h":82},{"id":"64aa486c10a3ee94","type":"group","z":"3928bff73625841e","g":"d43bcb37597acc50","name":"Add New Request","style":{"label":true,"color":"#ffff00","fill":"#a4a4a4"},"nodes":["2f0c9994740c2d2f","a46d0d7a7c738d15","808f9951a982459b","aa78c21a4c7d41ba","1290ec7fed78e7e0","1770ca5ff17c0d45","063d48f9230a0c39"],"x":34,"y":1219,"w":1382,"h":82},{"id":"fe6c0f600e5af025","type":"group","z":"3928bff73625841e","g":"d43bcb37597acc50","name":"Line - Load Table Product Select","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["a84997c5af6a3cef","84771afd82f42515","b414234d4a3801e1","b6fe4fa1d2902b94","e98c0716279a63be","fe5d08b2a715cf15","024f0e1ef9f1f193"],"x":34,"y":1059,"w":952,"h":142},{"id":"124efc52554c0181","type":"group","z":"3928bff73625841e","g":"aa69a3c37198d7c9","name":"Table Finish","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["e89c65915e135388","6db7c6e27dfd3b33","58e30ec9e109d5af","0f4bbb170e8d49b3","665b62058ce44e46","c63b63041a96e303","6a2971ad3e3cb9f3","0a5ccf445935470c"],"x":48,"y":2439,"w":2144,"h":508},{"id":"13f5fe45664f45e3","type":"group","z":"3928bff73625841e","g":"d43bcb37597acc50","name":"Line - Select Destination","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["f49f91527b400b98","813d96d5c712ef18"],"x":34,"y":859,"w":612,"h":82},{"id":"76df519ef3b34873","type":"group","z":"3928bff73625841e","g":"d43bcb37597acc50","name":"Line - Create Table Report MobileRobot Warehouse ","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["5fdbdfc91751c6f6","44e87b324d0d1669","a988853ac5e9890a"],"x":34,"y":759,"w":682,"h":82},{"id":"ae8b240d474576c5","type":"group","z":"3928bff73625841e","g":"c4aeb9aef2f19fbd","name":"Add Product","style":{"label":true,"color":"#ffff00","fill":"#a4a4a4"},"nodes":["056d1577f9fecdc1","44c532a111a05994","0d73af64fc422ea1","7330b542688f973d","28f6949c9783fd0f","7f77782813c0a995"],"x":34,"y":239,"w":1342,"h":82},{"id":"81c0c7c96d5e8d54","type":"group","z":"3928bff73625841e","g":"c4aeb9aef2f19fbd","name":"Load Table Product","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["99504cafe674d77f","54ec12230cfb974d","44a07703b0294c17","a2662f2da689f7fc","6f0cb9172826a6bc","356776eb0b925b54","0b02be3edecb7eaa"],"x":34,"y":339,"w":1072,"h":142},{"id":"5cdc3c172281b826","type":"group","z":"3928bff73625841e","g":"c4aeb9aef2f19fbd","name":"Select Row In Table","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["def8e63b95108f9a","0d20deef5b257453"],"x":34,"y":499,"w":652,"h":82},{"id":"b854373501e32bf8","type":"group","z":"3928bff73625841e","g":"c4aeb9aef2f19fbd","name":"Create Table Report MobileRobot Product ","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["94029040d2d41ef5","4f29ec798d879a14","84ed0a07cc2d2ca0"],"x":44,"y":139,"w":682,"h":82},{"id":"a347ffb88ad5a9b8","type":"group","z":"3928bff73625841e","g":"c4aeb9aef2f19fbd","name":"Update Row In Table","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["feab193d9764c3e7","134f9c30d5e22e74","9c5367741c4f6f87","5b68780a16593ffb","284a362aea2b20cd","ff828c0f94a05d12"],"x":34,"y":599,"w":1152,"h":82},{"id":"d33172349a68edc9","type":"group","z":"3928bff73625841e","g":"d43bcb37597acc50","name":"Line - Select Row In Table Product","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["a7bc79e85decbea4","aafefe9681ea9d16"],"x":34,"y":959,"w":672,"h":82},{"id":"c1c185a1647b1f03","type":"group","z":"3928bff73625841e","g":"aa69a3c37198d7c9","name":"Table Current Requirement ","style":{"label":true,"color":"#ffff00","fill":"#a4a4a4"},"nodes":["0313bc47e221ad83","25c09695670ca4df","b78e5e4c130bcd17","2a5a2208b2916c44","a97180d9d70a8c84","ebbc01dd8057e2c3"],"x":104,"y":1379,"w":1708,"h":388},{"id":"0a32e22db6a654c6","type":"group","z":"3928bff73625841e","g":"aa69a3c37198d7c9","name":"Table Prepare","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["36dc396bbd23b2df","475c823bdf59dc88","68e8a3ffd5bacfc5","66c28cef2687fc03","f71786c6395d9864","ecf3c776fca35717","24a370dd74fd44fc","8b170f902463dc1b","7621b0c74ea24276"],"x":104,"y":1779,"w":1478,"h":628},{"id":"ca01791b8537f946","type":"group","z":"583e03b8225471bf","g":"de62ff23920eeb88","name":"Add Product","style":{"label":true,"color":"#ffff00","fill":"#a4a4a4"},"nodes":["f7c5e61a33500e23","2dfd924f612e7f82","610d4f6e11a68038","27f1ef6508411faa","17220e688c950556","e679aebf2c44c064","081b748d65ba0f6d","5845943a3b078ee5"],"x":54,"y":239,"w":1342,"h":122},{"id":"826fcfb4a5a91c04","type":"group","z":"583e03b8225471bf","g":"de62ff23920eeb88","name":"Load Table Product","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["3775c3c4f7bb92ea","c0ddc9b250fd9627","28dba2d7e5ce6c85","ba88aa7187c61f0e","9eb3abca1c89691e","f795ebdbdd8aa500","3e0f03ebddf8ee7c"],"x":54,"y":379,"w":1072,"h":142},{"id":"9852a62420369795","type":"group","z":"583e03b8225471bf","g":"de62ff23920eeb88","name":"Select Row In Table","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["cc86f9e6a1bf460b","0152e401f235f1a5"],"x":54,"y":539,"w":652,"h":82},{"id":"55f19dc2ad605535","type":"group","z":"583e03b8225471bf","g":"de62ff23920eeb88","name":"Update Row In Table","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["c0a839cda841a5bf","61d5b81df7081024","d07b4b476fee334a","b523e183f2293765","a28c19279d13e7fd","578cf22ba5ac2e79"],"x":54,"y":639,"w":1162,"h":82},{"id":"2f7bd3de11cd564c","type":"group","z":"583e03b8225471bf","g":"de62ff23920eeb88","name":"Create Table Report MobileRobot Product ","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["f4de1a1eae40241e","0c1e6b0d344df0a2","090c7874ade5c2b7"],"x":64,"y":139,"w":682,"h":82},{"id":"a6e4b5904e322695","type":"group","z":"583e03b8225471bf","g":"50b8285984be6801","name":"Line - Create Table Report MobileRobot Warehouse ","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["3a026cef3d28268b","5236f5f6a1d996ed","9f3d6178f7a7566f"],"x":54,"y":819,"w":682,"h":82},{"id":"d16994cdd3e3bf9c","type":"group","z":"583e03b8225471bf","g":"50b8285984be6801","name":"Line - Select Destination","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["037b1866f3ef844b","6c58f3a45765e5a8"],"x":54,"y":919,"w":612,"h":82},{"id":"6b4375add90794fa","type":"group","z":"583e03b8225471bf","g":"50b8285984be6801","name":"Line - Load Table Product Select","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["de5067359d9e6d32","a604ee79d2b3b841","eb3648c93962b0f7","8a7e322862fb90d1","a40e65dbd2bfde6d","0fa1c0f2536229ed","072e4dab4f7662c6"],"x":54,"y":1119,"w":952,"h":142},{"id":"eeaf1a99ef2628c1","type":"group","z":"583e03b8225471bf","g":"50b8285984be6801","name":"Add New Request","style":{"label":true,"color":"#ffff00","fill":"#a4a4a4"},"nodes":["7a2c643bebc91f69","0e5d0272ee97cef6","87471df044d459e4","24d02ecf29427db4","08906a8fd83a46d7","3a1e89d3f0d3e3ef","bdcfa5b95d53c5a6"],"x":54,"y":1279,"w":1382,"h":82},{"id":"9e3cde1b8a5194b4","type":"group","z":"583e03b8225471bf","g":"50b8285984be6801","name":"Line - Select Row In Table Product","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["c5e839a6c0fd917c","6ae5db3504f3666c"],"x":54,"y":1019,"w":672,"h":82},{"id":"8940b92ed89dd58d","type":"group","z":"583e03b8225471bf","g":"2c8c4d62a366b5f0","name":"Table Current Requirement ","style":{"label":true,"color":"#ffff00","fill":"#a4a4a4"},"nodes":["8f9dde832d177c1c","d6e2dcbfc014869d","2f445d8884c01509","36e59ddf5e2e80c4","9f439ae8a8075d7f","277640226e71fb22"],"x":44,"y":1499,"w":1708,"h":388},{"id":"0d6b7315a7598035","type":"group","z":"583e03b8225471bf","g":"2c8c4d62a366b5f0","name":"Table Prepare","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["79c3152c60b364be","2c2601886838f658","e81d24025b41daed","62ff7b0586e311bc","5250b80d7de53712","c44bc8c88dade22c","20c357332993434d","79aef9cbbb33a9a5","71869c068f382306","e1bab90991b3682a"],"x":44,"y":1899,"w":1478,"h":648},{"id":"ae15653616c4bed0","type":"group","z":"583e03b8225471bf","g":"2c8c4d62a366b5f0","name":"Table Finish","style":{"fill":"#a4a4a4","label":true,"color":"#ffff00"},"nodes":["f463597a8d668f8a","68fa57258e8e9cc0","412e3177afb06ed4"],"x":48,"y":2593,"w":2204,"h":574},{"id":"ef4b3c3ef0b0f3bb","type":"group","z":"583e03b8225471bf","g":"d10aea083f072808","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["f5f213c3b11e816f","6564dc027c0b21bd","23f9bad2fdee1e96","05062b465afa0650","531753b54317d607"],"x":54,"y":3719,"w":1032,"h":82},{"id":"ebfef4bf98f97f61","type":"group","z":"583e03b8225471bf","g":"d10aea083f072808","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["a80c6a2c4e73f92b","9b7352ca0233f71c","7680415278d3975a"],"x":54,"y":3299,"w":652,"h":82},{"id":"4f6de5e1260c8dab","type":"group","z":"583e03b8225471bf","g":"d10aea083f072808","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["aa82a4b8538bdef3","450febaec1eaa632","b15fca580469d850","fd232413bf3f711e","f105b86753463a36"],"x":54,"y":3419,"w":1252,"h":82},{"id":"018db42f62c3f3d2","type":"group","z":"583e03b8225471bf","g":"d10aea083f072808","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["0268470c17ec9004","3d10669837daf9ba","7493fd9e8f0301ec","dab576bacbc74031","22826da5f6b06cdf","4a91983bb34e29ec","a3332e9c64b4ec48"],"x":54,"y":3539,"w":1252,"h":142},{"id":"be239a5ae1879a4b","type":"group","z":"583e03b8225471bf","g":"d10aea083f072808","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["6385c253c10fd832","3812621295aa48cf","39a01ed4ce15c129","907d46704ed52beb","bc9b1e129f61344f"],"x":54,"y":3839,"w":522,"h":162},{"id":"acf3a13119310e75","type":"group","z":"583e03b8225471bf","g":"eb9b2abdd2aa4897","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["62c3fd33b77087fb","5a4ba9679ce03ae6","fef541d597f2e358","c6b55d87b25ad70f","76e49a6e6efe428d","244fd4c63378760f","6fad2dc1dd4504b9"],"x":64,"y":5059,"w":1292,"h":142},{"id":"4ff18ed4e648bf4d","type":"group","z":"583e03b8225471bf","g":"eb9b2abdd2aa4897","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["be27b51f64baa43c","9bf6d70853d98595","6b7c71cb9e801931"],"x":74,"y":4739,"w":682,"h":82},{"id":"2b49833b8323ca77","type":"group","z":"583e03b8225471bf","g":"eb9b2abdd2aa4897","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["e7987de772d9d753","eeccaca735a2571c","5a1e2c9e93ecbe97","91ebf3e1779fb7f8","b5dceb25be862a42","b9f4feb23064dff0","b1b0088f908340a1","1d6e61ad79e90109","e4b7a0b1dd9cb56a","9bc551b626b5d374","45ef95dd9fcf49bd"],"x":64,"y":4859,"w":1082,"h":162},{"id":"2966b017c1c3d1a6","type":"group","z":"583e03b8225471bf","g":"eb9b2abdd2aa4897","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["814a5346454cda07","fe7429d319de4602","4b33ef9267c46a9e","64bd9548aa3e065d","1d8c804ce83d3689"],"x":74,"y":5239,"w":522,"h":162},{"id":"07a98b92274e9bcb","type":"group","z":"583e03b8225471bf","g":"bd48917a789185be","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["abb5eb468be6ac97","09ca10802b4d317f","5aa3881c6b0d29e5"],"x":74,"y":4099,"w":652,"h":82},{"id":"d14b8d5ffae8fe27","type":"group","z":"583e03b8225471bf","g":"bd48917a789185be","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["63baca1618a250c8","eaeee639620db325","ddb67739dba7d152","7473f2c75648f350","cf318d2413e02459"],"x":74,"y":4199,"w":1072,"h":82},{"id":"1eb3015757ffc51d","type":"group","z":"583e03b8225471bf","g":"bd48917a789185be","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["7aed4e736ff94406","95929937f2d08055","1bb251cc3d323104","5676262cb734c6b7","316d836dba8c2cdf","d372469d88d35f59","efd5799462945733"],"x":74,"y":4319,"w":1192,"h":142},{"id":"040a30817def961b","type":"group","z":"583e03b8225471bf","g":"bd48917a789185be","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["9b0b9419f582f954","da7a7bad2c7c4254","47277fdb5597ca50","0ab0811367391bb6","fd37a874cf9c92e2"],"x":74,"y":4479,"w":512,"h":162},{"id":"b1eed42acb7e7bb6","type":"group","z":"67bf0d5d2a1fcf16","g":"04f7ad02178e0f9f","name":"BUILD PACKAGE","style":{"fill":"#d1d1d1","label":true,"stroke":"#777777","color":"#ff0000"},"nodes":["934c847262f0ef05","47e9ce831e32c569","ade3b1aef52ce636","b883d199addc05cb","9a6a3ceab77bb393","c1cefca09fbe3863","bbe46c6c9d62aea7","12c6d405a9835945","ae4f2083c378b089","ab6d1cb24d983f66","f6db8fa514cb1a63","433f8a638ccee0a0","65586867b69a03d5","f468bb0cd9e8fecf","9a0b7d1f6a536d04","5ab00dec30fb8fe7","920d1cf4555365d1","48d10e0bc651ee0e","5b30a2094d88507b","a089fc53b3a2d46e","f535149b3186669c","38495bc9df173a01","53872094b9ff9c47","99bf48afea45efef","7917f1ffa53139b3","a61d729c4c4b1e0c","721c945949a227d7","8e2a1c01f5b8681f","a814d644b3463d02","6f1be630ef0e0168","aa0237c8c172df4e","866ddc7aaf452dba","c82c6e58437a3bf0","a2fa666c98b60512","dfa2713d86e77d8c","ab1ce343b9ef2063"],"x":54,"y":39,"w":852,"h":722},{"id":"0a5ccf445935470c","type":"group","z":"3928bff73625841e","g":"124efc52554c0181","name":"Update and Delete Product","style":{"label":true,"fill":"#d1d1d1"},"nodes":["ef7b73c0ed0ac975","8f3e930cf11cc1b7","4e149bac157bae14","30def1c0ab90ad2e","fb8795491868c513","6aeb50e57bf3c65d","27c76ced9d3e65ab","fa61200b9afece04","f2436f66cdd047ab","e1926cefd8326329","a9024e7af03d4d06","849e365bac155f00","2b408d2e20103a04","7133f15a89aa51e7","da0c8f1201d1b285","4fc69b5ecc919d8c","7caddb28149abbe5","cf12ac798e83fefd","82d130663eea1779","91efe54545421420","e39cf01339f09438","e2f372bc7135955e","ddd689c2fdae88ed"],"x":74,"y":2659,"w":2092,"h":262},{"id":"f71786c6395d9864","type":"group","z":"3928bff73625841e","g":"0a32e22db6a654c6","name":"Drag-Drop","style":{"label":true,"fill":"#d1d1d1"},"nodes":["eda3e58634ca12ee","100d35ae36892e97"],"x":134,"y":2199,"w":972,"h":82},{"id":"36dc396bbd23b2df","type":"group","z":"3928bff73625841e","g":"0a32e22db6a654c6","name":"Load Table Prepare","style":{"stroke":"#d1d1d1","label":true,"fill":"#d1d1d1"},"nodes":["a332d951d6aa6ac0","8d11e6f279a4ed5b","477eed968a0f9069","20c57d31f7ac76dd","3b0e53ecc4d6e1f6","33948b7506e48b07","cdf764d4bea2acb6","fc0a2d7dcfe2bda8","17df83f64ccbad06"],"x":134,"y":1859,"w":1142,"h":122},{"id":"475c823bdf59dc88","type":"group","z":"3928bff73625841e","g":"0a32e22db6a654c6","name":"Select Row","style":{"fill":"#d1d1d1","label":true},"nodes":["5e1c643fa7d30826","948205ee2fe84a6d"],"x":134,"y":1999,"w":692,"h":82},{"id":"2a5a2208b2916c44","type":"group","z":"3928bff73625841e","g":"c1c185a1647b1f03","name":"Select Row","style":{"fill":"#d1d1d1","label":true},"nodes":["686ad40a97031ab2","20c548a6e51e97a5"],"x":134,"y":1439,"w":692,"h":82},{"id":"a97180d9d70a8c84","type":"group","z":"3928bff73625841e","g":"c1c185a1647b1f03","name":"Delete Current Row","style":{"fill":"#d1d1d1","label":true},"nodes":["579b2f4cf9548b86","74f07e699679e94c","b4dc15bd83b40ea7","1ca9fa23fec1a030"],"x":134,"y":1659,"w":1092,"h":82},{"id":"ebbc01dd8057e2c3","type":"group","z":"3928bff73625841e","g":"c1c185a1647b1f03","name":"Confirm","style":{"fill":"#d1d1d1","label":true},"nodes":["3cd9955a92379f76","8a5c65d64bd9e434","58273a6fcc04370f","43ea7276a47341c6","1dea54e3824efed0","667daf01737c4d02"],"x":134,"y":1539,"w":1652,"h":82},{"id":"ecf3c776fca35717","type":"group","z":"3928bff73625841e","g":"0a32e22db6a654c6","name":"Move Back Current Row","style":{"fill":"#d1d1d1","label":true},"nodes":["27e5843a4f86887f","4e8d9e3826189f48","834b20e06bc8e93c","e692338751dd8833","b11fbd2722e4c266"],"x":134,"y":2099,"w":1082,"h":82},{"id":"24a370dd74fd44fc","type":"group","z":"3928bff73625841e","g":"0a32e22db6a654c6","name":"Update Warehouse Finish","style":{"fill":"#d1d1d1","label":true},"nodes":["385ff3abcb3e5ea3","9dd868d50db83064","384196072b1bffc3","e5cdd638bbb86712","2f89883d9bdc0f9a","60a20d4fa46eb4e9"],"x":134,"y":2299,"w":1422,"h":82},{"id":"6a2971ad3e3cb9f3","type":"group","z":"3928bff73625841e","g":"124efc52554c0181","name":"Update Current Delivery Tag","style":{"fill":"#d1d1d1","label":true},"nodes":["c1a35ebf19458a0f","5871983e5b4385cc"],"x":144,"y":2559,"w":722,"h":82},{"id":"36e59ddf5e2e80c4","type":"group","z":"583e03b8225471bf","g":"8940b92ed89dd58d","name":"Select Row","style":{"fill":"#d1d1d1","label":true},"nodes":["0c6e8578a78b3eb7","19e9b5e367f1ece0"],"x":74,"y":1559,"w":692,"h":82},{"id":"9f439ae8a8075d7f","type":"group","z":"583e03b8225471bf","g":"8940b92ed89dd58d","name":"Delete Current Row","style":{"fill":"#d1d1d1","label":true},"nodes":["274cfaf06b440dc7","5b585ba45cd8157b","c04a3d08ee41c863","140171d516cc44a3"],"x":74,"y":1779,"w":1092,"h":82},{"id":"277640226e71fb22","type":"group","z":"583e03b8225471bf","g":"8940b92ed89dd58d","name":"Confirm","style":{"fill":"#d1d1d1","label":true},"nodes":["9c521f4435017360","f3e3d5aa42f3b822","33937aa9544be230","23967d9b66db95fb","1b1a52e77415540d","a83a3c57bbb94f8b"],"x":74,"y":1659,"w":1652,"h":82},{"id":"79c3152c60b364be","type":"group","z":"583e03b8225471bf","g":"0d6b7315a7598035","name":"Select Row","style":{"fill":"#d1d1d1","label":true},"nodes":["0afb031d6bd46c49","d1104b4935afb68e"],"x":74,"y":2139,"w":692,"h":82},{"id":"62ff7b0586e311bc","type":"group","z":"583e03b8225471bf","g":"0d6b7315a7598035","name":"Drag-Drop","style":{"label":true,"fill":"#d1d1d1"},"nodes":["54a0d478e7e0620e","a8a3e3d5fbdb4b40"],"x":74,"y":2339,"w":972,"h":82},{"id":"5250b80d7de53712","type":"group","z":"583e03b8225471bf","g":"0d6b7315a7598035","name":"Move Back Current Row","style":{"fill":"#d1d1d1","label":true},"nodes":["98326d6981ac224d","30b040b1d8407a2c","3df822e031b274bb","08478195caf62f16","b9d36a398fab77e2"],"x":74,"y":2239,"w":1082,"h":82},{"id":"c44bc8c88dade22c","type":"group","z":"583e03b8225471bf","g":"0d6b7315a7598035","name":"Update Warehouse Finish","style":{"fill":"#d1d1d1","label":true},"nodes":["e5d892f72d65de2b","02238f8fc1670d8b","09f246c1f80613cb","cb85854eba69f83d","ce1ecc82df49e352","529e098dce5a46fc"],"x":74,"y":2439,"w":1422,"h":82},{"id":"71869c068f382306","type":"group","z":"583e03b8225471bf","g":"0d6b7315a7598035","name":"Load Table Prepare","style":{"stroke":"#d1d1d1","label":true,"fill":"#d1d1d1"},"nodes":["d642aca888d925af","82d1fa5dc6861707","8720d7f49ae6352e","5434749f81b5e735","164b34ebccf51c0a","63d1342626691328","a875f24db4e246ef","45eb3fb8b839f984","1c16c890983d289b"],"x":74,"y":1979,"w":1142,"h":142},{"id":"f463597a8d668f8a","type":"group","z":"583e03b8225471bf","g":"ae15653616c4bed0","name":"Update Current Delivery Tag","style":{"fill":"#d1d1d1","label":true},"nodes":["6458cd85286f0b94","db79b6d94a19086a"],"x":84,"y":2779,"w":722,"h":82},{"id":"68fa57258e8e9cc0","type":"group","z":"583e03b8225471bf","g":"ae15653616c4bed0","name":"Update and Delete Product","style":{"label":true,"fill":"#d1d1d1"},"nodes":["caa570453b98d7e9","3a23bab08ffc6e69","11e95fee5ea00fea","30024b333edaf1f8","7b5ecc3d8430d838","df9de0d416c912fc","fd125bb45b338eda","507dce0445738256","855d2f88e70f5c2e","02801f4ddbae6f04","71efca07dd444708","78f2187b2241ac78","f9cd332289dd8298","7d403a13f8581756","02408ca4ec07d47c","1112d6214a7015f5","74b37d54f0803084","d7a3ee5806b3b6be","b04d8545cbfa8425","bae2a22c2821fb9a","0929db09b2bb2baf","6296d00e6b378a55","2113f628ef2d25aa"],"x":74,"y":2879,"w":2152,"h":262},{"id":"412e3177afb06ed4","type":"group","z":"583e03b8225471bf","g":"ae15653616c4bed0","name":"","style":{"fill":"#d1d1d1","label":true},"nodes":["6afc1833a740985e","44e0d8c3ee24ce2f","6fcb081a8358b9e0","c79742e0a46c8459","9a603a5c476068d9","e068b40849b3dd22"],"x":74,"y":2619,"w":1152,"h":142},{"id":"73bba3dc402ce220","type":"junction","z":"dc9cf18bb9eee563","g":"158869de576da004","x":240,"y":100,"wires":[["cbc011a13d215ced"]]},{"id":"b8c8a47aac88d62e","type":"junction","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","x":1870,"y":240,"wires":[["2686a9cd55bdd59f","a24d81d2c7ff998c","76a574bf82434ae1","1a6d6f0203a7da4a"]]},{"id":"502c8c85d858de38","type":"junction","z":"67999b1b4961f212","g":"ac517e0cad9b6025","x":260,"y":100,"wires":[["301247b91708fa7e"]]},{"id":"533b8bfb6022db93","type":"junction","z":"740cb21391be927b","g":"06ab24c9391def6c","x":240,"y":100,"wires":[["db96e2d02dbc9439"]]},{"id":"bbe46c6c9d62aea7","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":160,"wires":[["47e9ce831e32c569"]]},{"id":"12c6d405a9835945","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":200,"wires":[["47e9ce831e32c569"]]},{"id":"ae4f2083c378b089","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":280,"wires":[["47e9ce831e32c569"]]},{"id":"433f8a638ccee0a0","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":360,"wires":[["47e9ce831e32c569"]]},{"id":"f468bb0cd9e8fecf","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":400,"wires":[["47e9ce831e32c569"]]},{"id":"920d1cf4555365d1","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":320,"wires":[["47e9ce831e32c569"]]},{"id":"48d10e0bc651ee0e","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":440,"wires":[["47e9ce831e32c569"]]},{"id":"5b30a2094d88507b","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":480,"wires":[["47e9ce831e32c569"]]},{"id":"f535149b3186669c","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":120,"wires":[["47e9ce831e32c569"]]},{"id":"99bf48afea45efef","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":560,"wires":[["47e9ce831e32c569"]]},{"id":"a61d729c4c4b1e0c","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":600,"wires":[["47e9ce831e32c569"]]},{"id":"721c945949a227d7","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":520,"wires":[["47e9ce831e32c569"]]},{"id":"a814d644b3463d02","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":640,"wires":[["47e9ce831e32c569"]]},{"id":"aa0237c8c172df4e","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":680,"wires":[["47e9ce831e32c569"]]},{"id":"c82c6e58437a3bf0","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":720,"wires":[["47e9ce831e32c569"]]},{"id":"ab1ce343b9ef2063","type":"junction","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","x":340,"y":80,"wires":[["47e9ce831e32c569"]]},{"id":"cf0ae1d58e6000b5","type":"mqtt-broker","name":"Brocker Local","broker":"localhost","port":"1883","clientid":"","autoConnect":true,"usetls":false,"protocolVersion":"4","keepalive":"60","cleansession":true,"autoUnsubscribe":true,"birthTopic":"","birthQos":"0","birthPayload":"","birthMsg":{},"closeTopic":"","closeQos":"0","closePayload":"","closeMsg":{},"willTopic":"","willQos":"0","willPayload":"","willMsg":{},"userProps":"","sessionExpiry":""},{"id":"28a4dd7430d421b8","type":"modbus-client","name":"","clienttype":"tcp","bufferCommands":true,"stateLogEnabled":false,"queueLogEnabled":false,"failureLogEnabled":true,"tcpHost":"192.168.1.110","tcpPort":"502","tcpType":"DEFAULT","serialPort":"/dev/ttyUSB","serialType":"RTU-BUFFERD","serialBaudrate":"9600","serialDatabits":"8","serialStopbits":"1","serialParity":"none","serialConnectionDelay":"100","serialAsciiResponseStartDelimiter":"0x3A","unit_id":"1","commandDelay":"1","clientTimeout":"1000","reconnectOnTimeout":true,"reconnectTimeout":"2000","parallelUnitIdsAllowed":true,"showErrors":true,"showWarnings":true,"showLogs":true},{"id":"2eaf96fabb89e5b9","type":"sqlitedb","db":"./db/CheckWeigh_ListDataUser.db","mode":"RWC"},{"id":"4da24c56a89316ed","type":"sqlitedb","db":"./db/Report_CheckWeigh.db","mode":"RWC"},{"id":"1fb1d414ca07ad2c","type":"sqlitedb","db":"./db/Report_CheckWeigh.db","mode":"RWC"},{"id":"4cabebdcc173f658","type":"sqlitedb","db":"./db/Report_CheckWeigh.db","mode":"RWC"},{"id":"a811dd20332e9e5f","type":"sqlitedb","db":"./db/Report_MobileRobot.db","mode":"RWC"},{"id":"72e48ed5298b1b7a","type":"tls-config","name":"","cert":"","key":"","ca":"","certname":"","keyname":"","caname":"","servername":"","verifyservercert":false,"alpnprotocol":""},{"id":"1cb8e3989b105072","type":"sqlitedb","db":"./db/VibrationCycleTime.db","mode":"RWC"},{"id":"00bbaea9f902ff99","type":"sqlitedb","db":"./db/Report_MobileRobot.db","mode":"RWC"},{"id":"934c847262f0ef05","type":"function","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"NPM-PACK-ALL","func":"// const child = childProcess.exec(\"npm pack --output ../\", {\nconst child = childProcess.exec(`npm pack`, {\n    cwd: msg.payload\n}, function (error, stdout, stderr) {\n    if (error) {\n        node.warn(error);\n        node.warn(stderr); // Log stderr\n    } else {\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 5000);\n    }\n});","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[{"var":"childProcess","module":"child_process"}],"x":660,"y":380,"wires":[["b883d199addc05cb"]]},{"id":"47e9ce831e32c569","type":"function","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"Ugly File","func":"const minify = global.get(\"minify\");\nconst uglifyJS = global.get(\"uglifyJS\");\n\nasync function compress(input, output) {\n    return await new Promise((res, rej) => {\n        minify({\n            compressor: uglifyJS,\n            input: input,\n            output: output,\n            callback: function (err, min) {\n                if (!err) {\n                    res(true)\n                } else {\n                    rej(false)\n                }\n            }\n        });\n    });\n}\nif (msg.payload == 'CONFIG_SERVER') {\n    let res = await compress('myPackage/config_server/config_server_original.js', 'myPackage/config_server/package/config_server.js');\n    if (res) {\n        msg.payload = 'myPackage/config_server/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'CONFIG_PROJECT') {\n    let res = await compress('myPackage/config_project/config_project_original.js', 'myPackage/config_project/package/config_project.js');\n    if (res) {\n        msg.payload = 'myPackage/config_project/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'CONFIG_PAGE') {\n    let res = await compress('myPackage/config_page/config_page_original.js', 'myPackage/config_page/package/config_page.js');\n    if (res) {\n        msg.payload = 'myPackage/config_page/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'PLC_OMRON') {\n    let res = await compress('myPackage/plc_omron/plc_omron_original.js', 'myPackage/plc_omron/package/plc_omron.js');\n    if (res) {\n        msg.payload = 'myPackage/plc_omron/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'PLC_MODBUS') {\n    let res = await compress('myPackage/plc_modbus/plc_modbus_original.js', 'myPackage/plc_modbus/package/plc_modbus.js');\n    if (res) {\n        msg.payload = 'myPackage/plc_modbus/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'PLC_MODBUS_NODE_RED') {\n    let res = await compress('myPackage/plc_modbus_node_red/plc_modbus_node_red_original.js', 'myPackage/plc_modbus_node_red/package/plc_modbus_node_red.js');\n    if (res) {\n        msg.payload = 'myPackage/plc_modbus_node_red/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'PLC_MODBUS_SERVER') {\n    let res = await compress('myPackage/plc_modbus_server/plc_modbus_server_original.js', 'myPackage/plc_modbus_server/package/plc_modbus_server.js');\n    if (res) {\n        msg.payload = 'myPackage/plc_modbus_server/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'SOCKET_CLIENT') {\n    let res = await compress('myPackage/socket_client/socket_client_original.js', 'myPackage/socket_client/package/socket_client.js');\n    if (res) {\n        msg.payload = 'myPackage/socket_client/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'CONFIG_WEB') {\n    let res = await compress('myPackage/config_web/config_web_original.js', 'myPackage/config_web/package/config_web.js');\n    if (res) {\n        msg.payload = 'myPackage/config_web/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'BCRYPT') {\n    let res = await compress('myPackage/bcrypt_generator/bcrypt_generator_original.js', 'myPackage/bcrypt_generator/package/bcrypt_generator.js');\n    if (res) {\n        msg.payload = 'myPackage/bcrypt_generator/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'SIEMENS') {\n    let res = await compress('myPackage/plc_siemens/plc_siemens_original.js', 'myPackage/plc_siemens/package/plc_siemens.js');\n    if (res) {\n        msg.payload = 'myPackage/plc_siemens/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'VNC') {\n    let res = await compress('myPackage/vnc_setup/vnc_setup_original.js', 'myPackage/vnc_setup/package/vnc_setup.js');\n    if (res) {\n        msg.payload = 'myPackage/vnc_setup/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\n\nif (msg.payload == 'MobileRobot') {\n\n    let res = await compress('myPackage/omron_mobile_robot/omron_mobile_robot_original.js', 'myPackage/omron_mobile_robot/package/omron_mobile_robot.js');\n    if (res) {\n        msg.payload = 'myPackage/omron_mobile_robot/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'CONFIG_WEB_NEXTJS') {\n    let res = await compress('myPackage/config_web_nextjs/config_web_nextjs_original.js', 'myPackage/config_web_nextjs/package/config_web_nextjs.js');\n    if (res) {\n        msg.payload = 'myPackage/config_web_nextjs/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'SCADA') {\n    let res = await compress('myPackage/scada/scada_original.js', 'myPackage/scada/package/scada.js');\n    if (res) {\n        msg.payload = 'myPackage/scada/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'RN_DESIGN') {\n    let res = await compress('myPackage/rn_design/rn_design_original.js', 'myPackage/rn_design/package/rn_design.js');\n    if (res) {\n        msg.payload = 'myPackage/rn_design/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'OPCUA') {\n    let res = await compress('myPackage/opcua_client/opcua_client_original.js', 'myPackage/opcua_client/package/opcua_client.js');\n    if (res) {\n        msg.payload = 'myPackage/opcua_client/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'ACE') {\n    let res = await compress('myPackage/ace/ace_original.js', 'myPackage/ace/package/ace.js');\n    if (res) {\n        msg.payload = 'myPackage/ace/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\nif (msg.payload == 'Siemens') {\n    let res = await compress('myPackage/plc_siemens/plc_siemens_original.js', 'myPackage/plc_siemens/package/plc_siemens.js');\n    if (res) {\n        msg.payload = 'myPackage/plc_siemens/package'\n        node.status({ fill: \"green\", shape: \"dot\", text: \"Success\" });\n        const myTimeout = setTimeout(() => {\n            node.status({});\n        }, 3000);\n        return msg;\n    }\n}\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"// Code added here will be run when the\n// node is being stopped or re-deployed.\nsetTimeout(()=>{\n    node.status({ });\n},2000)","libs":[],"x":500,"y":380,"wires":[["934c847262f0ef05"]]},{"id":"ade3b1aef52ce636","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"PLC_OMRON","payloadType":"str","x":170,"y":160,"wires":[["bbe46c6c9d62aea7"]]},{"id":"b883d199addc05cb","type":"debug","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"debug","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":810,"y":380,"wires":[]},{"id":"9a6a3ceab77bb393","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"PLC_MODBUS","payloadType":"str","x":180,"y":200,"wires":[["12c6d405a9835945"]]},{"id":"c1cefca09fbe3863","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"SOCKET_CLIENT","payloadType":"str","x":190,"y":280,"wires":[["ae4f2083c378b089"]]},{"id":"ab6d1cb24d983f66","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"BCRYPT","payloadType":"str","x":160,"y":320,"wires":[["920d1cf4555365d1"]]},{"id":"f6db8fa514cb1a63","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"SIEMENS","payloadType":"str","x":160,"y":360,"wires":[["433f8a638ccee0a0"]]},{"id":"65586867b69a03d5","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"VNC","payloadType":"str","x":150,"y":400,"wires":[["f468bb0cd9e8fecf"]]},{"id":"9a0b7d1f6a536d04","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"MobileRobot","payloadType":"str","x":170,"y":440,"wires":[["48d10e0bc651ee0e"]]},{"id":"5ab00dec30fb8fe7","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"PLC_MODBUS_SERVER","payloadType":"str","x":210,"y":480,"wires":[["5b30a2094d88507b"]]},{"id":"a089fc53b3a2d46e","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"CONFIG_PAGE","payloadType":"str","x":180,"y":120,"wires":[["f535149b3186669c"]]},{"id":"38495bc9df173a01","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"CONFIG_WEB_NEXTJS","payloadType":"str","x":210,"y":520,"wires":[["721c945949a227d7"]]},{"id":"53872094b9ff9c47","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"SCADA","payloadType":"str","x":150,"y":560,"wires":[["99bf48afea45efef"]]},{"id":"7917f1ffa53139b3","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"RN_DESIGN","payloadType":"str","x":170,"y":600,"wires":[["a61d729c4c4b1e0c"]]},{"id":"8e2a1c01f5b8681f","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"OPCUA","payloadType":"str","x":150,"y":640,"wires":[["a814d644b3463d02"]]},{"id":"6f1be630ef0e0168","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"ACE","payloadType":"str","x":150,"y":680,"wires":[["aa0237c8c172df4e"]]},{"id":"866ddc7aaf452dba","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"Siemens","payloadType":"str","x":160,"y":720,"wires":[["c82c6e58437a3bf0"]]},{"id":"a2fa666c98b60512","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"PLC_MODBUS_NODE_RED","payloadType":"str","x":220,"y":240,"wires":[["47e9ce831e32c569"]]},{"id":"dfa2713d86e77d8c","type":"inject","z":"67bf0d5d2a1fcf16","g":"b1eed42acb7e7bb6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"CONFIG_PROJECT","payloadType":"str","x":190,"y":80,"wires":[["ab1ce343b9ef2063"]]},{"id":"daaddeeb656fd7e1","type":"trigger","z":"78560ab9ca2b5d16","g":"593332529bf305f5","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-500","extend":false,"overrideDelay":false,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":340,"y":480,"wires":[["b20a3b2554f3b99b"]]},{"id":"db0496c4e9f7da3b","type":"inject","z":"78560ab9ca2b5d16","g":"593332529bf305f5","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":480,"wires":[["daaddeeb656fd7e1"]]},{"id":"b20a3b2554f3b99b","type":"function","z":"78560ab9ca2b5d16","g":"593332529bf305f5","name":"Alarm","func":"// setInterval(() => {\ntry {\n    let DataAlarm = global.get('Set_Mqtt_DataAlarm')\n    if (Array.isArray(DataAlarm)) {\n        if (DataAlarm.length > 0) {\n            let dataAlarmCheck = DataAlarm[0]\n            let data = {\n                type: dataAlarmCheck.Type,\n                message: dataAlarmCheck.Message,\n            }\n            msg.payload = data\n            node.send(msg)\n            let DataAlarm2 = global.get('Set_Mqtt_DataAlarm').slice(1)\n            global.set('Set_Mqtt_DataAlarm', DataAlarm2)\n        }\n\n    }\n} catch (error) {\n    node.warn(error);\n};\n\n\n// }, 500)","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":480,"wires":[["aef952cd9b882e16"]]},{"id":"aef952cd9b882e16","type":"mqtt out","z":"78560ab9ca2b5d16","g":"593332529bf305f5","name":"","topic":"MQTT_Alarm","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":660,"y":480,"wires":[]},{"id":"b95c81f2978a9167","type":"function","z":"78560ab9ca2b5d16","g":"d96a71a16749c22d","name":"PROCESS SYSTEM","func":"var VariableSystem = global.get(\"VariableSystem\");\nvar SubFunction = global.get(\"SubFunction\");\nvar Variables = global.get(\"Variable\");\n\nlet data=msg.payload\nif (data.typeDevice == 'System') {\n    SubFunction.ProcessSocketIO_System(data)\n}\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":60,"wires":[[]]},{"id":"bab0278084f9c369","type":"aedes broker","z":"78560ab9ca2b5d16","g":"d96a71a16749c22d","name":"","mqtt_port":"1883","mqtt_ws_bind":"port","mqtt_ws_port":"8083","mqtt_ws_path":"mqtt","cert":"","key":"","certname":"","keyname":"","persistence_bind":"memory","dburl":"","usetls":false,"x":170,"y":260,"wires":[[],[]]},{"id":"20279a9a2202dcd0","type":"mqtt in","z":"78560ab9ca2b5d16","g":"d96a71a16749c22d","name":"","topic":"Client-send-data","qos":"0","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":160,"y":200,"wires":[["b95c81f2978a9167","c2ed1cb639b00da8","e279206013139dcd","3e5260e168b09096","9b21fb82ac7b710f","67c65820a4bec1b9","e5e5c868b8c3169a","7b6793508f3b8cc2"]]},{"id":"c2ed1cb639b00da8","type":"function","z":"78560ab9ca2b5d16","g":"d96a71a16749c22d","name":"PROCESS FINS OMRON","func":"var VariableSystem = global.get(\"VariableSystem\");\nvar SubFunction = global.get(\"SubFunction\");\nvar Variable = global.get(\"Variable\");\n\nlet data = msg.payload\n\nfunction checkVariableTypeNumber(variable) {\n    if (typeof variable === 'string' && !isNaN(Number(variable))) {\n        return true;\n    }\n    if (typeof variable === 'number') {\n        return true;\n    }\n    return false;\n}\n\nfunction ProcessSocketIO_Fins_Flexible(data) {\n    node.warn(data);\n    //Bit\n    if (data.NameCommand === 'BitForce' && data.tag.length > 0 && checkVariableTypeNumber(data.idDevice) && data.typeDevice === 'Fins-Omron') {\n        const regex = /^\\d+\\.\\d+$/;\n        if (regex.test(data.tag)) {\n            //flexible\n            let tempTag = data.tag.split('.')\n            let Word = tempTag[0]\n            let Bit = tempTag[1]\n\n            if (!VariableSystem.TimeDelayWriteWordBitAdjust[parseInt(data.idDevice)]) {\n                Variable.OldWordBitAdjust[parseInt(data.idDevice)] = Variable.Word[parseInt(data.idDevice)].slice()\n            }\n\n\n            if (tempTag.length == 2 && !isNaN(Word) && !isNaN(Bit)) {\n                let mask = 1 << parseInt(Bit);\n                let currentWordOfBitAdjust = Variable.Word[parseInt(data.idDevice)][parseInt(Word)]\n                if (data.mode == 2) {\n                    node.warn(currentWordOfBitAdjust);\n                    currentWordOfBitAdjust ^= mask;\n                }\n                if (data.mode == 0) {\n                    currentWordOfBitAdjust &= ~mask;\n                    node.warn(currentWordOfBitAdjust);\n                }\n                if (data.mode == 1) {\n                    currentWordOfBitAdjust |= mask;\n                    node.warn(currentWordOfBitAdjust);\n                }\n                VariableSystem.TimeDelayWriteWordBitAdjust[parseInt(data.idDevice)] = 10\n                VariableSystem.COMMUNICATION_PLC_OMRON[parseInt(data.idDevice)].write('D' + Word, [currentWordOfBitAdjust]);\n            }\n        }\n    }\n\n    //Number\n    if (data.NameCommand === 'NumberForce' && data.tag.length > 0 && data.typeDevice === 'Fins-Omron') {\n        if (checkVariableTypeNumber(data.idDevice)) {\n            if (data.dataType === 'Word' && checkVariableTypeNumber(data.tag)) {\n                let DataWrite\n                if (parseInt(data.value) >= 0 && parseInt(data.value) < 65536) {\n                    DataWrite = parseInt(data.value)\n                    VariableSystem.COMMUNICATION_PLC_OMRON[parseInt(data.idDevice)].write('D' + parseInt(data.tag), [DataWrite]);\n                } else if (parseInt(data.value) < 0 && parseInt(data.value) > -32767) {\n                    DataWrite = parseInt(data.value) + 65536\n                    VariableSystem.COMMUNICATION_PLC_OMRON[parseInt(data.idDevice)].write('D' + parseInt(data.tag), [DataWrite]);\n                }\n            }\n            if (data.dataType === 'DWord' && checkVariableTypeNumber(data.tag)) {\n                var heightValueDWordAdjust = 0\n                var lowValueDWordAdjust = 0\n                if (parseInt(data.value) >= 0 && parseInt(data.value) < 4294967296) {\n                    heightValueDWordAdjust = parseInt(data.value / 65536);\n                    lowValueDWordAdjust = parseInt(data.value % 65536);\n                    VariableSystem.COMMUNICATION_PLC_OMRON[parseInt(data.idDevice)].write('D' + parseInt(data.tag), [lowValueDWordAdjust, heightValueDWordAdjust]);\n                }\n                if (parseInt(data.value) < 0 && parseInt(data.value) > -2147483648) {\n                    let tempValue = 4294967296 + parseInt(data.value)\n                    heightValueDWordAdjust = parseInt(tempValue / 65536);\n                    lowValueDWordAdjust = parseInt(tempValue % 65536);\n                    VariableSystem.COMMUNICATION_PLC_OMRON[parseInt(data.idDevice)].write('D' + parseInt(data.tag), [lowValueDWordAdjust, heightValueDWordAdjust]);\n                }\n            }\n        }\n    }\n\n    //TextFieldInput\n    if (data.NameCommand === 'TextFieldInput' && !isNaN(data.tag) && data.typeDevice === 'Fins-Omron') {\n        var myBuffer = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        var str = data.value;\n        var buffer = new Buffer(str, 'utf8');\n        for (let i = 0; i < buffer.length; i++) {\n            if (i < 40) myBuffer[i] = buffer[i];\n        }\n        let arr1 = [113, 113, data.tag, data.tag, 0, 0, 0, 0, 0, 0, 0,]\n        let arrResult = arr1.concat(myBuffer)\n\n        if (data.idDevice == '0') {\n            Variable.TextFieldInput[0][parseInt(data.tag)] = arrResult\n        } else {\n            if (parseInt(data.idDevice)) {\n                VariableSystem.COMMUNICATION_PLC_OMRON[parseInt(data.idDevice)].write('D1000', arrResult);\n            }\n        }\n    }\n}\n\nif (data.typeDevice == 'Fins-Omron') {\n    SubFunction.ProcessSocketIO_Fins_Flexible(data)\n}\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":100,"wires":[[]]},{"id":"e279206013139dcd","type":"function","z":"78560ab9ca2b5d16","g":"d96a71a16749c22d","name":"PROCESS MODBUS SERVER","func":"var VariableSystem = global.get(\"VariableSystem\");\nvar SubFunction = global.get(\"SubFunction\");\nvar Variables = global.get(\"Variable\");\n\nlet data=msg.payload\n\nif (data.typeDevice == 'Modbus-Server') {\n    node.warn(data)\n    SubFunction.ProcessSocketIO_Modbus_Server(data)\n    //BitAdjust\n    if (data.NameCommand === 'BitAdjustForce' && !isNaN(data.tag)) {\n        if (data.tag !== '') {\n            if(data.mode==2){\n                Variables.StoreModbusServerBit[parseInt(data.idDevice)][parseInt(VariableSystem.PLC_BitStartBitAdjust[parseInt(data.idDevice)]) + parseInt(data.tag)] = !Variables.StoreModbusServerBit[parseInt(data.idDevice)][parseInt(VariableSystem.PLC_BitStartBitAdjust[parseInt(data.idDevice)]) + parseInt(data.tag)]\n            }\n            if (data.mode == 0) {\n                Variables.StoreModbusServerBit[parseInt(data.idDevice)][parseInt(VariableSystem.PLC_BitStartBitAdjust[parseInt(data.idDevice)]) + parseInt(data.tag)] = false\n            }\n            if (data.mode == 1) {\n                Variables.StoreModbusServerBit[parseInt(data.idDevice)][parseInt(VariableSystem.PLC_BitStartBitAdjust[parseInt(data.idDevice)]) + parseInt(data.tag)] = true\n            }\n        }\n    }\n    // //WordAdjust\n    if (data.NameCommand === 'WordAdjustForce' && !isNaN(data.tag)) {\n        if (data.tag !== '') {\n            Variables.StoreModbusServerReg[parseInt(data.idDevice)][parseInt(VariableSystem.PLC_WordStartWordAdjust[parseInt(data.idDevice)]) + parseInt(data.tag)] = data.value\n        }\n    }\n}\n\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":180,"wires":[[]]},{"id":"3e5260e168b09096","type":"function","z":"78560ab9ca2b5d16","g":"d96a71a16749c22d","name":"PROCESS MOBILE ROBOT OMRON","func":"var VariableSystem = global.get(\"VariableSystem\");\nvar SubFunction = global.get(\"SubFunction\");\nvar Variables = global.get(\"Variable\");\n\nlet data = msg.payload\n\nif (data.typeDevice == 'ARCL-MobileRobot') {\n    if (data.NameCommand === 'BitForce' && isNaN(data.tag)) {\n        VariableSystem.COMMUNICATION_MOBILE_ROBOT[parseInt(data.idDevice)].write(data.tag + '\\r\\n')\n        VariableSystem.COMMUNICATION_MOBILE_ROBOT_TIMER[parseInt(data.idDevice)]=3\n    }\n}\n\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":220,"wires":[[]]},{"id":"9b21fb82ac7b710f","type":"function","z":"78560ab9ca2b5d16","g":"d96a71a16749c22d","name":"PROCESS MODBUS CLIENT","func":"var VariableSystem = global.get(\"VariableSystem\");\nvar SubFunction = global.get(\"SubFunction\");\nvar Variables = global.get(\"Variable\");\n\nlet data = msg.payload\nif (data.typeDevice == 'Modbus-Client') {\n    SubFunction.ProcessSocketIO_Modbus(data)\n}\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":140,"wires":[[]]},{"id":"67c65820a4bec1b9","type":"function","z":"78560ab9ca2b5d16","g":"d96a71a16749c22d","name":"PROCESS OPCUA","func":"var VariableSystem = global.get(\"VariableSystem\");\nvar SubFunction = global.get(\"SubFunction\");\nvar Variables = global.get(\"Variable\");\n\nlet data = msg.payload\nif (data.typeDevice == 'OPC-UA') {\n    node.warn(data);\n    SubFunction.ProcessSocketIO_OPCUA(data)\n}\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":410,"y":260,"wires":[[]]},{"id":"e5e5c868b8c3169a","type":"function","z":"78560ab9ca2b5d16","g":"d96a71a16749c22d","name":"PROCESS ACE","func":"var VariableSystem = global.get(\"VariableSystem\");\nvar SubFunction = global.get(\"SubFunction\");\nvar Variable = global.get(\"Variable\");\n\nlet data = msg.payload\nif (data.typeDevice == 'ACE') {\n    SubFunction.ProcessSocketIO_ACE(data)\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":400,"y":300,"wires":[[]]},{"id":"7b6793508f3b8cc2","type":"function","z":"78560ab9ca2b5d16","g":"d96a71a16749c22d","name":"PROCESS PROFINET","func":"var VariableSystem = global.get(\"VariableSystem\");\nvar SubFunction = global.get(\"SubFunction\");\nvar Variables = global.get(\"Variable\");\n\nlet data = msg.payload\nif (data.typeDevice == 'ProfiNet') {\n    node.warn(data);\n    SubFunction.ProcessSocketIO_ProfiNet(data)\n}\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":340,"wires":[[]]},{"id":"7d83c61ce99a5e56","type":"inject","z":"dc9cf18bb9eee563","name":"START_SYSTEM","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":380,"wires":[["901e1b866a4b5a22","3f4d218b69c4842e","b24f2841bb3c7811","12ced6e410446749"]]},{"id":"30f9ecc03c033b18","type":"plc_omron","z":"dc9cf18bb9eee563","name":"PLC NJR","host":"192.168.1.40","port":"9600","indexPLC":"3","topic":"","PLC_Interval":"300","PLC_Length_ReadWrite":"1000","PLC_Word_Start_ReadWrite":"500","x":660,"y":240,"wires":[[]]},{"id":"b24f2841bb3c7811","type":"Omron Mobile Robot","z":"dc9cf18bb9eee563","name":"","host":"192.168.1.100","password":"omron","port":"7171","indexPLC":"1","x":440,"y":320,"wires":[["3ec021e3ca4f0699"]]},{"id":"901e1b866a4b5a22","type":"function","z":"dc9cf18bb9eee563","name":"Initial","func":"// var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nvar SubFunction = global.get(\"SubFunction\");\nvar Variables = global.get(\"Variable\");\n\nVariables.Percent[0] = new Array(20).fill(0);\nVariables.BitAdjust[0] = new Array(20).fill(0);\nVariables.BitDisplay[0] = new Array(20).fill(0);\nVariables.WordAdjust[0] = new Array(20).fill(0);\nVariables.WordDisplay[0] = new Array(20).fill(0);\nVariables.DWordAdjust[0] = new Array(20).fill(0);\nVariables.DWordDisplay[0] = new Array(20).fill(0);\n// Variables.ListString[0] = new Array(20).fill('---');\n// Variables.TextField[0] = new Array(20).fill('---');\nVariables.TextFieldInput[0] = new Array(10).fill(0);\n\nglobal.set('OldDestination','')","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":380,"wires":[[]]},{"id":"cbc011a13d215ced","type":"Config Project","z":"dc9cf18bb9eee563","g":"158869de576da004","license":"$2a$12$K2c35lENlkOBg02rB0Jol.JaT969C/d8WCyvpmSLyNy6a1yc3xow2","port":"8001","mqtt_host":"localhost","mqtt_port":"1883","dbpath":"OmronTraining","x":430,"y":80,"wires":[[]]},{"id":"6cd0bf8f4be83aa1","type":"inject","z":"dc9cf18bb9eee563","g":"158869de576da004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"WRITE","payloadType":"str","x":150,"y":100,"wires":[["73bba3dc402ce220"]]},{"id":"2196ba820f1cf182","type":"inject","z":"dc9cf18bb9eee563","g":"158869de576da004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"TURN_OFF","payloadType":"str","x":170,"y":60,"wires":[["cbc011a13d215ced"]]},{"id":"3f4d218b69c4842e","type":"Scada Web Begin","z":"dc9cf18bb9eee563","x":340,"y":500,"wires":[["267da29bf389f8b6"]]},{"id":"18b225fe8aa427d6","type":"inject","z":"dc9cf18bb9eee563","name":"","props":[{"p":"payload"},{"p":"topic","v":"[{\"dataField\":\"Package\",\"capture\":\"Package\",\"width\":\"auto\"},{\"dataField\":\"Product\",\"capture\":\"Product\",\"width\":\"auto\"},{\"dataField\":\"LotId\",\"capture\":\"LotID\",\"width\":\"auto\"},{\"dataField\":\"Destination\",\"capture\":\"Destination\",\"width\":\"100\"},{\"dataField\":\"Quantity\",\"capture\":\"Quantity\",\"width\":\"100\"},{\"dataField\":\"Remark\",\"capture\":\"Remark\",\"width\":\"auto\"},{\"dataField\":\"User\",\"capture\":\"User\",\"width\":\"80\"},{\"dataField\":\"TypeReport\",\"capture\":\"TypeReport\",\"width\":\"100\"}]","vt":"json"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":180,"y":500,"wires":[["3f4d218b69c4842e"]]},{"id":"267da29bf389f8b6","type":"Scada Web Setup Alarm","z":"dc9cf18bb9eee563","name_page":"Setup Alarm","levelAccess":0,"x":490,"y":500,"wires":[["4e5b6f02059606e5"]]},{"id":"4e5b6f02059606e5","type":"Scada Web User","z":"dc9cf18bb9eee563","name_page":"User","levelAccess":10,"x":670,"y":500,"wires":[["1dc4812e0e3371f2"]]},{"id":"1dc4812e0e3371f2","type":"Scada Web Manage Variable","z":"dc9cf18bb9eee563","name_page":"Manage Variables","levelAccess":"0","x":870,"y":500,"wires":[["9188af99a8750c2a"]]},{"id":"73cd15f814814649","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"BASIC 1","width":"1450","height":"655","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada","x":260,"y":920,"wires":[["84c33b6bb0945f7d"]]},{"id":"84c33b6bb0945f7d","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"Robot - ePLC","width":"1450","height":"655","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada_Robot_ePLC","x":460,"y":920,"wires":[["24eebb77830dd1be"]]},{"id":"24eebb77830dd1be","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"SYSMAC 1","width":"1450","height":"655","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada_Sysmac1","x":690,"y":920,"wires":[["0ff14b9fd3f90d40"]]},{"id":"0ff14b9fd3f90d40","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"SYSMAC 2","width":"1450","height":"655","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada_Sysmac2","x":890,"y":920,"wires":[[]]},{"id":"146efe603cd9c5cf","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"Mobile Robot - Manage Product","width":"1700","height":"900","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada_MobileRobot_Manage_Product","x":250,"y":720,"wires":[["145728c797c9a0ca"]]},{"id":"145728c797c9a0ca","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"Mobile Robot - Line","width":"1700","height":"900","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada_MobileRobot","nameIcon":"","x":550,"y":720,"wires":[["94056e0121df7304"]]},{"id":"94056e0121df7304","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"Mobile Robot - Warehouse","width":"1700","height":"900","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada_MobileRobot_Warehouse","require_login":"true","x":820,"y":720,"wires":[["f856559d90f6a4f8"]]},{"id":"f856559d90f6a4f8","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"Mobile Robot - History","width":"1700","height":"900","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada_MobileRobot_History","nameIcon":"","x":220,"y":780,"wires":[["17e5a4cd78f866b9"]]},{"id":"7b8c666ce49eb3d5","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"Training KPI","width":"1450","height":"655","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada5","x":1150,"y":660,"wires":[[]]},{"id":"17e5a4cd78f866b9","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"Horizontal Machine","width":"1952","height":"962","backgroundColor":"457b9d","backgroundImage":"HorizontalMachine","idPage":"Scada6","x":810,"y":780,"wires":[["1cc1220262ecdc00"]]},{"id":"1cc1220262ecdc00","type":"Scada Web End","z":"dc9cf18bb9eee563","x":810,"y":840,"wires":[]},{"id":"6aa73ac6799717bd","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"Mobile Robot - Control","width":"1700","height":"900","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada_MobileRobot_Control","require_login":"true","nameIcon":"","x":220,"y":680,"wires":[["1ae63dcf519f9881"]]},{"id":"3d1cc4d5e5890deb","type":"inject","z":"dc9cf18bb9eee563","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":400,"y":200,"wires":[["30f9ecc03c033b18"]]},{"id":"4a54daea0e1f9cf4","type":"function","z":"dc9cf18bb9eee563","name":"Check Destination","func":"var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nif (Variable.ListString[0][25] !== '' && global.get('OldDestination') != Variable.ListString[0][25]){\n    global.set('OldDestination', Variable.ListString[0][25])\n    node.warn(Variable.ListString[0][25])\n    VariableSystem.COMMUNICATION_MOBILE_ROBOT[1].write(`goto ${Variable.ListString[0][25]}\\r\\n`)\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1350,"y":340,"wires":[[]]},{"id":"e380d9f75d81f77e","type":"inject","z":"dc9cf18bb9eee563","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1160,"y":340,"wires":[["4a54daea0e1f9cf4"]]},{"id":"8bd409be51a31413","type":"function","z":"dc9cf18bb9eee563","name":"Reset Old","func":"global.set('OldDestination', '')\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1320,"y":240,"wires":[[]]},{"id":"f1bbb07feb91272a","type":"inject","z":"dc9cf18bb9eee563","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1170,"y":240,"wires":[["8bd409be51a31413"]]},{"id":"1d7851b81c64ca0f","type":"function","z":"dc9cf18bb9eee563","name":"---","func":"var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nVariableSystem.COMMUNICATION_MOBILE_ROBOT[1].write(`status\\r\\n`)","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":420,"wires":[[]]},{"id":"fa2b5771612886e4","type":"inject","z":"dc9cf18bb9eee563","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1150,"y":420,"wires":[["1d7851b81c64ca0f"]]},{"id":"3ec021e3ca4f0699","type":"function","z":"dc9cf18bb9eee563","name":"function 55","func":"var Variable = global.get(\"Variable\");\nVariable.TextField[1][1] = msg.payload\n\nglobal.set('CheckStatusMobileRobot', 3)\nif (msg.payload.includes('Failed going to goal') || msg.payload.includes('Parking')) {\n    global.set('OldExecute', '')\n}\nif (msg.payload.includes(`Arrived at ${Variable.ListString[0][25]}`) && Variable.ListString[0][25] != global.get('OldCheckDestination')) {\n    global.set('OldCheckDestination', Variable.ListString[0][25])\n    node.send(msg)\n}\nif (msg.payload.includes('StateOfCharge')) {\n    // const getValue = (label) => {\n    //     const regex = new RegExp(`${label}:\\\\s*([\\\\w.]+)`);\n    //     const match = msg.payload.match(regex);\n    //     return match ? (isNaN(match[1]) ? match[1] : parseFloat(match[1])) : null;\n    // };\n    const getValue = (label) => {\n        const regex = new RegExp(`${label}:\\\\s*(.*)`);\n        const match = msg.payload.match(regex);\n        return match ? (isNaN(match[1]) ? match[1].trim() : parseFloat(match[1])) : null;\n    };\n\n\n    const stateOfCharge = getValue(\"StateOfCharge\");\n    const temperature = getValue(\"Temperature\");\n    const status = getValue(\"Status\");\n    Variable.Number[1][1] = stateOfCharge\n    Variable.Number[1][2] = temperature\n    Variable.ListString[1][0] = status\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":700,"y":320,"wires":[["19c820188a150a81"]]},{"id":"19c820188a150a81","type":"link out","z":"dc9cf18bb9eee563","name":"link out 33","mode":"link","links":["ddd689c2fdae88ed","6296d00e6b378a55","e7987de772d9d753"],"x":825,"y":320,"wires":[]},{"id":"2b591a8fb8240771","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"Vibration","width":"1700","height":"900","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada_Vibration","require_login":"false","nameIcon":"","x":440,"y":560,"wires":[["a7e36dc855be57ed"]]},{"id":"9188af99a8750c2a","type":"Scada Web Main Page","z":"dc9cf18bb9eee563","name_page":"Main Page","width":1920,"height":1080,"backgroundColor":"transparent","backgroundImage":"","idPage":"MainPage","notShowOnMenu":true,"nameIcon":"","x":210,"y":560,"wires":[["2b591a8fb8240771"]]},{"id":"1ed690b4b865f98d","type":"mqtt out","z":"dc9cf18bb9eee563","name":"","topic":"Mqtt_Vibration","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1220,"y":1120,"wires":[]},{"id":"b3f6906b15923d8d","type":"sqlite","z":"dc9cf18bb9eee563","mydb":"1cb8e3989b105072","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":630,"y":1060,"wires":[["ff9697d34e3ac9b3"]]},{"id":"9b211fa707f188b4","type":"function","z":"dc9cf18bb9eee563","name":"Insert Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet Id = 'a' + Math.random().toString(36);\nlet CycleTime = 1000;\nlet PosServo = 200\nmsg.topic = `INSERT INTO VibrationCycleTime (_id,  CycleTime, PosServo, TimeCreate) VALUES ($Id, $CycleTime, $PosServo, $TimeCreate)`\nmsg.payload = [Id, CycleTime, PosServo, Date.now()]\nnode.send(msg)\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":410,"y":1060,"wires":[["b3f6906b15923d8d"]]},{"id":"b5fe4916c41c5358","type":"function","z":"dc9cf18bb9eee563","name":"Create Table","func":"msg.topic = `CREATE TABLE IF NOT EXISTS VibrationCycleTime (\n    _id TEXT UNIQUE,\n    CycleTime REAL,\n    PosServo REAL,\n    TimeCreate INTEGER\n)`;\nnode.send(msg)\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":310,"y":1000,"wires":[["ea262af323bc8654"]]},{"id":"ad2e1df66f8906ef","type":"inject","z":"dc9cf18bb9eee563","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":140,"y":1000,"wires":[["b5fe4916c41c5358"]]},{"id":"ea262af323bc8654","type":"sqlite","z":"dc9cf18bb9eee563","mydb":"1cb8e3989b105072","sqlquery":"msg.topic","sql":"","name":"Execute Create Table","x":520,"y":1000,"wires":[[]]},{"id":"4eacf14b5d9d399f","type":"function","z":"dc9cf18bb9eee563","name":"Query DB","func":"let start_time = msg.req.params.start_time\nlet stop_time = msg.req.params.stop_time\nmsg.topic = `SELECT * FROM ChuSeKCS_NhietDo_Nito WHERE TimeCreate BETWEEN($start_time) AND($stop_time)`\nmsg.payload = [start_time, stop_time]\n\nreturn msg;\n\n\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":620,"y":1220,"wires":[["1be3d05f7972a78c"]]},{"id":"7460c613ae83da60","type":"http in","z":"dc9cf18bb9eee563","name":"","url":"/Mqtt_KCS_NhietDo_Nito/:start_time/:stop_time","method":"get","upload":false,"swaggerDoc":"","x":260,"y":1220,"wires":[["4eacf14b5d9d399f"]]},{"id":"1be3d05f7972a78c","type":"sqlite","z":"dc9cf18bb9eee563","mydb":"1cb8e3989b105072","sqlquery":"msg.topic","sql":"SELECT * FROM Lora\nWHERE TimeCreate BETWEEN (1484086810000) AND (1684986810000)\n","name":"Get Database","x":800,"y":1220,"wires":[["f05356fa808df76d"]]},{"id":"f05356fa808df76d","type":"function","z":"dc9cf18bb9eee563","name":"Convert Timestamp To String","func":"// function convertTimestamps(dataArray) {\n//     return dataArray.map(item => {\n//         let date = new Date(item.TimeCreate);\n//         let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n//         let ConvertTime = (currDate.getHours() < 10 ? \"0\" : '') + currDate.getHours() + ':' + (currDate.getMinutes() < 10 ? \"0\" : '') + currDate.getMinutes() + ':' + (currDate.getSeconds() < 10 ? \"0\" : '') + currDate.getSeconds()\n\n//         return { ...item, TimeCreate: ConvertTime };\n//     });\n// }\n\n// // Convert timestamps\n// msg.payload = convertTimestamps(msg.payload);\n// return msg;\n\n\n\nfunction convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload =  convertTimestamps(msg.payload)\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":1220,"wires":[["4f6114a9bc103f3a"]]},{"id":"4f6114a9bc103f3a","type":"http response","z":"dc9cf18bb9eee563","name":"Response","statusCode":"","headers":{},"x":1300,"y":1220,"wires":[]},{"id":"9df594154539c1fb","type":"inject","z":"dc9cf18bb9eee563","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":250,"y":1060,"wires":[["9b211fa707f188b4"]]},{"id":"ff9697d34e3ac9b3","type":"function","z":"dc9cf18bb9eee563","name":"Query DB","func":"\nmsg.topic = `SELECT * FROM VibrationCycleTime`\nmsg.payload = []\n\nreturn msg;\n\n\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":540,"y":1120,"wires":[["fb2dda5ac20c9cd6"]]},{"id":"fb2dda5ac20c9cd6","type":"sqlite","z":"dc9cf18bb9eee563","mydb":"1cb8e3989b105072","sqlquery":"msg.topic","sql":"SELECT * FROM Lora\nWHERE TimeCreate BETWEEN (1484086810000) AND (1684986810000)\n","name":"Get Database","x":720,"y":1120,"wires":[["55b1ad7c78650346"]]},{"id":"55b1ad7c78650346","type":"function","z":"dc9cf18bb9eee563","name":"Convert Timestamp To String","func":"// function convertTimestamps(dataArray) {\n//     return dataArray.map(item => {\n//         let date = new Date(item.TimeCreate);\n//         let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n//         let ConvertTime = (currDate.getHours() < 10 ? \"0\" : '') + currDate.getHours() + ':' + (currDate.getMinutes() < 10 ? \"0\" : '') + currDate.getMinutes() + ':' + (currDate.getSeconds() < 10 ? \"0\" : '') + currDate.getSeconds()\n\n//         return { ...item, TimeCreate: ConvertTime };\n//     });\n// }\n\n// // Convert timestamps\n// msg.payload = convertTimestamps(msg.payload);\n// return msg;\n\n\n\nfunction convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload =  convertTimestamps(msg.payload)\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":960,"y":1120,"wires":[["1ed690b4b865f98d"]]},{"id":"a7e36dc855be57ed","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"Cobot","width":"1700","height":"900","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Cobot","require_login":"false","nameIcon":"","x":630,"y":560,"wires":[["1e018422910110cb"]]},{"id":"439df5510f8b7859","type":"mqtt in","z":"dc9cf18bb9eee563","g":"2616ecf5c6a8dfdb","name":"","topic":"Variable/Bit","qos":"0","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":1320,"wires":[["8fdbbb2b275fa32d"]]},{"id":"8fdbbb2b275fa32d","type":"function","z":"dc9cf18bb9eee563","g":"2616ecf5c6a8dfdb","name":"Convert Bit Omron","func":"let data = '';\nif (Array.isArray(msg.payload)) {\n    msg.payload.forEach(function (element) {\n        data += `${element.nameTag}\\tBOOL\\t\\t%D${element.tag}\\tTRUE\\tFALSE\\tDo not publish\\n`;\n    });\n}\nmsg.payload = data; // Remove any trailing newlines\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":410,"y":1320,"wires":[["c6862ae55330b2db"]]},{"id":"c6862ae55330b2db","type":"mqtt out","z":"dc9cf18bb9eee563","g":"2616ecf5c6a8dfdb","name":"","topic":"Variable/BitProcess","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":730,"y":1320,"wires":[]},{"id":"da792e477ecfa9e0","type":"function","z":"dc9cf18bb9eee563","g":"2616ecf5c6a8dfdb","name":"Convert String Omron","func":"let data = '';\nif (Array.isArray(msg.payload)) {\n    msg.payload.forEach(function (element) {\n        data += `${element.nameTag}\\tSTRING[40]\\t\\t%D${element.tag}\\tTRUE\\tFALSE\\tDo not publish\\n`;\n    });\n}\nmsg.payload = data; // Remove any trailing newlines\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":1440,"wires":[["c5e0539cf3a7dc86"]]},{"id":"bb27f69b159c3f02","type":"mqtt in","z":"dc9cf18bb9eee563","g":"2616ecf5c6a8dfdb","name":"","topic":"Variable/String","qos":"0","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":1440,"wires":[["da792e477ecfa9e0"]]},{"id":"c5e0539cf3a7dc86","type":"mqtt out","z":"dc9cf18bb9eee563","g":"2616ecf5c6a8dfdb","name":"","topic":"Variable/StringProcess","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":740,"y":1440,"wires":[]},{"id":"c165e8f8551a24b3","type":"function","z":"dc9cf18bb9eee563","g":"2616ecf5c6a8dfdb","name":"Convert Number Omron","func":"let data = '';\nif (Array.isArray(msg.payload)) {\n    msg.payload.forEach(function (element) {\n        data += `${element.nameTag}\\tInt\\t\\t%D${element.tag}\\tTRUE\\tFALSE\\tDo not publish\\n`;\n    });\n}\nmsg.payload = data; // Remove any trailing newlines\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":1380,"wires":[["c2046126a48ff072"]]},{"id":"e862786273c2c715","type":"mqtt in","z":"dc9cf18bb9eee563","g":"2616ecf5c6a8dfdb","name":"","topic":"Variable/Number","qos":"0","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":1380,"wires":[["c165e8f8551a24b3"]]},{"id":"c2046126a48ff072","type":"mqtt out","z":"dc9cf18bb9eee563","g":"2616ecf5c6a8dfdb","name":"","topic":"Variable/NumberProcess","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":750,"y":1380,"wires":[]},{"id":"1ae63dcf519f9881","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"Mobile Robot - Program","width":"1700","height":"900","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada_MobileRobot_Program","require_login":"true","nameIcon":"","x":510,"y":680,"wires":[["146efe603cd9c5cf"]]},{"id":"94e12ed70aada921","type":"function","z":"dc9cf18bb9eee563","name":"Get DB","func":"\nmsg.payload=global.get(\"ConfigPageServer\")\nnode.send(msg);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":360,"y":840,"wires":[["b6b8b5361d906e74"]]},{"id":"3b01f0045eb6e20a","type":"http in","z":"dc9cf18bb9eee563","name":"/ConfigPage","url":"/ConfigPage","method":"get","upload":false,"swaggerDoc":"","x":190,"y":840,"wires":[["94e12ed70aada921"]]},{"id":"b6b8b5361d906e74","type":"http response","z":"dc9cf18bb9eee563","name":"Response","statusCode":"200","headers":{"content-type":"application/json"},"x":520,"y":840,"wires":[]},{"id":"1e018422910110cb","type":"Scada Web Page","z":"dc9cf18bb9eee563","name_page":"COBOT - Program","width":"1700","height":"1000","backgroundColor":"457b9d","backgroundImage":"2","idPage":"Scada_Cobot_Program","require_login":"true","nameIcon":"","x":830,"y":560,"wires":[["6aa73ac6799717bd"]]},{"id":"12ced6e410446749","type":"plc_modbus","z":"dc9cf18bb9eee563","name":"","idModbus":"1","host":"192.168.1.110","port":502,"indexPLC":"2","topic":"","debug":false,"PLC_Interval":500,"x":450,"y":420,"wires":[[]]},{"id":"82f7759fd19683d8","type":"function","z":"dc9cf18bb9eee563","name":"function 61","func":"var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nnode.warn(Variable.Bit);\n\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":100,"wires":[[]]},{"id":"f0266c448c5b16ae","type":"inject","z":"dc9cf18bb9eee563","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":680,"y":100,"wires":[["82f7759fd19683d8"]]},{"id":"056d1577f9fecdc1","type":"function","z":"3928bff73625841e","g":"ae8b240d474576c5","name":"Insert Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet ID = 'a' + Math.random().toString(36)\nlet NameProduct = Variable.ListString[0][0];\nlet ProductCode = Variable.ListString[0][1];\nlet Quantity = Variable.Number[0][1];\nlet Location = Variable.ListString[0][2];\nmsg.topic = `INSERT INTO Report_MobileRobot_Product (\n    _id, NameProduct, ProductCode, Quantity, Location, TimeCreate)\n    VALUES (\n    $ID, $NameProduct, $ProductCode, $Quantity, $Location, $TimeCreate)`\nmsg.payload = [ID, NameProduct, ProductCode, Quantity, Location, Date.now()]\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":830,"y":280,"wires":[["44c532a111a05994"]]},{"id":"44c532a111a05994","type":"sqlite","z":"3928bff73625841e","g":"ae8b240d474576c5","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1010,"y":280,"wires":[["0d73af64fc422ea1"]]},{"id":"0d73af64fc422ea1","type":"function","z":"3928bff73625841e","g":"ae8b240d474576c5","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Lưu Thành Công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1210,"y":280,"wires":[["7f77782813c0a995"]]},{"id":"7330b542688f973d","type":"mqtt in","z":"3928bff73625841e","g":"ae8b240d474576c5","name":"","topic":"MQTT_MobileRobot_ThemDuLieuKho","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":280,"wires":[["28f6949c9783fd0f"]]},{"id":"28f6949c9783fd0f","type":"function","z":"3928bff73625841e","g":"ae8b240d474576c5","name":"Check Condition Before Insert Database","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][0] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\n\nif (Variables.Number[0][1] > 0 && Variables.ListString[0][0].length > 0 && Variables.ListString[0][1].length > 0) {\n    msg.payload = 1;\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Đủ Thông Tin'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":560,"y":280,"wires":[["056d1577f9fecdc1"]]},{"id":"7f77782813c0a995","type":"link out","z":"3928bff73625841e","g":"ae8b240d474576c5","name":"link out 1","mode":"link","links":["6f0cb9172826a6bc"],"x":1335,"y":280,"wires":[]},{"id":"99504cafe674d77f","type":"function","z":"3928bff73625841e","g":"81c0c7c96d5e8d54","name":"Query DB","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Product`\nnode.send(msg);\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":300,"y":380,"wires":[["54ec12230cfb974d"]]},{"id":"54ec12230cfb974d","type":"sqlite","z":"3928bff73625841e","g":"81c0c7c96d5e8d54","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":480,"y":380,"wires":[["44a07703b0294c17"]]},{"id":"44a07703b0294c17","type":"function","z":"3928bff73625841e","g":"81c0c7c96d5e8d54","name":"REPORT","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":680,"y":380,"wires":[["a2662f2da689f7fc"]]},{"id":"a2662f2da689f7fc","type":"mqtt out","z":"3928bff73625841e","g":"81c0c7c96d5e8d54","name":"","topic":"Mqtt_MobileRobot_DataGrid_Product","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":930,"y":380,"wires":[]},{"id":"6f0cb9172826a6bc","type":"link in","z":"3928bff73625841e","g":"81c0c7c96d5e8d54","name":"link in 1","links":["7f77782813c0a995","ff828c0f94a05d12"],"x":195,"y":380,"wires":[["99504cafe674d77f"]]},{"id":"356776eb0b925b54","type":"status","z":"3928bff73625841e","g":"81c0c7c96d5e8d54","name":"","scope":["a2662f2da689f7fc"],"x":120,"y":420,"wires":[["99504cafe674d77f"]]},{"id":"0b02be3edecb7eaa","type":"inject","z":"3928bff73625841e","g":"81c0c7c96d5e8d54","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":290,"y":440,"wires":[["99504cafe674d77f"]]},{"id":"def8e63b95108f9a","type":"mqtt in","z":"3928bff73625841e","g":"5cdc3c172281b826","name":"","topic":"Mqtt_MobileRobot_DataGrid_Product_Response","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":240,"y":540,"wires":[["0d20deef5b257453"]]},{"id":"0d20deef5b257453","type":"function","z":"3928bff73625841e","g":"5cdc3c172281b826","name":"Add Data Selected","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nVariable.ListString[0][6]=msg.payload.record.NameProduct\nVariable.ListString[0][7] = msg.payload.record.ProductCode\nVariable.Number[0][5] = msg.payload.record.Quantity\nVariable.ListString[0][8] = msg.payload.record.Location\nglobal.set('Product_Row_Select_Id',msg.payload.record._id)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":570,"y":540,"wires":[[]]},{"id":"2f0c9994740c2d2f","type":"function","z":"3928bff73625841e","g":"64aa486c10a3ee94","name":"Insert Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet ID = 'a' + Math.random().toString(36)\nlet NameProduct = Variable.ListString[0][13];\nlet ProductCode = Variable.ListString[0][14];\nlet Quantity = Variable.Number[0][6];\nlet Location = Variable.ListString[0][16];\nlet Destination = Variable.ListString[0][12];\nlet Status='Waiting'\nmsg.topic = `INSERT INTO Report_MobileRobot_Warehouse (\n    _id, NameProduct, ProductCode, Quantity, Location, TimeCreate,Destination,Status)\n    VALUES (\n    $ID, $NameProduct, $ProductCode, $Quantity, $Location, $TimeCreate, $Destination,$Status )`\nmsg.payload = [ID, NameProduct, ProductCode, Quantity, Location, Date.now(), Destination, Status]\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":670,"y":1260,"wires":[["a46d0d7a7c738d15"]]},{"id":"a46d0d7a7c738d15","type":"sqlite","z":"3928bff73625841e","g":"64aa486c10a3ee94","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":870,"y":1260,"wires":[["808f9951a982459b"]]},{"id":"808f9951a982459b","type":"function","z":"3928bff73625841e","g":"64aa486c10a3ee94","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Lưu Thành Công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1090,"y":1260,"wires":[["063d48f9230a0c39"]]},{"id":"aa78c21a4c7d41ba","type":"mqtt in","z":"3928bff73625841e","g":"64aa486c10a3ee94","name":"","topic":"Mqtt_MobileRobot_Line_AddNewData","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":1260,"wires":[["1290ec7fed78e7e0"]]},{"id":"1290ec7fed78e7e0","type":"function","z":"3928bff73625841e","g":"64aa486c10a3ee94","name":"Check Condition","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][14] = false;\n}, 500);\n\n\nif (global.get('Line_Product_Row_Select_Current_Quantity') > 0 && Variables.ListString[0][12].length > 0 && Variables.ListString[0][13].length > 0 && Variables.ListString[0][14].length > 0) {\n    if (Variables.Number[0][6] <= global.get('Line_Product_Row_Select_Current_Quantity')) {\n        if (Variables.Number[0][6]>0){\n            msg.payload = 1;\n            node.send(msg);\n        }else{\n            let tempData = global.get('Set_Mqtt_DataAlarm')\n            if (!Array.isArray(tempData)) tempData = []\n            let data = {\n                Type: 'warning',\n                Message: 'Order Number == 0'\n            }\n            tempData.push(data)\n            global.set('Set_Mqtt_DataAlarm', tempData)\n        }\n       \n    } else {\n        let tempData = global.get('Set_Mqtt_DataAlarm')\n        if (!Array.isArray(tempData)) tempData = []\n        let data = {\n            Type: 'warning',\n            Message: 'Over order number'\n        }\n        tempData.push(data)\n        global.set('Set_Mqtt_DataAlarm', tempData)\n    }\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Đủ Thông Tin'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":1260,"wires":[["2f0c9994740c2d2f"]]},{"id":"1770ca5ff17c0d45","type":"link out","z":"3928bff73625841e","g":"64aa486c10a3ee94","name":"link out 2","mode":"link","links":["e98c0716279a63be"],"x":1375,"y":1260,"wires":[]},{"id":"a84997c5af6a3cef","type":"function","z":"3928bff73625841e","g":"fe6c0f600e5af025","name":"Query DB","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Warehouse where Status='Waiting'`\nnode.send(msg);\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":180,"y":1100,"wires":[["84771afd82f42515"]]},{"id":"84771afd82f42515","type":"sqlite","z":"3928bff73625841e","g":"fe6c0f600e5af025","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":360,"y":1100,"wires":[["b414234d4a3801e1"]]},{"id":"b414234d4a3801e1","type":"function","z":"3928bff73625841e","g":"fe6c0f600e5af025","name":"REPORT","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":560,"y":1100,"wires":[["b6fe4fa1d2902b94","024f0e1ef9f1f193"]]},{"id":"b6fe4fa1d2902b94","type":"mqtt out","z":"3928bff73625841e","g":"fe6c0f600e5af025","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":810,"y":1100,"wires":[]},{"id":"e98c0716279a63be","type":"link in","z":"3928bff73625841e","g":"fe6c0f600e5af025","name":"link in 2","links":["1770ca5ff17c0d45","667daf01737c4d02","b11fbd2722e4c266"],"x":75,"y":1100,"wires":[["a84997c5af6a3cef"]]},{"id":"fe5d08b2a715cf15","type":"status","z":"3928bff73625841e","g":"fe6c0f600e5af025","name":"","scope":["b6fe4fa1d2902b94"],"x":180,"y":1140,"wires":[["a84997c5af6a3cef"]]},{"id":"e89c65915e135388","type":"function","z":"3928bff73625841e","g":"124efc52554c0181","name":"Query DB Warehouse","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Warehouse where Status = 'Finish' ORDER BY TimeCreate ASC`\nnode.send(msg);\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":2480,"wires":[["6db7c6e27dfd3b33"]]},{"id":"6db7c6e27dfd3b33","type":"sqlite","z":"3928bff73625841e","g":"124efc52554c0181","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":580,"y":2480,"wires":[["58e30ec9e109d5af"]]},{"id":"58e30ec9e109d5af","type":"function","z":"3928bff73625841e","g":"124efc52554c0181","name":"REPORT","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":740,"y":2480,"wires":[["0f4bbb170e8d49b3"]]},{"id":"0f4bbb170e8d49b3","type":"mqtt out","z":"3928bff73625841e","g":"124efc52554c0181","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_WareHouse_Finish","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1090,"y":2480,"wires":[]},{"id":"665b62058ce44e46","type":"link in","z":"3928bff73625841e","g":"124efc52554c0181","name":"link in 5","links":["60a20d4fa46eb4e9","da0c8f1201d1b285"],"x":215,"y":2480,"wires":[["e89c65915e135388"]]},{"id":"c63b63041a96e303","type":"status","z":"3928bff73625841e","g":"124efc52554c0181","name":"","scope":["0f4bbb170e8d49b3"],"x":200,"y":2520,"wires":[["e89c65915e135388"]]},{"id":"eda3e58634ca12ee","type":"function","z":"3928bff73625841e","g":"f71786c6395d9864","name":"Check Condition Before Insert Database","func":"//Gan Lại Time Create De Save Thu Tu\nfunction convertTimestamps(dataArray) {\n    return dataArray.map((item,index) => {\n        return { ...item, TimeCreate: index };\n    });\n}\n\nglobal.set('SaveArrayDragDrop', convertTimestamps(msg.payload.DragDropTable))\n// if ((Variables.Number[0][4] > 0 && Variables.ListString[0][7].length > 0 && Variables.ListString[0][8].length > 0 && Variables.ListString[0][11] != '---' )) {\n//     global.set('SaveArrayDragDrop', convertTimestamps(msg.payload.DragDropTable))\n// } else {\n//     let tempData = global.get('Set_Mqtt_DataAlarm')\n//     if (!Array.isArray(tempData)) tempData = []\n//     let data = {\n//         Type: 'error',\n//         Message: 'Chưa giao hàng xong'\n//     }\n//     tempData.push(data)\n//     global.set('Set_Mqtt_DataAlarm', tempData)\n// }\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":2240,"wires":[[]]},{"id":"100d35ae36892e97","type":"mqtt in","z":"3928bff73625841e","g":"f71786c6395d9864","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_Response_WareHouse_Prepare_DragDrop","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":440,"y":2240,"wires":[["eda3e58634ca12ee"]]},{"id":"f49f91527b400b98","type":"function","z":"3928bff73625841e","g":"13f5fe45664f45e3","name":"Set Destination","func":"var Variable = global.get(\"Variable\");\n\nsetTimeout(() => {\n    Variable.Bit[0][1] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='1'){\n    Variable.ListString[0][12]='Traceability'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][2] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='2'){\n    Variable.ListString[0][12]='Warehouse'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][3] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='3'){\n    Variable.ListString[0][12]='sac'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][4] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='4'){\n    Variable.ListString[0][12]='Vibration'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][5] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='5'){\n    Variable.ListString[0][12]='Quattro'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][6] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='6'){\n    Variable.ListString[0][12]='Pack'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][7] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='7'){\n    Variable.ListString[0][12]='Viper'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][8] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='8'){\n    Variable.ListString[0][12]='GoalTM'\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":540,"y":900,"wires":[[]]},{"id":"813d96d5c712ef18","type":"mqtt in","z":"3928bff73625841e","g":"13f5fe45664f45e3","name":"","topic":"MQTT_MobileRobot_SelectDestination","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":900,"wires":[["f49f91527b400b98"]]},{"id":"ef7b73c0ed0ac975","type":"mqtt in","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_Response_WareHouse_Delete","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":340,"y":2700,"wires":[["e2f372bc7135955e"]]},{"id":"8f3e930cf11cc1b7","type":"function","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"Query DB Warehouse","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Warehouse where Status = 'Finish' ORDER BY TimeCreate ASC`\nnode.send(msg);","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":2700,"wires":[["4e149bac157bae14"]]},{"id":"4e149bac157bae14","type":"sqlite","z":"3928bff73625841e","g":"0a5ccf445935470c","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":1200,"y":2700,"wires":[["6aeb50e57bf3c65d"]]},{"id":"30def1c0ab90ad2e","type":"function","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"Query DB Product","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Product `\nnode.send(msg);\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":2800,"wires":[["fb8795491868c513"]]},{"id":"fb8795491868c513","type":"sqlite","z":"3928bff73625841e","g":"0a5ccf445935470c","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":1140,"y":2800,"wires":[["27c76ced9d3e65ab"]]},{"id":"6aeb50e57bf3c65d","type":"function","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"Store DB Warehouse","func":"global.set('Set_Mqtt_Warehouse', msg.payload)\nreturn msg\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1420,"y":2700,"wires":[["fa61200b9afece04"]]},{"id":"27c76ced9d3e65ab","type":"function","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"Store DB Product","func":"global.set('Set_Mqtt_Product', msg.payload)\nreturn msg","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1350,"y":2800,"wires":[["fa61200b9afece04"]]},{"id":"fa61200b9afece04","type":"function","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"Check","func":"if (global.get('Set_Mqtt_Warehouse')!= null && global.get('Set_Mqtt_Product') !=null){\nreturn msg;\n}\n\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1610,"y":2760,"wires":[["a9024e7af03d4d06"]]},{"id":"f2436f66cdd047ab","type":"function","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"Set null","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][12] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\n\nglobal.set('Set_Mqtt_Warehouse', null)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":720,"y":2700,"wires":[["8f3e930cf11cc1b7"]]},{"id":"e1926cefd8326329","type":"function","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"Set null","func":"global.set('Set_Mqtt_Product', null)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":740,"y":2800,"wires":[["30def1c0ab90ad2e"]]},{"id":"a9024e7af03d4d06","type":"function","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"Update Remain Product","func":"\n\nlet ArrWarehouse = global.get('Set_Mqtt_Warehouse')\nlet ArrProduct = global.get('Set_Mqtt_Product')\n\n\nlet ArrQuery = []\n\nif (Array.isArray(ArrWarehouse) && Array.isArray(ArrProduct)) {\n    let Temp = ArrProduct.filter(item => {\n        return (item.NameProduct == ArrWarehouse[0].NameProduct)\n    })\n\n    let query = `Update Report_MobileRobot_Product Set Quantity=${Temp[0].Quantity - ArrWarehouse[0].Quantity} Where _id=\"${Temp[0]._id}\"`\n    ArrQuery.push(\n        {\n            topic: query\n        }\n    )\n    // for(let index=0;index<ArrWarehouse.length;index++){\n    //     let Temp = ArrProduct.filter(item=>{\n    //         return(item.NameProduct==ArrWarehouse[index].NameProduct)\n    //     })\n\n    //    let query = `Update Report_MobileRobot_Product Set Quantity=${Temp[0].Quantity - ArrWarehouse[index].Quantity} Where _id=\"${Temp[0]._id}\"`\n    //     node.warn(query);\n    //     ArrQuery.push(\n    //         {\n    //             topic:query\n    //         }\n    //     )\n    // }\n}\nnode.warn.Temp\nreturn [ArrQuery]","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1810,"y":2760,"wires":[["849e365bac155f00"]]},{"id":"849e365bac155f00","type":"sqlite","z":"3928bff73625841e","g":"0a5ccf445935470c","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Update Data","x":2040,"y":2760,"wires":[["2b408d2e20103a04"]]},{"id":"2b408d2e20103a04","type":"function","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"Delete Data","func":"//** INSET DATABASE **//\nlet ArrWarehouse = global.get('Set_Mqtt_Warehouse')\nlet ArrQuery = []\nif (Array.isArray(ArrWarehouse)) {\n    let query = `Delete from Report_MobileRobot_Warehouse  Where _id=\"${ArrWarehouse[0]._id}\"`\n    ArrQuery.push(\n        {\n            topic: query\n        }\n    )\n    // for (let index = 0; index < ArrWarehouse.length;index++){\n    //     let query = `Delete from Report_MobileRobot_Warehouse  Where _id=\"${ArrWarehouse[index]._id}\"`\n    //     ArrQuery.push(\n    //         {\n    //             topic:query\n    //         }\n    //     )\n    // }\n}\nreturn [ArrQuery]","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1770,"y":2820,"wires":[["7133f15a89aa51e7"]]},{"id":"7133f15a89aa51e7","type":"sqlite","z":"3928bff73625841e","g":"0a5ccf445935470c","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Delete Data","x":1960,"y":2820,"wires":[["da0c8f1201d1b285"]]},{"id":"da0c8f1201d1b285","type":"link out","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"link out 5","mode":"link","links":["665b62058ce44e46"],"x":2105,"y":2820,"wires":[]},{"id":"4fc69b5ecc919d8c","type":"sqlite","z":"3928bff73625841e","g":"0a5ccf445935470c","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1450,"y":2880,"wires":[["7caddb28149abbe5"]]},{"id":"7caddb28149abbe5","type":"link out","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"link out 9","mode":"link","links":[],"x":1585,"y":2880,"wires":[]},{"id":"cf12ac798e83fefd","type":"inject","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":400,"y":2880,"wires":[["82d130663eea1779"]]},{"id":"82d130663eea1779","type":"function","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"Update Data","func":"\nmsg.topic = `Update Report_MobileRobot_History Set TimeFinish = \"${Date.now()}\" Where Status='Prepare' `;\n\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":2880,"wires":[["e39cf01339f09438"]]},{"id":"91efe54545421420","type":"function","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"Update Data","func":"\n\nmsg.topic = `Update Report_MobileRobot_History Set Status='Finish' Where Status='Prepare' `\n\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1270,"y":2880,"wires":[["4fc69b5ecc919d8c"]]},{"id":"e39cf01339f09438","type":"sqlite","z":"3928bff73625841e","g":"0a5ccf445935470c","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1070,"y":2880,"wires":[["91efe54545421420"]]},{"id":"94029040d2d41ef5","type":"sqlite","z":"3928bff73625841e","g":"b854373501e32bf8","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Create Table","x":600,"y":180,"wires":[[]]},{"id":"4f29ec798d879a14","type":"function","z":"3928bff73625841e","g":"b854373501e32bf8","name":"Create Table","func":"\n    msg.topic = `CREATE TABLE IF NOT EXISTS Report_MobileRobot_Product (\n    _id TEXT PRIMARY KEY UNIQUE,\n    NameProduct TEXT UNIQUE,\n    ProductCode TEXT UNIQUE,\n    Quantity INT,\n    Location TEXT,\n    TimeCreate INTEGER\n)`;\nnode.send(msg)\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":180,"wires":[["94029040d2d41ef5"]]},{"id":"84ed0a07cc2d2ca0","type":"inject","z":"3928bff73625841e","g":"b854373501e32bf8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":180,"wires":[["4f29ec798d879a14"]]},{"id":"5fdbdfc91751c6f6","type":"function","z":"3928bff73625841e","g":"76df519ef3b34873","name":"Create Table","func":"\n    msg.topic = `CREATE TABLE IF NOT EXISTS Report_MobileRobot_Warehouse (\n    _id TEXT PRIMARY KEY UNIQUE,\n    NameProduct TEXT,\n    ProductCode TEXT,\n    Quantity INT,\n    Location TEXT,\n    Destination TEXT,\n    Status TEXT,\n    TimeFinish INTEGER,\n    TimeCreate INTEGER\n)`;\nnode.send(msg)\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":800,"wires":[["44e87b324d0d1669"]]},{"id":"44e87b324d0d1669","type":"sqlite","z":"3928bff73625841e","g":"76df519ef3b34873","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Create Table","x":590,"y":800,"wires":[[]]},{"id":"a988853ac5e9890a","type":"inject","z":"3928bff73625841e","g":"76df519ef3b34873","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":140,"y":800,"wires":[["5fdbdfc91751c6f6"]]},{"id":"bd0d832173890e86","type":"sqlite","z":"3928bff73625841e","g":"4e740f5c1234b749","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Create Table","x":600,"y":3060,"wires":[[]]},{"id":"bb7187974bead65f","type":"function","z":"3928bff73625841e","g":"4e740f5c1234b749","name":"Create Table","func":"\nmsg.topic = `CREATE TABLE IF NOT EXISTS Report_MobileRobot_History (\n    _id TEXT PRIMARY KEY UNIQUE,\n    NameProduct TEXT,\n    ProductCode TEXT,\n    Quantity INT,\n    Location TEXT,\n    Destination TEXT,\n    Status TEXT,\n    TimeFinish INTEGER,\n    TimeCreate INTEGER\n)`;\nnode.send(msg)\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":3060,"wires":[["bd0d832173890e86"]]},{"id":"cc94f19aa37af4c5","type":"inject","z":"3928bff73625841e","g":"4e740f5c1234b749","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":3060,"wires":[["bb7187974bead65f"]]},{"id":"feab193d9764c3e7","type":"mqtt in","z":"3928bff73625841e","g":"a347ffb88ad5a9b8","name":"","topic":"MQTT_MobileRobot_UpdateDuLieuKho","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":640,"wires":[["134f9c30d5e22e74"]]},{"id":"7fd0ea077dd451bf","type":"function","z":"3928bff73625841e","g":"d8edaa67eed5c1ea","name":"Set Initial Data","func":"global.set('Product_Row_Select_Id','')\nglobal.set('Line_Product_Row_Select_Id','')\nglobal.set('Line_Product_Row_Select_Current_Quantity','')\nglobal.set('MobileRobot_Warehouse_DataGrid_Select',null)\nglobal.set('SaveArrayDragDrop', null)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":60,"wires":[["3a516dec94f8b372"]]},{"id":"fc8ce8bb62c42a6d","type":"inject","z":"3928bff73625841e","g":"d8edaa67eed5c1ea","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":140,"y":60,"wires":[["7fd0ea077dd451bf"]]},{"id":"134f9c30d5e22e74","type":"function","z":"3928bff73625841e","g":"a347ffb88ad5a9b8","name":"Check Condition","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][13] = false; //  UPdate Product\n}, 500);\n\n\nif (Variables.Number[0][5] > 0 && Variables.ListString[0][6].length > 0 && Variables.ListString[0][7].length > 0 && global.get('Product_Row_Select_Id').length>0) {\n    msg.payload = 1;\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Đủ Thông Tin'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":460,"y":640,"wires":[["9c5367741c4f6f87"]]},{"id":"9c5367741c4f6f87","type":"function","z":"3928bff73625841e","g":"a347ffb88ad5a9b8","name":"Update Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet query = `Update Report_MobileRobot_Product Set NameProduct='${Variable.ListString[0][6]}', ProductCode='${Variable.ListString[0][7]}', Quantity=${Variable.Number[0][5]}, Location='${Variable.ListString[0][8]}'   Where _id='${global.get('Product_Row_Select_Id')}'`\nmsg.topic = query\nnode.warn(query);\nreturn msg","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":630,"y":640,"wires":[["5b68780a16593ffb"]]},{"id":"5b68780a16593ffb","type":"sqlite","z":"3928bff73625841e","g":"a347ffb88ad5a9b8","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Database","x":810,"y":640,"wires":[["284a362aea2b20cd"]]},{"id":"284a362aea2b20cd","type":"function","z":"3928bff73625841e","g":"a347ffb88ad5a9b8","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Update Product Success'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1010,"y":640,"wires":[["ff828c0f94a05d12"]]},{"id":"ff828c0f94a05d12","type":"link out","z":"3928bff73625841e","g":"a347ffb88ad5a9b8","name":"link out 27","mode":"link","links":["6f0cb9172826a6bc"],"x":1145,"y":640,"wires":[]},{"id":"a7bc79e85decbea4","type":"mqtt in","z":"3928bff73625841e","g":"d33172349a68edc9","name":"","topic":"Mqtt_MobileRobot_Line_DataGrid_Product_Response","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":260,"y":1000,"wires":[["aafefe9681ea9d16"]]},{"id":"aafefe9681ea9d16","type":"function","z":"3928bff73625841e","g":"d33172349a68edc9","name":"Add Data Selected","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nVariable.ListString[0][13]=msg.payload.record.NameProduct\nVariable.ListString[0][14] = msg.payload.record.ProductCode\nVariable.ListString[0][16] = msg.payload.record.Location\n\nglobal.set('Line_Product_Row_Select_Id',msg.payload.record._id)\nglobal.set('Line_Product_Row_Select_Current_Quantity',msg.payload.record.Quantity)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":590,"y":1000,"wires":[[]]},{"id":"58273a6fcc04370f","type":"function","z":"3928bff73625841e","g":"ebbc01dd8057e2c3","name":"Update Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet NameProduct = global.get('MobileRobot_Warehouse_DataGrid_Select')?.NameProduct;\nlet ProductCode = global.get('MobileRobot_Warehouse_DataGrid_Select')?.ProductCode;\nlet Quantity = global.get('MobileRobot_Warehouse_DataGrid_Select')?.Quantity;\nlet Location = global.get('MobileRobot_Warehouse_DataGrid_Select')?.Location;\nlet Destination = global.get('MobileRobot_Warehouse_DataGrid_Select')?.Destination;\n\nmsg.topic = `Update Report_MobileRobot_Warehouse Set Status='Prepare' Where _id = \"${global.get('MobileRobot_Warehouse_DataGrid_Select')?._id}\" `\n\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1090,"y":1580,"wires":[["43ea7276a47341c6"]]},{"id":"43ea7276a47341c6","type":"sqlite","z":"3928bff73625841e","g":"ebbc01dd8057e2c3","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1310,"y":1580,"wires":[["1dea54e3824efed0"]]},{"id":"1dea54e3824efed0","type":"function","z":"3928bff73625841e","g":"ebbc01dd8057e2c3","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Chọn đơn hàng Thành Công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1550,"y":1580,"wires":[["667daf01737c4d02"]]},{"id":"3cd9955a92379f76","type":"mqtt in","z":"3928bff73625841e","g":"ebbc01dd8057e2c3","name":"","topic":"MQTT_MobileRobot_Select_Confirm_WareHouse_Prepare","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":370,"y":1580,"wires":[["8a5c65d64bd9e434"]]},{"id":"8a5c65d64bd9e434","type":"function","z":"3928bff73625841e","g":"ebbc01dd8057e2c3","name":"Check Condition Before Insert Database","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][10] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\n\nif (global.get('MobileRobot_Warehouse_DataGrid_Select')!==null && Variables.Number[0][7] > 0 && Variables.ListString[0][17].length > 0 && Variables.ListString[0][18].length > 0 && Variables.ListString[0][19].length>0) {\n    msg.payload = 1;\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa chọn đơn hàng'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":780,"y":1580,"wires":[["58273a6fcc04370f","b78e5e4c130bcd17"]]},{"id":"667daf01737c4d02","type":"link out","z":"3928bff73625841e","g":"ebbc01dd8057e2c3","name":"link out 3","mode":"link","links":["a332d951d6aa6ac0","e98c0716279a63be"],"x":1745,"y":1580,"wires":[]},{"id":"686ad40a97031ab2","type":"function","z":"3928bff73625841e","g":"2a5a2208b2916c44","name":"Add Data Selected","func":"var Variable = global.get(\"Variable\");\nVariable.ListString[0][17]=msg.payload.record.NameProduct\nVariable.ListString[0][18] = msg.payload.record.ProductCode\nVariable.Number[0][7] = msg.payload.record.Quantity\nVariable.ListString[0][19] = msg.payload.record.Destination\n\nglobal.set('MobileRobot_Warehouse_DataGrid_Select', msg.payload.record)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":1480,"wires":[[]]},{"id":"20c548a6e51e97a5","type":"mqtt in","z":"3928bff73625841e","g":"2a5a2208b2916c44","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_Response_WareHouse","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":380,"y":1480,"wires":[["686ad40a97031ab2"]]},{"id":"024f0e1ef9f1f193","type":"function","z":"3928bff73625841e","g":"fe6c0f600e5af025","name":"Reset Data Select","func":"global.set('MobileRobot_Warehouse_DataGrid_Select', null)","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":1160,"wires":[[]]},{"id":"0313bc47e221ad83","type":"function","z":"3928bff73625841e","g":"c1c185a1647b1f03","name":"Reset Data Select","func":"var Variable = global.get(\"Variable\");\nVariable.ListString[0][17] = ''\nVariable.ListString[0][18] = ''\nVariable.Number[0][7] = 0\nVariable.ListString[0][19] = ''\nglobal.set('MobileRobot_Warehouse_DataGrid_Select', null)\nglobal.set('SaveArrayDragDrop', null)","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":270,"y":1420,"wires":[[]]},{"id":"063d48f9230a0c39","type":"function","z":"3928bff73625841e","g":"64aa486c10a3ee94","name":"Erase Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nVariable.ListString[0][13]='';\nVariable.ListString[0][14]='';\nVariable.Number[0][6]=0;\nVariable.ListString[0][16]='';\nVariable.ListString[0][12]='';\nreturn msg","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1270,"y":1260,"wires":[["1770ca5ff17c0d45"]]},{"id":"579b2f4cf9548b86","type":"mqtt in","z":"3928bff73625841e","g":"a97180d9d70a8c84","name":"","topic":"MQTT_MobileRobot_WareHouse_CurrentRequirement_Delete","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":380,"y":1700,"wires":[["74f07e699679e94c"]]},{"id":"74f07e699679e94c","type":"function","z":"3928bff73625841e","g":"a97180d9d70a8c84","name":"Delete Current Select","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][15] = false;\n}, 500);\n\n\nif (global.get('MobileRobot_Warehouse_DataGrid_Select') !== null) {\n    msg.topic = `Delete from Report_MobileRobot_Warehouse Where _id = '${global.get('MobileRobot_Warehouse_DataGrid_Select')?._id}'`\n    node.send(msg)\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Not Select Row'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":720,"y":1700,"wires":[["b4dc15bd83b40ea7"]]},{"id":"b4dc15bd83b40ea7","type":"sqlite","z":"3928bff73625841e","g":"a97180d9d70a8c84","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":920,"y":1700,"wires":[["1ca9fa23fec1a030","b78e5e4c130bcd17"]]},{"id":"1ca9fa23fec1a030","type":"function","z":"3928bff73625841e","g":"a97180d9d70a8c84","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Delete Success'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1110,"y":1700,"wires":[["667daf01737c4d02"]]},{"id":"25c09695670ca4df","type":"link in","z":"3928bff73625841e","g":"c1c185a1647b1f03","name":"link in 49","links":["b78e5e4c130bcd17","3a516dec94f8b372"],"x":145,"y":1420,"wires":[["0313bc47e221ad83"]]},{"id":"b78e5e4c130bcd17","type":"link out","z":"3928bff73625841e","g":"c1c185a1647b1f03","name":"link out 28","mode":"link","links":["25c09695670ca4df"],"x":1065,"y":1640,"wires":[]},{"id":"3a516dec94f8b372","type":"link out","z":"3928bff73625841e","g":"d8edaa67eed5c1ea","name":"link out 29","mode":"link","links":["25c09695670ca4df","68e8a3ffd5bacfc5"],"x":445,"y":60,"wires":[]},{"id":"8d11e6f279a4ed5b","type":"function","z":"3928bff73625841e","g":"36dc396bbd23b2df","name":"Query DB","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Warehouse where Status = 'Prepare' `\nnode.send(msg);\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":1900,"wires":[["20c57d31f7ac76dd"]]},{"id":"20c57d31f7ac76dd","type":"sqlite","z":"3928bff73625841e","g":"36dc396bbd23b2df","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":600,"y":1900,"wires":[["3b0e53ecc4d6e1f6"]]},{"id":"3b0e53ecc4d6e1f6","type":"function","z":"3928bff73625841e","g":"36dc396bbd23b2df","name":"REPORT","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":780,"y":1900,"wires":[["33948b7506e48b07","cdf764d4bea2acb6","fc0a2d7dcfe2bda8"]]},{"id":"33948b7506e48b07","type":"mqtt out","z":"3928bff73625841e","g":"36dc396bbd23b2df","name":"","topic":"Mqtt_MobileRobot_DataGrid_WareHouse_Prepare","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1060,"y":1900,"wires":[]},{"id":"a332d951d6aa6ac0","type":"link in","z":"3928bff73625841e","g":"36dc396bbd23b2df","name":"link in 3","links":["667daf01737c4d02","60a20d4fa46eb4e9","b11fbd2722e4c266"],"x":295,"y":1900,"wires":[["8d11e6f279a4ed5b"]]},{"id":"477eed968a0f9069","type":"status","z":"3928bff73625841e","g":"36dc396bbd23b2df","name":"","scope":["33948b7506e48b07"],"x":220,"y":1940,"wires":[["8d11e6f279a4ed5b"]]},{"id":"5e1c643fa7d30826","type":"function","z":"3928bff73625841e","g":"475c823bdf59dc88","name":"Add Data Selected","func":"var Variable = global.get(\"Variable\");\nVariable.ListString[0][20]=msg.payload.record.NameProduct\nVariable.ListString[0][21] = msg.payload.record.ProductCode\nVariable.Number[0][8] = msg.payload.record.Quantity\nVariable.ListString[0][22] = msg.payload.record.Destination\n\nglobal.set('MobileRobot_Warehouse_DataGrid_Select_Prepare', msg.payload.record)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":2040,"wires":[[]]},{"id":"948205ee2fe84a6d","type":"mqtt in","z":"3928bff73625841e","g":"475c823bdf59dc88","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_Response_Prepare","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":370,"y":2040,"wires":[["5e1c643fa7d30826"]]},{"id":"68e8a3ffd5bacfc5","type":"link in","z":"3928bff73625841e","g":"0a32e22db6a654c6","name":"link in 50","links":["3a516dec94f8b372","cdf764d4bea2acb6","b11fbd2722e4c266","60a20d4fa46eb4e9"],"x":145,"y":1820,"wires":[["66c28cef2687fc03"]]},{"id":"66c28cef2687fc03","type":"function","z":"3928bff73625841e","g":"0a32e22db6a654c6","name":"Reset Data Select","func":"var Variable = global.get(\"Variable\");\nVariable.ListString[0][20] = ''\nVariable.ListString[0][21] = ''\nVariable.Number[0][8] = 0\nVariable.ListString[0][22] = ''\nglobal.set('MobileRobot_Warehouse_DataGrid_Select_Prepare', null)\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":270,"y":1820,"wires":[[]]},{"id":"cdf764d4bea2acb6","type":"link out","z":"3928bff73625841e","g":"36dc396bbd23b2df","name":"link out 30","mode":"link","links":["68e8a3ffd5bacfc5"],"x":845,"y":1940,"wires":[]},{"id":"27e5843a4f86887f","type":"mqtt in","z":"3928bff73625841e","g":"ecf3c776fca35717","name":"","topic":"MQTT_MobileRobot_WareHouse_Prepare_Back","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":340,"y":2140,"wires":[["4e8d9e3826189f48"]]},{"id":"4e8d9e3826189f48","type":"function","z":"3928bff73625841e","g":"ecf3c776fca35717","name":"Back Current Select","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][16] = false;\n}, 500);\n\n\nif (global.get('MobileRobot_Warehouse_DataGrid_Select_Prepare') !== null) {\n    msg.topic = `Update Report_MobileRobot_Warehouse Set Status='Waiting' Where _id = \"${global.get('MobileRobot_Warehouse_DataGrid_Select_Prepare')?._id}\" `\n    node.send(msg)\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Not Select Row'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":640,"y":2140,"wires":[["834b20e06bc8e93c"]]},{"id":"834b20e06bc8e93c","type":"sqlite","z":"3928bff73625841e","g":"ecf3c776fca35717","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":840,"y":2140,"wires":[["e692338751dd8833"]]},{"id":"e692338751dd8833","type":"function","z":"3928bff73625841e","g":"ecf3c776fca35717","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Delete Success'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1030,"y":2140,"wires":[["b11fbd2722e4c266"]]},{"id":"b11fbd2722e4c266","type":"link out","z":"3928bff73625841e","g":"ecf3c776fca35717","name":"link out 31","mode":"link","links":["68e8a3ffd5bacfc5","a332d951d6aa6ac0","e98c0716279a63be"],"x":1175,"y":2140,"wires":[]},{"id":"385ff3abcb3e5ea3","type":"mqtt in","z":"3928bff73625841e","g":"24a370dd74fd44fc","name":"","topic":"MQTT_MobileRobot_Select_Confirm_WareHouse_Finish","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":370,"y":2340,"wires":[["9dd868d50db83064"]]},{"id":"9dd868d50db83064","type":"function","z":"3928bff73625841e","g":"24a370dd74fd44fc","name":"Check Condition Before Insert Database","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][11] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif (global.get('SaveArrayDragDrop') !== null) {\n    msg.payload = (global.get(\"SaveArrayDragDrop\"))\n    node.send(msg)\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'No data to submit'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":760,"y":2340,"wires":[["384196072b1bffc3"]]},{"id":"384196072b1bffc3","type":"function","z":"3928bff73625841e","g":"24a370dd74fd44fc","name":"Update Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet ArrQuery=[]\nif(Array.isArray(msg.payload)){\n    for (let index = 0; index < msg.payload.length;index++){\n        let query = `Update Report_MobileRobot_Warehouse Set Status='Finish', TimeCreate=\"${index}\"   Where _id=\"${msg.payload[index]._id}\"`\n        ArrQuery.push(\n            {\n                topic:query\n            }\n        )\n    }\n}\nreturn [ArrQuery]","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1010,"y":2340,"wires":[["e5cdd638bbb86712"]]},{"id":"e5cdd638bbb86712","type":"sqlite","z":"3928bff73625841e","g":"24a370dd74fd44fc","mydb":"a811dd20332e9e5f","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1190,"y":2340,"wires":[["2f89883d9bdc0f9a"]]},{"id":"2f89883d9bdc0f9a","type":"function","z":"3928bff73625841e","g":"24a370dd74fd44fc","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'SUCCESS'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1390,"y":2340,"wires":[["60a20d4fa46eb4e9"]]},{"id":"60a20d4fa46eb4e9","type":"link out","z":"3928bff73625841e","g":"24a370dd74fd44fc","name":"link out 4","mode":"link","links":["665b62058ce44e46","68e8a3ffd5bacfc5","a332d951d6aa6ac0"],"x":1515,"y":2340,"wires":[]},{"id":"5871983e5b4385cc","type":"mqtt in","z":"3928bff73625841e","g":"6a2971ad3e3cb9f3","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_WareHouse_Finish","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":370,"y":2600,"wires":[["c1a35ebf19458a0f"]]},{"id":"c1a35ebf19458a0f","type":"function","z":"3928bff73625841e","g":"6a2971ad3e3cb9f3","name":"Update Current Delivery","func":"var Variable = global.get(\"Variable\");\nif (msg.payload.data && msg.payload.data.length > 0) {\n    Variable.ListString[0][23] = msg.payload.data[0].NameProduct\n    Variable.ListString[0][24] = msg.payload.data[0].ProductCode\n    Variable.Number[0][9] = msg.payload.data[0].Quantity\n    Variable.ListString[0][25] = msg.payload.data[0].Destination\n} else {\n     Variable.ListString[0][23] = ''\n    Variable.ListString[0][24] = ''\n    Variable.Number[0][9] = 0\n    Variable.ListString[0][25] = ''\n}\n\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":730,"y":2600,"wires":[[]]},{"id":"fc0a2d7dcfe2bda8","type":"function","z":"3928bff73625841e","g":"36dc396bbd23b2df","name":"Set Data to data in global","func":"node.warn(msg.payload)\nnode.warn(msg.payload.data)\nglobal.set('SaveArrayDragDrop', msg.payload.data)","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1070,"y":1940,"wires":[[]]},{"id":"8b170f902463dc1b","type":"inject","z":"3928bff73625841e","g":"0a32e22db6a654c6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":920,"y":2040,"wires":[["7621b0c74ea24276"]]},{"id":"7621b0c74ea24276","type":"function","z":"3928bff73625841e","g":"0a32e22db6a654c6","name":"function 54","func":"node.warn(global.get('SaveArrayDragDrop'))","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1070,"y":2040,"wires":[[]]},{"id":"17df83f64ccbad06","type":"inject","z":"3928bff73625841e","g":"36dc396bbd23b2df","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":420,"y":1940,"wires":[["8d11e6f279a4ed5b"]]},{"id":"e2f372bc7135955e","type":"link out","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"link out 32","mode":"link","links":["ddd689c2fdae88ed"],"x":485,"y":2800,"wires":[]},{"id":"ddd689c2fdae88ed","type":"link in","z":"3928bff73625841e","g":"0a5ccf445935470c","name":"link in 51","links":["e2f372bc7135955e","19c820188a150a81"],"x":605,"y":2800,"wires":[["f2436f66cdd047ab","82d130663eea1779","e1926cefd8326329"]]},{"id":"77cb54c8d9d41e26","type":"function","z":"3928bff73625841e","name":"Execute Mobile Robot","func":"var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\n\nif (Variable.ListString[0][25] && Variable.ListString[0][25].length > 0 &&\n    Variable.ListString[0][25] != global.get('OldExecute')) {\n    node.warn('execute Robot');\n    global.set('OldExecute', Variable.ListString[0][25])\n    VariableSystem.COMMUNICATION_MOBILE_ROBOT[1].write('goto '+ Variable.ListString[0][25] + '\\r\\n')\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":3160,"wires":[[]]},{"id":"22531fd67980d424","type":"inject","z":"3928bff73625841e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":200,"y":3160,"wires":[["77cb54c8d9d41e26"]]},{"id":"f7c5e61a33500e23","type":"function","z":"583e03b8225471bf","g":"ca01791b8537f946","name":"Insert Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet ID = 'a' + Math.random().toString(36)\nlet NameProduct = Variable.ListString[0][0];\nlet ProductCode = Variable.ListString[0][1];\nlet Quantity = Variable.Number[0][1];\nlet Location = Variable.ListString[0][2];\nmsg.topic = `INSERT INTO Report_MobileRobot_Product (\n    _id, NameProduct, ProductCode, Quantity, Location, TimeCreate)\n    VALUES (\n    $ID, $NameProduct, $ProductCode, $Quantity, $Location, $TimeCreate)`\nmsg.payload = [ID, NameProduct, ProductCode, Quantity, Location, Date.now()]\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":850,"y":280,"wires":[["2dfd924f612e7f82"]]},{"id":"2dfd924f612e7f82","type":"sqlite","z":"583e03b8225471bf","g":"ca01791b8537f946","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1030,"y":280,"wires":[["610d4f6e11a68038"]]},{"id":"610d4f6e11a68038","type":"function","z":"583e03b8225471bf","g":"ca01791b8537f946","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Lưu Thành Công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1230,"y":280,"wires":[["e679aebf2c44c064"]]},{"id":"27f1ef6508411faa","type":"mqtt in","z":"583e03b8225471bf","g":"ca01791b8537f946","name":"","topic":"MQTT_MobileRobot_ThemDuLieuKho","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":230,"y":280,"wires":[["17220e688c950556"]]},{"id":"17220e688c950556","type":"function","z":"583e03b8225471bf","g":"ca01791b8537f946","name":"Check Condition Before Insert Database","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][0] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\n\nif (Variables.Number[0][1] > 0 && Variables.ListString[0][0].length > 0 && Variables.ListString[0][1].length > 0) {\n    msg.payload = 1;\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Đủ Thông Tin'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":580,"y":280,"wires":[["f7c5e61a33500e23"]]},{"id":"e679aebf2c44c064","type":"link out","z":"583e03b8225471bf","g":"ca01791b8537f946","name":"link out 1","mode":"link","links":["9eb3abca1c89691e"],"x":1355,"y":280,"wires":[]},{"id":"081b748d65ba0f6d","type":"catch","z":"583e03b8225471bf","g":"ca01791b8537f946","name":"","scope":"group","uncaught":false,"x":250,"y":320,"wires":[["5845943a3b078ee5","7219f9264f0db306"]]},{"id":"5845943a3b078ee5","type":"function","z":"583e03b8225471bf","g":"ca01791b8537f946","name":"function 56","func":"let tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'error',\n    Message: 'Đang có lỗi'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":320,"wires":[[]]},{"id":"3775c3c4f7bb92ea","type":"function","z":"583e03b8225471bf","g":"826fcfb4a5a91c04","name":"Query DB","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Product`\nnode.send(msg);\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":420,"wires":[["c0ddc9b250fd9627"]]},{"id":"c0ddc9b250fd9627","type":"sqlite","z":"583e03b8225471bf","g":"826fcfb4a5a91c04","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":500,"y":420,"wires":[["28dba2d7e5ce6c85"]]},{"id":"28dba2d7e5ce6c85","type":"function","z":"583e03b8225471bf","g":"826fcfb4a5a91c04","name":"REPORT","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":700,"y":420,"wires":[["ba88aa7187c61f0e"]]},{"id":"ba88aa7187c61f0e","type":"mqtt out","z":"583e03b8225471bf","g":"826fcfb4a5a91c04","name":"","topic":"Mqtt_MobileRobot_DataGrid_Product","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":950,"y":420,"wires":[]},{"id":"9eb3abca1c89691e","type":"link in","z":"583e03b8225471bf","g":"826fcfb4a5a91c04","name":"link in 1","links":["e679aebf2c44c064","578cf22ba5ac2e79","02408ca4ec07d47c"],"x":215,"y":420,"wires":[["3775c3c4f7bb92ea"]]},{"id":"f795ebdbdd8aa500","type":"status","z":"583e03b8225471bf","g":"826fcfb4a5a91c04","name":"","scope":["ba88aa7187c61f0e"],"x":140,"y":460,"wires":[["3775c3c4f7bb92ea"]]},{"id":"3e0f03ebddf8ee7c","type":"inject","z":"583e03b8225471bf","g":"826fcfb4a5a91c04","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":310,"y":480,"wires":[["3775c3c4f7bb92ea"]]},{"id":"cc86f9e6a1bf460b","type":"mqtt in","z":"583e03b8225471bf","g":"9852a62420369795","name":"","topic":"Mqtt_MobileRobot_DataGrid_Product_Response","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":260,"y":580,"wires":[["0152e401f235f1a5"]]},{"id":"0152e401f235f1a5","type":"function","z":"583e03b8225471bf","g":"9852a62420369795","name":"Add Data Selected","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nVariable.ListString[0][6]=msg.payload.record.NameProduct\nVariable.ListString[0][7] = msg.payload.record.ProductCode\nVariable.Number[0][5] = msg.payload.record.Quantity\nVariable.ListString[0][8] = msg.payload.record.Location\nglobal.set('Product_Row_Select_Id',msg.payload.record._id)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":590,"y":580,"wires":[[]]},{"id":"c0a839cda841a5bf","type":"mqtt in","z":"583e03b8225471bf","g":"55f19dc2ad605535","name":"","topic":"MQTT_MobileRobot_UpdateDuLieuKho","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":230,"y":680,"wires":[["61d5b81df7081024"]]},{"id":"61d5b81df7081024","type":"function","z":"583e03b8225471bf","g":"55f19dc2ad605535","name":"Check Condition","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][13] = false; //  UPdate Product\n}, 500);\n\n\nif (Variables.Number[0][5] > 0 && Variables.ListString[0][6].length > 0 && Variables.ListString[0][7].length > 0 && global.get('Product_Row_Select_Id').length>0) {\n    msg.payload = 1;\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Đủ Thông Tin'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":680,"wires":[["d07b4b476fee334a"]]},{"id":"d07b4b476fee334a","type":"function","z":"583e03b8225471bf","g":"55f19dc2ad605535","name":"Update Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet query = `Update Report_MobileRobot_Product Set NameProduct='${Variable.ListString[0][6]}', ProductCode='${Variable.ListString[0][7]}', Quantity=${Variable.Number[0][5]}, Location='${Variable.ListString[0][8]}', TimeCreate=${Date.now()}   Where _id='${global.get('Product_Row_Select_Id')}'`\nmsg.topic = query\nnode.warn(query);\nreturn msg","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":650,"y":680,"wires":[["b523e183f2293765"]]},{"id":"b523e183f2293765","type":"sqlite","z":"583e03b8225471bf","g":"55f19dc2ad605535","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Database","x":830,"y":680,"wires":[["a28c19279d13e7fd"]]},{"id":"a28c19279d13e7fd","type":"function","z":"583e03b8225471bf","g":"55f19dc2ad605535","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Update Product Success'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1030,"y":680,"wires":[["578cf22ba5ac2e79"]]},{"id":"578cf22ba5ac2e79","type":"link out","z":"583e03b8225471bf","g":"55f19dc2ad605535","name":"link out 27","mode":"link","links":["9eb3abca1c89691e"],"x":1175,"y":680,"wires":[]},{"id":"f4de1a1eae40241e","type":"sqlite","z":"583e03b8225471bf","g":"2f7bd3de11cd564c","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Create Table","x":620,"y":180,"wires":[[]]},{"id":"0c1e6b0d344df0a2","type":"function","z":"583e03b8225471bf","g":"2f7bd3de11cd564c","name":"Create Table","func":"\n    msg.topic = `CREATE TABLE IF NOT EXISTS Report_MobileRobot_Product (\n    _id TEXT PRIMARY KEY UNIQUE,\n    NameProduct TEXT UNIQUE,\n    ProductCode TEXT UNIQUE,\n    Quantity INT,\n    Location TEXT,\n    TimeCreate INTEGER\n)`;\nnode.send(msg)\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":370,"y":180,"wires":[["f4de1a1eae40241e"]]},{"id":"090c7874ade5c2b7","type":"inject","z":"583e03b8225471bf","g":"2f7bd3de11cd564c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":170,"y":180,"wires":[["0c1e6b0d344df0a2"]]},{"id":"7219f9264f0db306","type":"debug","z":"583e03b8225471bf","g":"de62ff23920eeb88","name":"debug 49","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":880,"y":180,"wires":[]},{"id":"3a026cef3d28268b","type":"function","z":"583e03b8225471bf","g":"a6e4b5904e322695","name":"Create Table","func":"\n    msg.topic = `CREATE TABLE IF NOT EXISTS Report_MobileRobot_Warehouse (\n    _id TEXT PRIMARY KEY UNIQUE,\n    NameProduct TEXT,\n    ProductCode TEXT,\n    Quantity INT,\n    Location TEXT,\n    Destination TEXT,\n    Status TEXT,\n    TimeFinish INTEGER,\n    TimeCreate INTEGER\n)`;\nnode.send(msg)\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":370,"y":860,"wires":[["5236f5f6a1d996ed"]]},{"id":"5236f5f6a1d996ed","type":"sqlite","z":"583e03b8225471bf","g":"a6e4b5904e322695","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Create Table","x":610,"y":860,"wires":[[]]},{"id":"9f3d6178f7a7566f","type":"inject","z":"583e03b8225471bf","g":"a6e4b5904e322695","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":860,"wires":[["3a026cef3d28268b"]]},{"id":"037b1866f3ef844b","type":"function","z":"583e03b8225471bf","g":"d16994cdd3e3bf9c","name":"Set Destination","func":"var Variable = global.get(\"Variable\");\n\nsetTimeout(() => {\n    Variable.Bit[0][1] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='1'){\n    Variable.ListString[0][12]='Traceability'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][2] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='2'){\n    Variable.ListString[0][12]='Warehouse'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][3] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='3'){\n    Variable.ListString[0][12]='sac'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][4] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='4'){\n    Variable.ListString[0][12]='Vibration'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][5] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='5'){\n    Variable.ListString[0][12]='Quattro'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][6] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='6'){\n    Variable.ListString[0][12]='Pack'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][7] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='7'){\n    Variable.ListString[0][12]='Viper'\n}\n\nsetTimeout(() => {\n    Variable.Bit[0][8] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif(msg.payload.tag=='8'){\n    Variable.ListString[0][12]='GoalTM'\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":560,"y":960,"wires":[[]]},{"id":"6c58f3a45765e5a8","type":"mqtt in","z":"583e03b8225471bf","g":"d16994cdd3e3bf9c","name":"","topic":"MQTT_MobileRobot_SelectDestination","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":230,"y":960,"wires":[["037b1866f3ef844b"]]},{"id":"de5067359d9e6d32","type":"function","z":"583e03b8225471bf","g":"6b4375add90794fa","name":"Query DB","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Warehouse where Status='Waiting'`\nnode.send(msg);\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":200,"y":1160,"wires":[["a604ee79d2b3b841"]]},{"id":"a604ee79d2b3b841","type":"sqlite","z":"583e03b8225471bf","g":"6b4375add90794fa","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":380,"y":1160,"wires":[["eb3648c93962b0f7"]]},{"id":"eb3648c93962b0f7","type":"function","z":"583e03b8225471bf","g":"6b4375add90794fa","name":"REPORT","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":580,"y":1160,"wires":[["8a7e322862fb90d1","072e4dab4f7662c6"]]},{"id":"8a7e322862fb90d1","type":"mqtt out","z":"583e03b8225471bf","g":"6b4375add90794fa","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":830,"y":1160,"wires":[]},{"id":"a40e65dbd2bfde6d","type":"link in","z":"583e03b8225471bf","g":"6b4375add90794fa","name":"link in 2","links":["3a1e89d3f0d3e3ef","a83a3c57bbb94f8b","b9d36a398fab77e2"],"x":95,"y":1160,"wires":[["de5067359d9e6d32"]]},{"id":"0fa1c0f2536229ed","type":"status","z":"583e03b8225471bf","g":"6b4375add90794fa","name":"","scope":["8a7e322862fb90d1"],"x":200,"y":1220,"wires":[["de5067359d9e6d32"]]},{"id":"072e4dab4f7662c6","type":"function","z":"583e03b8225471bf","g":"6b4375add90794fa","name":"Reset Data Select","func":"global.set('MobileRobot_Warehouse_DataGrid_Select', null)","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":1220,"wires":[[]]},{"id":"7a2c643bebc91f69","type":"function","z":"583e03b8225471bf","g":"eeaf1a99ef2628c1","name":"Insert Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet ID = 'a' + Math.random().toString(36)\nlet NameProduct = Variable.ListString[0][13];\nlet ProductCode = Variable.ListString[0][16];\nlet Quantity = Variable.Number[0][6];\nlet Location = Variable.ListString[0][14];\nlet Destination = Variable.ListString[0][12];\nlet Status='Waiting'\nmsg.topic = `INSERT INTO Report_MobileRobot_Warehouse (\n    _id, NameProduct, ProductCode, Quantity, Location, TimeCreate,Destination,Status)\n    VALUES (\n    $ID, $NameProduct, $ProductCode, $Quantity, $Location, $TimeCreate, $Destination,$Status )`\nmsg.payload = [ID, NameProduct, ProductCode, Quantity, Location, Date.now(), Destination, Status]\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":690,"y":1320,"wires":[["0e5d0272ee97cef6"]]},{"id":"0e5d0272ee97cef6","type":"sqlite","z":"583e03b8225471bf","g":"eeaf1a99ef2628c1","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":890,"y":1320,"wires":[["87471df044d459e4"]]},{"id":"87471df044d459e4","type":"function","z":"583e03b8225471bf","g":"eeaf1a99ef2628c1","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Lưu Thành Công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1110,"y":1320,"wires":[["bdcfa5b95d53c5a6"]]},{"id":"24d02ecf29427db4","type":"mqtt in","z":"583e03b8225471bf","g":"eeaf1a99ef2628c1","name":"","topic":"Mqtt_MobileRobot_Line_AddNewData","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":230,"y":1320,"wires":[["08906a8fd83a46d7"]]},{"id":"08906a8fd83a46d7","type":"function","z":"583e03b8225471bf","g":"eeaf1a99ef2628c1","name":"Check Condition","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][14] = false;\n}, 500);\n\n\nif (global.get('Line_Product_Row_Select_Current_Quantity') > 0 && Variables.ListString[0][12].length > 0 && Variables.ListString[0][13].length > 0 && Variables.ListString[0][16].length > 0) {\n    if (Variables.Number[0][6] <= global.get('Line_Product_Row_Select_Current_Quantity')) {\n        if (Variables.Number[0][6]>0){\n            msg.payload = 1;\n            node.send(msg);\n        }else{\n            let tempData = global.get('Set_Mqtt_DataAlarm')\n            if (!Array.isArray(tempData)) tempData = []\n            let data = {\n                Type: 'warning',\n                Message: 'Order Number == 0'\n            }\n            tempData.push(data)\n            global.set('Set_Mqtt_DataAlarm', tempData)\n        }\n       \n    } else {\n        let tempData = global.get('Set_Mqtt_DataAlarm')\n        if (!Array.isArray(tempData)) tempData = []\n        let data = {\n            Type: 'warning',\n            Message: 'Over order number'\n        }\n        tempData.push(data)\n        global.set('Set_Mqtt_DataAlarm', tempData)\n    }\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Đủ Thông Tin'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":1320,"wires":[["7a2c643bebc91f69"]]},{"id":"3a1e89d3f0d3e3ef","type":"link out","z":"583e03b8225471bf","g":"eeaf1a99ef2628c1","name":"link out 2","mode":"link","links":["a40e65dbd2bfde6d"],"x":1395,"y":1320,"wires":[]},{"id":"bdcfa5b95d53c5a6","type":"function","z":"583e03b8225471bf","g":"eeaf1a99ef2628c1","name":"Erase Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nVariable.ListString[0][13]='';\nVariable.ListString[0][14]='';\nVariable.Number[0][6]=0;\nVariable.ListString[0][16]='';\nVariable.ListString[0][12]='';\nreturn msg","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1290,"y":1320,"wires":[["3a1e89d3f0d3e3ef"]]},{"id":"c5e839a6c0fd917c","type":"mqtt in","z":"583e03b8225471bf","g":"9e3cde1b8a5194b4","name":"","topic":"Mqtt_MobileRobot_Line_DataGrid_Product_Response","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":280,"y":1060,"wires":[["6ae5db3504f3666c"]]},{"id":"6ae5db3504f3666c","type":"function","z":"583e03b8225471bf","g":"9e3cde1b8a5194b4","name":"Add Data Selected","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nVariable.ListString[0][13]=msg.payload.record.NameProduct\nVariable.ListString[0][16] = msg.payload.record.ProductCode\nVariable.ListString[0][14] = msg.payload.record.Location\n\nglobal.set('Line_Product_Row_Select_Id',msg.payload.record._id)\nglobal.set('Line_Product_Row_Select_Current_Quantity',msg.payload.record.Quantity)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":610,"y":1060,"wires":[[]]},{"id":"8f9dde832d177c1c","type":"function","z":"583e03b8225471bf","g":"8940b92ed89dd58d","name":"Reset Data Select","func":"var Variable = global.get(\"Variable\");\nVariable.ListString[0][17] = ''\nVariable.ListString[0][18] = ''\nVariable.Number[0][7] = 0\nVariable.ListString[0][19] = ''\nglobal.set('MobileRobot_Warehouse_DataGrid_Select', null)\nglobal.set('SaveArrayDragDrop', null)","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":210,"y":1540,"wires":[[]]},{"id":"d6e2dcbfc014869d","type":"link in","z":"583e03b8225471bf","g":"8940b92ed89dd58d","name":"link in 49","links":["2f445d8884c01509","c712f2a8c80b5cfb"],"x":85,"y":1540,"wires":[["8f9dde832d177c1c"]]},{"id":"2f445d8884c01509","type":"link out","z":"583e03b8225471bf","g":"8940b92ed89dd58d","name":"link out 28","mode":"link","links":["d6e2dcbfc014869d"],"x":1005,"y":1760,"wires":[]},{"id":"0c6e8578a78b3eb7","type":"function","z":"583e03b8225471bf","g":"36e59ddf5e2e80c4","name":"Add Data Selected","func":"var Variable = global.get(\"Variable\");\nVariable.ListString[0][17]=msg.payload.record.NameProduct\nVariable.ListString[0][18] = msg.payload.record.ProductCode\nVariable.Number[0][7] = msg.payload.record.Quantity\nVariable.ListString[0][19] = msg.payload.record.Destination\n\nglobal.set('MobileRobot_Warehouse_DataGrid_Select', msg.payload.record)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":650,"y":1600,"wires":[[]]},{"id":"19e9b5e367f1ece0","type":"mqtt in","z":"583e03b8225471bf","g":"36e59ddf5e2e80c4","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_Response_WareHouse","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":320,"y":1600,"wires":[["0c6e8578a78b3eb7"]]},{"id":"274cfaf06b440dc7","type":"mqtt in","z":"583e03b8225471bf","g":"9f439ae8a8075d7f","name":"","topic":"MQTT_MobileRobot_WareHouse_CurrentRequirement_Delete","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":320,"y":1820,"wires":[["5b585ba45cd8157b"]]},{"id":"5b585ba45cd8157b","type":"function","z":"583e03b8225471bf","g":"9f439ae8a8075d7f","name":"Delete Current Select","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][15] = false;\n}, 500);\n\n\nif (global.get('MobileRobot_Warehouse_DataGrid_Select') !== null) {\n    msg.topic = `Delete from Report_MobileRobot_Warehouse Where _id = '${global.get('MobileRobot_Warehouse_DataGrid_Select')?._id}'`\n    node.send(msg)\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Not Select Row'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":660,"y":1820,"wires":[["c04a3d08ee41c863"]]},{"id":"c04a3d08ee41c863","type":"sqlite","z":"583e03b8225471bf","g":"9f439ae8a8075d7f","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":860,"y":1820,"wires":[["140171d516cc44a3","2f445d8884c01509"]]},{"id":"140171d516cc44a3","type":"function","z":"583e03b8225471bf","g":"9f439ae8a8075d7f","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Delete Success'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1050,"y":1820,"wires":[["a83a3c57bbb94f8b"]]},{"id":"9c521f4435017360","type":"mqtt in","z":"583e03b8225471bf","g":"277640226e71fb22","name":"","topic":"MQTT_MobileRobot_Select_Confirm_WareHouse_Prepare","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":310,"y":1700,"wires":[["f3e3d5aa42f3b822"]]},{"id":"f3e3d5aa42f3b822","type":"function","z":"583e03b8225471bf","g":"277640226e71fb22","name":"Check Condition Before Insert Database","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][10] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\n\nif (global.get('MobileRobot_Warehouse_DataGrid_Select')!==null && Variables.Number[0][7] > 0 && Variables.ListString[0][17].length > 0 && Variables.ListString[0][18].length > 0 && Variables.ListString[0][19].length>0) {\n    msg.payload = 1;\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa chọn đơn hàng'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":720,"y":1700,"wires":[["33937aa9544be230","2f445d8884c01509"]]},{"id":"33937aa9544be230","type":"function","z":"583e03b8225471bf","g":"277640226e71fb22","name":"Update Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet NameProduct = global.get('MobileRobot_Warehouse_DataGrid_Select')?.NameProduct;\nlet ProductCode = global.get('MobileRobot_Warehouse_DataGrid_Select')?.ProductCode;\nlet Quantity = global.get('MobileRobot_Warehouse_DataGrid_Select')?.Quantity;\nlet Location = global.get('MobileRobot_Warehouse_DataGrid_Select')?.Location;\nlet Destination = global.get('MobileRobot_Warehouse_DataGrid_Select')?.Destination;\n\nmsg.topic = `Update Report_MobileRobot_Warehouse Set Status='Prepare' Where _id = \"${global.get('MobileRobot_Warehouse_DataGrid_Select')?._id}\" `\n\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1030,"y":1700,"wires":[["23967d9b66db95fb"]]},{"id":"23967d9b66db95fb","type":"sqlite","z":"583e03b8225471bf","g":"277640226e71fb22","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1250,"y":1700,"wires":[["1b1a52e77415540d"]]},{"id":"1b1a52e77415540d","type":"function","z":"583e03b8225471bf","g":"277640226e71fb22","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Chọn đơn hàng Thành Công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1490,"y":1700,"wires":[["a83a3c57bbb94f8b"]]},{"id":"a83a3c57bbb94f8b","type":"link out","z":"583e03b8225471bf","g":"277640226e71fb22","name":"link out 3","mode":"link","links":["d642aca888d925af","a40e65dbd2bfde6d"],"x":1685,"y":1700,"wires":[]},{"id":"0afb031d6bd46c49","type":"function","z":"583e03b8225471bf","g":"79c3152c60b364be","name":"Add Data Selected","func":"var Variable = global.get(\"Variable\");\nVariable.ListString[0][20]=msg.payload.record.NameProduct\nVariable.ListString[0][21] = msg.payload.record.ProductCode\nVariable.Number[0][8] = msg.payload.record.Quantity\nVariable.ListString[0][22] = msg.payload.record.Destination\n\nglobal.set('MobileRobot_Warehouse_DataGrid_Select_Prepare', msg.payload.record)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":650,"y":2180,"wires":[[]]},{"id":"d1104b4935afb68e","type":"mqtt in","z":"583e03b8225471bf","g":"79c3152c60b364be","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_Response_Prepare","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":310,"y":2180,"wires":[["0afb031d6bd46c49"]]},{"id":"2c2601886838f658","type":"link in","z":"583e03b8225471bf","g":"0d6b7315a7598035","name":"link in 50","links":["c712f2a8c80b5cfb","a875f24db4e246ef","b9d36a398fab77e2","529e098dce5a46fc"],"x":85,"y":1940,"wires":[["e81d24025b41daed"]]},{"id":"e81d24025b41daed","type":"function","z":"583e03b8225471bf","g":"0d6b7315a7598035","name":"Reset Data Select","func":"var Variable = global.get(\"Variable\");\nVariable.ListString[0][20] = ''\nVariable.ListString[0][21] = ''\nVariable.Number[0][8] = 0\nVariable.ListString[0][22] = ''\nglobal.set('MobileRobot_Warehouse_DataGrid_Select_Prepare', null)\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":210,"y":1940,"wires":[[]]},{"id":"54a0d478e7e0620e","type":"function","z":"583e03b8225471bf","g":"62ff7b0586e311bc","name":"Check Condition Before Insert Database","func":"//Gan Lại Time Create De Save Thu Tu\nfunction convertTimestamps(dataArray) {\n    return dataArray.map((item,index) => {\n        return { ...item, TimeCreate: index };\n    });\n}\n\nglobal.set('SaveArrayDragDrop', convertTimestamps(msg.payload.DragDropTable))\n// if ((Variables.Number[0][4] > 0 && Variables.ListString[0][7].length > 0 && Variables.ListString[0][8].length > 0 && Variables.ListString[0][11] != '---' )) {\n//     global.set('SaveArrayDragDrop', convertTimestamps(msg.payload.DragDropTable))\n// } else {\n//     let tempData = global.get('Set_Mqtt_DataAlarm')\n//     if (!Array.isArray(tempData)) tempData = []\n//     let data = {\n//         Type: 'error',\n//         Message: 'Chưa giao hàng xong'\n//     }\n//     tempData.push(data)\n//     global.set('Set_Mqtt_DataAlarm', tempData)\n// }\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":860,"y":2380,"wires":[[]]},{"id":"a8a3e3d5fbdb4b40","type":"mqtt in","z":"583e03b8225471bf","g":"62ff7b0586e311bc","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_Response_WareHouse_Prepare_DragDrop","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":380,"y":2380,"wires":[["54a0d478e7e0620e"]]},{"id":"98326d6981ac224d","type":"mqtt in","z":"583e03b8225471bf","g":"5250b80d7de53712","name":"","topic":"MQTT_MobileRobot_WareHouse_Prepare_Back","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":280,"y":2280,"wires":[["30b040b1d8407a2c"]]},{"id":"30b040b1d8407a2c","type":"function","z":"583e03b8225471bf","g":"5250b80d7de53712","name":"Back Current Select","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][16] = false;\n}, 500);\n\n\nif (global.get('MobileRobot_Warehouse_DataGrid_Select_Prepare') !== null) {\n    msg.topic = `Update Report_MobileRobot_Warehouse Set Status='Waiting' Where _id = \"${global.get('MobileRobot_Warehouse_DataGrid_Select_Prepare')?._id}\" `\n    node.send(msg)\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Not Select Row'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":580,"y":2280,"wires":[["3df822e031b274bb"]]},{"id":"3df822e031b274bb","type":"sqlite","z":"583e03b8225471bf","g":"5250b80d7de53712","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":780,"y":2280,"wires":[["08478195caf62f16"]]},{"id":"08478195caf62f16","type":"function","z":"583e03b8225471bf","g":"5250b80d7de53712","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Delete Success'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":970,"y":2280,"wires":[["b9d36a398fab77e2"]]},{"id":"b9d36a398fab77e2","type":"link out","z":"583e03b8225471bf","g":"5250b80d7de53712","name":"link out 31","mode":"link","links":["2c2601886838f658","d642aca888d925af","a40e65dbd2bfde6d"],"x":1115,"y":2280,"wires":[]},{"id":"e5d892f72d65de2b","type":"mqtt in","z":"583e03b8225471bf","g":"c44bc8c88dade22c","name":"","topic":"MQTT_MobileRobot_Select_Confirm_WareHouse_Finish","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":310,"y":2480,"wires":[["02238f8fc1670d8b"]]},{"id":"02238f8fc1670d8b","type":"function","z":"583e03b8225471bf","g":"c44bc8c88dade22c","name":"Check Condition Before Insert Database","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][11] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif (global.get('SaveArrayDragDrop') !== null) {\n    msg.payload = (global.get(\"SaveArrayDragDrop\"))\n    node.send(msg)\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'No data to submit'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":700,"y":2480,"wires":[["09f246c1f80613cb"]]},{"id":"09f246c1f80613cb","type":"function","z":"583e03b8225471bf","g":"c44bc8c88dade22c","name":"Update Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet ArrQuery=[]\nif(Array.isArray(msg.payload)){\n    for (let index = 0; index < msg.payload.length;index++){\n        let query = `Update Report_MobileRobot_Warehouse Set Status='Finish', TimeCreate=\"${index}\"   Where _id=\"${msg.payload[index]._id}\"`\n        ArrQuery.push(\n            {\n                topic:query\n            }\n        )\n    }\n}\nreturn [ArrQuery]","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":950,"y":2480,"wires":[["cb85854eba69f83d"]]},{"id":"cb85854eba69f83d","type":"sqlite","z":"583e03b8225471bf","g":"c44bc8c88dade22c","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1130,"y":2480,"wires":[["ce1ecc82df49e352"]]},{"id":"ce1ecc82df49e352","type":"function","z":"583e03b8225471bf","g":"c44bc8c88dade22c","name":"Success Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'SUCCESS'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1330,"y":2480,"wires":[["529e098dce5a46fc"]]},{"id":"529e098dce5a46fc","type":"link out","z":"583e03b8225471bf","g":"c44bc8c88dade22c","name":"link out 4","mode":"link","links":["2c2601886838f658","d642aca888d925af","9a603a5c476068d9"],"x":1455,"y":2480,"wires":[]},{"id":"20c357332993434d","type":"inject","z":"583e03b8225471bf","g":"0d6b7315a7598035","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":880,"y":2180,"wires":[["79aef9cbbb33a9a5"]]},{"id":"79aef9cbbb33a9a5","type":"function","z":"583e03b8225471bf","g":"0d6b7315a7598035","name":"function 54","func":"node.warn(global.get('SaveArrayDragDrop'))","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1050,"y":2180,"wires":[["e1bab90991b3682a"]]},{"id":"d642aca888d925af","type":"link in","z":"583e03b8225471bf","g":"71869c068f382306","name":"link in 3","links":["a83a3c57bbb94f8b","529e098dce5a46fc","b9d36a398fab77e2"],"x":235,"y":2020,"wires":[["82d1fa5dc6861707"]]},{"id":"82d1fa5dc6861707","type":"function","z":"583e03b8225471bf","g":"71869c068f382306","name":"Query DB","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Warehouse where Status = 'Prepare' `\nnode.send(msg);\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":360,"y":2020,"wires":[["5434749f81b5e735"]]},{"id":"8720d7f49ae6352e","type":"status","z":"583e03b8225471bf","g":"71869c068f382306","name":"","scope":["63d1342626691328"],"x":160,"y":2060,"wires":[["82d1fa5dc6861707"]]},{"id":"5434749f81b5e735","type":"sqlite","z":"583e03b8225471bf","g":"71869c068f382306","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":540,"y":2020,"wires":[["164b34ebccf51c0a"]]},{"id":"164b34ebccf51c0a","type":"function","z":"583e03b8225471bf","g":"71869c068f382306","name":"REPORT","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":720,"y":2020,"wires":[["63d1342626691328","a875f24db4e246ef","45eb3fb8b839f984"]]},{"id":"63d1342626691328","type":"mqtt out","z":"583e03b8225471bf","g":"71869c068f382306","name":"","topic":"Mqtt_MobileRobot_DataGrid_WareHouse_Prepare","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1000,"y":2020,"wires":[]},{"id":"a875f24db4e246ef","type":"link out","z":"583e03b8225471bf","g":"71869c068f382306","name":"link out 30","mode":"link","links":["2c2601886838f658"],"x":815,"y":2080,"wires":[]},{"id":"45eb3fb8b839f984","type":"function","z":"583e03b8225471bf","g":"71869c068f382306","name":"Set Data to data in global","func":"node.warn(msg.payload)\nnode.warn(msg.payload.data)\nglobal.set('SaveArrayDragDrop', msg.payload.data)","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1010,"y":2060,"wires":[[]]},{"id":"1c16c890983d289b","type":"inject","z":"583e03b8225471bf","g":"71869c068f382306","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":360,"y":2060,"wires":[["82d1fa5dc6861707"]]},{"id":"e1bab90991b3682a","type":"debug","z":"583e03b8225471bf","g":"0d6b7315a7598035","name":"debug 52","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1240,"y":2180,"wires":[]},{"id":"6458cd85286f0b94","type":"function","z":"583e03b8225471bf","g":"f463597a8d668f8a","name":"Update Current Delivery","func":"var Variable = global.get(\"Variable\");\nif (msg.payload.data && msg.payload.data.length > 0) {\n    Variable.ListString[0][23] = msg.payload.data[0].NameProduct\n    Variable.ListString[0][24] = msg.payload.data[0].ProductCode\n    Variable.Number[0][9] = msg.payload.data[0].Quantity\n    Variable.ListString[0][25] = msg.payload.data[0].Destination\n} else {\n     Variable.ListString[0][23] = ''\n    Variable.ListString[0][24] = ''\n    Variable.Number[0][9] = 0\n    Variable.ListString[0][25] = ''\n}\n\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":670,"y":2820,"wires":[[]]},{"id":"db79b6d94a19086a","type":"mqtt in","z":"583e03b8225471bf","g":"f463597a8d668f8a","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_WareHouse_Finish","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":310,"y":2820,"wires":[["6458cd85286f0b94"]]},{"id":"caa570453b98d7e9","type":"mqtt in","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_Response_WareHouse_Delete","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":340,"y":2940,"wires":[["2113f628ef2d25aa"]]},{"id":"3a23bab08ffc6e69","type":"function","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"Query DB Warehouse","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Warehouse where Status = 'Finish' ORDER BY TimeCreate ASC`\nnode.send(msg);","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":940,"y":2920,"wires":[["11e95fee5ea00fea"]]},{"id":"11e95fee5ea00fea","type":"sqlite","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":1220,"y":2920,"wires":[["df9de0d416c912fc"]]},{"id":"30024b333edaf1f8","type":"function","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"Query DB Product","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Product `\nnode.send(msg);\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":3020,"wires":[["7b5ecc3d8430d838"]]},{"id":"7b5ecc3d8430d838","type":"sqlite","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":1160,"y":3020,"wires":[["fd125bb45b338eda"]]},{"id":"df9de0d416c912fc","type":"function","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"Store DB Warehouse","func":"global.set('Set_Mqtt_Warehouse', msg.payload)\nreturn msg\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1440,"y":2920,"wires":[["507dce0445738256"]]},{"id":"fd125bb45b338eda","type":"function","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"Store DB Product","func":"global.set('Set_Mqtt_Product', msg.payload)\nreturn msg","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1370,"y":3020,"wires":[["507dce0445738256"]]},{"id":"507dce0445738256","type":"function","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"Check","func":"if (global.get('Set_Mqtt_Warehouse')!= null && global.get('Set_Mqtt_Product') !=null){\nreturn msg;\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1630,"y":2980,"wires":[["71efca07dd444708"]]},{"id":"855d2f88e70f5c2e","type":"function","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"Set null","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][12] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\n\nglobal.set('Set_Mqtt_Warehouse', null)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":740,"y":2920,"wires":[["3a23bab08ffc6e69"]]},{"id":"02801f4ddbae6f04","type":"function","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"Set null","func":"global.set('Set_Mqtt_Product', null)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":760,"y":3020,"wires":[["30024b333edaf1f8"]]},{"id":"71efca07dd444708","type":"function","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"Update Remain Product","func":"\n\nlet ArrWarehouse = global.get('Set_Mqtt_Warehouse')\nlet ArrProduct = global.get('Set_Mqtt_Product')\n\n\nlet ArrQuery = []\n\nif (Array.isArray(ArrWarehouse) && Array.isArray(ArrProduct)) {\n    let Temp = ArrProduct.filter(item => {\n        return (item.NameProduct == ArrWarehouse[0].NameProduct)\n    })\n\n    let query = `Update Report_MobileRobot_Product Set Quantity=${Temp[0].Quantity - ArrWarehouse[0].Quantity} Where _id=\"${Temp[0]._id}\"`\n    ArrQuery.push(\n        {\n            topic: query\n        }\n    )\n    // for(let index=0;index<ArrWarehouse.length;index++){\n    //     let Temp = ArrProduct.filter(item=>{\n    //         return(item.NameProduct==ArrWarehouse[index].NameProduct)\n    //     })\n\n    //    let query = `Update Report_MobileRobot_Product Set Quantity=${Temp[0].Quantity - ArrWarehouse[index].Quantity} Where _id=\"${Temp[0]._id}\"`\n    //     node.warn(query);\n    //     ArrQuery.push(\n    //         {\n    //             topic:query\n    //         }\n    //     )\n    // }\n}\nnode.warn.Temp\nreturn [ArrQuery]","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1830,"y":2980,"wires":[["78f2187b2241ac78"]]},{"id":"78f2187b2241ac78","type":"sqlite","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Update Data","x":2060,"y":2980,"wires":[["f9cd332289dd8298"]]},{"id":"f9cd332289dd8298","type":"function","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"Delete Data","func":"//** INSET DATABASE **//\nlet ArrWarehouse = global.get('Set_Mqtt_Warehouse')\nlet ArrQuery = []\nif (Array.isArray(ArrWarehouse)) {\n    let query = `Delete from Report_MobileRobot_Warehouse  Where _id=\"${ArrWarehouse[0]._id}\"`\n    ArrQuery.push(\n        {\n            topic: query\n        }\n    )\n    // for (let index = 0; index < ArrWarehouse.length;index++){\n    //     let query = `Delete from Report_MobileRobot_Warehouse  Where _id=\"${ArrWarehouse[index]._id}\"`\n    //     ArrQuery.push(\n    //         {\n    //             topic:query\n    //         }\n    //     )\n    // }\n}\nreturn [ArrQuery]","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1810,"y":3060,"wires":[["7d403a13f8581756"]]},{"id":"7d403a13f8581756","type":"sqlite","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Delete Data","x":2020,"y":3060,"wires":[["02408ca4ec07d47c"]]},{"id":"02408ca4ec07d47c","type":"link out","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"link out 5","mode":"link","links":["9a603a5c476068d9","9eb3abca1c89691e"],"x":2185,"y":3060,"wires":[]},{"id":"1112d6214a7015f5","type":"sqlite","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1470,"y":3100,"wires":[["74b37d54f0803084"]]},{"id":"74b37d54f0803084","type":"link out","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"link out 9","mode":"link","links":[],"x":1605,"y":3100,"wires":[]},{"id":"d7a3ee5806b3b6be","type":"inject","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":420,"y":3100,"wires":[["b04d8545cbfa8425"]]},{"id":"b04d8545cbfa8425","type":"function","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"Update Data","func":"\nmsg.topic = `Update Report_MobileRobot_History Set TimeFinish = \"${Date.now()}\" Where Status='Prepare' `;\n\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":890,"y":3100,"wires":[["0929db09b2bb2baf"]]},{"id":"bae2a22c2821fb9a","type":"function","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"Update Data","func":"\n\nmsg.topic = `Update Report_MobileRobot_History Set Status='Finish' Where Status='Prepare' `\n\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1290,"y":3100,"wires":[["1112d6214a7015f5"]]},{"id":"0929db09b2bb2baf","type":"sqlite","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1090,"y":3100,"wires":[["bae2a22c2821fb9a"]]},{"id":"6296d00e6b378a55","type":"link in","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"link in 51","links":["19c820188a150a81","2113f628ef2d25aa"],"x":625,"y":3020,"wires":[["855d2f88e70f5c2e","b04d8545cbfa8425","02801f4ddbae6f04"]]},{"id":"2113f628ef2d25aa","type":"link out","z":"583e03b8225471bf","g":"68fa57258e8e9cc0","name":"link out 36","mode":"link","links":["6296d00e6b378a55","e7987de772d9d753"],"x":495,"y":3020,"wires":[]},{"id":"6afc1833a740985e","type":"function","z":"583e03b8225471bf","g":"412e3177afb06ed4","name":"Query DB Warehouse","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Warehouse where Status = 'Finish' ORDER BY TimeCreate ASC`\nnode.send(msg);\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":2660,"wires":[["44e0d8c3ee24ce2f"]]},{"id":"44e0d8c3ee24ce2f","type":"sqlite","z":"583e03b8225471bf","g":"412e3177afb06ed4","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":480,"y":2660,"wires":[["6fcb081a8358b9e0"]]},{"id":"6fcb081a8358b9e0","type":"function","z":"583e03b8225471bf","g":"412e3177afb06ed4","name":"REPORT","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":660,"y":2660,"wires":[["c79742e0a46c8459"]]},{"id":"c79742e0a46c8459","type":"mqtt out","z":"583e03b8225471bf","g":"412e3177afb06ed4","name":"","topic":"Mqtt_MobileRobot_DataGrid_Select_WareHouse_Finish","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":990,"y":2660,"wires":[]},{"id":"9a603a5c476068d9","type":"link in","z":"583e03b8225471bf","g":"412e3177afb06ed4","name":"link in 5","links":["529e098dce5a46fc","02408ca4ec07d47c"],"x":115,"y":2660,"wires":[["6afc1833a740985e"]]},{"id":"e068b40849b3dd22","type":"status","z":"583e03b8225471bf","g":"412e3177afb06ed4","name":"","scope":["c79742e0a46c8459"],"x":280,"y":2720,"wires":[["6afc1833a740985e"]]},{"id":"0d97febabcf3abb4","type":"function","z":"583e03b8225471bf","g":"1b60f0ae1b8ca709","name":"Set Initial Data","func":"global.set('Product_Row_Select_Id','')\nglobal.set('Line_Product_Row_Select_Id','')\nglobal.set('Line_Product_Row_Select_Current_Quantity','')\nglobal.set('MobileRobot_Warehouse_DataGrid_Select',null)\nglobal.set('SaveArrayDragDrop', null)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":60,"wires":[["c712f2a8c80b5cfb"]]},{"id":"09099a866e64c973","type":"inject","z":"583e03b8225471bf","g":"1b60f0ae1b8ca709","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":60,"wires":[["0d97febabcf3abb4"]]},{"id":"c712f2a8c80b5cfb","type":"link out","z":"583e03b8225471bf","g":"1b60f0ae1b8ca709","name":"link out 29","mode":"link","links":["d6e2dcbfc014869d","2c2601886838f658"],"x":465,"y":60,"wires":[]},{"id":"f5f213c3b11e816f","type":"mqtt in","z":"583e03b8225471bf","g":"ef4b3c3ef0b0f3bb","name":"","topic":"MQTT_MobileRobot_UpdateDuLieuKho","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":230,"y":3760,"wires":[["6564dc027c0b21bd"]]},{"id":"6564dc027c0b21bd","type":"function","z":"583e03b8225471bf","g":"ef4b3c3ef0b0f3bb","name":"Check Condition","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][13] = false; //  UPdate Product\n}, 500);\n\n\nif (Variables.Number[0][5] > 0 && Variables.ListString[0][6].length > 0 && Variables.ListString[0][7].length > 0 && global.get('Product_Row_Select_Id').length>0) {\n    msg.payload = 1;\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Đủ Thông Tin'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":3760,"wires":[["23f9bad2fdee1e96"]]},{"id":"23f9bad2fdee1e96","type":"function","z":"583e03b8225471bf","g":"ef4b3c3ef0b0f3bb","name":"Update Data","func":"//** INSET DATABASE **//\n/*\nvar Variable = global.get(\"Variable\");\nlet query = `Update Report_MobileRobot_Product Set NameProduct='${Variable.ListString[0][6]}', ProductCode='${Variable.ListString[0][7]}', Quantity=${Variable.Number[0][5]}, Location='${Variable.ListString[0][8]}', TimeCreate=${Date.now()}   Where _id='${global.get('Product_Row_Select_Id')}'`\nmsg.topic = query\nnode.warn(query);\nreturn msg\n*/\n\n//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet ID = 'a' + Math.random().toString(36)\nlet NameProduct = Variable.ListString[0][6];\nlet ProductCode = Variable.ListString[0][7];\nlet Quantity = Variable.Number[0][5];\nlet Location = Variable.ListString[0][8];\nmsg.topic = `INSERT INTO Report_MobileRobot_Add_Update_History (\n    _id, NameProduct, ProductCode, Quantity, Location, TimeCreate, Status, Destination)\n    VALUES (\n    $ID, $NameProduct, $ProductCode, $Quantity, $Location, $TimeCreate, $Status, $Destination)`\nmsg.payload = [ID, NameProduct, ProductCode, Quantity, Location, Date.now(), \"Update\", \"None\"]\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":690,"y":3760,"wires":[["05062b465afa0650"]]},{"id":"05062b465afa0650","type":"sqlite","z":"583e03b8225471bf","g":"ef4b3c3ef0b0f3bb","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Database","x":890,"y":3760,"wires":[["531753b54317d607"]]},{"id":"531753b54317d607","type":"link out","z":"583e03b8225471bf","g":"ef4b3c3ef0b0f3bb","name":"link out 35","mode":"link","links":["0268470c17ec9004"],"x":1045,"y":3760,"wires":[]},{"id":"a80c6a2c4e73f92b","type":"inject","z":"583e03b8225471bf","g":"ebfef4bf98f97f61","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":3340,"wires":[["9b7352ca0233f71c"]]},{"id":"9b7352ca0233f71c","type":"function","z":"583e03b8225471bf","g":"ebfef4bf98f97f61","name":"Create Table","func":"\nmsg.topic = `CREATE TABLE IF NOT EXISTS Report_MobileRobot_Add_Update_History (\n    _id TEXT PRIMARY KEY UNIQUE,\n    NameProduct TEXT,\n    ProductCode TEXT,\n    Quantity INT,\n    Location TEXT,\n    Destination TEXT,\n    Status TEXT,\n    TimeCreate INTEGER\n)`;\nnode.send(msg)\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":360,"y":3340,"wires":[["7680415278d3975a"]]},{"id":"7680415278d3975a","type":"sqlite","z":"583e03b8225471bf","g":"ebfef4bf98f97f61","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Create Table","x":580,"y":3340,"wires":[[]]},{"id":"aa82a4b8538bdef3","type":"mqtt in","z":"583e03b8225471bf","g":"4f6de5e1260c8dab","name":"","topic":"MQTT_MobileRobot_ThemDuLieuKho","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":230,"y":3460,"wires":[["fd232413bf3f711e"]]},{"id":"450febaec1eaa632","type":"function","z":"583e03b8225471bf","g":"4f6de5e1260c8dab","name":"Insert Data","func":"//** INSET DATABASE **//\n\nvar Variable = global.get(\"Variable\"); \n\nlet ID = 'a' + Math.random().toString(36)\nlet NameProduct = Variable.ListString[0][0];\nlet ProductCode = Variable.ListString[0][1];\nlet Quantity = Variable.Number[0][1];\nlet Location = Variable.ListString[0][2];\nmsg.topic = `INSERT INTO Report_MobileRobot_Add_Update_History (\n    _id, NameProduct, ProductCode, Quantity, Location, TimeCreate, Status, Destination)\n    VALUES (\n    $ID, $NameProduct, $ProductCode, $Quantity, $Location, $TimeCreate, $Status, $Destination)`\nmsg.payload = [ID, NameProduct, ProductCode, Quantity, Location, Date.now(), \"Add\", \"None\"]\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":3460,"wires":[["b15fca580469d850"]]},{"id":"b15fca580469d850","type":"sqlite","z":"583e03b8225471bf","g":"4f6de5e1260c8dab","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1110,"y":3460,"wires":[["f105b86753463a36"]]},{"id":"fd232413bf3f711e","type":"function","z":"583e03b8225471bf","g":"4f6de5e1260c8dab","name":"Check Condition Before Insert Database","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][0] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\nif (Variables.Number[0][1] > 0 && Variables.ListString[0][0].length > 0 && Variables.ListString[0][1].length > 0) {\n    msg.payload = 1;\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Đủ Thông Tin'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":580,"y":3460,"wires":[["450febaec1eaa632"]]},{"id":"f105b86753463a36","type":"link out","z":"583e03b8225471bf","g":"4f6de5e1260c8dab","name":"link out 34","mode":"link","links":["0268470c17ec9004"],"x":1265,"y":3460,"wires":[]},{"id":"0268470c17ec9004","type":"link in","z":"583e03b8225471bf","g":"018db42f62c3f3d2","name":"link in 52","links":["f105b86753463a36","531753b54317d607","bc9b1e129f61344f"],"x":205,"y":3580,"wires":[["3d10669837daf9ba"]]},{"id":"3d10669837daf9ba","type":"function","z":"583e03b8225471bf","g":"018db42f62c3f3d2","name":"Query DB","func":"if (global.get('Mqtt_Start_1') != null && global.get('Mqtt_Finish_1') != null){\n    msg.topic = `SELECT * FROM Report_MobileRobot_Add_Update_History where TimeCreate between ${global.get('Mqtt_Start_1')} and ${global.get('Mqtt_Finish_1')}`\n    node.send(msg);\n} else {\n    msg.topic = `SELECT * FROM Report_MobileRobot_Add_Update_History`\n    node.send(msg);\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":360,"y":3580,"wires":[["7493fd9e8f0301ec"]]},{"id":"7493fd9e8f0301ec","type":"sqlite","z":"583e03b8225471bf","g":"018db42f62c3f3d2","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":560,"y":3580,"wires":[["dab576bacbc74031"]]},{"id":"dab576bacbc74031","type":"function","z":"583e03b8225471bf","g":"018db42f62c3f3d2","name":"REPORT","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":760,"y":3580,"wires":[["22826da5f6b06cdf"]]},{"id":"22826da5f6b06cdf","type":"mqtt out","z":"583e03b8225471bf","g":"018db42f62c3f3d2","name":"","topic":"Mqtt_MobileRobot_DataGrid_Add_Update_History","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1090,"y":3580,"wires":[]},{"id":"4a91983bb34e29ec","type":"status","z":"583e03b8225471bf","g":"018db42f62c3f3d2","name":"","scope":["ba88aa7187c61f0e"],"x":360,"y":3640,"wires":[["3d10669837daf9ba"]]},{"id":"a3332e9c64b4ec48","type":"inject","z":"583e03b8225471bf","g":"018db42f62c3f3d2","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":3640,"wires":[["3d10669837daf9ba"]]},{"id":"6385c253c10fd832","type":"mqtt in","z":"583e03b8225471bf","g":"be239a5ae1879a4b","name":"","topic":"Mqtt_Dt_Start_1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":160,"y":3880,"wires":[["39a01ed4ce15c129"]]},{"id":"3812621295aa48cf","type":"mqtt in","z":"583e03b8225471bf","g":"be239a5ae1879a4b","name":"","topic":"Mqtt_Dt_Finish_1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":160,"y":3960,"wires":[["907d46704ed52beb"]]},{"id":"39a01ed4ce15c129","type":"function","z":"583e03b8225471bf","g":"be239a5ae1879a4b","name":"Time Start","func":"global.set('Mqtt_Start_1', msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":410,"y":3880,"wires":[["bc9b1e129f61344f"]]},{"id":"907d46704ed52beb","type":"function","z":"583e03b8225471bf","g":"be239a5ae1879a4b","name":"Time FInish","func":"global.set('Mqtt_Finish_1', msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":410,"y":3960,"wires":[["bc9b1e129f61344f"]]},{"id":"bc9b1e129f61344f","type":"link out","z":"583e03b8225471bf","g":"be239a5ae1879a4b","name":"link out 39","mode":"link","links":["0268470c17ec9004"],"x":535,"y":3920,"wires":[]},{"id":"62c3fd33b77087fb","type":"link in","z":"583e03b8225471bf","g":"acf3a13119310e75","name":"link in 53","links":["1d6e61ad79e90109","1d8c804ce83d3689"],"x":195,"y":5100,"wires":[["5a4ba9679ce03ae6"]]},{"id":"5a4ba9679ce03ae6","type":"function","z":"583e03b8225471bf","g":"acf3a13119310e75","name":"Query DB","func":"if (global.get('Mqtt_Start_3') != null && global.get('Mqtt_Finish_3') != null){\n    msg.topic = `SELECT * FROM Report_MobileRobot_Delivery_History where TimeCreate between ${global.get('Mqtt_Start_3')} and ${global.get('Mqtt_Finish_3')}`\n    node.send(msg);\n} else {\nmsg.topic = `SELECT * FROM Report_MobileRobot_Delivery_History where Status = 'Finish' ORDER BY TimeCreate ASC`\nnode.send(msg);\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":370,"y":5100,"wires":[["fef541d597f2e358"]]},{"id":"fef541d597f2e358","type":"sqlite","z":"583e03b8225471bf","g":"acf3a13119310e75","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":650,"y":5100,"wires":[["c6b55d87b25ad70f"]]},{"id":"c6b55d87b25ad70f","type":"function","z":"583e03b8225471bf","g":"acf3a13119310e75","name":"REPORT","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":850,"y":5100,"wires":[["76e49a6e6efe428d"]]},{"id":"76e49a6e6efe428d","type":"mqtt out","z":"583e03b8225471bf","g":"acf3a13119310e75","name":"","topic":"Mqtt_MobileRobot_DataGrid_Delivery_History","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1150,"y":5100,"wires":[]},{"id":"244fd4c63378760f","type":"inject","z":"583e03b8225471bf","g":"acf3a13119310e75","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":170,"y":5160,"wires":[["5a4ba9679ce03ae6"]]},{"id":"6fad2dc1dd4504b9","type":"status","z":"583e03b8225471bf","g":"acf3a13119310e75","name":"","scope":["ba88aa7187c61f0e"],"x":390,"y":5160,"wires":[["5a4ba9679ce03ae6"]]},{"id":"be27b51f64baa43c","type":"inject","z":"583e03b8225471bf","g":"4ff18ed4e648bf4d","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":180,"y":4780,"wires":[["9bf6d70853d98595"]]},{"id":"9bf6d70853d98595","type":"function","z":"583e03b8225471bf","g":"4ff18ed4e648bf4d","name":"Create Table","func":"\nmsg.topic = `CREATE TABLE IF NOT EXISTS Report_MobileRobot_Delivery_History (\n    _id TEXT PRIMARY KEY UNIQUE,\n    NameProduct TEXT,\n    ProductCode TEXT,\n    Quantity INT,\n    Location TEXT,\n    Destination TEXT,\n    Status TEXT,\n    TimeCreate INTEGER\n)`;\nnode.send(msg)\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":4780,"wires":[["6b7c71cb9e801931"]]},{"id":"6b7c71cb9e801931","type":"sqlite","z":"583e03b8225471bf","g":"4ff18ed4e648bf4d","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Create Table","x":630,"y":4780,"wires":[[]]},{"id":"e7987de772d9d753","type":"link in","z":"583e03b8225471bf","g":"2b49833b8323ca77","name":"link in 55","links":["19c820188a150a81","2113f628ef2d25aa"],"x":105,"y":4900,"wires":[["b5dceb25be862a42"]]},{"id":"eeccaca735a2571c","type":"function","z":"583e03b8225471bf","g":"2b49833b8323ca77","name":"Query DB Warehouse","func":"msg.topic = `SELECT * FROM Report_MobileRobot_Warehouse where Status = 'Finish' ORDER BY TimeCreate ASC`\nnode.send(msg);","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":4900,"wires":[["5a1e2c9e93ecbe97"]]},{"id":"5a1e2c9e93ecbe97","type":"sqlite","z":"583e03b8225471bf","g":"2b49833b8323ca77","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":660,"y":4900,"wires":[["91ebf3e1779fb7f8"]]},{"id":"91ebf3e1779fb7f8","type":"function","z":"583e03b8225471bf","g":"2b49833b8323ca77","name":"Store DB Warehouse","func":"global.set('Set_Mqtt_Warehouse', msg.payload)\nreturn msg\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":880,"y":4900,"wires":[["b9f4feb23064dff0"]]},{"id":"b5dceb25be862a42","type":"function","z":"583e03b8225471bf","g":"2b49833b8323ca77","name":"Set null","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][12] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\n\nglobal.set('Set_Mqtt_Warehouse', null)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":240,"y":4900,"wires":[["eeccaca735a2571c"]]},{"id":"b9f4feb23064dff0","type":"function","z":"583e03b8225471bf","g":"2b49833b8323ca77","name":"Check","func":"if (global.get('Set_Mqtt_Warehouse')!= null){\nreturn msg;\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1070,"y":4900,"wires":[["b1b0088f908340a1"]]},{"id":"b1b0088f908340a1","type":"function","z":"583e03b8225471bf","g":"2b49833b8323ca77","name":"Insert Finish History","func":"var Variable = global.get(\"Variable\");\n\nlet ArrWarehouse = global.get('Set_Mqtt_Warehouse')\n\nlet ID = ArrWarehouse[0]._id;\nlet NameProduct = ArrWarehouse[0].NameProduct;\nlet ProductCode = ArrWarehouse[0].ProductCode;\nlet Quantity = ArrWarehouse[0].Quantity;\nlet Location =  ArrWarehouse[0].Location;\nlet Destination = ArrWarehouse[0].Destination;\nlet Status=  ArrWarehouse[0].Status;\nmsg.topic = `INSERT INTO Report_MobileRobot_Delivery_History (\n    _id, NameProduct, ProductCode, Quantity, Location, TimeCreate,Destination,Status)\n    VALUES (\n    $ID, $NameProduct, $ProductCode, $Quantity, $Location, $TimeCreate, $Destination,$Status )`\nmsg.payload = [ID, NameProduct, ProductCode, Quantity, Location, Date.now(), Destination, Status]\nnode.send(msg)","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":220,"y":4980,"wires":[["9bc551b626b5d374"]]},{"id":"1d6e61ad79e90109","type":"link out","z":"583e03b8225471bf","g":"2b49833b8323ca77","name":"link out 38","mode":"link","links":["62c3fd33b77087fb"],"x":595,"y":4980,"wires":[]},{"id":"e4b7a0b1dd9cb56a","type":"debug","z":"583e03b8225471bf","g":"2b49833b8323ca77","name":"debug 53","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":980,"y":4980,"wires":[]},{"id":"9bc551b626b5d374","type":"sqlite","z":"583e03b8225471bf","g":"2b49833b8323ca77","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":450,"y":4980,"wires":[["1d6e61ad79e90109"]]},{"id":"45ef95dd9fcf49bd","type":"catch","z":"583e03b8225471bf","g":"2b49833b8323ca77","name":"","scope":null,"uncaught":false,"x":720,"y":4980,"wires":[["e4b7a0b1dd9cb56a"]]},{"id":"814a5346454cda07","type":"mqtt in","z":"583e03b8225471bf","g":"2966b017c1c3d1a6","name":"","topic":"Mqtt_Dt_Start_3","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":180,"y":5280,"wires":[["4b33ef9267c46a9e"]]},{"id":"fe7429d319de4602","type":"mqtt in","z":"583e03b8225471bf","g":"2966b017c1c3d1a6","name":"","topic":"Mqtt_Dt_Finish_3","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":180,"y":5360,"wires":[["64bd9548aa3e065d"]]},{"id":"4b33ef9267c46a9e","type":"function","z":"583e03b8225471bf","g":"2966b017c1c3d1a6","name":"Time Start","func":"global.set('Mqtt_Start_3', msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":5280,"wires":[["1d8c804ce83d3689"]]},{"id":"64bd9548aa3e065d","type":"function","z":"583e03b8225471bf","g":"2966b017c1c3d1a6","name":"Time FInish","func":"global.set('Mqtt_Finish_3', msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":5360,"wires":[["1d8c804ce83d3689"]]},{"id":"1d8c804ce83d3689","type":"link out","z":"583e03b8225471bf","g":"2966b017c1c3d1a6","name":"link out 41","mode":"link","links":["62c3fd33b77087fb"],"x":555,"y":5320,"wires":[]},{"id":"abb5eb468be6ac97","type":"sqlite","z":"583e03b8225471bf","g":"07a98b92274e9bcb","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Create Table","x":600,"y":4140,"wires":[[]]},{"id":"09ca10802b4d317f","type":"function","z":"583e03b8225471bf","g":"07a98b92274e9bcb","name":"Create Table","func":"\nmsg.topic = `CREATE TABLE IF NOT EXISTS Report_MobileRobot_Line_History (\n    _id TEXT PRIMARY KEY UNIQUE,\n    NameProduct TEXT,\n    ProductCode TEXT,\n    Quantity INT,\n    Location TEXT,\n    Destination TEXT,\n    Status TEXT,\n    TimeCreate INTEGER\n)`;\nnode.send(msg)\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":4140,"wires":[["abb5eb468be6ac97"]]},{"id":"5aa3881c6b0d29e5","type":"inject","z":"583e03b8225471bf","g":"07a98b92274e9bcb","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":180,"y":4140,"wires":[["09ca10802b4d317f"]]},{"id":"63baca1618a250c8","type":"function","z":"583e03b8225471bf","g":"d14b8d5ffae8fe27","name":"Insert Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet ID = 'a' + Math.random().toString(36)\nlet NameProduct = Variable.ListString[0][13];\nlet ProductCode = Variable.ListString[0][16];\nlet Quantity = Variable.Number[0][6];\nlet Location = Variable.ListString[0][14];\nlet Destination = Variable.ListString[0][12];\nlet Status='Waiting'\nmsg.topic = `INSERT INTO Report_MobileRobot_Line_History (\n    _id, NameProduct, ProductCode, Quantity, Location, TimeCreate,Destination,Status)\n    VALUES (\n    $ID, $NameProduct, $ProductCode, $Quantity, $Location, $TimeCreate, $Destination,$Status )`\nmsg.payload = [ID, NameProduct, ProductCode, Quantity, Location, Date.now(), Destination, Status]\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":730,"y":4240,"wires":[["7473f2c75648f350"]]},{"id":"eaeee639620db325","type":"mqtt in","z":"583e03b8225471bf","g":"d14b8d5ffae8fe27","name":"","topic":"Mqtt_MobileRobot_Line_AddNewData","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":250,"y":4240,"wires":[["ddb67739dba7d152"]]},{"id":"ddb67739dba7d152","type":"function","z":"583e03b8225471bf","g":"d14b8d5ffae8fe27","name":"Check Condition","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][14] = false;\n}, 500);\n\n\nif (global.get('Line_Product_Row_Select_Current_Quantity') > 0 && Variables.ListString[0][12].length > 0 && Variables.ListString[0][13].length > 0 && Variables.ListString[0][16].length > 0) {\n    if (Variables.Number[0][6] <= global.get('Line_Product_Row_Select_Current_Quantity')) {\n        if (Variables.Number[0][6]>0){\n            msg.payload = 1;\n            node.send(msg);\n        }else{\n            let tempData = global.get('Set_Mqtt_DataAlarm')\n            if (!Array.isArray(tempData)) tempData = []\n            let data = {\n                Type: 'warning',\n                Message: 'Order Number == 0'\n            }\n            tempData.push(data)\n            global.set('Set_Mqtt_DataAlarm', tempData)\n        }\n       \n    } else {\n        let tempData = global.get('Set_Mqtt_DataAlarm')\n        if (!Array.isArray(tempData)) tempData = []\n        let data = {\n            Type: 'warning',\n            Message: 'Over order number'\n        }\n        tempData.push(data)\n        global.set('Set_Mqtt_DataAlarm', tempData)\n    }\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Đủ Thông Tin'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":4240,"wires":[["63baca1618a250c8"]]},{"id":"7473f2c75648f350","type":"sqlite","z":"583e03b8225471bf","g":"d14b8d5ffae8fe27","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":950,"y":4240,"wires":[["cf318d2413e02459"]]},{"id":"cf318d2413e02459","type":"link out","z":"583e03b8225471bf","g":"d14b8d5ffae8fe27","name":"link out 37","mode":"link","links":["7aed4e736ff94406"],"x":1105,"y":4240,"wires":[]},{"id":"7aed4e736ff94406","type":"link in","z":"583e03b8225471bf","g":"1eb3015757ffc51d","name":"link in 54","links":["cf318d2413e02459","fd37a874cf9c92e2"],"x":225,"y":4360,"wires":[["95929937f2d08055"]]},{"id":"95929937f2d08055","type":"function","z":"583e03b8225471bf","g":"1eb3015757ffc51d","name":"Query DB","func":"if (global.get('Mqtt_Start_2') != null && global.get('Mqtt_Finish_2') != null){\n    msg.topic = `SELECT * FROM Report_MobileRobot_Line_History where TimeCreate between ${global.get('Mqtt_Start_2')} and ${global.get('Mqtt_Finish_2')}`\n    node.send(msg);\n} else {\n    msg.topic = `SELECT * FROM Report_MobileRobot_Line_History`\n    node.send(msg);\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":380,"y":4360,"wires":[["1bb251cc3d323104"]]},{"id":"1bb251cc3d323104","type":"sqlite","z":"583e03b8225471bf","g":"1eb3015757ffc51d","mydb":"00bbaea9f902ff99","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":580,"y":4360,"wires":[["5676262cb734c6b7"]]},{"id":"5676262cb734c6b7","type":"function","z":"583e03b8225471bf","g":"1eb3015757ffc51d","name":"REPORT","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":780,"y":4360,"wires":[["316d836dba8c2cdf"]]},{"id":"316d836dba8c2cdf","type":"mqtt out","z":"583e03b8225471bf","g":"1eb3015757ffc51d","name":"","topic":"Mqtt_MobileRobot_DataGrid_Line_History","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1080,"y":4360,"wires":[]},{"id":"d372469d88d35f59","type":"status","z":"583e03b8225471bf","g":"1eb3015757ffc51d","name":"","scope":["ba88aa7187c61f0e"],"x":380,"y":4420,"wires":[["95929937f2d08055"]]},{"id":"efd5799462945733","type":"inject","z":"583e03b8225471bf","g":"1eb3015757ffc51d","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":180,"y":4420,"wires":[["95929937f2d08055"]]},{"id":"9b0b9419f582f954","type":"mqtt in","z":"583e03b8225471bf","g":"040a30817def961b","name":"","topic":"Mqtt_Dt_Start_2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":180,"y":4520,"wires":[["47277fdb5597ca50"]]},{"id":"da7a7bad2c7c4254","type":"mqtt in","z":"583e03b8225471bf","g":"040a30817def961b","name":"","topic":"Mqtt_Dt_Finish_2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":180,"y":4600,"wires":[["0ab0811367391bb6"]]},{"id":"47277fdb5597ca50","type":"function","z":"583e03b8225471bf","g":"040a30817def961b","name":"Time Start","func":"global.set('Mqtt_Start_2', msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":4520,"wires":[["fd37a874cf9c92e2"]]},{"id":"0ab0811367391bb6","type":"function","z":"583e03b8225471bf","g":"040a30817def961b","name":"Time FInish","func":"global.set('Mqtt_Finish_2', msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":4600,"wires":[["fd37a874cf9c92e2"]]},{"id":"fd37a874cf9c92e2","type":"link out","z":"583e03b8225471bf","g":"040a30817def961b","name":"link out 40","mode":"link","links":["7aed4e736ff94406"],"x":545,"y":4560,"wires":[]},{"id":"88b19192c38bdcc9","type":"function","z":"583e03b8225471bf","name":"Execute Mobile Robot","func":"var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\n\nif (Variable.ListString[0][25] && Variable.ListString[0][25].length > 0 &&\n    Variable.ListString[0][25] != global.get('OldExecute')) {\n    node.warn('execute Robot');\n    global.set('OldExecute', Variable.ListString[0][25])\n    VariableSystem.COMMUNICATION_MOBILE_ROBOT[1].write('goto '+ Variable.ListString[0][25] + '\\r\\n')\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":820,"y":60,"wires":[[]]},{"id":"cd6c680583d564d3","type":"inject","z":"583e03b8225471bf","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":620,"y":60,"wires":[["88b19192c38bdcc9"]]},{"id":"435dfaf01403b27b","type":"modbus-getter","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Read Position Base Cobot","showStatusActivities":false,"showErrors":true,"showWarnings":true,"logIOActivities":false,"unitid":"","dataType":"InputRegister","adr":"7001","quantity":"24","server":"28a4dd7430d421b8","useIOFile":false,"ioFile":"","useIOForPayload":false,"emptyMsgOnFail":false,"keepMsgProperties":true,"delayOnStart":false,"startDelayTime":"","x":660,"y":120,"wires":[["462cf6f09d95d156"],[]]},{"id":"462cf6f09d95d156","type":"function","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Save Scada","func":"var Variables = global.get(\"Variable\");\nif (flow.get(\"global_functions\")) {\n    Variables.ListString[5][0] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[0], msg.payload[1])\n    Variables.ListString[5][1] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[2], msg.payload[3])\n    Variables.ListString[5][2] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[4], msg.payload[5])\n    Variables.ListString[5][3] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[6], msg.payload[7])\n    Variables.ListString[5][4] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[8], msg.payload[9])\n    Variables.ListString[5][5] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[10], msg.payload[11])\n\n    Variables.ListString[5][6] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[12], msg.payload[13])\n    Variables.ListString[5][7] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[14], msg.payload[15])\n    Variables.ListString[5][8] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[16], msg.payload[17])\n    Variables.ListString[5][9] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[18], msg.payload[19])\n    Variables.ListString[5][10] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[20], msg.payload[21])\n    Variables.ListString[5][11] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[22], msg.payload[23])\n\n    //Save to wordDisplay\n    Variables.WordDisplay[6][1] = parseFloat(Variables.ListString[5][6])\n    Variables.WordDisplay[6][2] = parseFloat(Variables.ListString[5][7])\n    Variables.WordDisplay[6][3] = parseFloat(Variables.ListString[5][8])\n    Variables.WordDisplay[6][4] = parseFloat(Variables.ListString[5][9])\n    Variables.WordDisplay[6][5] = parseFloat(Variables.ListString[5][10])\n    Variables.WordDisplay[6][6] = parseFloat(Variables.ListString[5][11])\n\n}\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":100,"wires":[[]]},{"id":"2b084b90fdf0dd13","type":"trigger","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-100","extend":false,"overrideDelay":false,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":420,"y":120,"wires":[["435dfaf01403b27b"]]},{"id":"be87d783f6300c75","type":"trigger","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-1","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":380,"y":300,"wires":[["0b3114fbd5796dbe","4d3037469d50f3ed","f241f251d7b88b93","fa50a0efed7f98c0","e6ec2a31c85c99c9"]]},{"id":"defefb9cc7b35b45","type":"function","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Save Scada","func":"var Variables = global.get(\"Variable\");\nVariables.WordDisplay[5][1]=msg.payload[0] //Speed\n\n\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":180,"wires":[[]]},{"id":"153ff944ef3f9858","type":"Scada-BitAdjust","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","indexPLC":"5","tag":"1","comment":"Play/Pause","x":1100,"y":160,"wires":[["90bcdfc8f275ba06"]]},{"id":"90bcdfc8f275ba06","type":"modbus-write","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Pause","showStatusActivities":false,"showErrors":false,"showWarnings":true,"unitid":"","dataType":"Coil","adr":"7108","quantity":"1","server":"28a4dd7430d421b8","emptyMsgOnFail":false,"keepMsgProperties":false,"delayOnStart":false,"startDelayTime":"","x":1250,"y":160,"wires":[[],[]]},{"id":"1c425391676b27d0","type":"Scada-BitAdjust","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","indexPLC":"5","tag":"2","comment":"Play/Pause","x":1100,"y":220,"wires":[["28073598bdbf9ae8"]]},{"id":"28073598bdbf9ae8","type":"modbus-write","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Stop","showStatusActivities":false,"showErrors":false,"showWarnings":true,"unitid":"","dataType":"Coil","adr":"7105","quantity":"1","server":"28a4dd7430d421b8","emptyMsgOnFail":false,"keepMsgProperties":false,"delayOnStart":false,"startDelayTime":"","x":1250,"y":220,"wires":[[],[]]},{"id":"06ddf6059a064a57","type":"Scada-BitAdjust","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","indexPLC":"5","tag":"3","comment":"Play/Pause","x":1100,"y":280,"wires":[["a43469162e2b8ea8"]]},{"id":"a43469162e2b8ea8","type":"modbus-write","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"+","showStatusActivities":false,"showErrors":false,"showWarnings":true,"unitid":"","dataType":"Coil","adr":"7106","quantity":"1","server":"28a4dd7430d421b8","emptyMsgOnFail":false,"keepMsgProperties":false,"delayOnStart":false,"startDelayTime":"","x":1250,"y":280,"wires":[[],[]]},{"id":"88ec72b302e19b2f","type":"Scada-BitAdjust","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","indexPLC":"5","tag":"4","comment":"Play/Pause","x":1100,"y":340,"wires":[["4b243b5c4e48dd44"]]},{"id":"4b243b5c4e48dd44","type":"modbus-write","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"-","showStatusActivities":false,"showErrors":false,"showWarnings":true,"unitid":"","dataType":"Coil","adr":"7107","quantity":"1","server":"28a4dd7430d421b8","emptyMsgOnFail":false,"keepMsgProperties":false,"delayOnStart":false,"startDelayTime":"","x":1250,"y":340,"wires":[[],[]]},{"id":"0b3114fbd5796dbe","type":"modbus-getter","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Read Status Cobot","showStatusActivities":false,"showErrors":true,"showWarnings":true,"logIOActivities":false,"unitid":"","dataType":"Input","adr":"7201","quantity":"8","server":"28a4dd7430d421b8","useIOFile":false,"ioFile":"","useIOForPayload":false,"emptyMsgOnFail":false,"keepMsgProperties":true,"delayOnStart":false,"startDelayTime":"","x":610,"y":240,"wires":[["257cf9bcd379f2aa"],[]]},{"id":"257cf9bcd379f2aa","type":"function","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Save Scada","func":"var Variables = global.get(\"Variable\");\nVariables.BitDisplay[5][1] = msg.payload[0] ? 1 : 0 //7201 Error\nVariables.BitDisplay[5][2] = msg.payload[1] ? 1 : 0 //7202 Running\nVariables.BitDisplay[5][3] = msg.payload[2] ? 1 : 0 //7203 Editting\nVariables.BitDisplay[5][4] = msg.payload[3] ? 1 : 0 //7204 Pause\nVariables.BitDisplay[5][5] = msg.payload[4] ? 1 : 0\nVariables.BitDisplay[5][6] = msg.payload[5] ? 1 : 0\nVariables.BitDisplay[5][7] = msg.payload[6] ? 1 : 0\nVariables.BitDisplay[5][8] = msg.payload[7] ? 1 : 0\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":240,"wires":[[]]},{"id":"4d3037469d50f3ed","type":"modbus-getter","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Read Status Cobot","showStatusActivities":false,"showErrors":true,"showWarnings":true,"logIOActivities":false,"unitid":"","dataType":"InputRegister","adr":"7102","quantity":"1","server":"28a4dd7430d421b8","useIOFile":false,"ioFile":"","useIOForPayload":false,"emptyMsgOnFail":false,"keepMsgProperties":true,"delayOnStart":false,"startDelayTime":"","x":610,"y":300,"wires":[["c3c839a8095d38a9"],[]]},{"id":"c3c839a8095d38a9","type":"function","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Save Scada","func":"var Variables = global.get(\"Variable\");\n\n//Auto - Manu\nif (msg.payload[0] == 2) {\n    Variables.ListString[5][12] = 'MANU'\n}\nif (msg.payload[0] == 1) {\n    Variables.ListString[5][12] = 'AUTO'\n}\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":300,"wires":[[]]},{"id":"f241f251d7b88b93","type":"modbus-getter","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Read Status Cobot","showStatusActivities":false,"showErrors":true,"showWarnings":true,"logIOActivities":false,"unitid":"","dataType":"InputRegister","adr":"7101","quantity":"1","server":"28a4dd7430d421b8","useIOFile":false,"ioFile":"","useIOForPayload":false,"emptyMsgOnFail":false,"keepMsgProperties":true,"delayOnStart":false,"startDelayTime":"","x":610,"y":180,"wires":[["defefb9cc7b35b45"],[]]},{"id":"a38fb289d50b48ee","type":"modbus-write","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Play/Pause","showStatusActivities":false,"showErrors":false,"showWarnings":true,"unitid":"","dataType":"Coil","adr":"7104","quantity":"1","server":"28a4dd7430d421b8","emptyMsgOnFail":false,"keepMsgProperties":false,"delayOnStart":false,"startDelayTime":"","x":1270,"y":100,"wires":[[],[]]},{"id":"c64a3610e1289305","type":"Scada-BitAdjust","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","indexPLC":"5","tag":"0","comment":"Play","x":1100,"y":100,"wires":[["a38fb289d50b48ee"]]},{"id":"fa50a0efed7f98c0","type":"modbus-getter","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Read Name Project","showStatusActivities":false,"showErrors":true,"showWarnings":true,"logIOActivities":false,"unitid":"","dataType":"InputRegister","adr":"7701","quantity":"50","server":"28a4dd7430d421b8","useIOFile":false,"ioFile":"","useIOForPayload":false,"emptyMsgOnFail":false,"keepMsgProperties":true,"delayOnStart":false,"startDelayTime":"","x":610,"y":360,"wires":[["3c3ade5172fb5755"],[]]},{"id":"3c3ade5172fb5755","type":"function","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Save Name Project","func":"var Variables = global.get(\"Variable\");\n\nlet pairs = [];\nfor (let i = 0; i < msg.payload.length; i++) {\n    pairs.push([msg.payload[i] >> 8, msg.payload[i] & 0xFF]);\n}\nlet asciiChars = [];\nfor (let i = 0; i < pairs.length; i++) {\n    asciiChars.push(String.fromCharCode(pairs[i][0], pairs[i][1]));\n}\n\nlet clear_string=asciiChars.join('')\nvar index = clear_string.indexOf('\\0');\n\nVariables.ListString[5][14] = clear_string.substring(0,index)","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":890,"y":360,"wires":[[]]},{"id":"e6ec2a31c85c99c9","type":"modbus-getter","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Read Operation Parameter","showStatusActivities":false,"showErrors":true,"showWarnings":true,"logIOActivities":false,"unitid":"","dataType":"InputRegister","adr":"7340","quantity":"12","server":"28a4dd7430d421b8","useIOFile":false,"ioFile":"","useIOForPayload":false,"emptyMsgOnFail":false,"keepMsgProperties":true,"delayOnStart":false,"startDelayTime":"","x":640,"y":420,"wires":[["472de6ddcd3af5af"],[]]},{"id":"472de6ddcd3af5af","type":"function","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"Save Scada","func":"var Variables = global.get(\"Variable\");\nif (flow.get(\"global_functions\")) {\n    Variables.ListString[5][20] = 'Controller Temperature: ' + flow.get(\"global_functions\").convert_num_2_float(msg.payload[0], msg.payload[1]) + ' °C'\n    Variables.ListString[5][21] = 'Robot Voltage: ' + flow.get(\"global_functions\").convert_num_2_float(msg.payload[2], msg.payload[3]) + ' V'\n    Variables.ListString[5][22] = 'Robot Power Consumption: ' + flow.get(\"global_functions\").convert_num_2_float(msg.payload[4], msg.payload[5]) + ' W'\n    Variables.ListString[5][23] = 'Robot Current: ' + flow.get(\"global_functions\").convert_num_2_float(msg.payload[6], msg.payload[7]) + ' A'\n    Variables.ListString[5][24] = 'Controller Box IO Current: ' + flow.get(\"global_functions\").convert_num_2_float(msg.payload[8], msg.payload[9]) + ' A'\n    // Variables.ListString[5][5]=flow.get(\"global_functions\").convert_num_2_float(msg.payload[10], msg.payload[11])\n\n    // Variables.ListString[5][6] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[12], msg.payload[13])\n    // Variables.ListString[5][7] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[14], msg.payload[15])\n    // Variables.ListString[5][8] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[16], msg.payload[17])\n    // Variables.ListString[5][9] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[18], msg.payload[19])\n    // Variables.ListString[5][10] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[20], msg.payload[21])\n    // Variables.ListString[5][11] = flow.get(\"global_functions\").convert_num_2_float(msg.payload[22], msg.payload[23])\n\n\n}\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":420,"wires":[[]]},{"id":"c13af66195e2f633","type":"inject","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":200,"y":100,"wires":[["73ec91254211a901"]]},{"id":"73ec91254211a901","type":"function","z":"56f47a6a1f08d3ac","g":"a3e9061bc91ca8d3","name":"SubFunc Convert Float","func":"var VariableSystem = global.get(\"VariableSystem\");\nvar Variables = global.get(\"Variable\");\nvar global_functions = {};\n\n// flow.set(\"global_functions\", global_functions);\n// let global_functions = flow.get('global_functions')\nglobal_functions.convert_num_2_float = function (num1, num2) {\n    try {\n        var register1 = num1; // First register value\n        var register2 = num2; // Second register value\n\n        // Convert Modbus registers to float\n        var buffer = Buffer.alloc(4);\n        buffer.writeUInt16BE(register1, 0); // Write the first register value to buffer\n        buffer.writeUInt16BE(register2, 2); // Write the second register value to buffer\n\n        var floatValue = buffer.readFloatBE(0); // Read float from buffer\n        var formattedValue = floatValue.toFixed(2)\n        return formattedValue;\n    } catch (err) {\n        node.warn(err);\n    }\n}\nflow.set(\"global_functions\", global_functions);\nreturn(msg)\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":170,"y":180,"wires":[["2b084b90fdf0dd13","be87d783f6300c75"]]},{"id":"99a5ef98a7e56903","type":"function","z":"a933b5fd7ed9762b","name":"Convert Time","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":1400,"wires":[["663436b33281c676"]]},{"id":"f044cebf5eac3ee2","type":"mqtt out","z":"a933b5fd7ed9762b","name":"Mqtt_CheckWeigh_DataGrid_Cui","topic":"Mqtt_CheckWeigh_DataGrid_Cui","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1770,"y":1400,"wires":[]},{"id":"2f2574d27c82f29d","type":"function","z":"a933b5fd7ed9762b","name":"Generate Layout History","func":"let Data = msg.payload[0]\nvar Variable = global.get(\"Variable\");\n\nVariable.Number[0][30] = Data.PhieuCan;\nVariable.ListString[0][30] = Data.BienSoXe;\nVariable.ListString[0][32] = Data.DaiDienBenBan;\nVariable.ListString[0][33] = Data.NguoiBan;\nVariable.ListString[0][34] = Data.DaiDienBenMua;\nVariable.ListString[0][35] = Data.DiaChi_DaiDienBenBan;\nVariable.ListString[0][36] = Data.DiaChi_NguoiBan;\nVariable.ListString[0][37] = Data.DiaChi_DaiDienBenMua;\nVariable.ListString[0][38] = Data.GhiChu;\nVariable.ListString[0][39] = Data.GioCanTong;\nVariable.ListString[0][40] = Data.GioCanBi;\nVariable.Number[0][31] = Data.SoCanTong;\nVariable.Number[0][32] = Data.SoCanBi;\nVariable.Number[0][35] = Data.PhanTramCuiKho;\nVariable.Number[0][36] = Data.GiaTienCuiKho;\nVariable.Number[0][37] = Data.PhanTramCuiTuoi;\nVariable.Number[0][38] = Data.GiaTienCuiTuoi;\nVariable.Number[0][33] = Data.TrongLuongHienTai;\nVariable.Number[0][34] = Data.TrongLuongCuiKho;\nVariable.Number[0][50] = Data.TrongLuongCuiTuoi;\nVariable.Number[0][39] = Data.ThanhTien;\n\nvar msg1 = { payload: Data.Image_CanTong1 };\nvar msg2 = { payload: Data.Image_CanTong2 };\nvar msg3 = { payload: Data.Image_CanBi1 };\nvar msg4 = { payload: Data.Image_CanBi2 };\nif (Variable.Number[0][32] > 0) {\n  var msg5 = { payload: false };  \n} else{\n  var msg5 = { payload: true }; \n}\n\nnode.send([msg1, msg2, msg3, msg4, msg5]);\n","outputs":5,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1500,"y":1980,"wires":[["141d6f8f638c6a28"],["e01abc8a0d46f7d1"],["8833ea8aef6c8de4"],["afae30e0b0f1cb9b"],["2c4779fbb56bf1cc"]]},{"id":"141d6f8f638c6a28","type":"mqtt out","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_Image1_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1840,"y":1880,"wires":[]},{"id":"e01abc8a0d46f7d1","type":"mqtt out","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_Image2_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1840,"y":1920,"wires":[]},{"id":"8833ea8aef6c8de4","type":"mqtt out","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_Image3_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1840,"y":2000,"wires":[]},{"id":"afae30e0b0f1cb9b","type":"mqtt out","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_Image4_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1840,"y":2040,"wires":[]},{"id":"d6b50e9eeb8550bb","type":"function","z":"a933b5fd7ed9762b","name":"Luu Trang Thai Phieu Can","func":"var Variables = global.get(\"Variable\");\nVariables.Bit[0][47] = true; //   BIT Ở CHẾ ĐỘ XEM PHIẾU\nVariables.Number[0][47] = Variables.Number[0][32];  // CHECK SỐ CÂN BÌ ĐÃ CÂN HAY CHƯA.\nVariables.Number[0][48] = Variables.Number[0][31];  // CHECK SỐ CÂN TỔNG ĐÃ CÂN HAY CHƯA.","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":980,"y":2000,"wires":[[]]},{"id":"0085c06398aac96d","type":"inject","z":"a933b5fd7ed9762b","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":110,"y":40,"wires":[["1b26cac664929052"]]},{"id":"1b26cac664929052","type":"function","z":"a933b5fd7ed9762b","name":"Create Table","func":"\n    msg.topic = `CREATE TABLE IF NOT EXISTS TeaCheckWeigh_Cui (\n    _id TEXT UNIQUE,\n    PhieuCan INTEGER PRIMARY KEY AUTOINCREMENT,\n    BienSoXe TEXT,\n    LoaiHang TEXT,\n    DaiDienBenBan TEXT,\n    NguoiBan TEXT,\n    DaiDienBenMua TEXT,\n    DiaChi_DaiDienBenBan TEXT,\n    DiaChi_NguoiBan TEXT,\n    DiaChi_DaiDienBenMua TEXT,\n    GhiChu TEXT,\n    GioCanTong TEXT,\n    GioCanBi TEXT,\n    SoCanTong REAL,\n    SoCanBi REAL,\n    TrongLuongHienTai REAL,\n    PhanTramCuiKho REAL,\n    GiaTienCuiKho REAL,\n    PhanTramCuiTuoi REAL,\n    GiaTienCuiTuoi REAL,\n    TrongLuongCuiKho REAL,\n    TrongLuongCuiTuoi REAL,\n    ThanhTien REAL,\n    Image_CanTong1 TEXT,\n    Image_CanTong2 TEXT,\n    Image_CanBi1 TEXT,\n    Image_CanBi2 TEXT,\n    TimeCreate INTEGER\n)`;\nnode.send(msg)\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":260,"y":40,"wires":[["a2cd0ad3f741bebe"]]},{"id":"a2cd0ad3f741bebe","type":"sqlite","z":"a933b5fd7ed9762b","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"","name":"Execute Create Table","x":450,"y":40,"wires":[[]]},{"id":"cd511d6eed643ebf","type":"inject","z":"a933b5fd7ed9762b","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":680,"y":40,"wires":[["ee1c018b16e49136"]]},{"id":"ee1c018b16e49136","type":"trigger","z":"a933b5fd7ed9762b","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-500","extend":false,"overrideDelay":false,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":890,"y":40,"wires":[["b745865e87bd1063"]]},{"id":"b745865e87bd1063","type":"function","z":"a933b5fd7ed9762b","name":"Get Weigh","func":"var Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\n//** COVERT DATETIME **/\n// Create a new Date object to get the current date\nconst currentDate = new Date();\n\n// Get the current day as a string (e.g., \"01\" for the 1st of the month)\nconst day = String(currentDate.getDate()).padStart(2, '0'); // padStart ensures two digits\n\n// Get the current month as a string (e.g., \"01\" for January)\nconst month = String(currentDate.getMonth() + 1).padStart(2, '0'); // getMonth() returns 0-based index\n\n// Get the current year as a string (e.g., \"2024\")\nconst year = String(currentDate.getFullYear());\n\n// Get the current hour as a string (e.g., \"01\" for the 01: 00 AM)\nconst hour = String(currentDate.getHours()).padStart(2, '0'); // padStart ensures two digits\n\n// Get the current minute as a string (e.g., \"01\" for the 01 minute of hour)\nconst minute = String(currentDate.getMinutes()).padStart(2, '0'); // padStart ensures two digits\n\n// Get the second as a string (e.g., \"01\" for the 01 second of minute)\nconst second = String(currentDate.getSeconds()).padStart(2, '0'); // padStart ensures two digits\n\n// Combine them in the desired format\nconst currentHourStr = `${hour}:${minute}:${second}`;\n\n// Combine them in the desired format\nconst currentDateStr = `${day}-${month}-${year}`;\n\nconst formattedTime = `${day}-${month}-${year} ${hour}:${minute}:${second}`;\n\nVariables.ListString[0][22] = formattedTime;\n\n\n/// ** CAPTURE SỐ CÂN TỔNG BẰNG NÚT NHẤN ** ///\nif (Variables.Bit[0][30]) {\n    (Variables.Bit[0][30]) = false; // NÚT NHẤN LẤY SỐ CÂN TỔNG.\n    if ((Variables.Bit[0][47] == true) && (Variables.Number[0][48]) > 0) {\n        let tempData = global.get('Set_Mqtt_DataAlarm')\n        if (!Array.isArray(tempData)) tempData = []\n        let data = {\n            Type: 'error',\n            Message: 'Đã Cân Tổng Rồi - Cần Tạo Phiếu Cân Mới'\n        }\n        tempData.push(data)\n        global.set('Set_Mqtt_DataAlarm', tempData)\n    } else {\n        if (!isNaN(Variables.Number[0][30])) {\n            if ((Variables.ListString[0][30].length) > 0) {\n                Variables.Number[0][31] = Variables.Number[0][1]; // CAPTURE SỐ CÂN TỔNG.\n                Variables.ListString[0][39] = formattedTime;\n            } else {\n                let tempData = global.get('Set_Mqtt_DataAlarm')\n                if (!Array.isArray(tempData)) tempData = []\n                let data = {\n                    Type: 'error',\n                    Message: 'Chưa Nhập Biển Số Xe'\n                }\n                tempData.push(data)\n                global.set('Set_Mqtt_DataAlarm', tempData)\n            }\n        } else {\n            let tempData = global.get('Set_Mqtt_DataAlarm')\n            if (!Array.isArray(tempData)) tempData = []\n            let data = {\n                Type: 'error',\n                Message: 'Chưa Thêm Phiếu Cân'\n            }\n            tempData.push(data)\n            global.set('Set_Mqtt_DataAlarm', tempData)\n        }\n    }\n\n}\n\n/// ** CAPTURE SỐ CÂN BÌ BẰNG NÚT NHẤN ** ///\nif (Variables.Bit[0][31]) {\n    (Variables.Bit[0][31]) = false; // NÚT NHẤN LẤY SỐ CÂN BÌ.\n    if ((Variables.Bit[0][47] == true) && (Variables.Number[0][47]) > 0) {\n        let tempData = global.get('Set_Mqtt_DataAlarm')\n        if (!Array.isArray(tempData)) tempData = []\n        let data = {\n            Type: 'error',\n            Message: 'Đã Cân Bì Rồi - Cần Tạo Phiếu Cân Mới'\n        }\n        tempData.push(data)\n        global.set('Set_Mqtt_DataAlarm', tempData)\n    } else {\n        if (!isNaN(Variables.Number[0][30])) {\n            if ((Variables.Number[0][31]) > 0) {\n                Variables.Number[0][32] = Variables.Number[0][1]; // CAPTURE SỐ CÂN BÌ.\n                Variables.ListString[0][40] = formattedTime;\n            } else {\n                let tempData = global.get('Set_Mqtt_DataAlarm')\n                if (!Array.isArray(tempData)) tempData = []\n                let data = {\n                    Type: 'error',\n                    Message: 'Chưa Lấy Số Cân Tổng'\n                }\n                tempData.push(data)\n                global.set('Set_Mqtt_DataAlarm', tempData)\n            }\n            if ((Variables.Number[0][32]) >= (Variables.Number[0][31])) {\n                let tempData = global.get('Set_Mqtt_DataAlarm')\n                if (!Array.isArray(tempData)) tempData = []\n                let data = {\n                    Type: 'error',\n                    Message: 'Cân Bì Sai'\n                }\n                tempData.push(data)\n                global.set('Set_Mqtt_DataAlarm', tempData)\n            }\n        } else {\n            let tempData = global.get('Set_Mqtt_DataAlarm')\n            if (!Array.isArray(tempData)) tempData = []\n            let data = {\n                Type: 'error',\n                Message: 'Chưa Thêm Phiếu Cân'\n            }\n            tempData.push(data)\n            global.set('Set_Mqtt_DataAlarm', tempData)\n        }\n    }\n}\n\n\n/// ** KIỂM TRA % CỦI KHÔ => GIÁ TIỀN ** ///\nif (Variables.Number[0][35] == 0) {\n    Variables.Number[0][36] = 0; // NẾU % CỦI KHÔ = 0 THÌ GIÁ TIỀN CỦI KHÔ = 0\n}\nif (Variables.Number[0][37] == 0) {\nVariables.Number[0][38] = 0; // NẾU % CỦI TƯƠI = 0 THÌ GIÁ TIỀN CỦI TƯƠI = 0\n}\n\n/// ** AUTO TÍNH % CỦI TƯƠI ** ///\nVariables.Number[0][66] = 100 - Variables.Number[0][64];\n\nif (Variables.Number[0][31] > 0 && Variables.Number[0][32] > 0) {\n    Variables.Number[0][33] = (Variables.Number[0][31] - Variables.Number[0][32]).toFixed(0); // TRỌNG LƯỢNG HIỆN TẠI.\n    Variables.Number[0][34] = (Variables.Number[0][33] * Variables.Number[0][35] / 100).toFixed(0); // TRỌNG LƯỢNG CỦI KHÔ.\n    Variables.Number[0][37] = 100 - Variables.Number[0][35]; // % Củi Tươi = 100% - % Củi Khô (Nhập)\n    Variables.Number[0][50] = (Variables.Number[0][33] * Variables.Number[0][37] / 100).toFixed(0); // TRỌNG LƯỢNG CỦI TƯƠI.\n    Variables.Number[0][55] = (Variables.Number[0][34] * Variables.Number[0][36]).toFixed(0); // THÀNH TIỀN CỦI KHÔ.\n    Variables.Number[0][56] = (Variables.Number[0][50] * Variables.Number[0][38]).toFixed(0); // THÀNH TIỀN CỦI TƯƠI.\n    Variables.Number[0][39] = (Variables.Number[0][34] * Variables.Number[0][36] + Variables.Number[0][50] * Variables.Number[0][38]).toFixed(0); // THÀNH TIỀN.\n    Variables.Number[0][57] = (Variables.Number[0][39] / Variables.Number[0][33]).toFixed(0); // GIÁ MUA BÌNH QUÂN.\n}\n\n/// ** NÚT NHẤN HỦY SỐ CÂN TỔNG ** ///\nif (Variables.Bit[0][4]) {\n    (Variables.Bit[0][4]) = false; // NÚT NHẤN HỦY.\n    Variables.Number[0][2] = 0; // RESET.\n}\n\n/// ** NÚT NHẤN HỦY SỐ CÂN BÌ ** ///\nif (Variables.Bit[0][5]) {\n    (Variables.Bit[0][5]) = false; // NÚT NHẤN HỦY.\n    Variables.Number[0][3] = 0; // RESET.\n}\n\n/// ** CHECK ERROR & RESET DATA ** ///\nif (Variables.Number[0][2] == 0 || Variables.Number[0][3] == 0 || Variables.Number[0][2] < Variables.Number[0][3]) {\n    Variables.Number[0][4] = 0; // RESET\n    Variables.Number[0][6] = 0; // RESET\n    Variables.Number[0][8] = 0; // RESET\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1120,"y":40,"wires":[[]]},{"id":"2c4779fbb56bf1cc","type":"mqtt out","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_CheckWeigh_Editable_Cui","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1880,"y":2080,"wires":[]},{"id":"5f6942873791be72","type":"mqtt in","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_CheckWeigh_DataGrid_Response_Cui_Change_Data","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":240,"y":2820,"wires":[["4c95bb7fb46a59a1","2be272c558b7a894"]]},{"id":"4c95bb7fb46a59a1","type":"function","z":"a933b5fd7ed9762b","name":"Summary Data","func":"function convertToNumber(input) {\n    // Replace period (.) with nothing to remove thousands separator\n    // Replace comma (,) with a period (.) for decimal separator\n    if (input) {\n        let formattedString = input.replace(/\\./g, '').replace(',', '.');\n        // Convert the formatted string to a number\n        return parseFloat(formattedString);\n    }else{\n        return 0\n    }\n\n}\n\nlet SoCanTong_Sum = 0;\nlet SoCanBi_Sum = 0;\nlet TrongLuongHienTai_Sum = 0;\nlet TrongLuongCuiKho_Sum = 0;\nlet TrongLuongCuiTuoi_Sum = 0;\nlet ThanhTien_Sum = 0;\n\nmsg.payload.forEach(function (element) {\n    SoCanTong_Sum = SoCanTong_Sum + convertToNumber(element.SoCanTong);\n    SoCanBi_Sum = SoCanBi_Sum + convertToNumber(element.SoCanBi);\n    TrongLuongHienTai_Sum = TrongLuongHienTai_Sum + convertToNumber(element.TrongLuongHienTai);\n    TrongLuongCuiKho_Sum = TrongLuongCuiKho_Sum + convertToNumber(element.TrongLuongCuiKho);\n    TrongLuongCuiTuoi_Sum = TrongLuongCuiTuoi_Sum + convertToNumber(element.TrongLuongCuiTuoi);\n    ThanhTien_Sum = ThanhTien_Sum + convertToNumber(element.ThanhTien);\n});\nmsg.payload = {\n    data: [{\n        SoCanTong: (SoCanTong_Sum).toFixed(0),\n        SoCanBi: (SoCanBi_Sum).toFixed(0),\n        TrongLuongHienTai: TrongLuongHienTai_Sum,\n        TrongLuongCuiKho: TrongLuongCuiKho_Sum,\n        TrongLuongCuiTuoi: TrongLuongCuiTuoi_Sum,\n        ThanhTien: ThanhTien_Sum,\n    }]\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":570,"y":2820,"wires":[["90aae2ea4fcb8c70"]]},{"id":"90aae2ea4fcb8c70","type":"mqtt out","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_CheckWeigh_DataGrid_Cui_Summary","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":860,"y":2820,"wires":[]},{"id":"2be272c558b7a894","type":"function","z":"a933b5fd7ed9762b","name":"Reset Choice Ticks","func":"var Variables = global.get(\"Variable\");\nif (Variables.ListString[0][61].length > 0) {\n    Variables.Bit[0][41] = false;\n    Variables.Bit[0][42] = false;\n    Variables.Bit[0][43] = false;\n    Variables.Bit[0][40] = false;\n}\nVariables.Number[0][40] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":580,"y":2880,"wires":[[]]},{"id":"02805302ded362ca","type":"function","z":"a933b5fd7ed9762b","name":"Dia Chi Dai Dien = Dia Chi Ben Ban","func":"var Variables = global.get(\"Variable\");\nVariables.ListString[0][36] = Variables.ListString[0][35];\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":570,"y":3000,"wires":[[]]},{"id":"897e4fc4d49a1f61","type":"mqtt in","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_CheckWeigh_Cui_BenBan_Response","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":2940,"wires":[["8c41e314bfe6bdc1"]]},{"id":"8c41e314bfe6bdc1","type":"function","z":"a933b5fd7ed9762b","name":"Dai Dien = Ben Ban","func":"var Variables = global.get(\"Variable\");\nVariables.ListString[0][33] = Variables.ListString[0][32];\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2940,"wires":[[]]},{"id":"982f496755fb17d3","type":"mqtt in","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_CheckWeigh_Cui_DiaChiBenBan_Response","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":220,"y":3000,"wires":[["02805302ded362ca"]]},{"id":"7058763e40782af6","type":"link out","z":"a933b5fd7ed9762b","name":"link out 19","mode":"link","links":["bbef2de2fbc5401c","a6d0c984d21fb267"],"x":755,"y":1400,"wires":[]},{"id":"2e2ae4d9e8814c33","type":"mqtt in","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_CheckWeigh_DataGrid_Response_DanhGiaCui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":220,"y":3300,"wires":[["53fe196caab560f2"]]},{"id":"53fe196caab560f2","type":"function","z":"a933b5fd7ed9762b","name":"Query DB","func":"msg.payload[0] = msg.payload.record;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":550,"y":3300,"wires":[["12e0c2f1e00b77cc"]]},{"id":"12e0c2f1e00b77cc","type":"function","z":"a933b5fd7ed9762b","name":"Generate Data","func":"let Data = msg.payload[0]\nvar Variable = global.get(\"Variable\");\n\nVariable.Number[0][64] = Data.PhanTramCuiKho;\nVariable.Number[0][60] = Data.PhanTramCuiTuoi;\nVariable.Number[0][65] = Data.GiaTienCuiKho;\nVariable.Number[0][67] = Data.GiaTienCuiTuoi;\nVariable.Number[0][63] = Data.PhieuCan;\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":3300,"wires":[[]]},{"id":"9ef3e45525625785","type":"mqtt in","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_CheckWeigh_Check_DanhGiaCui_Luu","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":3360,"wires":[["58b4323cb49452c7"]]},{"id":"58b4323cb49452c7","type":"function","z":"a933b5fd7ed9762b","name":"Check Status","func":"var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nif (Variable.Bit[0][63]) {\n    (Variable.Bit[0][63]) = false;\n    if (Variable.Number[0][63] > 0) {\n        node.send(msg);\n    } else {\n        let tempData = global.get('Set_Mqtt_DataAlarm')\n        if (!Array.isArray(tempData)) tempData = []\n        let data = {\n            Type: 'error',\n            Message: 'Chưa Chọn Phiếu Cân'\n        }\n        tempData.push(data)\n        global.set('Set_Mqtt_DataAlarm', tempData)\n    }\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":570,"y":3360,"wires":[["b5a5d2322ab6aeb8"]]},{"id":"b5a5d2322ab6aeb8","type":"function","z":"a933b5fd7ed9762b","name":"Update Data","func":"var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\n\n//** UPDATE DATABASE **//\n    let PhanTramCuiKho = Variable.Number[0][64];\n    let PhanTramCuiTuoi = Variable.Number[0][66];\n    let GiaTienCuiKho = Variable.Number[0][65];\n    let GiaTienCuiTuoi = Variable.Number[0][67];\n    let PhieuCan = Variable.Number[0][63];\n    msg.topic = `UPDATE TeaCheckWeigh_Cui SET PhanTramCuiKho = '${PhanTramCuiKho}', PhanTramCuiTuoi = '${PhanTramCuiTuoi}', GiaTienCuiKho = '${GiaTienCuiKho}', GiaTienCuiTuoi = '${GiaTienCuiTuoi}' WHERE PhieuCan = ${PhieuCan}`;\n    node.send(msg) ;\n\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":780,"y":3360,"wires":[["5f87f25d9714f6e3"]]},{"id":"5f87f25d9714f6e3","type":"sqlite","z":"a933b5fd7ed9762b","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":990,"y":3360,"wires":[["e9ba5696738dfb97"]]},{"id":"e9ba5696738dfb97","type":"function","z":"a933b5fd7ed9762b","name":"Warning Completed","func":"var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\n\n//** UPDATE DATA**//\n    Variable.Number[0][64] = 0;\n    Variable.Number[0][66] = 0;\n    Variable.Number[0][65] = 0;\n    Variable.Number[0][67] = 0;\n    Variable.Number[0][63] = 0;\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Kỹ Thuật Lưu % Nước & Giá Tiền Thành Công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1210,"y":3360,"wires":[["ddc42efca54c9ece"]]},{"id":"ddc42efca54c9ece","type":"link out","z":"a933b5fd7ed9762b","name":"link out 22","mode":"link","links":["56f7a1daf1ce8017","50184f745af805d3"],"x":1375,"y":3360,"wires":[]},{"id":"663436b33281c676","type":"function","z":"a933b5fd7ed9762b","name":"Delete Images","func":"/// DELETE 4 COLUMNS ///\n\nlet TempTable = msg.payload.data\nTempTable.forEach(obj => {\n  delete obj.Image_CanTong1;\n  delete obj.Image_CanTong2;\n  delete obj.Image_CanBi1;\n  delete obj.Image_CanBi2;\n});\nmsg.payload = { data: TempTable }\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1510,"y":1400,"wires":[["f044cebf5eac3ee2"]]},{"id":"8a94b06d652d6177","type":"mqtt out","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_Image1_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":2060,"wires":[]},{"id":"130e3013cd2696b3","type":"mqtt out","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_Image2_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":2100,"wires":[]},{"id":"c2a910e3cf0fcb82","type":"mqtt out","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_Image3_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":2140,"wires":[]},{"id":"1e1fc55ccbba059a","type":"mqtt out","z":"a933b5fd7ed9762b","name":"","topic":"Mqtt_Image4_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":2180,"wires":[]},{"id":"0c23a43f4a9acd7f","type":"link in","z":"a933b5fd7ed9762b","name":"link in 48","links":["e8f0298b36317021"],"x":1315,"y":2140,"wires":[["8a94b06d652d6177","130e3013cd2696b3","c2a910e3cf0fcb82","1e1fc55ccbba059a"]]},{"id":"eaab9bac830c948d","type":"mqtt in","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"","topic":"Mqtt_CheckWeigh_CanBiLuu_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":500,"wires":[["68f77e6a18417403"]]},{"id":"b68262b7147275f6","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Check View Function","func":"/// ** CHECK VIEW FUNCTION ** ///\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][35] = false; //  NÚT NHẤN UPDATE DATA\n}, 500);\nif ((Variables.Bit[0][47] == true) && (Variables.Number[0][47]) > 0) {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Đã Cân Bì Rồi - Cần Tạo Phiếu Cân Mới'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n} else {\n    node.send(msg);\n}\n\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":500,"wires":[["af18cbf80880f626"]]},{"id":"af18cbf80880f626","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Update Database","func":"/// ** UPDATE DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][35] = false; //  NÚT NHẤN UPDATE DATA\n}, 500);\n\nif ((Variables.Number[0][32]) == 0) {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Lấy Số Cân Bì'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n} else {\n    if ((Variables.Number[0][32]) < (Variables.Number[0][31])) {\n        msg.payload = 1;\n        node.send(msg);\n    } else {\n        let tempData = global.get('Set_Mqtt_DataAlarm')\n        if (!Array.isArray(tempData)) tempData = []\n        let data = {\n            Type: 'error',\n            Message: 'Cân Bì Sai'\n        }\n        tempData.push(data)\n        global.set('Set_Mqtt_DataAlarm', tempData)\n    }\n}\n\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":720,"y":500,"wires":[["3019a472568dba57"]]},{"id":"61fec996e9b5b32c","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Set Empty Store Image","func":"msg.timeout = 10000;\nglobal.set('StoreImage3_Cui','')\nglobal.set('StoreImage4_Cui','')\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1740,"y":540,"wires":[["b8bd14c219163e98","6ff62200659d4a8e","b77df33afc185bf5","5602c5851b844178"]]},{"id":"b8bd14c219163e98","type":"mqtt out","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"","topic":"Mqtt_Image3_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":2000,"y":520,"wires":[]},{"id":"6ff62200659d4a8e","type":"mqtt out","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"","topic":"Mqtt_Image4_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":2000,"y":560,"wires":[]},{"id":"b77df33afc185bf5","type":"http request","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Fetch Image","method":"GET","ret":"bin","paytoqs":"ignore","url":"http://192.168.1.49:3001/snapshot/camera1","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":1980,"y":480,"wires":[["d09f7bc096076c78"]]},{"id":"5602c5851b844178","type":"http request","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Fetch Image","method":"GET","ret":"bin","paytoqs":"ignore","url":"http://192.168.1.49:3001/snapshot/camera2","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":1980,"y":600,"wires":[["9c0cfe03cdafa5fc"]]},{"id":"d09f7bc096076c78","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"CheckCameraIsOnline","func":"if(msg.payload.toString()=='Camera is offline'){\n    let msg2 = {payload:1};\n    node.send([, msg2]);\n}else{\n    node.send(msg);\n}    ","outputs":2,"timeout":"0","noerr":0,"initialize":"","finalize":"","libs":[],"x":2170,"y":480,"wires":[["c9eba5393c64f384"],["7ef7f302259ea232"]]},{"id":"9c0cfe03cdafa5fc","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"CheckCameraIsOnline","func":"if(msg.payload.toString()=='Camera is offline'){\n    let msg2 = {payload:1};\n    node.send([, msg2]);\n}else{\n    node.send(msg);\n}    ","outputs":2,"timeout":"0","noerr":0,"initialize":"","finalize":"","libs":[],"x":2170,"y":600,"wires":[["894957abc544b791"],["51c3d0d153bbe548"]]},{"id":"c9eba5393c64f384","type":"base64","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Convert to Base64","action":"encode","property":"payload","x":2400,"y":460,"wires":[["de01f5436ae9309b","ebb6fd626a9c2f01"]]},{"id":"7ef7f302259ea232","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Process Camera Offline","func":"let tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'error',\n    Message: 'Camera 1 có vấn đề - lấy hình thất bại'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2420,"y":520,"wires":[["dea13e90796f2068"]]},{"id":"894957abc544b791","type":"base64","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Convert to Base64","action":"encode","property":"payload","x":2400,"y":640,"wires":[["72b1873ff4460d1e","ddffb78c1789f34f"]]},{"id":"51c3d0d153bbe548","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Process Camera Offline","func":"let tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'error',\n    Message: 'Camera 2 có vấn đề - lấy hình thất bại'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2420,"y":580,"wires":[["0a8d057fe6c550b0"]]},{"id":"de01f5436ae9309b","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Save Image 3","func":"global.set('StoreImage3_Cui',msg.payload)\nif(msg.payload.length>200){\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Camera 1 có vấn đề - lấy hình thất bại'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n};","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2630,"y":480,"wires":[["1d06c21cfc82e001","dea13e90796f2068"]]},{"id":"ebb6fd626a9c2f01","type":"mqtt out","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"","topic":"Mqtt_Image3_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":2640,"y":440,"wires":[]},{"id":"72b1873ff4460d1e","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Save Image 4","func":"global.set('StoreImage4_Cui',msg.payload)\nif(msg.payload.length>200){\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Camera 2 có vấn đề - lấy hình thất bại'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n};","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2630,"y":620,"wires":[["c7d54b2f3381bf08","0a8d057fe6c550b0"]]},{"id":"ddffb78c1789f34f","type":"mqtt out","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"","topic":"Mqtt_Image4_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":2640,"y":660,"wires":[]},{"id":"3019a472568dba57","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Query Max Phieu Can","func":"msg.topic = `SELECT MAX(PhieuCan) as max_PhieuCan FROM TeaCheckWeigh_Cui`\nmsg.payload = [];\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":500,"wires":[["8c53efc6084ffd8f"]]},{"id":"8c53efc6084ffd8f","type":"sqlite","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":1130,"y":500,"wires":[["6b7f8f0d810d4512"]]},{"id":"6b7f8f0d810d4512","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Update Data","func":"//** UPDATE DATABASE **//\nvar Variable = global.get(\"Variable\");\nif ((Variable.Number[0][35] > 0 && Variable.Number[0][36] == 0) ||\n    (Variable.Number[0][37] > 0 && Variable.Number[0][38] == 0)) {\n\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Nhập Giá Tiền'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n\n} else {\n    if ((msg.payload[0].max_PhieuCan) == Variable.Number[0][30] || (msg.payload[0].max_PhieuCan) > Variable.Number[0][30]) {\n        let PhieuCan_2 = Variable.Number[0][30];\n        let GhiChu_2 = Variable.ListString[0][38];\n        let GioCanBi_2 = Variable.ListString[0][40];\n        let SoCanBi_2 = Variable.Number[0][32];\n        let TrongLuongHienTai_2 = Variable.Number[0][33];\n        let PhanTramCuiKho_2 = Variable.Number[0][35];\n        let GiaTienCuiKho_2 = Variable.Number[0][36];\n        let PhanTramCuiTuoi_2 = Variable.Number[0][37];\n        let GiaTienCuiTuoi_2 = Variable.Number[0][38];\n        let TrongLuongCuiKho = Variable.Number[0][34];\n        let TrongLuongCuiTuoi = Variable.Number[0][50];\n        let ThanhTien_2 = Variable.Number[0][39];\n        let Image_CanBi1_2 = global.get('StoreImage3_Cui');\n        let Image_CanBi2_2 = global.get('StoreImage4_Cui');\n        msg.topic = `UPDATE TeaCheckWeigh_Cui SET GhiChu = '${GhiChu_2}', GioCanBi = '${GioCanBi_2}', SoCanBi = '${SoCanBi_2}', TrongLuongHienTai = '${TrongLuongHienTai_2}', PhanTramCuiKho = '${PhanTramCuiKho_2}', GiaTienCuiKho = '${GiaTienCuiKho_2}', PhanTramCuiTuoi = '${PhanTramCuiTuoi_2}', GiaTienCuiTuoi = '${GiaTienCuiTuoi_2}', TrongLuongCuiKho = '${TrongLuongCuiKho}', TrongLuongCuiTuoi = '${TrongLuongCuiTuoi}', ThanhTien = '${ThanhTien_2}', Image_CanBi1 = '${Image_CanBi1_2}', Image_CanBi2 = '${Image_CanBi2_2}' WHERE PhieuCan = ${PhieuCan_2}`;\n        node.send(msg)\n    } else {\n        let tempData = global.get('Set_Mqtt_DataAlarm')\n        if (!Array.isArray(tempData)) tempData = []\n        let data = {\n            Type: 'error',\n            Message: 'Chưa Lưu Phiếu Cân Tổng'\n        }\n        tempData.push(data)\n        global.set('Set_Mqtt_DataAlarm', tempData)\n    }\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":700,"y":580,"wires":[["c2a96eed5083d1db"]]},{"id":"c2a96eed5083d1db","type":"sqlite","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"UPDATE TeaCheckWeigh SET SoCanBi = 1, PhanTramNuoc = 2, GiaTien = 3 WHERE PhieuCan = 4","name":"Execute Update Data","x":890,"y":580,"wires":[["713ca261378171f2"]]},{"id":"713ca261378171f2","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Success Message","func":"var Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nVariables.Bit[0][17] = false;\nVariables.Number[0][47] = 0;\n\n/// WRITE DATA TO PLC //\nif (VariableSystem.COMMUNICATION_PLC_MODBUS[2]) {\n    VariableSystem.COMMUNICATION_PLC_MODBUS[2].writeSingleCoil(2058, 1).then(function (resp) {\n}, console.error); // RESET BUZZER\n}\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Lưu Số Cân Bì Thành Công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1100,"y":580,"wires":[["38edd92f1b2506c6"]]},{"id":"38edd92f1b2506c6","type":"link out","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"link out 14","mode":"link","links":["50184f745af805d3","56f7a1daf1ce8017"],"x":1235,"y":580,"wires":[]},{"id":"16293824c6077ddc","type":"mqtt in","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"","topic":"Mqtt_CheckWeigh_CanBiCui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":1470,"y":540,"wires":[["61fec996e9b5b32c","d96446a6537e1edb"]]},{"id":"1d06c21cfc82e001","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Camera 1 Capture Complete","func":"let tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Camera 1 lấy hình thành công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2890,"y":480,"wires":[[]]},{"id":"c7d54b2f3381bf08","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Camera 2 Capture Complete","func":"let tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Camera 2 lấy hình thành công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2890,"y":620,"wires":[[]]},{"id":"d96446a6537e1edb","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Disable Cam 1, 2 save","func":"global.set('Save_Camera1',false);\nglobal.set('Save_Camera2',false);\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1730,"y":600,"wires":[[]]},{"id":"dea13e90796f2068","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Enable Save Cam 1","func":"global.set('Save_Camera1',true);\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2860,"y":520,"wires":[[]]},{"id":"0a8d057fe6c550b0","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Enable Save Cam 2","func":"global.set('Save_Camera2',true);\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2860,"y":580,"wires":[[]]},{"id":"68f77e6a18417403","type":"function","z":"a933b5fd7ed9762b","g":"db7fcfe8cfc3b1d9","name":"Check Camera","func":"var Variables = global.get(\"Variable\");\nif (global.get('Save_Camera1') && global.get('Save_Camera2')) {\n    node.send(msg);\n} else {\n\n    setTimeout(() => {\n        Variables.Bit[0][34] = false; //  NÚT NHẤN INSERT DATA\n    }, 500);\n    \n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Chờ lấy hình camera'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":560,"wires":[["b68262b7147275f6"]]},{"id":"68be07131e38a12a","type":"function","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","name":"Them Phieu Can Moi","func":"/// ** THEM PHIEU CAN MOI ** ///\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][32] = false; //  NÚT NHẤN PHIẾU CÂN MỚI\n}, 500);\n\nVariables.Number[0][31] = 0; // RESET\nVariables.Number[0][32] = 0; // RESET\nVariables.Number[0][33] = 0; // RESET\nVariables.Number[0][34] = 0; // RESET \nVariables.Number[0][35] = 0; // RESET\nVariables.Number[0][36] = 0; // RESET\nVariables.Number[0][37] = 0; // RESET\nVariables.Number[0][38] = 0; // RESET\nVariables.Number[0][39] = 0; // RESET\nVariables.Number[0][50] = 0; // RESET\nVariables.ListString[0][30] = ''; // RESET\nVariables.ListString[0][31] = ''; // RESET\nVariables.ListString[0][32] = ''; // RESET\nVariables.ListString[0][33] = ''; // RESET\nVariables.ListString[0][34] = 'Công ty cổ phần phát triển chè Nghệ An'; // RESET\nVariables.ListString[0][35] = ''; // RESET\nVariables.ListString[0][36] = ''; // RESET\nVariables.ListString[0][37] = 'Xóm 3- Đỉnh Sơn- Anh Sơn- Nghệ An '; // RESET\nVariables.ListString[0][38] = ''; // RESET\nVariables.ListString[0][39] = ''; // RESET\nVariables.ListString[0][40] = ''; // RESET\nVariables.Number[0][41] = 0 ; // RESET PHIEU CAN MUON XEM\nVariables.Bit[0][47] = false; //   BIT Ở CHẾ ĐỘ XEM PHIẾU\nVariables.Number[0][47] = 0; // CHECK SỐ CÂN BÌ ĐÃ CÂN HAY CHƯA.\nVariables.Number[0][48] = 0; // CHECK SỐ CÂN BÌ ĐÃ CÂN HAY CHƯA.\nmsg.payload = \" \"\nnode.send(msg);\n\n\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":860,"wires":[["c8f0832fd5657c22","46747aee71a9cd73","944a97e7fa69e0c7","3e620a9abdefb620","a19bc1ee27f26f1b","161c753392696654"]]},{"id":"9fa6f5429a64ab1a","type":"mqtt in","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","name":"","topic":"Mqtt_CheckWeigh_ThemPhieuCan_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":860,"wires":[["68be07131e38a12a"]]},{"id":"c8f0832fd5657c22","type":"mqtt out","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","name":"","topic":"Mqtt_Image1_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":760,"y":760,"wires":[]},{"id":"46747aee71a9cd73","type":"mqtt out","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","name":"","topic":"Mqtt_Image2_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":760,"y":820,"wires":[]},{"id":"944a97e7fa69e0c7","type":"mqtt out","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","name":"","topic":"Mqtt_Image3_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":760,"y":900,"wires":[]},{"id":"3e620a9abdefb620","type":"mqtt out","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","name":"","topic":"Mqtt_Image4_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":760,"y":960,"wires":[]},{"id":"a19bc1ee27f26f1b","type":"function","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","name":"Query Max Phieu Can","func":"msg.topic = `SELECT MAX(PhieuCan) as max_PhieuCan FROM TeaCheckWeigh_Cui`\nmsg.payload = [];\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":990,"y":860,"wires":[["29e77c5a92372dba"]]},{"id":"29e77c5a92372dba","type":"sqlite","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1200,"y":860,"wires":[["83a5f99825028b1c"]]},{"id":"83a5f99825028b1c","type":"function","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","name":"Lay So Phieu Can Moi","func":"var Variables = global.get(\"Variable\");\nVariables.Number[0][30] = msg.payload[0].max_PhieuCan + 1\nmsg.payload = true;\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1410,"y":860,"wires":[["d310ce3159704b04"]]},{"id":"161c753392696654","type":"link out","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","name":"link out 15","mode":"link","links":["a7232d34054f77ee","bbef2de2fbc5401c"],"x":515,"y":940,"wires":[]},{"id":"d310ce3159704b04","type":"mqtt out","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","name":"","topic":"Mqtt_CheckWeigh_Editable_Cui","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1680,"y":860,"wires":[]},{"id":"a6d0c984d21fb267","type":"link in","z":"a933b5fd7ed9762b","g":"554f2bec755372c0","name":"link in 39","links":["7058763e40782af6"],"x":335,"y":940,"wires":[["68be07131e38a12a"]]},{"id":"849aee0a36ee7c38","type":"mqtt in","z":"a933b5fd7ed9762b","g":"936960f4ecf6c946","name":"","topic":"Mqtt_CheckWeigh_XoaTimKiem_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":1340,"wires":[["dcde6444849d9f0a"]]},{"id":"dcde6444849d9f0a","type":"function","z":"a933b5fd7ed9762b","g":"936960f4ecf6c946","name":"Query DB","func":"var Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nVariables.ListString[0][41] = ''; // RESET\nVariables.Number[0][40] = 0; // RESET\nVariables.ListString[0][61] = ''; // RESET\nsetTimeout(() => {\n    Variables.Bit[0][37] = false; //   NÚT XÓA TÌM KIẾM.\n}, 500);\n\nmsg.payload = []\nnode.send(msg);","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":610,"y":1340,"wires":[["99a5ef98a7e56903","7058763e40782af6"]]},{"id":"a37be8022d9b276b","type":"mqtt in","z":"a933b5fd7ed9762b","g":"c0a138530eb94ba5","name":"","topic":"Mqtt_CheckWeigh_Check_Phieu2Lan_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":1500,"wires":[["30999262fe95fb47"]]},{"id":"48be13151be0031c","type":"mqtt in","z":"a933b5fd7ed9762b","g":"c0a138530eb94ba5","name":"","topic":"Mqtt_CheckWeigh_Check_All_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":1440,"wires":[["5410445df29b6393"]]},{"id":"5410445df29b6393","type":"function","z":"a933b5fd7ed9762b","g":"c0a138530eb94ba5","name":"Filter","func":"var Variables = global.get(\"Variable\");\nVariables.Bit[0][41] = true;\nVariables.Bit[0][42] = false;\nVariables.Bit[0][43] = false;\nVariables.Bit[0][40] = false;\nVariables.ListString[0][61] = ''; // RESET\nmsg.payload = global.get('StoreQueryGridView_Cui')\nVariables.Number[0][40] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":1440,"wires":[["99a5ef98a7e56903"]]},{"id":"30999262fe95fb47","type":"function","z":"a933b5fd7ed9762b","g":"c0a138530eb94ba5","name":"Filter","func":"var Variables = global.get(\"Variable\");\nVariables.Bit[0][41] = false;\nVariables.Bit[0][42] = true;\nVariables.Bit[0][43] = false;\nVariables.Bit[0][40] = false;\nVariables.ListString[0][61] = ''; // RESET\nmsg.payload = global.get('StoreQueryGridView_Cui').filter(item => item.SoCanBi > 0)\nVariables.Number[0][40] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":1500,"wires":[["99a5ef98a7e56903"]]},{"id":"fc21403cf7e54863","type":"mqtt in","z":"a933b5fd7ed9762b","g":"c0a138530eb94ba5","name":"","topic":"Mqtt_CheckWeigh_Check_Phieu1Lan_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":1560,"wires":[["12982c8860aa763d"]]},{"id":"12982c8860aa763d","type":"function","z":"a933b5fd7ed9762b","g":"c0a138530eb94ba5","name":"Filter","func":"var Variables = global.get(\"Variable\");\nVariables.Bit[0][41] = false;\nVariables.Bit[0][42] = false;\nVariables.Bit[0][43] = true;\nVariables.Bit[0][40] = false;\nVariables.ListString[0][61] = ''; // RESET\nmsg.payload = global.get('StoreQueryGridView_Cui').filter(item => item.SoCanBi == 0)\nVariables.Number[0][40] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":1560,"wires":[["99a5ef98a7e56903"]]},{"id":"c8bb4e655f92271e","type":"mqtt in","z":"a933b5fd7ed9762b","g":"341d7cefad79a087","name":"","topic":"Mqtt_CheckWeigh_Check_LanCanTrongNgay_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":240,"y":1660,"wires":[["61f898d96564e6bc"]]},{"id":"50184f745af805d3","type":"link in","z":"a933b5fd7ed9762b","g":"341d7cefad79a087","name":"link in 31","links":["469d6905b31b3cd6","38edd92f1b2506c6","ddc42efca54c9ece"],"x":455,"y":1700,"wires":[["61f898d96564e6bc"]]},{"id":"61f898d96564e6bc","type":"function","z":"a933b5fd7ed9762b","g":"341d7cefad79a087","name":"Query DB","func":"\n// Get current date and time\nconst currentDate = new Date();\n\n// Set hours, minutes, seconds, and milliseconds to 0 to get midnight of the current day\ncurrentDate.setHours(0, 0, 0);\n\n// Convert this midnight timestamp to milliseconds\nconst StartTimestamp = currentDate.getTime();\n\n// Get current timestamp\nconst EndTimestamp = Date.now(); // This gives you the current timestamp in milliseconds\n\n// Now you have startTimestamp (beginning of the current day) and endTimestamp (current time)\n// You can use these values to search or perform any operations within this range\nconsole.log(\"Start Timestamp (midnight of current day):\", StartTimestamp);\nconsole.log(\"End Timestamp (current time):\", EndTimestamp);\nnode.warn(StartTimestamp);\nnode.warn(EndTimestamp);\n\nvar Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nlet start_time_Cui = StartTimestamp\nlet stop_time_Cui = EndTimestamp\n\nsetTimeout(() => {\n    Variables.Bit[0][40] = false; //   NÚT CÁC LẦN CÂN TRONG NGÀY.\n}, 500);\nVariables.ListString[0][61] = ''; // RESET\nmsg.topic = `SELECT * FROM TeaCheckWeigh_Cui WHERE TimeCreate BETWEEN ($start_time_Cui) AND ($stop_time_Cui) `\nmsg.payload = [start_time_Cui, stop_time_Cui]\nnode.send(msg);\nnode.warn(msg.topic);\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":590,"y":1660,"wires":[["fadf620ce8a025bc"]]},{"id":"fadf620ce8a025bc","type":"sqlite","z":"a933b5fd7ed9762b","g":"341d7cefad79a087","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":850,"y":1660,"wires":[["5ea69969efe695f1"]]},{"id":"5ea69969efe695f1","type":"function","z":"a933b5fd7ed9762b","g":"341d7cefad79a087","name":"Filter","func":"var Variables = global.get(\"Variable\");\nglobal.set('StoreQueryGridView_Cui', msg.payload)\nVariables.Bit[0][41] = false;\nVariables.Bit[0][42] = false;\nVariables.Bit[0][43] = false;\nVariables.Number[0][40] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1040,"y":1660,"wires":[["99a5ef98a7e56903"]]},{"id":"32f6799c5ff7914f","type":"function","z":"a933b5fd7ed9762b","g":"1647607299efe37a","name":"Export Excel","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][38] = false; //   NÚT XUẤT EXCEL\n}, 500);\nmsg.payload = {\n    exportExcel: 1\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":1800,"wires":[["6ab8cf910c8b73d5"]]},{"id":"f7de4c3ab33066b4","type":"mqtt in","z":"a933b5fd7ed9762b","g":"1647607299efe37a","name":"","topic":"Mqtt_CheckWeigh_ExportExcel_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":1800,"wires":[["32f6799c5ff7914f"]]},{"id":"6ab8cf910c8b73d5","type":"mqtt out","z":"a933b5fd7ed9762b","g":"1647607299efe37a","name":"Mqtt_CheckWeigh_DataGrid_Cui","topic":"Mqtt_CheckWeigh_DataGrid_Cui","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":690,"y":1800,"wires":[]},{"id":"4758ebf86864563d","type":"mqtt in","z":"a933b5fd7ed9762b","g":"343e4d693aad4da1","name":"","topic":"Mqtt_CheckWeigh_DataGrid_Response_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":220,"y":2080,"wires":[["130cfebffc37fda5","601c6b4574734c02"]]},{"id":"130cfebffc37fda5","type":"function","z":"a933b5fd7ed9762b","g":"343e4d693aad4da1","name":"Get Data Current Row","func":"msg.payload[0] = msg.payload.record;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":650,"y":2080,"wires":[["d6b50e9eeb8550bb","2c7c75570942ae5c"]]},{"id":"7d0295dedb5c3b4b","type":"function","z":"a933b5fd7ed9762b","g":"343e4d693aad4da1","name":"View History Mode","func":"var Variables = global.get(\"Variable\");\nif (Variables.Number[0][1] < 100) {\n    return msg\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Đang Ở Chế Độ Cân - Không Thể Xem Lịch Sử'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":2140,"wires":[[]]},{"id":"601c6b4574734c02","type":"function","z":"a933b5fd7ed9762b","g":"343e4d693aad4da1","name":"Reset value","func":"msg.payload = \" \"\nreturn msg\n\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":620,"y":2160,"wires":[["e8f0298b36317021"]]},{"id":"e8f0298b36317021","type":"link out","z":"a933b5fd7ed9762b","g":"343e4d693aad4da1","name":"link out 16","mode":"link","links":["a7232d34054f77ee","0c23a43f4a9acd7f"],"x":735,"y":2160,"wires":[]},{"id":"2c7c75570942ae5c","type":"function","z":"a933b5fd7ed9762b","g":"343e4d693aad4da1","name":"Query DB Get 4 Images","func":"\nlet data=msg.payload[0]\nmsg.topic = `SELECT * FROM TeaCheckWeigh_Cui WHERE PhieuCan=\"${data.PhieuCan}\"`\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":940,"y":2080,"wires":[["af002674d4a8f7b4"]]},{"id":"af002674d4a8f7b4","type":"sqlite","z":"a933b5fd7ed9762b","g":"343e4d693aad4da1","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":1170,"y":2080,"wires":[["2f2574d27c82f29d"]]},{"id":"098fe07b93acdf12","type":"mqtt in","z":"a933b5fd7ed9762b","g":"5fb38034229b6b33","name":"","topic":"Mqtt_CheckWeigh_Check_XemPhieu_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":1920,"wires":[["e9ab32ecdef2b943"]]},{"id":"e9ab32ecdef2b943","type":"function","z":"a933b5fd7ed9762b","g":"5fb38034229b6b33","name":"Query DB","func":"var Variables = global.get(\"Variable\");\nVariables.ListString[0][61] = ''; // RESET\nsetTimeout(() => {\n    Variables.Bit[0][39] = false; //   NÚT TÌM PHIẾU CÂN.\n}, 500);\n\nif (Variables.Number[0][41] > 0) {\n    msg.topic = `SELECT * FROM TeaCheckWeigh_Cui WHERE PhieuCan = '${Variables.Number[0][41]}' `\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Chưa Nhập Số Phiếu Cần Tìm'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":490,"y":1920,"wires":[["eb256d1c52115f86"]]},{"id":"eb256d1c52115f86","type":"sqlite","z":"a933b5fd7ed9762b","g":"5fb38034229b6b33","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":650,"y":1920,"wires":[["2f2574d27c82f29d","d6b50e9eeb8550bb"]]},{"id":"dcd51f6325fba9a8","type":"function","z":"a933b5fd7ed9762b","g":"5fb38034229b6b33","name":"View History Mode","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][36] = false; //   NÚT TÌM PHIẾU CÂN.\n}, 500);\nif (Variables.Number[0][1] < 100) {\n    return msg\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Đang Ở Chế Độ Cân - Không Thể Xem Lịch Sử'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":1980,"wires":[[]]},{"id":"692201b5db091437","type":"function","z":"a933b5fd7ed9762b","g":"d257f860d200adb1","name":"Check Condition Before Add Data","func":"// /// ** SAVE USER DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n     Variables.Bit[0][33] = false; //  NÚT LƯU THÔNG TIN NGƯỜI DÙNG\n }, 500);\n\nif (Variables.ListString[0][31].length>0) {\n    node.send(msg)\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Chưa Nhập Tên Lưu'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":490,"y":2260,"wires":[["8c23a02463ca7568"]]},{"id":"8c23a02463ca7568","type":"function","z":"a933b5fd7ed9762b","g":"d257f860d200adb1","name":"Create Table","func":"\nmsg.topic = `CREATE TABLE IF NOT EXISTS TeaCheckWeigh_Cui_SaveList (\n    NameKey TEXT PRIMARY KEY,\n    BienSoXe TEXT,\n    DaiDienBenBan TEXT,\n    NguoiBan TEXT,\n    DaiDienBenMua TEXT,\n    DiaChi_DaiDienBenBan TEXT,\n    DiaChi_NguoiBan TEXT,\n    DiaChi_DaiDienBenMua TEXT,\n    GhiChu TEXT,\n    TimeCreate INTEGER\n)`;\nnode.send(msg)\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":720,"y":2260,"wires":[["8a07b987198e054b"]]},{"id":"8a07b987198e054b","type":"sqlite","z":"a933b5fd7ed9762b","g":"d257f860d200adb1","mydb":"2eaf96fabb89e5b9","sqlquery":"msg.topic","sql":"","name":"Execute Create Table","x":910,"y":2260,"wires":[["30defd625dd79ec3"]]},{"id":"85a22348714e5b2b","type":"mqtt in","z":"a933b5fd7ed9762b","g":"d257f860d200adb1","name":"","topic":"Mqtt_CheckWeigh_SaveSample_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":2260,"wires":[["692201b5db091437"]]},{"id":"30defd625dd79ec3","type":"function","z":"a933b5fd7ed9762b","g":"d257f860d200adb1","name":"Insert Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet NameKey_2 = Variable.ListString[0][31];\nlet BienSoXe_2 = Variable.ListString[0][30];\nlet DaiDienBenBan_2 = Variable.ListString[0][32];\nlet NguoiBan_2 = Variable.ListString[0][33];\nlet DaiDienBenMua_2 = Variable.ListString[0][34];\nlet DiaChi_DaiDienBenBan_2 = Variable.ListString[0][35];\nlet DiaChi_NguoiBan_2 = Variable.ListString[0][36];\nlet DiaChi_DaiDienBenMua_2 = Variable.ListString[0][37];\nlet GhiChu_2 = Variable.ListString[0][38];\nmsg.topic = `INSERT INTO TeaCheckWeigh_Cui_SaveList (\n    NameKey, BienSoXe, DaiDienBenBan, NguoiBan, DaiDienBenMua, DiaChi_DaiDienBenBan, DiaChi_NguoiBan, DiaChi_DaiDienBenMua, GhiChu, TimeCreate)\n    VALUES (\n    $NameKey_2, $BienSoXe_2, $DaiDienBenBan_2, $NguoiBan_2, $DaiDienBenMua_2, $DiaChi_DaiDienBenBan_2, $DiaChi_NguoiBan_2, $DiaChi_DaiDienBenMua_2, $GhiChu_2, $TimeCreate)`\nmsg.payload = [NameKey_2, BienSoXe_2, DaiDienBenBan_2, NguoiBan_2, DaiDienBenMua_2, DiaChi_DaiDienBenBan_2, DiaChi_NguoiBan_2, DiaChi_DaiDienBenMua_2, GhiChu_2, Date.now()]\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1100,"y":2260,"wires":[["0c4a8ddbc019c465"]]},{"id":"0c4a8ddbc019c465","type":"sqlite","z":"a933b5fd7ed9762b","g":"d257f860d200adb1","mydb":"2eaf96fabb89e5b9","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":1280,"y":2260,"wires":[["bd91dd83c5efa4e3"]]},{"id":"bd91dd83c5efa4e3","type":"function","z":"a933b5fd7ed9762b","g":"d257f860d200adb1","name":"Success Message","func":"var Variables = global.get(\"Variable\")\n\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Lưu Dữ Liệu Mẫu Thành Công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nVariables.ListString[0][31] = '---'; // RESET\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1480,"y":2260,"wires":[["7ed1d0041cf83a6a"]]},{"id":"bc3dc82a597b7d18","type":"catch","z":"a933b5fd7ed9762b","g":"d257f860d200adb1","name":"Handle Error ","scope":"group","uncaught":true,"x":740,"y":2320,"wires":[["6be45720c107a486"]]},{"id":"6be45720c107a486","type":"function","z":"a933b5fd7ed9762b","g":"d257f860d200adb1","name":"Error Message","func":"var Variables = global.get(\"Variable\");\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\n\nnode.warn(msg.error)\ntry {\n    if (msg.error && JSON.stringify(msg.error).length > 0) {\n    if (JSON.stringify(msg.error).includes('UNIQUE constraint failed')) {\n        let data = {\n            Type: 'error',\n            Message: 'Trùng Tên'\n        }\n        tempData.push(data)\n    }\n}\n} catch (error) {\n    node.warn(error);\n};\n\n// node.warn(msg.error.includes('UNIQUE constraint failed'))\nlet data = {\n    Type: 'alert',\n    Message: JSON.stringify(msg.error)\n}\ntempData.push(data)\n\n\nglobal.set('Set_Mqtt_DataAlarm', tempData)","outputs":0,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":2320,"wires":[]},{"id":"7ed1d0041cf83a6a","type":"link out","z":"a933b5fd7ed9762b","g":"d257f860d200adb1","name":"link out 17","mode":"link","links":["e9d5b6a822b289a5"],"x":1605,"y":2260,"wires":[]},{"id":"43ae846607c1338b","type":"function","z":"a933b5fd7ed9762b","g":"29c775ceaa71eb73","name":"Query DB","func":"\nmsg.topic = `SELECT * FROM TeaCheckWeigh_Cui_SaveList`\nnode.send(msg);\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":330,"y":2460,"wires":[["54759c40cb2a47d0"]]},{"id":"54759c40cb2a47d0","type":"sqlite","z":"a933b5fd7ed9762b","g":"29c775ceaa71eb73","mydb":"2eaf96fabb89e5b9","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":490,"y":2460,"wires":[["c530411bbb3264c0"]]},{"id":"97b5f3ed2d485f81","type":"function","z":"a933b5fd7ed9762b","g":"29c775ceaa71eb73","name":"Generate Layout From Sample User","func":"let Data = msg.payload\nvar Variable = global.get(\"Variable\");\n\nVariable.ListString[0][30] = Data.BienSoXe;\nVariable.ListString[0][32] = Data.DaiDienBenBan;\nVariable.ListString[0][33] = Data.NguoiBan;\nVariable.ListString[0][34] = Data.DaiDienBenMua;\nVariable.ListString[0][35] = Data.DiaChi_DaiDienBenBan;\nVariable.ListString[0][36] = Data.DiaChi_NguoiBan;\nVariable.ListString[0][37] = Data.DiaChi_DaiDienBenMua;\nVariable.ListString[0][38] = Data.GhiChu;","outputs":0,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":820,"y":2640,"wires":[]},{"id":"c530411bbb3264c0","type":"function","z":"a933b5fd7ed9762b","g":"29c775ceaa71eb73","name":"Load List User To Select Sample","func":"let tempData = msg.payload\nlet arr = []\nif (Array.isArray(tempData)) {\n    arr = tempData.map((item) => {\n      return { \"value\": JSON.stringify(item), \"label\": item.NameKey } \n    })  \n}\nmsg.payload=arr\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":2460,"wires":[["dd2db33389dde591"]]},{"id":"dd2db33389dde591","type":"mqtt out","z":"a933b5fd7ed9762b","g":"29c775ceaa71eb73","name":"","topic":"Mqtt_CheckWeigh_Select_ListUser_Cui","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1090,"y":2460,"wires":[]},{"id":"541588db6122d9a8","type":"status","z":"a933b5fd7ed9762b","g":"29c775ceaa71eb73","name":"","scope":["dd2db33389dde591"],"x":130,"y":2460,"wires":[["43ae846607c1338b"]]},{"id":"e9d5b6a822b289a5","type":"link in","z":"a933b5fd7ed9762b","g":"29c775ceaa71eb73","name":"link in 32","links":["7ed1d0041cf83a6a"],"x":175,"y":2420,"wires":[["43ae846607c1338b"]]},{"id":"28e3a7c335961674","type":"mqtt in","z":"a933b5fd7ed9762b","g":"29c775ceaa71eb73","name":"","topic":"Mqtt_CheckWeigh_Select_ListUser_Response_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":240,"y":2600,"wires":[["68ef2489b7f55a3c"]]},{"id":"68ef2489b7f55a3c","type":"function","z":"a933b5fd7ed9762b","g":"29c775ceaa71eb73","name":"Select value","func":"let tempObj=JSON.parse(msg.payload.value)\nvar msg1 = {payload:tempObj.NameKey};\nvar msg2 = {payload:tempObj};\nnode.send([msg1, msg2]);","outputs":2,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2600,"wires":[["2f6f8f4d419457a6"],["97b5f3ed2d485f81"]]},{"id":"2f6f8f4d419457a6","type":"mqtt out","z":"a933b5fd7ed9762b","g":"29c775ceaa71eb73","name":"","topic":"Mqtt_CheckWeigh_Select_ListUser_CurrentValue_Cui","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":850,"y":2600,"wires":[]},{"id":"a7232d34054f77ee","type":"link in","z":"a933b5fd7ed9762b","g":"29c775ceaa71eb73","name":"link in 33","links":["161c753392696654","e8f0298b36317021"],"x":555,"y":2540,"wires":[["2f6f8f4d419457a6"]]},{"id":"ed268bbaffb0d252","type":"inject","z":"a933b5fd7ed9762b","g":"e0f5c7de1a97f706","name":"","props":[{"p":"payload","v":"","vt":"date"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"BASE64_ENCODED_IMAGE_STRING","payloadType":"str","x":120,"y":2740,"wires":[["90fe11f2a85265be"]]},{"id":"90fe11f2a85265be","type":"function","z":"a933b5fd7ed9762b","g":"e0f5c7de1a97f706","name":"function 53","func":"msg.payload='/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAMDAwMDAwQEBAQFBQUFBQcHBgYHBwsICQgJCAsRCwwLCwwLEQ8SDw4PEg8bFRMTFRsfGhkaHyYiIiYwLTA+PlQBAwMDAwMDBAQEBAUFBQUFBwcGBgcHCwgJCAkICxELDAsLDAsRDxIPDg8SDxsVExMVGx8aGRofJiIiJjAtMD4+VP/CABEIATIBywMBIgACEQEDEQH/xAAdAAAABgMBAAAAAAAAAAAAAAACAwQFBggAAQcJ/9oACAEBAAAAAJrTLgIc2LWCMFghejXNKcpyd61s3AFYNfeVgpqVhgzjBmniUKB9fg0eGNacQrVrosVG9nbOPMPMNGMcrd4mrG7OK56UCLUOR6+ZP7k+OLmpEWUEBIEryFibG1jbI+1sDM1zHp3JlAzl4xaGavQg7EycUa0rc2tTelRhTpE827FBa+GaIK0WUAgraqb+pPkAVtKDQc0Jx9uvGyEgHmaFgnBKbdaGVdSZvM1mYPWuudeh9dxDwreZmCUjnXoB5hFkgBrNYPLW8z5QcaIWbEPeZ0zr9XSBE73hgjxiE+drM5i7vDke5LVS5QRElU4LapSqkwxBRMBbDklcTRgHozMHibZqBoSH7bz8QtSTBvLCrdlSbEjcwN6YZrwVYmNVnZW1ra2ghGmChszePyIDmxbzWw73Y+R1hZhZmYLNiFrtMekXEtj1mF71mYZ6a1nrLmYHAhDhcj9JPOiLCwIBb2Xsc57lXJoOXvTseiTa3tE5dHjzQ/KlJwgpgZo/OjxBavVOzgegZDByFSteixJzCxrTzVuIj0CCOompgLEpIYUO5mzzk1ZoQQFEm5IEi+yNXEyZpQNzU1pGhm5kO+CSk2BzNYEGb36bec0VHmb3rea1rusFcubH6KAYDeZrXZPRDyMDvWa3sIcvkk6hy2BNsXbMANrjzGlk99aNxAGt5mszA67hAVMG2LNbzWswy2E+pW5OKl3kD6tex6gLi+PPoQ5JpPwrlKNCDGlJEUkdaGososvMKElkRiRsM2I09QacarWPRqEzLgyRnMjjVF+QU5UHLT1rpNW3shqw9YmE7uwNI3BScmWrDwkO5xWxpyFAmuE2MWRyK7PbUsP4y+QGKx5kRaSjGWXm5rbbqRbgPfnAhPcPRl12nOZqkdmgvaoDXftlj6RXcAUcXvi3MuixRfaFVkba2OmnJh62AInrYRazUmtL2NSfo7HQJgixkGc65PZuotgOVcKcrgednoq+KySz05JRbwtWDYG+CVG5+uOVmHK7wPZmJiUXMW+wKgI8fFGiSyhDWRepE5bD33kCvrdXbQ9tPTEh0lUlmq3VU2RzmnJLSurrpc4PVIumdPWdBl0i4hTmyxrSJ/VFNRCRU5qEjbCn6UwHqvJZe36Qy8opva3dCpEQQ4LGBXyJjt+ha0rScGpD4sWu7Sy6OtqlpRJ7cOlcK7IyJzamXUIYNKO12qcTePVm5z1i00mj3Aa8NdibQo4vWrjS7v3eeUJORqgEJ05aJWpccxW8O9wWHzRW+mzjV6o1jwwCG+glBXnuaWuXcbjQvzs6H2rgCL0VrrV/tcrrP2W2VJedd7P4Lcl2hnIjdkJTNxxYsU7IOkBl0ebecw/SCc17p96oMinzBuDWfuNlHXgFN/UerNZ/TE1m8zLwVd7DadDz6HdQ88rR9mXVqidromyKlq0tWDlbs9BG14t55dOvlKjLf2X4TSf1aWs/mpZPhXUrJTmvNIvUmrHDvQ5Wy+alxK1dA6wy9sdon573ysFOPPnnVm+ldsPXLDNqaimPj1hzRHqkXLqlwvqrdenkdD/VV6Z/N7unHui3WzglDvUbnVBPReS8VpTcquEAmiiIX2Oov6ldNL89YBYyzVjAjwglyrmU7SlC/oS/LO3tJd96pZ6jc38+fUqWM/nR1bn0su4LiFBfUZ4pFwSYwoN06zKr2brBEru+bnql0AHnbEe6W57wQpwlGq4+ompyw1RryYsf5/djsx5v3wePPX0tnyLzz6HE115d8boR6byRk53CZTRC4daeyWVK5lWD0a8z/U+Xh86kXTLg91YpESDW68dOcndXi0HlB3zzfnnTq9WWsD50eiHSU3nt01gKvAbw2kHpiRXiyg4l52XS4HMbSda4BS/0m8xfT2cLfOXUuu/1MhrdiWnVJplDegEpUrjVzuHn92Z/iCa83mzY+aR6sd6+Mcl7wbwR79C0Xnc6dP4yl9AOXU+u6+0osDaqgjfc2GUzupym7UgVOBpTWt8/xAOOQF5yKxFRfRhTDKI36ogI96sp3it/DU6zo1oZAnjdcYDKu+Tdt5dx5r6HeJdWHiHPRd/uFQq7rC/iQHpmvz8xe6LRtiqE3ilaNXtySjwsg/QEwAYt4ROpi0NopP1czhUTknX5CojnFWSb9mO85b3cFKUxNYjjvAFW39UQlG33QlZa9aaIJ5GCJJwwkwnjHBLnhBNpgJE2IwGK1B6FuJOS0VT9vNVIY0lzucYQR1uQRlmU2O6czujg6c74ZPO0KW9uVAJVqYREK83VcljulQtbSy9X40lmEpJQNziip4ou2E6PLylEkcpaslqk5Dw6rdgV70zxGiHcOeJb0NaYw3Z69RxUPV15S8hgZJNyiRcer0K1XTCkK9o4Yz+nKJnZGyHxbzAPcnd2kEsm0wjUmXxvD2SHucoTFJV7otApcnyXPWRWvj1MJI8wXj1inVOaa3pzYvxJrlTHFWuOsTew5hocNeFyWYdMc9pkrPptcXdSUfIV8SNk7nEXGKgGx6bkyNC1IECc9SUBEUVoveg7Lzezl4CHTSttw4lEpd41ozezezQ4p3Vuid/j66HtTGnJJM3rYd5vWy9aFgACDrazY0xeSAwQxNLe/LYoEYthzeazBB3mZsO8wObw1KYIsOB3rYDBEaOK3hjk9hLAY2JZEKMk7zes3ghFb0YWLM1sO81m9lnl4AIcDmhrkhGwGGur8iKwoDK+OiVhCLWtYLAjBvWYMItCzA6DgzzCSggLzQdDeEyAZR57oaWqIb0ChaYhK1mC0HeAzN6zBhFgtCDrBBNHhKbAYHNbmLc2aJ2e7acAsSYt6AkKFsO97DsIQGb1maAZgg70Ab+QwuyZMRsOa3h//8QAHAEAAgIDAQEAAAAAAAAAAAAAAAECBgMFBwQI/9oACgICEAMQAAAA0m1lljBjakKKiGSM4OEhuCXr8eRNMiARgTRKDTi8uMmMBgDhjbyEoMchxjjmGQEICQsMsowAWOM1KIASRAxZHKE8eSMwcSHu8rgJoIAmk5AJKbzvzr0RBtSCEW5SiEJqYlGeNNjIjCR58owiA8WWOIyAGSDYKOPPCcZDiKU8WbGANCRKMsMPSIlEclhivRjmeX1wnF+fLiJThkaItzbwPJFwJqUZrJjyYoyfkz4hxF7pRS8fq5D0PR++C6jS5rkF7x5AvFer2z2mv1fui63uiWz8PTqT4PXx+9s22H6G5HuNcxnq1hPGeP3/ADj2Wv7OJCIJs9eK/VeOTd67Xe7b6rjPQmJpxXmUDf4fpviW+0k8WaGr92TDNeX1/NnavF6A13ovlbhOkWC8V7caypbyvbWz6qy6bmFz9MOh1Kp72tbvolS9XmpNr+iuJWPTAT1W0BHmy8C6vcdKsFCtfU6PU97ZNTufBzC49MpnFekdeoFNsFl1Htjz6zXWtaXcejF6/L48XRqTbtG4zhrPW8eaHj9fz/2boNZ9fj4p0XoVS5Ffe9c1guJdH7Pz/nFqvFb5ndOyc93mv0Xvqe73Hl5fuNr5ug6TpNDs2nHNYfM/SOE/m/uV6rGt9fN7Tf6xxnoHeeaD4R0nt/PuMXzrVF3+s8uT3x4P07tvNPBPjlisWO9abqVBsmnc54vEOY1k4N2HpVM8fo5rcLlX+VXXptQz4+WXXq1K4X0Xr1ArFh3+r3Orou3vWgrW5x6/3Q1247hyay6dzlgqNvhJSjPlN/qG5rG5t+h3+rHQLPa9JsvHUd9rfdt/DvdZz+w7fxXfSUDYYMnQfBpXrMn0rxvf6kjB6ayxnB483Kb3yC8Qlnw2HX6L2+b0poyx6xTeR3SPnzeHD6934YS1GTxexSvWl77yjd6gaUvaQkSx0O18evmbBb9TfavzK5aHaNTWTDvNRpfU5uRC/aD2+Ktbek7xysXm7TzH3eTFkJefYjFCcX555IAxkSUVjhOeGRKMPTIcSbUJxlKGSIhjacQgxiYmIYxIlEmkAwAAAAEICQNEWDItppJjABEgEAxADQ0yIyMnGQOEgCJIERYxDESAiMZEYpJSTIjI5Y//xAA1EAABBAECBAYBAgYDAQADAAABAAIDBAUGERITFSEQFBYiMUEyIyQgMDM0NVElQEJEJlBT/9oACAEBAAEIAsfdOT01K45lvNrVLA/l91soLLZ9MUWN1ZIybyJBaCuFbBbLZbLhK4VsP4NlF2lYVlMxHPJ5hawsttSU3o9+62XCuErgK5blyXrkSry8q8vMvKzryc6GPsFdPsqtGYCXKenYlk4m9OsrplhdLtFDDXj8dDyK6LdQwWQK9P5BDTmQ2VWTJ0hI2HhfLDwP8lP9eRsLyMy8jJ9+RevIOXkHLpz105y6cV04rpxQxrlDVLA1r5ascsXLaMRMV0WVDCPQwErl6clXpuRu2/paX79Kn79MRhem4l6bhQ0wxel4dk3SzXfj6YZs3jkwWNl908emsJ22bp7DgoYnEtfsunYgLyWGC5WFauPBsXmMGF5vD/XmsSvNYcrm4IrmYBC5gx2b5rBFu66np1qOcwLV6jwgUmqcWPxdq7Hj8TrCuPg6xb9O1e8/B1dY+vVdpVp9KW7EcEPkcMzu7qmkF1jSa65pULr2mENR6aC9S6dXqbTwHb1Tgl6sw23YatxH0dW4tpXrDHL1fR+qWabbx8txljUPIrCcHWkv16yn33B1ne37esMijq3JuR1NkSnaiuv4eI6gurrt1ddvLreQXWb66tfWLtWLuUqQTyxUOeFqIQV7UXlfNWAvN2F5uwvMzrnzLnzLmyrmyLjctz4/SxuwnLk13lNPBHufHf8AjhlME8Uo5UT2Nc3JV/KXpov5Rk4gN90HLTTxJhsvEnt50Fto8NlstlstlstlstlstlgXCPM0nF7hxgu1CT5itvstlstlstlstlstlsPHHmJnM48rlMc/ETwwkbeHZdvHZbeOxVTUmSr1YYxkhYtP8wuW9cqVciVeXmXl5l5edeXnXlp15adeWsLy1heWsLGSXKbpuAmeSF0QNWyvK2F5adcmRcmRcmVciVeXlXl5l5SyvJWV5OyvJ2lWq2I7Mbn8dwzwvGZoZW/ba9o09mSm6ZzJQ0pl0NJZVDSGTQ0dkPv0ZdXoy0houwhoywpNIvhG7jgazflmDpOPaLEOpneKTH2bO4lbgYim6ciQ04E3S7Nt16aYF6fg+xg6GyOHxzUcdSae3lawTtPtBHFHhYu69PkoYScLob3fPQP9+nwvTwXp0L06F6eG69PBenmL08xdBd9dCduujliNaNvyG1QvMUGLz+Pb8nLUW/j12t2C9RMXqRO1Fv8ALtQAL1FEvUcC9TsHxDnnXJSyI6hkDSGHUmRoP5Ug1pKF61kKOtbG/b1tOjra0jrW6nawyJ+PV2TXqvIL1TZ+xqudvcetsmPx9bZhYPL5PLW+W/UWayOKsiOu7VeccvUua+jn8uUczlCjlMgV525tsjbtFeYsLmyrjf4aTsGHLtjWfj87irMRXf8Al6Sk5WoKiy0XLyj2qVo5kv8AK2K2K2Wnzw35CuLYLPf5SX+dpHy9VlqWXVUnNya2Wy2Wy2Wy7eGy28Klh1S3DO2TVlGcGMXYxBcnYP5HZdluFj7XlbteYZHINt3n2GSh0Dy2Ti3XA93wK1h3wMbkHfDcNl3fHRMt99Kvj56fbXT7S6dcXTri8laCgZZhl4hBHP5hhju1MjZtSSPGJvlDA5Mr07lV6byy9NZhem8uvTeVCOn8kug3vvoNxdDt77I4C4CQeg2txu3GxRRcKfhZLEriwaYm+/S703S+6GlAvSbENJw/KfpmrF+XRMcui41DF4vZenLK9N2/roFpqOFtPb7/AE85enJUNOzr09cXp6+hgMiuiZMLo+UXScqF0rKLpeVXTcsEGZdnwZckD3feyDB3OZmA7nN/7OarffWKG66vjl1qiF12kjn6yOfYuvL1A4Ktmb1ps3Jbn8nuAJtVZmjO+CUa3vffre4vW1tetrC9bWV62tr1tdXrS6vWlwoauJPvGq6B/qeotPfY1Fgn/jZrRV65nd6ux7Pw9Zx/XrWX6drSy5esrqOsMivVmUQ1Rlh8HU2XKOoMoUczkStyt3LSGRq12zRW9Wy1LIqz1+ZIubKubIuZKuZIuZIuZIuY9cb1xOXG5BztwtWxxyUK0jbDA3k/zcL/AE8ooz+oxZc75Gz/ADcPCZrUEY1ZZMVPh/mHRVlejLahwjcZUEt+DNY17p2XPTNvg3DtOThHDSALpTyV0e2fx6NkT8HB5hOxOVZ8uqW2fkRw/PE1Uoo7duGA5qfKR0YYJrD2yRxrZbeG38nD/wBPJpnaRiyX99Of5fZN2LgBpmvbN4SwanN2zFzJPLTn4FC6V0rJIYjIlDB5JybpvJuQ0pkUNKWvv0jJ9nSbG/n6cojsfNShR3rkbQnXef8A1a2Mw1w/qRW8fXYyGE5GHYbNvt4iDxRuG5v5jAU38uR+c0y9HKaUK6ppkfj1fCj8etY4fDsxRchmKDZonnJ5CDKv3lkt4meoyKZ/p1wC5WntjvyMGuRg1ycIuVhAuDCrbCL/AIRb4Vb4bYrjxChuYyuJOAXcQxwIlt4qVxeefil5nFrzeLXncavO45dRo/XU6i6nUXU6q6rCPgZjb465Ko9S5KFpbEdUZgt4V6jy69R5klQ5+WOX9avkJrLQa/MynbZ0uSDOJPEn25ntLlyG/wDqwypG0leYhXG9c2Rc+VC1MELky8/Mhk5FBkZnRTvNLHPvEyvGn6G66BQXp/HbIYDGL09jSjhMI07O6PgU3A4h/wCB01RA4kMBi10TEro+L+hicSukYldKxSdjcYB2bQxe6OPx4QoY/wCU2nS+xWprylVhHGKtQDs2CM7kcuJcqHdcuPfcOZ8eG6ms163DzDl6bNwGYq1Kxr10a2FZo2qzONwEhHbkv33PLJRjC4dlerRyQlj8LfkpNsPEurbbvxfqG85Py1hyN6Qo2CVznrnSLZbIbeGy2Wyg/sbKxffHweADt3b7eDt9jtLTutleHCtbXlrybWyZ7NgbM2KEPKa0F3fhCAU07Y2OIifk8s9/Jx1+z5o4zJZGexDkqhZlS4VptsPLJJh/fRqT3nPVK7bxVuKnZf7WOUd58eaEwf8APh8j+DK0JrRY+GOjmYiCwz6sd8vrail7vpYq+2wJLIWy22CfsmniV52wCq/21w+G38XInXJmXLkXBIuF64StlAP2txYY746NDxC7LgXBsFwbrbx/1sgsg39vJtp1rTUfuOHdpWb7XqiyXeCZYL3YgqhcnrSTRxQvffysQktS8uqXO4JiwzKCbzFeKUDv/DsF2K4UeLbsCh4vGyA7rI9gVV/srqEMi8tKvKyLycq8lKvIvXkSn4ao3sPT8R+Bpxx+DpuX6OmrKdpm4jpa6VlcHYx2OnlfgtzSCDVw9lsuFFvwgEfE7fXiArEXNHLWKstpCxWmqZeexkY4I89Xk4IrbLuVrPge5mFjfFim8WKswV32WvklfeylZsOel4Kr0BkTRLRgJebQ4UN/H48HgObsduEADxH0t/B632csqfa5afqG7z4k3TQ+/TkI7kafp/ZwGOQwmK3XSMQw9xj8Pso8zU5pkkiz2H390Wcwu27W5bCcXEoMhipuzSKRYUyOD61PD/wVrbTjv2rwgPBzgCmv3dwoeBOwRkCModsW8aDkD4GVoT5mEbK3BRv7GzVho02Ftfdp4tm4XENeHrYHZPwuJe5zlXqVKjSK9mKnO3gn5bQGiOJlWu48gIojfuiQFzQuCfbcB3dfXg4rj4RuY3Pl7MkF1ibbD9wva7ussfZItMNazmyyG1j9+78hh90c1hPhOzeFHZddwu/b1PjR8erYPoWnptrsnTVy1odG3GP/ACkqYgbljqmJ+UYcc34lrRNhmLNNHeKcIJx2CvZW1FbkZHg8hLPcMMsZ4mjwzVyzU4HRdZyGyOWyC6rkAquoLMPaarcrXI+dXe79JxVjKZBk0jF1XILqmQQy2RadxT1IHENvNd7WOC3CvZOGoPda1Ddn9sUdq4524q6lvR+2zVmhtVzPXadwny8p2xt5uOBzhHPfuWDu+OzZhO7KepJ/ay7+mYmzRu3I9tidsYVrME+2s6R7zu6GzYru4oq2oHyHa93YWlZNu0UzlUb/APjUrl+og+YFc2xtsuKdEzLuVwoO2XEg9BwXN+lxoSBMdxe1aYPayPCQ7BTv5s8j1UmNa1DMm7B7tiVqL+3YV8kAN0xZc0E+mzxcKu4e5Rj5pp25qNhk8POjkhE0V/tesLGY05F79/S8Cfpdu36VqpYpTcqfT2Q5U3kpGFX7Ta8TnGaZ9iQyPx2Gs5Aca9N0tu2QxdrHEczG35sdabPGHxyASR5bIiF0bFYgMExYKmAkkaH2JdO1CP0bVaenMYpsFkTVm5D5fY0rLWuZLymxRSTPDI4sJGB+tLgYnt/bcsscWu03ZjnHT5tRsEcGwr9tMjwC2RC2QC4QuHZcCDFy0YjwrgKDdgoG/qNWmTtNYC+lfk5deV3h89ljZedRrSErUA/ZqM8MrChtxuT67XPa8Bre7HTM5cr2LEP48Rssn2yFhaZ+LYUczZHFqe0fefAkxw3ieY5Y3AO3c5ahk/Ta1V4ufYjjQAaxsbSnxMlikryH2khYeUnGM4so4uuP3wvBa4BI7ui3cK9RjvwtidFp+o3bjtu2jRPES44OBrYXTLcbqSrKWEjNcJdBKsZKYb9Z41X+BVdnFp6AJtR5C6c/5PTnkrpbihiCD3ON4fjpkiNV7G7ubXJAK8sQN0Kb3bFGo7uvLO+SKvcktgax4KwHsv2AuIFZxwZUk8dOT8UFiHwzw3ovX2E0dytt0/srw2uWFp8k4+cLMD/kZ1pn8rQUONir2Xzo/CznejKh8hDbbdajZsyFyxv9/WTSvvZTdgFJ/UesCP8AjJFk/wDITrB3a9UzCabMQNh5kcWoaZ7S1pqlzvU+Fc/pOTASsTWecbCRXqBnc7Bq1CwMnDRSFczVgNVk8K0/AZcRCF5Ad15FeSbvujUaV5Vq8uxeWYn0ed7XNomI7ONWo4bN6ZAdipKg2DR5Bw2XTz/6lxzn7rFezMTBD43WoX9omKjX83dghObpV65ikgwE/JyUYLO6zbf2EyPwonA8I8JBsFkxtkLK06f2tsLM/wB+9aZP61lBFZsfsJ19qP3NCzFQ2cdLwtc5hDhStR5OJskG0m4Cyt4V2Fi+lghvjHLKf5CfwpNtlzhXt461Ud7mPfG4OZjcm3J1yJbf9JyjGywrR0ir4FajP7pqxbWOvVydVLS42xEXjt4HwGyfA8dxw8WwUMTC5xYI2dw50LW/AY35JjPcnkueQFSbwahe1Rva+PiGcfxWwFgWt6ixyzUXMx7yhIWPDwyQS7SDM/2FhH4Kre6GE+E23CVmBtkrC09/b3As3/erTX91Mgj8LMj/AI+x4Q92tJJcxwcMxhzWJs12ucxwcw5TIkbElzju7bvssD/jZFlP8hYWLo+escJjAjYGRcczTuMzjGjhtVsLMK1+u85iuyvA4hnwFie2IqeBWoD+6CxHfJ1AtUnutN9sTXC3XGOLh8Se3hxBSP4Ni9jHybJrGMB2LQd1sNlw/C4U1oT28rVb2oOIjWQk5t2YrTkY3syqVomaWFzXMe5hwk/OxsQWWH7GdH4WPdvUrHwf8FZpp6lOtN//AFhZ8fvGLTZ/eyBBH4WY/wAfZQcRG4Cqd4o074QJjdu2xiMVaO7vTWO3TcNiIhwKQcMjmjBH/jXrJ/5Cdad22nKcU3d3ZZkOZTlaYZNiwLUB/aIfisZ/ianjn/7wLC8BydPh1QfesJ/j6PhOTH7w1243Q38N2+EFxh90ott4O5sxctxPOZt350fZGRm4QcEeAhZH2asJUntiKeeJznKjkpaPEA/UTnApznPeXHTUv6tmBZHvSmX0sUf2FVcSe/sVmJBLflK0z+VorUP91EtOf35QKJWZmDKUwUjGtdwtqDhijVywK0fNfNqODiAi443RMmi7K7O2KFzyTxElYeItxrVnYeTkpFpx/FYfAmwSl+zoKwatVcuKCKNVmGSeJizDOdCGJre3bByi5iIuBNaXnYZ8xnIuYzAR8WViK1Mf1ViTw0Km/NbtuHOa8EKvKGwBqMwXMTpey54TZH8fGvOHbvNbklsxtIyHF+fnXuIIN6TjfxHK2GsKZlJPasjLzM/FMcjJy6k58K+DyFmMPb6byivYm5j2NfNi5/LZCvIrTf0ZWeFDNQV6scMvqCkreoWOj4a3ckk4akatD36jG01dY+55GyJV6grDsPUUAVu9NdPuxNE3bQTf9olj+Nj8jj5cdZMT8flrmO3EfqNm/ELuQnvO91GnJdmDGtY2OIMblKRv1RwNcWuDm0tXlsYbdsazrhn7WzbsXJ3zTaeoPlnFh+TDuSx7crT8vNzmY/J2cbPzYI9YY6QDn3tWPlieylx/K09QdBG6Z2pP6yqbNpVkHjbZAn4Q4N17VxhcZLgFuhYC54TJO7ijJ8FCZGU8alfxBcY4e107XKzllo55qsjYhStlwCEOx2XKartR1ipYhYattM51mKIudRvMJafI3iunZBRYbKzu2bQ07FUIltkb9znMbdtciSDouZIAXQ8uug5gqtpa0fdbr1oK8Qjh+ke6migsRcizY0vKTvS9OZr4UWm52n91XrxV28EbYnP+J4HwOa4W8ZSyBL1JgMqz8eiZb5dTwY4xzYIGwRholj5sZaXt5ZfDNPhRxb03UbLDs9lC5IVjMIC/ik4eDZo1B3mQid5SFyjm3K8wNkJ9ynThc9GdpXmWrvtu0SFCRcfZbuXH3Ujuy4t1kf8A53KM/wDtcydNIcPESTL8/neQr3hbyrZ5+Q3ZFe4fGz1tIiHJo3R9oJVnL04PbJTtwXY3SQHZOZuuBBn+m1nnYpkYapY2yt4TPTlj+OE7qOpPKoK8cA7eFirHZHeWhM1CCwfiHHcR3lYxrG7NKz3e01NzGOqRR1Z3WRx+wzSH8m2zw7KZ26bYLgCJJ+IdudKtzsmfiQd033J7nNkRKJ3W6ut46jCqmxhYV9FMO6CC28dlt4Fdt0d/pdltutl7f/VmnjKZfLHSla/KmWJo7LYoROcoK7WhABqLkXoyDdc5i5zO6EzEJ2rntXPajIi/uuMrmOTpXtG5yx4rECznEcq/gYzgaNuXu73csb7tcAU3ZhcnR8XxyHI6S/07Slg9w7S90fB05kmuRw95v59NttCfUkb88vYd+WHUJ1iP1asW/LG/cQviOxAQCDSpbtaPdPylp7zy6uY//rFdrT7hhPfw+fHi8ArFeZ8oINiGWGSFzGwwZaJteL2s2PyV+IW6c9FxXM2T5H/UzRHC6WSljGzV2ym+1lGThfFYhTZ66aQQi4Ikbrj7rmKZ/wCmVe92QgacrPK7LzsZ01vANzVAXkHlT4x4iPD0+WRvfpMi6NImalxDyus4iVzXtOTqnuyrfr2oWPXtcmN9vbh/2YmHss/Ta7Fz8GGsBlaNOsMa4Li7tIJYBuuJv1ajkmpywskx0kZHFyuWeFXa8kjw1tChdjuxPXF2RIXH9IFcSBC42j55saEkavYnH3JucqeKpUX8cbWOd3LYpA4lEuDvcfhPZCAUTEwBfqyHtFHLsshK+It5klyzzDMs1cflooGR9PvoUsk34xTrFSq4WOa1yLtlzmFB7SppWj44PM5uENa5kuf5idfqg7LqlUDs/MQgLrH+nZtwUmekC9RPXE5CV4QtThdRtIZW0E3N3Wpupcg1RasyaGr7vCWvrcqaR0tMmyzlufNkCA0QdRuoZDI/XUMqpruUkbsW3MzCwsZDfyMS6tkkcneJ3TsxeC6vfTcllH/iLOdPwJtQ/XFqMoDUyaNSlN9QBMs6ijGy6lqJvycvmGjvLn7zPyu5aSwRxDLYw9zBqBjNkNQW9vaMxl3j2ZA5/KMYxDGalA2bHkNS142MPVM7/wCuq5QfMGYkHFzX5u9v+n1rK/COVzI+G5vNfCsz5GyHECerQ3CiyNaGRr4zn7W3Y5vJO+HZHIPJKddvuT7Fonu6R5+d/wCPZQn5W/dAe5R5LJVztHFqTICUmf1EV6icjqF26OpbY/D1NmPr1DnENR5pDU2YCGqsrsjqnIlepLTt+Jl+7dO0bKt6T5OOsju5za0ewdymDuq8cO+7pa8QcSXcATWxO2JuCNobwFznkAO4GNJc8v4d1Dy3te54vQxdmz3KkgHAMm8M4WHITFOtyk7o2pVznrmOQnmC81ZXmJ15icrjeuJ5+dz/AC2jxB2K33TT3RXytkGjwPYpg3/ja5zHBzY83YDPfLkbUz93jIWmtDQMrZ22LMn9SMyMPDs/qUbXFdUr7btfkYpSC52Xbtsx2QeV52wD7XyySfknf9ndb+G6YO2/gAtx4bI9ymjbwPz/ANs/9Df+DZAIBfCK7eBKYNz4u7n/APUn+HZAE9hwcC3W63RW6KhC3RP/AHQB/NLfDb+CM/a4l8lbbfPZOct01u6b2RK3/wC3sfAELdb/AMp35u8D8/ws/E+EX0n/AJlP8WfH/ed+DVL/AOfCP5TvyP8AK//EAEwQAAEDAQIICQkFBgYABwAAAAEAAgMRBCEFEBIxQVFxkRMiMlJhgZKhsSAwQlNigpPB0SMzcqLhFGODlKPwQENUc4SyUGBkcMLi8f/aAAgBAQAJPwLlxlwcNjqr0QYXbW3jzxGXHVhbpuRzRkHbVFHyz5Oh4O5VbwlOIWmoybkHA8EQQRk+OMFAoFNKYUxMTO9M71H3piany19mP6oON3pC/uQxNO5RPPUoJNyjKZ3po7Sb3p0kYkHHppTn1rdqr0oVTcRCITwnhP7k/uT/AMqf3J/cnppkaDmrRWYsIdUOD/qq7wqdoJzO2nxdtSRbyp4eMckcrOVPEO0rTF2XK0g7I3KWQ7ISjafgIWv4I+qFsr/shQWvryWqWS6/IL8oLLcRo4fwqot8ihze2rNHSnK4T9VDZu0mWQdYX7H3I2Xs/ojZ+x+i4E7Ik1vw0G9mi4NGJPh3BBp2Rp0O4Ixdy4NNjJ6UxnemM3FNZ2F/1RO5SSKwWgySGjRl0WCpsxP3ywfPvWD5t6wZJvWC371gx/csFu7lgs9ywUe5YL8FgvvCwV4LBneFgsbwrFE1sMoYWHOrJGQ4OcQDeKGisjR1qysza1EwIBeKPevRdXOsnvWQi0KRSu3lTO3qR7o3yUeMo3hMdThDxS4m5R8C1zSaDapHJ5UhUhUjlI/enu3p7t6c7eifIFeIRvQAcYDTr83/AJb2u3FXtcKt1DStDrvO+iYpF6MDnbvPes+S5yFPsAd588/IyskA9amFRE3r82E2N/BDJBcL6Kj7qGhqU0pjtyY7co3blG7co37lE/con7lE7con7lE/con7kHM4WPJJNwU1lj4SItJ4NzTsO1RPu9lRO3JhQQQQQTVG7cVE/cVG/cVG7coZ8kG8sbxupcM1we0X2eis1qkAiY3KfHk5tiscu5WcjrUQ7QQb2gsjens3qWLepo96kZvVO0muOy9MtHYKZaOyVDM2nsV8V+0PGoqyu71Z+5WY7kAPcWRuP1TWf31rI3hOjHYU0O5itcHYCwnYyNqtsG2tVb7KKrCVj7lhGzLCFm3q32ftLCFn7SwhZ+0sIWftK32ftLCFm3rCNm3rCFn3q3WftK2RV6L1hFg6/wBVhCP++tW2LcPqrTH8Jn1UoPuRJzf6aaw015K4H8v0Rg7lLF1GimcdkqfafjJ1r+OjaeuUJlqkfkOfTh8m5udWSL8UjjIe9BtaA0vzHMoojvUMHemQj3So49xUcfZQZ2E+mxoUsncpJu2myO2zOUA65XlRxDehDuUuTGIsp2QKXq0vNeferT+VWojYArW9Wp6tMinfvU8m9Sv7SkdvTnb8VKTsLL96jAfA5rh1f/vnfSym7whmtPzQ9N3ih5oYhWlktFb6ehi5kf8A189NGypaL3UuCc13Frd7XkHzGeN4coZTwjaEXZKBAyzkg3GnnKVjkBUJLia5sxQLTqNyvTHHqUMp9wqyWg/w3KwWn4ZVimHUoHDco+9RqMqFyhk3Jjm6L2EihXFFc5hLhuomSylzr5ODcMrerNIrJJuVmcrM5WV25WZ25Wc7iou5ABFqfGnxXdKfHTapJ8r8bGjwUt1bq8Y9ykd8NykkOyIqWT4alf2R9VLJub9VJMdmR9ULYfwtafBMwifcCs2Eu4fJWO3Ha4fRWKy/zIWD7N/MBWGEU1WkKxB4H/qWmiwY3+ZasGtH/IasHRfHCsFm+KFY7L2wrHY97VYMHnaWqwYO7lYsGflVjwV+VWLBW5iwfg3cxWTBrex9U2wM2CJWuFo9ngh4K3y+7I0K12k/8mnyT7Q7/luUJ960SFWSz9ZkKsdj7D/qrJY/gn6qyWT4H6qxWP4X6qx2P4Ss1l+Go7KzgIjI7iUuGpOaL9SdG50ZoeLVRwH3SoYdxUcXZKii3FRx7imR9lZA9xOHwwn/ANILugYhOdkcQWD5nazVYMlNBz1g+y5LRWnCGpqsGNHvLB7O0rJGOtWaJQxbkyLcsgdSkUymKmKJRO9SRsrex0mlSxZeQ5rxG7m7Nqe7env7Se7enu3p7t6e7enu3px3oneid6cd6JzhRtqQKmmvMhniHnf9A/8A7Bc8eK9c7zv+bOwdQ4y1ecZJ8RpTJt7FVogqARQ5Teka1Y2thkFGuaK5PSQmzu41xbHUFuhwvUkg/HZ3jwqrTD1h4+StNk65CPkn2V+y0M+aiadkrPqrFKdlD4KwWr4TlZpxtjcgRtFEQpAwSPAytS4AtbQgiMh12u+iF7Kg9NTXzv8AoX9xC5wXrD5so51EyX9nyicolov6VEGhrqUYS8KGU+6VZpuwVZJuzRQU2uaPmmM7YQiHv/onxfmPyU26FxVof/Ln6q0Wjqs//wBlNaz/AA2j5px6irQ/qcVxztVpks45hvG9TR5LW8XjaApGH3gsgAGmeqY3cFHHI/SGxi5YPZ2GLB7eqgVnlZ+GYj5qW2t/5blbbf8AHDvEK1SH8TIj/wDBSRuaw1LOCY2vZarfkNHJYyLMpOEkYbpuCoS3U4aVGW/hy/mU+09FFPauwFNa+wE+2bmp1s/Kv2z8qba+01RWr4gUFp+IPorPaOj7VWWb436KyS/aNyXfbm8LB7qg1H2xVgNSb/tirB/VKwcz4rlg2L4jlg2HtuWDLPvcsGWTcVguw9g/VYLsPYP1WDLD2D9Vg2wfCP1WD8H/AAFYbD/LBRWeNpzhsAAQhpq4AJkP8u36IR/ACs8ddJaMk7sxUNndUZw1CFlfYUzia8kMDVapu0rTKfeVpkzaXKcOP+4nN3opycjiogszWgU1lydRmVytJUsu4KSfcFJP3J8/cnT9yneDqywp3fECL3fxQopgP9xRv+IoX/EKgdd7ZVl/qFWQdsqxs7TlZIu8qwxA6uMrDDuJVis+5WGAab2qwwdlWGBtc32as1n7CskBp+7FwVns/wAMKGH4YUcNNXBhMiH8MXpkfYCazsBZAys3ECjLr8+SL0Ym1FaFuZPiv6Ciwt000I0CeU8p7k529X3cV2kFUOQzKyTmWQ3Y1Tu6gpZT7yLu0h5r1kR8V7Xjipnux6lFITW80qoZeyoJeyoZr+iidxmsGX0+Scyk4NgPOyQjxwPspDnB26QVI5vGGY9Ku4rk8mkrqVvU5Y1ucmpUvD2WXNfmrpH0xPIHC5OfRm8stymilHLgW0VtG9WwH3yp8sNzCpPkhaivUeJ8wwphTCmlNKaVVaoj+ZaHP8+PRcvW/JBjiBRriASNi53zXNcvXFQcMJDyaGt2m5MySDdHmzX0vVxoSU05OVytFV6TB/gOaV6tnimlMKagqIhOG5WvPoqrUcytIKtLT1KZm5SR7kYlkZJyRdtWiV3knzRpl3J/AyNkrfmNLimMkjvy7tGtCoilIf0alM1wcLmekKoct5cNikETy7iuOa7OE/hHMIq8bar0rt6ik/ZsrKrk3b1njcR5WlUu8zzCntbVrb3ZrlaI+yrZuarRJ3BSzb0Xn3kw9ZKjCER1jJcPBMjHTlvCdE3+N9UR1Sgp9+rLUxaCPWa1N+dSk0yTStV675Yys/k9flw5b83CNOS7rUPBg5zncVkuDhRwN4IVj01plktQF2YKympNaCQqBsVc5zu3lRNlbWuo9yY5obmaM12tWdkRdyqE/PFu8iJ9Niz+S3K7lZpKdHG8EM2LmFSxxNFBlSGgqsI2Ue8sJx9QJVve7ZEVJa3bI1DbHdQCsVoO0hYPf2gnMXBblHCb84ATYBtYE6DqCDabSozXokcFl04N12XlaF6xvhjIo27Mr+EaS12pwxupVxGaqkHZCm7lMUyOdnSKHqITiWjlxu5cf1C6lO4BryKK0PVpkVpeogf3rOK4bU4PY8cR4zHGa6mjSsmBnsZ+sq0S1/EUG2qPU8cbqKflMrxmnlM24tPJTBK/WeSFKdguClkYehxQ4dnP9MdelPy4n8l4/vOirtZQp+8Oc7E4k9JUskZ1tdRDL/fNFHt260QQRVpGZwVbwc6aCTam3FQRjqTYk5g2BSKRyJRd5jmOHcvYx6XFeg8FZq1Gw4vW/JZyaK0wNJ9E1uVvs9djlkyRH/MYajrR4ze8al93M3LaNWsL1hUoiYzO6lVhD+krewu1OYWpuQf7zI/ZTcnofiOYI3lOEUXPd8lb35Wsx3KjmO5MjeSVsc3nDUuQ4ZTetXhx41OaqkG9h1g5lJwQ5oFXK1vDtUjbt4TclwR+xnuI1HQUEbhyukoVcU95OpinOVoZIM+woUc03g6ELuVCdR1LmlabXjr5AxhBUqji1rmDxxZ2tOPPweQdrMXrWLnt8cVWuad6HEkGS9vQV6LiNyrxJnDeuevYVzhoxcqGWjT7LtCzh4OLS/wXpvAVzWXNGLkStPUdBWhejlBq9GgQynWWuT+E6N6uxP4NzD9m8it3NUr37LloWcklcomg2YguWQWv6aaVn4Vveub81/qSh5LT1qu5ZkELkLlQItrsTgqZ1zHdxxZ30GP0HCQddxxc5i1hahj9a7xWiX5LWPBc1vinFzn5ujFzmLWuhaXuXrBj1rnFesPgucnZGU0ZJ2KOSVgdkl1aX7FZpANbXqfLOmN1z/1xc04vSLkAduLnnwQk4UztqajJpsWoeK57ih5ZpRCXIAupRcc0zVu60KnoTAqIDOdCFL1+8xayVme8A7FHkNcXNLelubuXJlrGevF7Pji5jT3Y/WFc8eC5rPBerHjj9nxxah4IVfC7hBs0rODVH7an2sXTrCa6uqi+8pc364iRSUnu0rnYonyBwyXtArUKCVrNBc2iNCMxCutMQvPPC5jlqWrHrPgn3iVtG0z9a9nxXT5ggjUUMgaTWtVRzUAhizJ2lc+QYtDPFegxzihyC1/yWcOqOpZpGB461zMXqmY+ctbFpjZ4L1Xzx6m+K0Lmt8Fo0a0C6zO/pnUUS0jSFapd6N50lFetK5y5Db3IcGwaAnk9DrwmUaTSRg9A/RZsvJdsctTvDFzMety0SrW1asWfygm0b4oLSPJ9e7vxa6blqDN6zOBaetZwSCs8TjGdmcL1Zxepbj6D3LUxepavUnHzR4p1MrOF6tvhidSufUdqhfA7XFm3FW6an+2opH5Xpudm3LQaL1pXPXso4ucwhDNI0rmO8FqXq8ftoEHKOVfWq5zUfRJpXEK0z7PJKfwkmulNyu1ogUCz0R0o9OP14Wiq0kprXNcalpVljHTUo3k1K9OPKG1q9W7wxeqx9A7lmyWr1IXqnY/SFO9PDxrCz8G3wQcY28rJVkq3TluvV8Mg4p+RxZmhaSvScXLM8NcOtZ5G8XaE0tOmqC5chzeyEM7wvSa8Dcs4zhcqHiuGM14O5x9peiCSucPBerx6LvJpcgvu28ZwGlVGwp+Y3VRpxQE4Gvdi9J0ZWo4hGAec+hXA/ECa3JcaZTXZQqs2XQ7HXLU4Yo3/AGdRVulMn7lE5p0uejnQo+Y5XVoXqfmmZQoQR0FQS9pWeQ+8rmjM0L7tl7zivicMiQLNnY7nDWqOjOeN17VYwOjLuXFboYMyzekdQQ4oFAvvoK0HOZ+iqHDSrNw1PTFx61Y+Nrebk7Le7OUOK3k7VnY+q+6mvadR0hOpzhoO1WR4f7BqFAYbvvDeVeTrQ4z82xc/5L1QxVxaMWbyM5xFac+Ir2fFML79CglvPNK0XbsQJLm5TR0tVnm7BQyHSRiuVdxsys0wI9gqzTdgqyT9gqySbSKJwlkGaJuYbcUTpQGkHJ0XqxS3dCsUu5WORSMgbqrV5Tclg3nbjZwkejW38JU8cw5ruK5WR28KRrBzWnKcmhre87cVRzTqR/ZpzndSrHbRoULZW86N4crK5g1uoE7hDzRmVFpUeWx3LYdPSOlS8I3Pwb+K8delWeQe6oyPxXLjU3JvFpnVLnlNJDYW3oZkVmCN+IpwR8x0+KNOlSv3+RK/erz0p796e5Sv3pzj14yQnu3p7t6e7fjLi7QGqSuTymG5w6fJ13jELlxggVcOlZ9ePlaChljoUbsQuxaXuTnB3BNrdrCJPQECskbb0S466Kqz+TdiGP0ZHDeFpa093+CzL7J7875DlNB6FxGZJy6XA3aPLOMoo+Y037yq1ayMXfhV1w60a9GLRnVQHXjE5WgU6WpzFwR61GKbVA7aoX7kxwp0LvV+TIw77l6ody60ceZTR70Lh3pzWH2k9jj0HzL+J6TEI7QBymG8goUbJc5h0VWfzDiAEXOyr7tCcGX3HN1HUpo+2FLH2giD5Xs+KNPtA0bqKpNAmOdsTCmFQlvQU1NCkeNrVbKEaL71K1wvrTP1I8GXeg+4hEb1egmNPUo2Agg3Cly9EuaVmIvKvuxvNXhQycpN2KOpOhR5Aa68+YKcFK6GQ8pzNPSpHTP1u0ILNoXF2qRm9SNr+JTs31TSdgTHblGckOBo4XGitDgHXsY2rRTUmEysPHedI0dab+YKP8wRqS64VzYinBFHqV9MivUr2G1k96cEDuxNu2oN3pzGqcdlEop5TyU5SuVofvKlqskg6wE4cb72zE37W1zjvVmeGOzlodd1Ky2p+1pCwZP+b6LBkv51guTc9YOkHuvUEzWn92TuqrAXHWWPqsGu7L1gx1dj1g4jqcsH9zlg1x91ywU7sOWCz2CsGfkKwaOz+qwdH/fWsEWc9f6rBNnHvAKwWUbZQmWFmusg+qmsQ2cZTQ0GhsedCZpyczXVv6wrcwdBs6whYjtZkq1YOPWv2Nwaa8SRqa+g0B7fBWOM0FKkD5FYPgPUsGwrB0fuU+awazJ6TesFs3FYJZT8CwU3cVgyGzudnlJRNoldyy00psKsRq03ZUhKs8O5RxjY1ZI6lJRTHepa9af5u1zNp7Snme0ilGuyKKS2/GX7T8YoWj45XCDbM4qcjrKtkitcm9Wl+9Sv7SlkHWp7R0ceitk7jqyiCrRN2ypZKZzWQp7zXNximdeUVcs21UTQRpuQ0qMFRtuVjJrm4qa2MNN9VGwjYosh2nUg1uwKV6e87Sid+OR29TSdoqV/aUjt6cU4/wCPNCNKaHv0Pr4og9CcKA1zINKZn0hF12a5MrtVQ7YmlRUTU6icT/7JZ/8AzCPN6/8Aw3V53//EACkQAAICAQMCBwEBAQEBAAAAAAABESExQVFhcYEQkaGxwdHw8eEgMED/2gAIAQEAAT8hhZgBpR9GSEnodnqJi/4ivDzEWQxNlh0HTV2rKL5vp+yBlNWRHIyG51nUJu5LVkeoa6kEckd2SXX6kkRVSnfcFl4zgQ5E7bVrG4VPY6X4C4lPKJNkZR5BX9jNTyHB8gn4TyH+lI3DiO4p3MLeEY2aKoQfqmcL8vAD0dDFlC5N8QvsjAL5SX6w2jiIPJEjXlPqNo6aVMAbPZeA3YXglf1yf6WL/MJtHnF/fGZzTzf3qbj5DIImt1kyRso8RDVDCryHyJ6lvuBl/t6GM859C10fvYxISciewTeyBbQB572zgpf2HLFNm6f6NzdCWugT+4brzcoXMTsuk8RyIq7d5R0ThcDCdjbjomhmzFz3JRyigjpAXTWq/ZqSHCeYaEungxpDnG/UHwTtX7tFpXbV/cK449V/pdjUZ/Mh8HuGK/drXnA/iISUMrf6ENQteGvoRzMLtjijHbsxISO+TqXRhZ8Dh/n6ja/oJ0dfC2+ZIrSRFaOYtpQ7dH979kf7e5oBJfW2CAiklARTRfYGhs2kyERJHq5+o4Knev0l0/icFm6CGlK5iNSquYOpq1HFUTsx5GPLp+wOS/B0HxnWPY1iBC4d44ezj3h1AzUQ2/of4P7NmhpP2c1d2Sfi9Rv+2KYvimo8YIokXoNJVbGCr0/xMhKvfw7VBvpjPnzPAE33xt+2f3g3Z8xk9RCWpCQ8ywsYSKbkDl5tC42stkLYodv+8z3qgNlmthtDy9RsHCb2PA/CCC/+FkdAWtTpIdDU1Aej9iBctOYaVqTOPBIn4kvH6/DMbSkleeWG1URLreRpDKTlVGRIl4JEvBLx0jUiB2jdXupWpji5rXZCGUaaJRl4GoyQvBLYh7MSnRmaxIvlva+a6Edm54cNb4cbMep5AnfYP6co+Wavrz+0P7g/qD+rP7E/oT+nEDO6lsWYmBclQLrWdKI3YJTW2mT9j+qO3cG//wAfbSU7DPsybHiSUS/05mmrLRPNydSARVVTsy6PpOZzC0GgnUe/hEMZSGoWGph2jWCU79fYWt5n6Nzd6+DVT/OB9Xuv2GChLSfb6RsTxur1C2VoqceSQgpqVNtUGUrudmaKuLh4GUbjNvsUbe9oRJ90q9WIOuv7SYXnGEKBpLq6mN5H1jMkWkWOuELVMqI2WXWvJiGKcamNyZfEIk/wepfH5dz9L7PyvsX53yaiP83I7/fufk/YtD8+o5rNbfsWM3Y8/Rjy0NKBbF7lGj6rNgTOdPmCejo6isXfT6DzBaU6a6Ic0pK53Dh5/wBB+Kjb+B7lP6I3fYEX0PoWStkx8E4MKNIpfHoX1QGaU+bMoZ9Auvr2Gh7x0BuSRx5g0SO/7HdL85GlvSxu/wA/wT63avgX7hdB3JsiHHm4b8I7zKTepk+FYueZQWJTNY6Bwwi2SM/6Bn/RM/5hEiQoZZneNmfNEufNn96RAtydnSythXxUVdH6B5KF8k9fMkklkv8AMknwonC/3orWUlW8yjpCgoQhCI4II4I4I8eDw09hs3TZhSsSWO4ohxpC8vjMEksfjJM+KuCZqRwtFZLVFG3lW+iO51kdyI6yO7I5ELn/AII54/zDtdyKTjtFzO7gWBjUbLlOGW9CCP8AiCidyJ3oW4ifcMreMiIu1TaIordGWm4ZXwWz6BemJ2enY34P15djK0WtT1KJLhps39iDZ2Ev+kNX3H8ceX5kXas2kFDTSFEETTMnEtEhh8R0SkijoY188C6vNHDdUyUlm9QP/YGqWSDij617+AeV1rp9ielp4tfYiobQ00+xLZcXCfZKm8+4MRqnRKONWhoX3Pg2zPULfMPeCfZry66BAoAXf5jsxKz2r8DTlgE0jkSA1ALUAKvN6F5lOfiHHLSWir1/8x2NcyYYTh7TtstNRC5m0vicyVE1rV6i9zB8mL3fuLSXX/YkfWWjDguN+j+4ocBhqFXqG6v3/uUL2jg/YJbFFdtH2DK4h/Ahsy1+CCB7evz4sZPdEWFcp/uNMzYtOzvD2q/eRYyujfYz0mXU6T6rHm+axELZi2R9o3UEX0S+T9F8n5T5H+b9z8d8j2Lu+yX/AE/JfNqw/wDY1RZf7j6mxvj4Rj1weRU35QTCYIzSJjce4oxJ7xEGBD0J1cavfhFevY24WGXSuwc1doYcVzqf3X2f6x9jOXN3P6hHjzxwCDPcxlLF+4lK7kHg6lz+sP68/tz+pP6M/oR/6ok+8f2hD9olOJ2XuJJW6lUwoIq1arLTaIWkELwv/wAWjiBVfpaJvkF4v/miWPwclMuuWXsPaTDfu8L/AMI/4mV2vhITnork+SPAGPYuMOTjXODdcoTo+mkE9ag3KuCJs6r1QJ1B2/zKhEr9Nie6j9JIT8dbZSx+/wAmYSd72R6IK+B/q89x/WMPuSywMfpTLRZBAsODZDgbyTIZIiSGQ/8AqbUtZ+7GofljzmT4Nl+MMh+EHVorlBEkloyLei21JGCdkX+HszFwhN/suhh/18Cek4k8N/IOYk34JDyIv3pJnOoZ+zDGU9Cub/68CilMuBXQ+RlgWX7QSZg5YvYfkjl+0M6USttfDFeRO4u3mpIzjKtpJglEs0usNO7CjJvGCSarVtiXcY09ktN2zLNvVBoT1e0zC4j2cOB2v5GyD5B+6xdZvZybROlodENjc1ndkqDoiHYW9RCk+ol544ZEizluSRHnPg89x7JBrnuHsYf9GDX/AFsfj9JDq9Sb4KIavQSNYEglLrjpghOFJp9iX8zbXdnG7nbk6gvuh/O/ItLzb5IFHmX5Ej5RYpFN9lk7S7gV8JfubNewM71LddiTH9I8iLRBfX8fSTi59z3nyhfSkSFro3Q0QZymEz2MWWUq5csddvtXsiOGuHb8kNFWpYfcZRZvJ+41OPSiVrFuhJ8AUnMoSlaYR0jfHnh2IS7ZHY3wcJZwhi3XCNWR/iBuEr7qHJIZZIglT5YLUyHLgI5f1f6I9YnpBNLm7gx5D/rGv3HuQydy/mG4PVGg16mLf0Y9yJB3f9kmZSkvoSWmqDGGCTKErglmVOA0VS5TkU+Q40FigEIw58hDgl05cdtgSW30X8FnH7eg2WVg01q6wNJMonlin12uSvRZFPaXk59KiFdtJquXDO3EhDZ2lyKW9exd7nJRCFWjbt3R2N6os7bR4EcQvzkY2voIr31jETLY3Y0r5jZsci8vEptkPb/gYCyvZSP4ZmJbsqGGjsLgJNPgyWHJT1JmZwNLuW488LS82NUobVdJJ2SDVKDgrEJYOSCZVlgiZS2tCLpNmBOL3NXP4kuGE8J6gtt7jJdtIo0MMezNkmsWQ+yw1Z2KiQhbSUtpoMo7nYV6mGCniI/NZLgmBrcdwQmNE2wHxNcDK3WTzHmK4X8vwPQvlfFMx8yJRYdQSxIzUPO5Elhex/xUQQMgjjxgIvoFoeUNduLofxRrt5BHS9o+T8A2iMiiHx4MhtkuSTqShbKLnzO8UaDXJChMiMiOExcaFOLeBzJiASVjZZrczBfsSi3g8hFwAl/S2rEbUmaN+PX6glkSolC0gat1SOSyTGW+upBIEoHQkLA0Jt1HoKIabSLsPYgioZFoUQaiGYuMVZ25/oJMabcSjkt/WJ4puv0NGPmWY9f0bqOLF/tjCt4MjEvU5QT8klsQ+lbhwsiZFl9BrSt8GaKeublW/hRZKxMjxTmydXt6EWNbjg7rJdJYcQJqV1JL8GWNFHYXnEkbxLUWIbJEVYEE77bk3T2bFo/YkgWLnD8wz8Klp2lrgVzV7ZSTiYTpSdiwQ2NyoaWplxyQidK9w+0sLmCrSfbjs3FI8DcRQoEtPgYlSkhoTQlh2KsyTcbIfBCRCZavUce9SB+3tj1cvS6hx3sIFBToiWd0QJtOTmP0M2d2E1bMmnzlkKoZFjDkMbNEXR0WFNZCEireINDyqJ9xTpxLAMQmOEkq4ENyZ5K4M7gFNwP2N3DaEsCbmgq5iCzqL2NMlFlWTsk1HghU3BO3mtCvBUGHR5WJTZu31rErgYXDMURJVjyAajZSohKNIGpxgCnjgiQ+Jm4KCQg20PqJTTVqWxNRcsXeI4DpmbjKzuEQ2EZhCa6l7wiSVQmVL2E0cw0avyE909BtQnuNScIjKQRTTdV7ha26mYfIWYToyWoLUv4RPZS5AyxIhJJqkzI+U1gRNyYwSdeKLTOM1JJlnuFy4vIXYRHA+cvRT/wb6GhXNDGHnQNHoYv2JkFslSxeZGS+hBy6Umdb5HAgMCUkWBxWlcD5k+tSErsyUChD1dLJSkTqNsIgb1eRC+pobLUhfFpkRXr1h8hWNUpdRFkBJFQxt+4/rCv3NpoXUsR9g1Qu+kw34fAmQWT1zPlf55FdG0S/VG2BqU1oEDix0HRsfDRRdnd1FBI47N8CSh1P6sY43p3RI52woyXDNUSX+MjS3KTqOGtE2HpqejeBnlqCljpIw46p8hoPe7zGJSR1AQVldROwYEbsqoaoWubSv8ECEckTMDc7tcCSpVapMdJ3SQrT0Q7fqETJlIpzIyqEo1SHJQQl2yxROhDuET5xjzg9yJSZN2cxb1Fum26TZAP9AITici9Avqwk1CUEW7eDILaw2zgnavUtJkdRal6F/mQwgm485uGNLHF3d+0xfwclDFTZXhQha/qDfAUo7k56b3TXLVDmTX/Ga6jNdMlbhza32Xcnvv8AJbdCpXfW6BopcZPtsaaZaz3N+C1xLhNyw1Ot0LDILA8o5jkW9Bxo1xdRpFlqkc7DltNNP7A0T36a3T1Q2yYHsN/LIMBrtZ+w7GiFiJVrpCS82MzXjTLpTqN+kYpDZD4g7OdwO/6mvAaGtNTcWcLIjWbFw0Ew3Xl4ZvCnsJmseCTSLRZCJQ0bKbNiM+YM/bsCQuWUk12FhEdwd8hEgWYcWsGQ9PUTRwkz0Emo5LmgV7hWMmaRhBn3gboSibpJEIZNjn7kB5MPWYEIY/1lJjMAdVC0+jJLu58x0Z1f2n9zATqkoCwkIxAyamPJORJy5NeQipJtzlkVTWkGmCPNJpqVoy4wGaxPIWxSJUyzS/LQPWfp4SNC1pTXvQ354gaa23bIUVFso9pTyIqJSF5IkcSWcUYy61e6Ff5b6MaG8OBJjBOhIxmJhQRlNTqW8p4w++5dQE2EV4oOXKMGo3rLSWxE1J4Q05RrVaESaLYMUDVKKRgWhjcxXcFT1NrKHpqdezOBDtaXeASSPZ3qWp9PeENi1Z6CeC1YsHraIfsaQbcJQptW+aDZuuKh8aPzouNBj7ileEGyIr2EHKvZoaJv2yZtckqepI8gjKi/tJpUukFj8cEElUZtsMdao2VZKclOg8kDRN+qEaptHytApe5T1k/N2IAvmT/Sy/dGiSNQrSpvMWGcuZwspKAq86MSp1NYkvZCSbRDwC9VJRVHtCgV+p6bmohJYj0d+RIZurwn3CQbAwmixmSHq2OQeC2FHqZtm0ixG9ERWo7l8pfWROOV5nXnlBX+gBFwbE5G7hVPT7CJRPKpiHThN5Ka2wtRlmKp0EtT0I14dklm7DV/lCUDUyTu2ND5Q8hKVrLgVMCrnRYbEI+gnhGMsOHmpioFvQY9Tuy2p1FQzOo3YbNdnA/VwZKNAxth9NCTOC9lPoNAvJtQ1B/soB9UNP7KEIuQh1/uLwyWfzCRCux5eA2nALZ3YoghBgSLJlQyhYH7o6mPUbPWnsjZPQhejz6MykLDVUS0CngXTUVE7Ui8FaNRjvRryFqWIecyjT/5g5z2aOIXuUynyS3oxAcJKWkpPivtsSYPyV4aLdfyFgS1hqz8fojWgXNaoY+/wEMjQJ2gVtdDFyCfYCA03k2EeUx0sZe+p9phQkyGujRJwURbkhryslvqajuyiO9qdkfh4IGtE/G3c0EBqI2Ip7E8qHuK5FrJcPIYXdJsOhyUyqnzG00EfgED9fsK9pGW1w+5DXG7EmhLdRKupMiahx4KZFErRIYQ5jl8DGS6616iJNbpIQo0PptRY21GpeW3K4NA1kdBRXHQSXPycQxegQYilu6fgiq7ZrEoSzTXKoU2vraCmBZw0Gb57JNlumMRr+QaZ7l3qyyiJ9M6y91GGnhJIeHIZLeSvxCBtSZIR2jZGNThy+X9oXphGSGsE4z6EFzSGp2Y9IWsnkj93Am5L7GssiSkU2V5So9DV+sfdUWyulJ5dYVC5dng2NPU9xD0mZ7TQbP80xKpViB0ITHHxXLXKEKXDRmRvLUCizZe0bzkaoFwm4hJZJSkkIxPnyJEwsGyELgkQ6CrsEVlYsdFulkgubhvl8odO6TeRLmqIl0bitZQik81WESCnmcstjxG90JW6SXpPQURF2zEF0To4CPblTzIjTd/cY1e/tkJSPs8PW9g5wsoVCcrF7EBeCWH5vFJJamimMalbXbBOZy2eN2cCbKhudh9XoiYMsfmOR/wkSvHTNCx0pemdMbls4QYOxM+t4avmKZeP5ke+4MR7fJD4IJ7TNrlBZCArt0DdbXY2m8pD2w1d+CejKY8mGn5OmOlry4JNvKGrwMTwsCQkpRFNbhsLdzc5FWduCwvMuSjUpyUTDYkpb1klzYIQK9ItF5C6k5hj82eecFk4iE4XQvPikiJ8CDUzMJcBml0Pnj3EPaenYsInBEQ9UmVnUU9mmmuQnHRIbaJtpndkRufwgke/wAozUVeJ2XuJFUW6nto4r0Fl320X2TSr9sktO4ruET6CtWRgXD26CLZbgaaEirVeTkb5k1m/UT+KHsQmqM9PUIoCaOBwJK21n20uQ/5imkppr5FzGSnpvRuMSanxXdlkczYs9ktEROE5eoSwAQiUS5g2+JENtOyDi11AwVFMmwrhaEm21Mu2depWGI4Bu7I2N2qxPk0JskgksZeUNvliFbjgIR48xSI0MSWMkMiPYQteqjQotBRY0egWvBqFNLUZ19PQvCkJSy4kw5hdZki60p2QcR1ugVyJTQxaDrUwQ3cjy8Q0CwnfrYtCindFXmOsxNh3PUc7sb2wPokHy24D4OwxbMhU/TSGCynHsiWD1Hpd2G0ktIRSM5bdU/f4Bm0pfHxdPsWear85EllkRfLKzyNuOVCh97FadRAHgEnujLnAne00p/Iopt10CvGON1YoFIVwJwZCMxqMCGGaJuTKMFuFssD6vE9hUS080EtpvtUUPtwMyYUk7wtCDyaY9OLTzIEdN7EcZTGnCRbhKnlMlFo18Ay9aiYmxqhnFqLUmNCUYHUjLrgzWez+SP5FYM1Qj3IsMQmHLkiBTnVOnqcE2LSnPBLtgwnVixfKq5Y/wDUjYeE1ZnciNiSPIHA236ogQuhOQ+L1HTzRD1q1ymmu8jwFcWC9mqJF2FNMDacvzLt4ySk2uoQtVDLKb06DFxvys9yOETIhNvdZ+xG1ls6mImBBxTDkp0uT+CISHaB6HKtFkRFEglHRYfoirF4pKKsCSyaTQIHTzCaUCMD5JN5IWjjKYIEXSiG9xsCNLaZNovIVJamqJ0YmgVfYPa02HzKaGMw3MbIXz6wfA+lfPA0pJgSpCREUMDawKnUrgiy+TQkipB5WDAjShQUEuqJo7Tx3EtNx7oiuKgXmWEOWMjGw9oeYEOc8kEJ4FQLCXgabbg2FxyQsRHR4CYLbKhokOB5Y4S0Ga9s2GLo7FsqQV2018NRRmxUH0JklHIKswGxyM3dznEcp/Z/oQUtObPliXwPyTeCjVLYY/BGJ183HkTloabbomyyUTQadKw3qGPbfoFQwEQLh5Q1aDyFLdN9CsyJ4iWwYmFtJaYlEidD1cT9ixUKMkpz1G1RkpDbrJJtJJ9RaiDQ72ueU0RcrlwGG1WB1FJPp3l0mxoEQhOAeRJvAoQQ6mFoOwY+gioE0Q+TgSXmL7aL3GVoaoxuQLb3CBOP9ZJqkHhpyKF1siNEKtmCUUIsES9RrgnypwkCVJQm6wPqcxQkUgn1OZcZFrZxMq5os6RPXzEBq5F4GLgg90Uw6ZLNC0UNtDS3Jvkqp64Q3zkNNDuIKLZqW5EZ0Cq5TVs5lCbbvvQrncvFIHhoG5zaRIkxDm+hU/SJuE1n2HIZJmg/NEcFjkykU+q1XcadBKla0NG7aCYVzyQ/MRbeHqa4KHFE6aMTJwI5w+5b7jo1FjS6lA/yNkR+bZKEYYgLBrRCP6jBDMXdEPCzbUK0du2GSLiaesR87okcwThHEv0SB0M6diPF8BohRRZEoIoBvSdhwHOoqxULD1G0JRY1K8ahSElfo5M6SUZRZW1MIy1XBYIXm0iLxvcwoxeYz3YSOX5B/aMW6MX5gk56yx3nW1D2Uvo2SUd1hBp/J8jKhJDlDVDZWJWuwtIpgoUhyJOWkepdUrjiExteQoDUN8fQekd1nT/I0oL0uxR3HHDdybICo8JZDJA3vV45lvNlR+TyOv8Ap3GoES5UuEMJsRqgjTovmCQ8lHyKE9OSElHapWImVjbS6xbw2Bb7pXA4otUV6oeTp7mJN2uvkuEFLLnqyI87Y/MRhEsTYPHwn9kZw+w2RLbWfI7OUT9A9ULaQvUeqSu0qNNohR05K3a1D1eVqNl79oF5QdX1yfyXojZSd4kvPSSSRkt7S7Y3I/c/9yiSKA2goJGezoSVrBJ48mTB2pRt1Bsd0ZYcdZLBP6nKpJuIHLX9T3JvugQPkG94pdwgPfTKR7Gh5CzEmmOydmsXSfvEK1MIV3Y+Z7Q08zpTEta5eT0/UWZDtCifkkTbYaCvTVlwdLThFzDNJA1Q9VTCQhCpBvIWM+Gte0DlzBkRzyXyxBob2jlaOIqyVXXltka+dyfLNtmCT0deDX9UPKf1Z+5fMD6jzD3ZBq/Mbe78/Cv/AAldkR4OcVoZiVeNC+gR1DgWYkeQkSQPPgvFgF6UjhruQZRywfYskA6sOpQo/gKndZRBU2o1OOxIsXktImhOujzGiJ5H0GGiTlrBHQ3WWOXCw3h/JfM4S37jbWNRQzIUl+KLL/5f/Ff9IRMMh4HYmQzBY1zJLmEjRSHDQ75EUK8MjJ18F/5T/wCq8IbjF/4V4tSQ/CZLbJ8EzwQ9R8ZKxUsl31E0ySnRHRYkQIg1/wDjRC/403/9EhxORpMaF4Qn/wByamT8e4lIkmysCnMshuvBRDCRLIzk1XgyZBI8+Mf/ABQv+lfA3luSOR3gaKQ//BruiIceCL8JqzM2ESbl5FNRCjDbPKNBDYmToNqNkbmf+III/wDeSv8AiTQhoQyWwOA34v8A5lbnqpr4engh4PVmhl1HrDSPHj79TfwX/Go8+L8Nf+F46+D/AOVl+HpPGe34Bi/7TcH/xAAnEAEAAgICAQQDAQEBAQEAAAABABEhMUFRYXGBkbEQocHR8OHxIP/aAAgBAQABPxCk5S4W1R449CKLzd86aZmtwu5lIUTPWY4IvcqbYHEcMRw3GT+CgcFnSQvbqfdgwaQLKlQreIYs9CDaUvxDRphSwR3U7s8VNz9JDrFjj8ax/wDGg/iyGHD+xnJeFisFAtPLiADEdsKle2fPnAo9JRfBRKjPowcUq+I8Xv4glh/H/YDQzPR/Yaj/ALvM+jH+00G/UUqj3S15oyyvOIdGgVxzCVAxZO2zCjidrPRqgZhF4HBFZerwvFdrEXuhIK+wDGtL3NjNCqPxIwzUCNShMFOUpiAmyyCNtFxLB5lPuZKaerATT8sR0Om5QzX6QAuh6kw4+xyheP1pWydWhi/c5b+X+xpr/r7y4MnxqOAtc1/2IxY401gMZqrsHkpRCbQXQon5tMMDumfuUyn1P8UM+0/U49s9p9SjWZd6BiQB113l9ahSw9h5ZVjcJXEGqOvekryj4q/cF2Pw6PuODhM4fesLCusaQN3bRt0l+8omrasfVCOsbz+yswRROVin3uWRbufEkqeMtv8AuaWQ6X/sU5H9G+mORzr9aLrqhq31AgaHCfxhSSt4uvECLhUof01FFcfIM05Gbf6KgdZHz7PlY3nIriveNKhbR9AZ4+bBmFaJMtb0qRY0Kr5JAQZCYvdmrgY0k0QrBgcWk0l1k/3FwfjEE5uhqul0I56PNApHpAhwe5KkAxN/+4H5HrOkwWLlSz5oGML5ilbyotbY6HsTKWMbMiJUodKwAQTAMNODNL+C7nW0Rxa1RQMNilcgGd1hIVv2duvQWUxSIrbHpD7BeEj3awfyTiB8KEsKOuGJm4xtjYQ/d9qfBFOg+EmgXMLpYz4wuD/sVKym9H0/1hRZyFxBVcILkyoasrgYyiTedbWsEMiagBPj37xRoKeCGqo5dSroGo/8hkvWzEMseYX8B/1zFFV5ZN+VGrgZSwy/ECJGbWMiiOMaJ4imGEHbReO/xMT8RV5me5nsma3Le/wEWDnpKGuZhnYslliJlhuO2v4EIQFYeZMJQ3M3BxNmIGmarmHh11TkiLMpRq+YgcGPHcQWJhC4ELNOCIK8C5aEnsCX7lvwPlDy/BeC6zMqY7AEEC4UWaA0UssUDLhYVFWhZBos5j2SyCNy7mHnKVa4+Ypn9ICmibkQpsUKNUXjBLZWh4aVmljobmGliPIVicCALVSxKd681L9MR5fEqM4jOIoEY9JbTCYcMutG5rsAGBf5o+eGkV1RjUBYFOFwjFVcfi4uteMGo8FiJqRiHA6ZBoIKO/xSDazQo/2JaZ7sHGmN+Y8qRnpKYGFw5Yx4QouwVT2sBY8ioMXg7qhW49m6VKqpz2kq4fJDiEvzBWbVLF7Kk+iFBWOv/hPd/wDrU/7j+QTj/t8TTAsgqVND1FCmhrWAZq2YiNeh3xOEdZpfa02vckfvxg0+dgvD9eZuL7Z3Ae+f4pDTt9DJzgeUf+IIf/8AUrCC4fD9s7yvfSZdJNRgnaUkwVrWmmzBAhlfGjUNOyP52Qj1Qlk7yWiLmdx9QTgXANx+EA+bd/ZgPebpOw8piDeZ/aQ8KbtYd2EZjAQMAT4lp2rRe2EDSE9ZpoxKAlK0xVW0AYIdICNQJbB8v1sDv6WArPZrHqfN4sNubPH4SIwtjlF3GOi9smG0royVX4aS4ib1/cvN6FB/ArCDUqA4fDLpAN5b3qVFXjStZ7yssb/9FJWDbwsxIINtP6k6uF/lFDMNLLf/ABiwvysfxNmDCsy+5NOoeg/cJqh5xHticL24wkFGyyRNIiTo3gZnnpL7broYd7nZVm2ja1Ki53PiR0jSWSLD4DEuzxqkxv0pPuNQDwf7F+8d9lc3HsM963wP4Z2e4ofUgkabP2IsKiULjwwvAa9CU4EMG7SF7EtEqFtp4ncNeUDbP4djbb0YWp97awKKigMytse5i8lDcqK/N9f95ZtP+O5TQPqpfz1ttTYrgDvhFmSF8LdpVsbKz8y+3yZdbWHrfllu256nzMEK7Z6mCO1+Zfn8sPsS9JDGBMpAKh8MA4acB54KiZe3pPAfEp0noID8E8IiQtgmnPM/US3DRaABbBz6iOylEoERqcKUmCYL3DZEcpdngYlIRgDT+RlkAW0hLljmjisBvU4RC+6ESmpX8Q3fWYr+kR2gkKuYbkIfKU6ZTe5dqGW6yvYYiYodXc9iRYiy7p0hJlLUxzU9Ew4DMCmVRmHYYmZZjcF1JDH74QaX3jH4uNo0VzZCqA057y8C1BKlu+nMVcMLlhLil/UZu4/7gjWm4+sjPW3STgvRZUen/fLHvZRkh3H6v9YFwvZv7NE/oP8AZ3eyn6jtQZwVq6BPLpIgPwbUT9IVGnsLhoG+oVhKnMKLZ/JeVQGb9NAEKb2WOwrgLDKXe5XQG10KqPAJxreQ/qQc7EcKk9WoFzL5mjGxJHrM04o4BjJcI7beWlQkoBBj0Ao0fYiKO5Q0oJSJd/0kMoK4f7ocuK8H3AdWuCkJ8y69Pk/1Jj0loov1Sf0IOp3dSngBwz9QjezEVV+JFF1eU9AxGYrj52TcDFrBhsgHuQYUa2jPKKDZxl5Ow0Yln6ODmDKmJUjVp13G4paK3H7grEs60ehpbX+GTjKtMg8iEBF1QUnu2N0wv63JwB2S9tqZrFOEdzmPgjov9l78iGPbh9hmoP8Aku5LxHG11eMC5Z2rNq/XAgVfYv8Ac6tOhEr9WAOUPK4ZhR32rUSzCVTNDsjGO93f1IKwRzy/LgSD+HM2zT6J+0qF1CBAVgk6i1yjtR8oRsrCqvvdE2q6p+8txOtIawANd2WvHFimGkuHjeMFM52mY/rS8mCYpHfEn8YiYF+CNqHrwrv0SbBfMm28225IXV5hDQe+DsJviBMFjwMFVWxvCBCrzXdghYqWKR47i+2vtf7OOn/vuXf8/wC4vy/L9yn/AKf3O5P+e4gpf1/3iClv+O4dHABj2QliUv3xbbjup7ZBwGcy2VKVBRFOGJJQZ6IZbDMN3iKniDXP4cP4xM3+edNM9wlKFZPoEG/bLb5qUJZMEQwQYon4s5mXNTgGJrMFLomnIX3+mTVeqXVp+qX7S5c3KlQIuU6piW6ZUDQHj76Wf9Fa90Ey6Q4xu9YXUTKP3H1rqa3ZIg5O/tAia4AMXusxOowD7YiukmRTcP0PPUUL/sLh9uihq/SKXIaTFXH/AAjkhVkd/ZSsjR/zAlP+eONStQt2cGeZauyBHSiNRNKhuyI20WkZeW85XFMP2EGIiXUHHimbX5Mv4ywkKivTExm26sXZ1BKaUHdly5hMuGU9MpuqZ4GDOoibo95jtJQaHvF0D3iaNJhBAmTuuvDo+5hNhQoV+01TrD1X+qPuOTWSD71hU9Z8hCsGeV+8H2H3AgXvP8sO16T7tmu9If1l1xhmvIDpEn3iFCL/AMZEdDK4Ym0jzHqKCrE1kDDAkN1kPN5RAOYUVEBVgD6dSBauGUOH65tZ6LzKO3y4dwoOKM1wOCxQD6WyOIfDBqIGDA34nol6rh7Q5w/QX4jdnRnz6iMPW8lVWMQQUlAF5NJhYyKKJMJJxYYq1/dU7Y6C8h2UyuMZKI8JeD+qQN+9PvMOBu6ogx4lMdlftR+9z+o9XmFuV6V/UZqvMA+VpPOU7cHHBzQsV14xzjWXXjDDseOS5VFQ4nfLlFLHC+FMJ5/1QtA9FaB0t6sUnywffllpDkZ9GAIqDdUQo4HBaHxDa7TTie8D/ufdMUGjwjtoYoPkRc50jX5iC8O4QvuMEvbVr8T2z40OcWeGADnOjscoaSXsKwu+VUYPvxhYWvAStsD0QO6JohFbJXQWy+HCwCX2ZEGkealfSGWm9n7uJ0CdDBJojNmmoNhFN0SxEzGBYYcViFg46p6BxCAB2Na7ioebk6TTrLzKxVpSItPZRHDnvmeleDqNU3rHAYtsJUvT3/lL+m6BLDZHncPggqlnP8MJE+YS+GWC6uIOGMdzqt9azDhSrgtoABvC5boJqF4bKaUcBivtJw3wmLPgSkW6LVGNc8wzFeHO/lnAJI3c9My5jPcubq2NAA3YOSjOWcJQMY76/wAoikSB9cjKI0ug/RMKhDhpoEroGY3U1J3kq1S2NArE6ogy6zunq4NpSLJDtpY1RknRy9WJYELYhx/4IWrBEAVTTioU23wy9ktA/hSN+kXORcxu17ELpunZDrLgJ9MB3N2P3Y/eiK/wUQOtHQ+mOpkUPJ6baltybVMcKD7Q/wDCRzl+oCsDWCpcML6guvwS0Ase7IWUAEx4NqatFR/bk21HIzDlam8PhAbhxdEIPtCTekV3sG4pTA6/zmEJcBcaj9kicFXqAVxnKRHPYwlOLAHol+SgPDUwSoK3CyQ92JQW7OJbLhHDPMjXK5fUseETxk0w1kZLVNQ6NIy0BedWC5Ry0V4qjwgwhRsq8AvdY7dYsny9bcCwjN3O+MQfLlYmR6M3L6jJWEnXfWYvKjwqw8Q2oOM0kNyKgnyQIuyTNsuaYinjHbOSjklLLxWc9pvUHGR+oQhPj3qdUTEuUNUMOgYYESgpHYQECSvIlEcpT44R11qewkAWI4J5EpBlxPRLwiW0d0xAz8MvVo3FV0dwXSrtkHB3ecpNk+XGiXqa6URx7RVfSTS0hqu5SgJa1SKG3OIu1cXWoUOLUQqWDxEkLKbLZRNFQOqwoAzBWtLcQqKCxfEHLmIWwxQMAzGUlpVpy9kp22YIsTQzDKr1gvozS/SSyBQ/Y5eB2fYj3mLUYjIrDHltiiCEPmSKUoIoR4jhGoaGwvuGOWSHdD9JU5Z26qHQRJk37xM2Z4rMvifDKTgLW8U5lHRdgjDJd0uLDsy52gZPSOGZsLvOWcYLgQzWF4RLuBAFuHEYUvYXLOYlC3BFVPmzi7ygfbFqHfKIAlHof8jB6vtLYD3F8EkolwKAVW67NlWNxfh7FfnCbDUo8SxzAIAwLSq6wgkaGzgCXYcUeDN9tbW0GEJOL8rFLwLAdy9JNoCbb3TzBmqWVVeGO4lybNP5CLvYnMRIGmCe8bTCSjNnUsoDbAooyQKh++lR+6TDLMRZqO93grlbSDw7J6dU6B2ge1OArfilXGrRsF0XFA8WLMtf9i3QXV1B5noBiQW3VlMFwKWr8kUd4O7DS6XaBH/8L2vA0IRPkm1/uG+AA4CIW/FT1h2TKuw48ygaLcwfnnAMLEAAbMOCClW77zHCnXXEAZlwVGpFBMQ5GqYee3VsNgbdwhGwUGZZVEnvi1pJBsUBtgSy8mYUtsARClxtpMftlLQn6jx8BawD5vJEWBldyylwXqaDIJOP0GhezIzHeoLwqbBklXolWd+BIinLmy9sKxCIePdMIk+2qAGHNyqd601kBuaE9xCiGVzBYWPaJhHKnzqC9m4Ww4lSCymcyi2yPqKxA1FrIvMS4riCodHcttA6UBXzGounmUboJUZCIWHMyzR1shOpYWHDBiibRHA4UwSj1HxxBy4woCHq/E3IqFHqOhHlXobbdDZ4T4MJArZhmDMQscCTuRzswwMBLzctY6olWquq46or3wMQblSXCaPR2ENSgLTEdXOYkTkfg07S0QzGxgPVTmmm0UMYIUWIheYLiQIhim2OL8tc47LhEzeHAO28XQuyGROElEGXSPJBRZPvkva7K4oe0pjCZJhsRUfe5Cemhmy00VoBATbIhuHLKjFp0+XKeXcb2PqNwqIosIMYEGFIGDQwZBBGyrRCnJFrLQ2rK4VcxW/gIKcGdygoOPW12ym2HJwaRbJ5Ix7omNfOIabUDk3MKxkE0Lcd/KDXAeoSo+1sM+s9TTHZKsx0qht6kXT+IfWJbO7ZaRp54wOcBgoRZUb+VfCl1S3jbEW7OGHV4ahQAxCaRroEHX6cbNThk+RJSMATeWOJHAc9qHY8qGuMSregNw1vTA6nx3gIKGDod3Fluq7urbmcJRMD3TLMOTxF+jMDo4lnMrt7PWHklWoLzbuY7vWB/QyUu1zYuV4ZDt8X9VMooZS1nIa9kh0wDg8++ylxx6hdLtI0qYdC5jN1ijHuVwZuwK8R/YCaX6MEsVPJAVDlEG+Szh/clwXls7ArxmnvctYQ97mmgEg1BbBBfVRlJJl+xUBSnIGP3KBuIxnl82XCjPzRh5QMXKEXZEM8vUcKDjEIwjYXXUVa1oxUqG1iQ6EXAAsRLuP5pzYqF995mUbr3w2I4IK76UBXtjLYD9bKGQi1FuKxP+7qjQ91g182POoQIlrMD5VMwGMA8Fi29My/W8eH8hxA7E1p3w6CGGqzh6xWCAfRpoZ36YpROtaeBLGmQtF+Rw0fWyW0WeuRkVbVeonW2jvD3EuUApo4gcDqaygRaZxHTTNIV94UmBtfk6dPJHVsKcY4/ImumWUVDo6DXJpiVg7FWKfRcRzbop55uaMElJdZc2xNvK249T8GcNlo+E4SWfql4bwt47kTAAGTVpjBEzLimm0vEO4Th+1ldQCt71nuActhVHUnujGsaoJKfuZBekteSgyVwGOCVMFv0DHJDQnO4m6KcalrlPD/AGHeh6ZJcJQYG3TDkZ9SWZP3ZctiQQY2ZNVsgAgp8QtGjTxcq2FprYMY6Xtnwyv07e6sSG7ykcAxedwAtBDTLlNeuZQWaMWU5XXPf8iAsg6T5l9LcYSnYb70gEM9h42TPoGuquEPJBsGUcbddmxiMlo/fCEiVlyAprRTbfkGFHj94iMix2r8H0ZqVH5fM7Yj2Kw9WRMPQShmMBjD8UuPzwnpwj7tyzr3fhU3CA9wSBQAevbCVOFoRegGYHJHywiIzqVro+Fm0fEUAtUDYR5pjbpcweLDlHb2y/QrbGCVCjoGXpLfUKdnZhKUvtbddrNnCHyrYB9GOEufmCEKFHghr3QXpyHZKY5lhoLiVuDg7KGD6kB5idZ0z7RFACDgSnhcOH+xrzgJFdxjKtp9Y7XEaLoeojPiKXTh8EULSdVGol0jR3cPFX42cU+YCcH0K7IVWBcgOdxlzUss6WcyuY1Z2JmRCVrDPyy4pJtOCS6uQA9CECOE2ML2LxzsfqK4Au0jON9ekwfsR7JNm0Zok+6kLYUu70GbvAPcxZjBiLTCnqbiUgaPWTLEFFdDFqMwVaKqrrxO8tW7mLsYcYuUTwkzC6UdYZL2/U/MMkA3e5qVehvqwC9o/mi2rdxs09QYi1suvaK7VpRL26NDAXoNQ8qQSnTjwmzghjIaMkt/66eUZiOzNVeJR7EMRJeRz9N/BGwNhAMibG+YW9bLj5wUHj2nw0GipGx6QuBfJ0wOoYmj3Z1QpEvrpjGrPcuCRyab7gOAOyGAjyfRuNzaDzAilNaxE5quzEFI2hqBtqDYmdFwSjtvMaCHjMzwYeeKxMgOoTkcRk5d/CCuCNC/8EJ1IAtvqkHAagAuiseJft93BYPkhly2jgLjyove0rgS2U/Rj3uc9tf2PPT0NPL9SZuHcQbZ1dH2u7wUt+ySyXZ6hCfJni2HSv4Y9CrbKKRkgEC2794y12yj1mcPl3zmBc4X5hyt/dEp7K13Fo5MBt+olFUVuEo5+IIWITMivAcwONgwnQIjKFQeJUUgTkcxPeUPKWeUKJaBhpvwsNGE7dVPXRojVTLm5gfEq+6l6xBU7hqLqv1j2Yozrd9s4bWXwxcYSw3sMlw6z6SchsifACehxc45ofQ1XyOFfO32jUm50V7Eqj6QuSxewTyimOZQQGCby1PzlPsofmU9BELqKV/sGvHRLdNxJAFc1BtaHBAriyAuOpHkhU6lM8A97hQo6p4wemoItSBaK18RpPIL2W8ylry8Zim6CBhzq/SWoaAoGy4ywdW0/bZi0qoAQYERjNrSa6bJYhquBo+5CF1Xs70+8CnamKD+Idi+BMg9mcrDf4aY+kxUMVh9spce4t1SBZ/kMN1ZfmSHlH+4ONR9Ihq3/wCMiuyFEsJoO1f1hvVyHLHWrSKq55pZlQ1moXIkXqMC1uRdHEPJm30QFjapUh6xurswntOYNIAunU8wArrSRZ+g+kV4sWqxdPMZnwMzXakoBCiNbSXlDDGp4aUlr+lB4+jAKMwt3cXSwza/ZqEqUtslOWAUQYRfEfxTgWMEudz+woWAkTT6QdGcNH0ZhaX1KZgEFNOY1JdPcIXETF6w3T8B5huZbrpoZcnZBmM7ChTDhxUoGMCbyzFW3CxxiApAt+BBBZUtjtHEXe+cgmyQLLjhDVbPbhHO26c3f1Fci1uPcAZWn5wWqiXvg8tr8ynZE69KYKANr83HG2CfakA4MKJKzgW6vwMjIqCHpHdYxXuxEPjbkaPEHQhjStP8Ce3eCYb4hM8p8IxOdsaIQIb3gElmxktXeb4RmaeE+VwEFQ949vCb9Xu6QLe5qdNbqTTw/wAJZhdG/CwtFO36IgO+miBSDvC1gXgsfN9RxRGGulXwN4oRL4st56iZarkW5dUX+DSb2YvjLgblowxVCHVmuCtPGAnUCps5qCZ4QOx19hY9dZddDG1u6ejEGqy2/RlAVA1BULI3Uvj8MYu9A1PRORzAxQyWbWoe34tBeAeVgbAgQZDuOK+IERvOM8sZmWc6jxMosaYQuhaiq9OFXNkuAH3MUXvX1ZVFyCFaB8DKN/ie/YRxjYFWtserlZXb5DyjK7mUV3aNxdjdnFVuAu3IfJJdBzA3MIB28RSRuy5IZbxm3DKhL6KL+Cjq9avi0OgN0bUtl84ApZWajQ7CZeIeoThyTTEfgAcFCUG7TE9LibRpZtZmAAtjl12iwzj2sN6lSBC6p0+rF2MK7tXC2apXpoigimu6P2TAb1jSy/MlMcwUn+kBKHH1Y2Uay1ORKy0Yi1pO/iMnp4Fd4JYwsk0nFy7rqFYk9jKnSTN1LobU0UVzlhLgucLYjBFonVYR2Eu+vRRaQBYBQWS7jzdzPGN5QQPUjOUoTakhCEAaAXdQ1NKl9S0AOu45EQBaZYDFQcPQzLgDFIuUZ7QMvLnznLYaUYrNFj1LTNgxxCjETcgSEw7zu5UTBcD18QGqAttjRhmHmd+riv1LUp14ZPbMEHwu2hvBCIK81EVirrIzYaYaqDe8/wDqJUNdl0kXLuTrjuMcpMW5BqNMrEzeaviFsAyYd8yM0YkWpBNDDdnoQQXcfEFSG13FXwiYblV/4YgR8U+5SUONKl8iu3mBb00nKge4QoAsBqEp2sh8vltL5DR7uzz5JaD9r4NDhhthptfhuMjat4+XKyg2NkxspjYKqro5B8trFrffLIzb6njkYjvSVjmFodmGNbzqF73wY8j0+AaeCIMXSN8ISRfPmHb1GoH3AF2dI5IXQwJpfekqrvNK90jcGwlfC6/VBfK20L+xPMp+H8JmXnxfAynmM9myc3KwUUuWgAYyyGRHC91DWq16U+IJZUu4VCK7fQvMDDHwQ3B0zqBtpCi3MG9JL9DBDCwAniYA1KGFYt1LRKJTip7QVVFVBUYHmW+k1FfSgnqyOQ5uNmsDMZ5OXDi6IGixq0BGdGDGPLzUgdoxIIdl0Ij6RyYLsywwxYxHA2Tx46joteLYxNnFf4wwvUH3WZNjRbynKOp1djQHQdEM1pDdEGWDTa1bDpzEQK7KEeAL2igxbSOTrCgN2eLksgbQ9cJ16w4XiJ2qlF97B+E3GGX5wyvKifM6Ly88CEU9sEN0Ty2D3amJC+fNxUZXNIyv2rZ5bNvyIWujAXIKGawCQlvNUclf3EpSoA0Hg8S/62X08MI0lgB/ZAGPOZUhO0e2jLNQcmwdItISRbDFRkhXJBdjovbLjyzBARoTzANlAguVYUIN+rg1uhhCr0eF7xSiGrNKY6CrPliK6MPOISEgZRqvNQ0qofVcrwu93FSpKyRF9gm+KhagFeRx1HmOG/A8wVaUCN+ZTaDUdHTCoOYAdMrjMjbJZA+JAaA7lApBSLSMCthBcjefmFlmZqNloFAmqSECj8hqI2WNgbWWvVRW0jpPN1mXUlG80dSLcxx1A8BKeqizc6ibOXs+kq1ZIxlF25y6KpbEjacOWD2ZmGZ0fHKtFJFauDMAtkeQiDyuxyRIKlbllah5S+5YPYhTFu6h1UoKJQOOGsrtdxCW1X1E3gcIDcoC+LYDwokpItD9HETqFHFeY5GpWm8PZGUEcu3lZuJZKoBfK4ZvaxrPvxNeRAJe6zHTvVPdGGZnL2AwiOduTwo6WMtPQK8bzzN3tQAgPDNANOWujolJc5gRwzejhaRgYWxLZut7rEdkUZYyVxHnzKsyrM6FeZY3G62KdXKgTIdMulNZJFALDfJGFFlXRQJA1Wjm0NXxLlCCKK7cktw0fceOLglaelwdCi4oql9sZsZBVkXUCsxGG4xCKaCLQqRUEbcsKgtDdDmU3gfQgEDRLpjUAA6gi1xyV4h99ZSWAByuhhu4QKtouEzhqY2vbPTNaNrQEz2YApWNVxAjkRZwgvAKgKM2C0O4jSqbKwiAmasDqbCWl3BWiXLcSy+Jmtu5rYVLRzMlY/DSInbI3QCghKsXyDcW8ljFwWaBCMMAbH6gr555VUezZtGzqM2snJKgBirwkW2Zz9VItlFi3tiyY/NbT+yKxa6zcRbbz2DkMo5qbLW8sGCoMhL9kdRALSzvMP7FOgI4uqxY5Vrh1e6WNXgYouZWKx0VFntm5YMKPUU8Ju8CnKzHhUf25W2tsap2VEGLAAe6HyklA9oOi1BaYb8zFZKQLTfmM0WcLghhFlS4xAPzEqVtPA/FgE1plYmoFGxjeIwkTHg+lbzTUZjEx14VzSghVEDcoX/WJK4Ng3lq5RhHQ/mOAGUJht94KDc8zj9w43nTLraUMerFsEDGuiV3VyhooIvHNV/omHUDkj9wBMVhD2SKU9zLc2czzarNsSsOXlvcwHDJl9jB9EmGAax4NaoFgXBywqliesMMtdDbPEDis9Qy0trDR0YLiu8LWDG6zcvDtOH8MJgZFBzUYqxMSjSs6CwOYsPJVFDZUUsqy273sYiFjXvlOldgl8I7UPa4gKcGy6QgCiwrK13yjcswk3u0/pIE2ijfJsZSjKvOyAnpl1CFcNgFGrAqwtc0trfaYzwFNOHFMsC95iC7Q1oD0pgIKTDMDxjZPGpUBMjz6kKDq5GYm21jXlCTSNo5hhhS8sEA9xMj2MAS+QY9eSLbuTkfKIfKN2u/IltFthr4iyPXGNsGel2l+TUWmwaVArlVst4Dq2Qi1uGWBhaWKs9CswW91HGZCnt8y90q4EkBwxJar2HNQwiCIQhArR3rcDszdBB67uWGz8w3dBC3Mqo2BrR8wgeBvFV3mMZQXiv6h9PrMINSqxa4B0zTgG2+rmq7HogIi/XA4PUiEEt4PuNTAYWlX3ga1TRvSstPuCj4mm/ggaVeCGb8AEp0yZMuOo2qDW3D1gpq01Ue3pEROPIxTHuiYCoYBnoeMVrGv0SDVcxwEmG9YBCFpQe/xcusuI3pGBVMKg+1kfUXKOxJ4A95+osO3pafMEZnxttWq/JD7NssnmaxQvk/ygQVKoOe8TPcBbGsBNnV40eYT3iT5Uf94oE77S+5ogJ5nURXSJ56Rl/85JuMXFqkn3CAH7npqZge0Gr/AIJiy95MJTIMGCWcaLLi2TmLFFsZa4ozJEWwHBXW2GDvr35gbrrW01NFUAMD7LQjnNhMW1qtjVrO0L+FxRVXOP0zDzbbtAY6yC/uiUDxRBIidQFsAWquBOFp6cd9tkPVUzsiJwkV5DM217CsZAjrnVQk5eoxXsHocbltVsLU+ZVBYjl7uiLLY3hT4ZaqOVvn/d4r3C5n85hb5BBaAojmFHQVaYukbqOl5JSrYZg6sSVuXzHSq8a8o6kvlbm0TxUskexs77VNxQpThevAA+yiPPsQUyqecWj1CedqmLIYboXPcmTf1juHUrxmb/7cYl/bfJq+YpZ+m/IZq+2W4yLQxzCQCOlqKko7Zy+rM3VtYFnKXdQ+VscxX1gwBaoCFXqGoLpjZ5i4PFoCNZuI6j1CZ6pQB3co7uFGHqRtRTaj5qLgC2ghwcQ9chYhVyrDhEVpnrYjHlOBXeYAlo7KDHHFOd5iLiPS58TP1TLCkDg/9Zdas+V/sIovoT7QCnxqPqXqp0tDI/flL+6DeVv5ldoh+WEzC4nqpTQIuJSkAhyksAbiGQduYnEHh+BLTCsMwuxIdBl5Cf1BT9YzX8EAZNc85BHewQV9YCho+MNPg8TGhRlIb38X+sQFb3vEdi5hMaQrD5tjM+7VK8DGCZnGHnn+4YVIyzCkdatgjEm5xJ1BUXNUp7KXprKlZf8As5iEGAZlDLTCNG4hsIFkOIA3GuZi8fjjc2IJHxBOYsPP5r8GEHRAZGLDkjRsiZ0TC51vEDnJlqPcgODS75mIwMqs4kQ2UwANOoApDarcQ4KyiXDiVmBj/wDNnf5tXP4p/OZxKifhqFdMQeyALzCxfM0UJUctQzjUp6Zp/DAjLpzGrcQMaZnAVEHNwaY0aYyBT3jNBh1oFxd2hFBzPLLA7EYnaA2lpDTAJ0lyFVi4ym+CIwULqUEIudwfzTX/AOC/lTFy+vwD+EalMR/DCM3zAvKwvBRQLhiUKVxKNhHE2Igfi3j8cfgi6zIblTONxSGZTKQUrRX3EhYMgrYmYJbjZ5gpbhSOzaKSwF1CIdVcT3yDPHMTxAIi5gxLJiWVOdTEElksqWSye0dOIJcUqYmHZDiIgMseI44lkcwGC+uAX1kAO1EF2j6xLqtRuoYhYsGKR5zKe2EAbsybI3VpFWMMcGHNCgowssZglV3yeZZMqu5ioWYD0SgoEJeA5iIzMsEsJgLKlVqM033MwjOZTD8KrZTUqpX4plNSmAspjpmmcTUfFsERsblATCsTGKge7JGvYkySl1hqOPB6lhlLi24YMyYSmU1zKfMo2PkhDDAgFo/hsTX6wntI/SA1cZ+3n2zT+NnpGXPrJ3+DHcIaTZ+dPw6x/wDyJxjqazh/DOH8jCnGE19SPMIn1fgbM/r8O4fjidygy6n/xAAwEQABAwQBBAEEAQMEAwAAAAABAgMEAAUGERIHExQhMRAVIkEgIzAyFhckJUBCUf/aAAgBAgEBCABatuVy+vOuaK5J/TjquBSEupUja++yn3SpbIFGcwPkz41CfHPwJzZ9BTi3CkIS4ogJJTQTWtUfqppLmifwFfhR+a5GuTlfl9edc/p+dDl7ocihFAbooSR77LRoMtCg22K4t0pKfWuNcE/vgn9a19QKQduKTR9fxUF0lD3AVtyuLlacFf1DRCwKIcUCKbQ602NFx4Up+QBXkSx/iZM+hInn471wNAS3FpLiSP3tv9gt/raK2ij7Pqg22RyrVD6aVWlVofxA2a4GkgpO6B2CAAd1xVWjRUkfPJJ+NiisDQoj0NaNcVUAaNCtkbptZ46Pb37rtiu2K7YrtIrhXbZ+RWj9eVbog6ooUa7W/VKjhQ9+LHoxWKEOOfhMVtH+P+NAqPxtYoKUaIUT9OWtCnNBWhyP8OIocK/9iaCEcASG0bFLlQ0KKa86DRnwdUu6w0/H3eNX3aPX3hBOh9038C5E19xNCeVbFee8SOHmyCN0Zj/7M2RTUt5SvyVJfCiA3Jc9Al9HP8hJY17XLQPQjS4slvkjvsV5bfxXlf8Azia0n6TQPHTyvmYXpi5Psx1ZjkXxScuyJSkgt2yeptKyq2yg2qnskvzUh5ujkt8NIv19ecQ2k2a+Bl4uPG8tMWxwtW6a5IuaHsij3C1CKpnIIVxsyIJIuU75JuM01Y3WZtzaanpgYMlXJd1j4S3AfXHVOkJJAROkqOqtc2a3PYSi2giVOrhWk1xFCC9XhvV4kip8V8MJJyf+nfZ4rkNVyQRui4rdd1Z+Uj9gH3qoL3ZmMEX2x3ORe5sttu2ybha8ddjw1hU3KAL9FRNuVgZTnrC3bOHz8UBuvZ9FSUo/xV8UrX6bJSurOkqukbdpiLeduBBtxNC3OULWP2mW6K+5OULkrYqbP5RnEnM0cMllirBYZN/eU1HyCySLHO8Z2121+7TWojKOm1446U702vCUkifa5VvleM+x03uTzaFh3DcmehGEqdByXEwsCFdbhb1OGLZbDkt/ki4JcwO8phuCrhb5VtlLZkWqyT7w+Go7PTJwpBcyLE5tjHcLLLjzgQLd04kTEIXOuvThlpjnBskUs3lht3HrgCq4V57n6+4PV5z1argK0KmpSYUgjO0FOSP10xigMTZFdTYO2Ic0YcrhkUA1muSXCwKiCHC6iXFt9tL2fxGX7TGmt3O5SbfifmRV5vkjL6wuHLZy7HXC7YLci43uPGdy3Il43GYjxLPn91Zlo8vqNBTIt0WWLYyzi+OInJ/19kTz5fUvNLLPsi0T+nNsaelvTF5PmdwanPQ4WHZbOuEtEKVktuQxmdqdRijCnItxWPGVXiqrxVV49CKo14lS4SlRnQnPBq9IXWDoEHGESF3xbGQ4rLkMY8vhfrfXU9H9K2LoHRBrJ9LwtparntfT8mpcx+W6XHenp5Y8+Kxl9EPKI619SLTKkuR5rNstsubPaZbzsBrHkCm7ezdMdjxX28PxVpamHMqwn7dFXMh9MtmFNAvrqzeJqqwTZyiKgZL+WZ2FusSHatfIB06991VBxVFCBQSBWhTiSUKFdQGj9zi6lgWzBuFdOJKJNskRFpiqt+VpZV1NT/wYJpXoGr4e5gaDT39Xp9R2reunXL7HISJCnPLfrH8/jOMIjXU5Zi0JILGfuB3Gw4m4T3rXiIkNeVLJL6sYlvXrFZCZXTdPGPcava/+zka6dfllbNXxRXnNnBxMf9EwSQK40BSH0K+RIbNd5qi+1o1nEfyrxakJni2CKI860IxuA8oW7N4Yg5PDmHPLNOutrZEWPheRvuBFZZ27RiiYBtkVy44Qhln/AEVkfurDbTilheVMYVHduQXIumD2q4WtpdptmAXddwaMzqNdYzUSNb27SqNk2JohrkdPboXylHZjYZizjbvTe4tIdkRnsk6cvy5Tr0LCsLdscxydMXc2rr1EaUjEkoVj0IkhFfhQCa+KJP65GiTo1l0oQJFnmnKcsVkQjgW+c5AmMyE5JmDF/bigf7oL2AHep7hT+N5vs2+SQ9Ks+fO2u2R4Q/3Ne96v+V3G+aQtyzXNiL5S7Flt1siOw3N6j3JxspjOuSZzy3F2y7zbNIDkdXUycGeJul6uF5kJdkx31RnQ4mL1IntMpS5es5u10YUwzg7aU5CgnGHEN2GAB5Ka8lNebqu27XacrgqiBo11Eb1b0qoaUlVAKJ9NR33yA0/iN9ixkyXX2FsnirX090wEKcAXZ5kmdark1LWeKtJQ4OX5GZ2wQhTy1+6s2M3S/B0wpuP3i3OqbdfVPjJHcJcX/l21J9jA0gXF51ePoWm0QkDTor+rWl15K68lVeSmvIbPo5lavu0RxDb2K3VD6GGxhGQGsagZVYElqpUm5sx0mPkFlynIJaX3jg9+17GC340nA77v2cDvgHpy05lIgGE+MDko3ybwKYpY4np7clLIpeBPJ0Di9tXZYrrNS7lfA8rt39q+XiCGXUYTO4BYOGylD1YsfdhF5lu3tJhR2mq7yaL/ALrvfw0KKUkaPhQy6HVGNH3XjsD4EdhPx2Ga8dg/PZZHx2WzQZSCdBuu22PgDQ9BB5bUBXFJGlcQTWk0pptf+XjsUltCAQj1r6eq9Vv+Wv5Ef+Fut1qtVr6aoj+8B/IJ3/ZPx/eFH+KK/8QAQREAAgECAwMGCwUGBwAAAAAAAQIAAxEEEiExQVEQEyBhcZEFIjJCcoGSk6GxwRRSYoLRBiNUg6LCMEBDU2Cy0v/aAAgBAgEJPwDpDk0tKhjmMTAYP6S3yiVD6NM/WJUXjmW03dB7SpKkqbJVlSa/4JEO49Ef5EwL3xVgWBYFgXvgAuIQYglOUgZQEorKaRQoHCCEjshJ7YIORiJck7+kemDAYIDBCBCOQ8ggMHRMYRhGHfHXv5GN+iDykiO0JbqvaIVPbeKW9dpS/ri5fXflPIOQdMNyOLxhHBttsCZm9lpnHYhMWu3C1IyliT/JeYfFe6MwmK900weK900wWL90ZgcbrwpATBYvT7ygfWYCubmw0X6mYHEjdoEH1ng/EHtKf+p4OqjtZf1mDZe11/WYRrg2Pjr+spsl92cR1FuLAx0v2iFX0uFU3MRjqVI4EbpTaU5SPQJs1RFa33WYLK5oUqLNTVABu0vMfUnhKstyBcET9qKpDqDoUn7UVwcv30E8J1qqqxAYubzH1/bMx2IuzW0czw6/P4emaj0MxJFhfWeFa7HHnYCRlucvGeHK1CngaiIajFjfNPCtXE0sQM1NwxGw2mMxDfaKWY+Ows2lxMTX94ZiK/vDMdWo0DqzF2+YnhBmJ2k4p5jG55VJpjn3a5jtb0jKje0ZWZWLglg1zaHxRVpsO1kF+ReQfERIkTTnKZ9moCZ/EP8AGGFSOBh7CDsjtbq0mkBjKvji94706DU+dNXN4hQLxitVWg5WoV1ynPfXhMMMWOfT9zfytZRGHzKq/Zwb83doyP8AZcSUGU3sp48t7QC34tTB3QW6uTewg0NZAvaFEMeHkWCDjNlwT2lRCAwTPdtgE5tr0lcEDjGVXqEgFiQNBeV6G23ltK1FuoOfrAVIYA32d4mIwih1B869jrttPC1JsONlMsxGnHSVXSlW8o0SQrE6C5MrvSL2FUg3YkR2Rw3iYiqxDWHATwhmSq2Z01AZuu8RlYNYX2HslIneX2AeuYs5uoaQGrSuBnHExCWJtYR+ZQ65Rq0qM7AaAwkVBUAsRvvE0TGuL+iAItoOjtFJvlPPCEewINhSmpg1Bam/zE31wO/SZbVhUJLC+wiZKtJtKgyBSIACHpkdYaECoMPRK3F9GtHp6EELk2gCU7FkZSNysovcTYXN7fhiqKzocmmiBdJlr0iwDC1tu+MGKVVym1tHEXMDRz1vXqJVTK+ykBoI3NVaiFGphbnTYwhziibIDxMqcyKLeM4AuTvGsqc7zoIWoQLpbW2lrgz/AFqi3Ag0bwhXUd8EEHQ302nnYakZoGzO35ZquVnp32jJqZ/EUj/UJuFRT8DybqVA/IQ6jBUCv5bRibIFHULWE3VnHeJoBVdSTs1uIudEpkPbdc3EpMTmHYIdFqUQfUISEqYekPhObL+aecObujjmVFyhFzPvpDo1ZiOww6Wc/CdsHl4qvUP5n0g6VtQYNWwtNR+Um88VhhLW66kObJUJt1PtE0NHGIO0Z7i02rVYd4B5NbYbDn4ifwKQHTKJ/vmXGWsx04gxApC2DbQwE5os7gHmwNp47J59WlBdlwtJQeBYAXEqvzh1LE77w58odQ3UBebOeUCa+PPNpO3wgIK0769pnnFv+x6B5DDL/vAUBHU8NIUj4irUYLewn2ZXq6WFS5JgypVVW46oZSNRkqh7DaRa0wLqCdWewAEPjvSo0l/EQbkjqgvUqYXKAeI0mCcAsNcwlQK+Y1GXq4AxM9BqxLAGxsTAEYgMGvfNKIpUEdSWJBvbgFjKTzikgbgvGVBzgoikfSXYZVVk0GUBrj12tKgBIc7blmYWsI4U1/Hp+kJUVSxuQbk27FBj2y0iqWvrGzU8PTCA8cupm1lLd7HlHQMTPzNavdeORxMOtIUs1xtuTACadRWHqMwWR6BNmJ3NtEwC2G/PrMApP4mjXC+Qv3RwEwi1RSB1JtvmATXdmJEYUqG6mNgMw1VaGXyythGDUUbyDKaUWYWL7YS9R9tRtdY+XiNxlGmWt6hKxfL5KHyR6oSpuG04jYRKdGqQNWYlSY60Efy8hgtlpOT3XjA/uvr0FiwcmnNY0pb0lDHkFzKTubgGyzDEUzbUanXqEDA8GUr8+hUyHapIJ1HZKtZ8T9iqAJUUBAgG0dc0AUQRbQ2ETnOb27ph62ZTqAhMpVEXdmQibYTLnJh6x7lgOlBOQcoifGAWg1JDj0gCPjMM7Md+lphgP5iD6zB4epTc6k1EuJhkq1Ta6tWWwMwtFCikAJUX9ZST3i/rKdMdtRYKI/mCNSHZVCzE0eaK5b5kzW7RMQl2NzYq390rIeN1P9uaFCN5AP1AmKRfSAX5mYmiFc3uHtqOy8OBZdwdrn5iUMFzebykZb/EypSC9br+sr4cdtWn+sr0auIr0HpLTptnK5xbO5GgEe+Smq3tbyRaGND0qNMuNhyrfvtKa90pU/ZEpU/ZEpU/ZEpU/ZEpovYogHcIB3DkUCAQ690PwgvyAHtERT6pST1qDFCg7QALGDkEH/GP/8QAKxEAAQQBBAICAQUAAwEAAAAAAQACAwQFBhESExQhEDFBFRYiIzIgMFEl/9oACAEDAQEIAOsf7+Nwtwtx8EjZNY1zgSyM7niInn6FeUrxZUKkxRqShOgc3/QbA0/2B8TWjiZ2BeQxd4/Hbuu4hGcptrhuhO/b13SLnIfa5SLlInsDUxgeF0hdTF0sXSxdLU+NobumsZ2PCEbAgG/jdw+gXH7O6KBIJUR3jC9f8pwdmofQ/wCG4XZE777oz/ntYu4ISsXbGu2Nd0YITpYpZSUOnf21tclCOt+eqp+eqkjHUb9OMDWEN/m0DiTMt7H43sH7/vX96PeuVjfiuM665/tdEy6D+ekrgomub/riF/BbNX9a/gn8C1Nbsj6++TVyagC76Eb0WOXF3F2wPEDlzYubFzYubFzYg9qd1tkLz5EBXkwBeXEvLavLC4vTnSdmx4SLg8oxyfnrcup6MTwEzd5/k1jWncBxCEjgu6Y/fbIEJ5Pw+Z5BDgGuA3ETCjCxdDT9dDV0tRiAaVDGHjd3TGPrqjXVGutqDGrewmbD/Tp3A7DueCE2G4QHIQ3l490/badhwTMbYaxpPhTlCg7b2aJXgptMN9o1W7jc1GHkUyqwNGxqxH/QqV06vE320V4vwYAPp8D3t9NrWWN2b1WiPc3kwScHdlhcZj7XVN8elxYqgZ3OWN0/i5qkdiT9uYcr9uYjY7SWa7JHRBluPm3aLDY18THn9Gxg+jicY1pc7z8a2aICGKhJLciLp6kdenLHiXVbgmjkxs1LITWWN8Sr+BUqrJQ9VR7qpn1U4ADHyalNuFs/TEumJWakEkEjXZCOMw1nrgxbBbBDKV1+pQL9RhVG7C+fYYdwdi6pACIR/wDQHAewDudkdgrAHRJvjr+Pbj68Dxchp3sm2WxGRTw7FiZDBDkpXaYnMeQax3yCdvW+623PxZfxrTFZa62OGrGnZJnIo5Ri/Vyn0Ynr9PjXhMVOptbjcMAeWIrLJ5GHGV2TSY3Iw5OHtiuWo6NaSeQ6vx4O4bq+g47KrbguRCSGTVlSKRzTHnsKybuEFnD5t/JWcfTtsj7rt/E4iMU03U+LbLG4V7kFuMyxXb9fHxmSaXWcRP8AXi89WyXFhe5rBub+q60JcytQ1eZpAyzbfHJRmkjzNNsstVNx7F+m199z+nVVuuwrcKr6twAacdviIwtaTBpggGjrH9s0JzTd8Va207ia2SZP22dJ1el3Vpad8V50DqtOK3nnVpTpjGPa/jYqyYTLsa2/cdUx8lpuExRzE0002Q0rSfC7x9JTviuzV3ZF7s3l5Khj0ri+hoLdPZGpk2eNqu7LWpRwNwmnastVk9nUGBqQVHz18JbmdjrbXZy1HDaiaRehRvw7rz40LZLNkbhC816q3wyxE52mtxjiw6oLrGa6BjxNisy2OTKDnjLO2jT/AGXAm/YCwwDNQSNVUBurHKNgYwAaqH/1oXLLsMuEcBpO/WrNmgms269WB0j9NO5Zh5Vi1JRzcliOTOZmRjXtwmpH2Jm17OtN+2qFUtO8CGMZIn9Jtudhv442845yFkuTeXCrDsvFiXjQpgKDD+eKDSCFpWQPq2Ewm7qh5WronQ3q9ljZRZwz3jRx2sWmoeiCqAMepXNLXBmrHlD04Bar9ZGrvCGS1omOyumLLJXTVG4XNWvUmmGmPLvaYK8dzUb4XitWEewztVuOy8PRqSV8sdBz6jQIGrL7NwtsrFN2xF1yzJIycyZIeRBL/aLynRyx/wCXNnaNzvMg2xv70vJ10LbjW810z5q9p2Wnjb5GmpjZxdiE6cyFWlbkdNJqLFRtJbhOy9nX2WXZ46mpZZJDqHEgkrJ3W5rKQtryiRlPjHU1Fdr3HeZc1ZQZXea+kqMj7T7Ut42MLnXTtfqt0kLWlkljM5OJ61DUe+nWmZjtQiqwMlyOZ82LxmwUzU0/Za/UEz25eyEZHlwI5kovduulq6vfsRNKEDdwtPRGeC7AMHgxiBJvZgZZgkidhsFJi5JHEaO9e2aOA/3jsbWxsXXFe0wLlyedfsxgbssZhK+OG4/UqRsGJmU0/RyTy9VNIVI37zyT16UQjjkhpZiAR2To+nG8OTYKlRnVWgnjAdDLLpTHTHnHDiMbizybecXYywVnK0j8pYcTWk3K8R5XgOK7413sTZmBCaPdaXlaJpEJGOOwJaAjPC0kOZm8bPKYYopS/fcL0vS35AtF6GGrdgdDv69TF7m7NFAyHd8dFjT7yN/HYoxm1Wnxl2Fssfi1nkBrYGM9IxxlZxrWY71mjvdmcPa5Bc14bF4i8VyNaXYrTt4Up+UseVxvB8jmZzDxkkZOzgsk4ONerRfZPdi8jhsXAYWDUmKX7mxiOpsWnakxbwQhkMJXssngGqZZC4M/cW+xe7UkUTQUdUTObu3NWo8m6GUwV6UcYD8ZPQpzmRv7nYCWo6l22V/Ksu12LISS2pjJGK9pxXhyfkUz+Vuhut1y2+u6bbZc5Fyefsue773IXJ6Jk/G9gn1ycQt5gfTjM7bfZ/oHZnEBOHJuxDGhfj2Bx+hJIPozTHZSOdM0iT/1Bo+dh87/ABut/jdA/JJ2QA3/AOzdbrf52+d1v8b/AAPgFFD5J+SUESt/krYfHL/qCKCKHyUPgofSP38D4Py/8L//xAA9EQACAQICBwQHBgQHAAAAAAABAgADERIhBBAxQVFxkRMggaEiMlJhkrHBBUJTYnKCFCOT0TNDRGCDotL/2gAIAQMBCT8A75hyhhhhEIjoP1RqbZG2GcT36d775SlKUtZ7gggg3jUO9wnE98d5TFIhbpAYzdIzRmhJzgIyjNGMcyoRKrSoxlyTADEWKssNR1GGNGjmHUDqEHeIhEF4p6QHURGHWMOsYdYw6xh1jCOc9whaYoH6RDEMaHKGGNGhhhHiLwJ0IgWWHhePccrQyx5wDUINR19IIIIIIRq2S8pHPZeJ8ogPMiLRW988do1EkH8URqPPtRKtD+rK1D+rK+j+LkzSdHFxcWJml0es0qmeRvNJpn4pXToxlZD+x46HL2T9Y6fAZY24AiAwSy++0IvYMORjrGj6hBNqoxU+9ReI1SrUF2xmaN5zRQTbYSZ9jJ/Lbg0+x6YudoVpolMFlzGc0WlNGpgAfdmgfyqjYRUmhIw0VSVJ35Xn2ZSd9IQ+iDwn2fTo1KT2K8Sc5o9O1FgBlKFPpKNLpNFpvV3DADNCpL/xLNHo9kT6Z7FRYc7ylT6SnT6SnTIKE3A2QWPZup5K9h3FMaNDtSqPiWwhyKXGonwhIG8ZZzztCCeMMYD0eMCPWD4cO0g3Jj4e0F033utpVFF8LgO2wWAjirgcuKy5hrLaXBqpiNxa512gAEA1+wZ6xptlzYmJeJ56hbXlmJup284LqTYDjPRXhAxVBchdsSvt/LErDnbVRPokhjbbaaIQ+K8oDtdwva8oh1TJU4SmCt/UTcN9zNBOKmxCtiBNofRsCRHGQ9WaONvGDs6hPqw2EQu6nNj6spoFv6ywjAaZbwAm6lnDBF1CCfiL85uuPEGH8xhyt6M/DJ6QkFHU9RaMS+68YkKHHSbDWYGXGeUfIEEAQel2S2H6spUJRXz4knOKQ9usYkYD/wBTDhs+FWHASmQ2H1uJgugIYkm0NjW9c8LQk4xks9DCRcDdGJRaLiNYrSXzjxo0Oeu9g4Jm1KrAzMgKPEzKzANb3ib6D/Kfk1e1VE2fxB+s2sSZ95BNppJ5GPhd6gIvyjiwE3pVPWZstdxFYW2i0uSd9pvVpcYVsYfY+c3pUg2JTHwiKIoiiX1ibO2hGde4vwSLkyAHnN9Bh5TeFOr8V/OD/UTcCIP8sfOC6tTFxEDcjmJjAVSbMTN1JxMwa7G3KUlw2tsmWIK3Uw3bsnv1tPfNhNO3WEEBXm6w8pfI6jqzimIZuIfqsUs6bWHviuQpm0XQeIj4VdSLmV1c22CLendmmQWspPiJXGzhASEUC5Hvn+KlMYeYillvYiC7ulgILYgynm0UeuzBtxBlEq4HrYhYwEqgAZyLAWN4pYUsankTFxi24i4PjBYVCtl27DBZ2Ukjhcibn+kMIjDVa2omHDjo08+GJbR1cvbygFnW0r3DDLDxmlG/KaSGHDDBbiZXw9qRNKPSE1KkrqXFrwvTY712GVDVT2SLSwRRZVG6CzDY00klR90iJgU+vc3JgxU2mkugOeEAGXrVT95hsm0lR1Ig21D3DrM+9o9M/CxXURHUczK6s43HKAeBv3Btig0FqZkG7YmgyENoYJUwhyQABKqENxIEZWPANBFEABaui+d4NrmDWY2sZYSpz3EgyuALe+aSW/Y39ppFSmQPYYD5SucGdiiNeVa1iblnRpWJ5I39oXP7GhqfAY1UfsMpVWZGxAPe15o+WInad/hKOC3Bv/QWekeBYD5XmjgD9ZPyWUWx0wRYDEPPDNGrg8QT9FMp1SbbGe30E0ZyfcSfpNEqef8AaUjTCMHYOQCSNwiMAWJsdsAEMfy7uUqNaO3gY9Q82MYmE9TGYcjKjn3FjGYfuMdr8zCTzJg2QCKAdZbrCY7dTKj/ABGWfO4LZkf7c//Z'\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":2740,"wires":[["1c1c6c0716fcce3e"]]},{"id":"1c1c6c0716fcce3e","type":"function","z":"a933b5fd7ed9762b","g":"e0f5c7de1a97f706","name":"Decode Base64","func":"const base64Image = msg.payload; // Assume this is your base64 encoded image string\nconst buffer = Buffer.from(base64Image, 'base64');\n\nmsg.payload = {\n    \"upload\": {\n        \"value\": buffer,\n        \"options\": {\n            \"filename\": \"car4.jpg\",\n            \"contentType\": \"image/jpeg\"\n        }\n    },\n    \"regions\": \"us-ca\" // Change to your country\n};\nmsg.headers = {\n    'Authorization': 'Token ecbbbc0e1e625c8389d50e6b3dda572eeb64dab3',\n    'Content-Type': 'multipart/form-data'\n};\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":490,"y":2740,"wires":[["f150476a8fd185e7"]]},{"id":"f150476a8fd185e7","type":"http request","z":"a933b5fd7ed9762b","g":"e0f5c7de1a97f706","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://api.platerecognizer.com/v1/plate-reader/","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":700,"y":2740,"wires":[["be9bdf0c3faa8093"]]},{"id":"be9bdf0c3faa8093","type":"debug","z":"a933b5fd7ed9762b","g":"e0f5c7de1a97f706","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","targetType":"full","statusVal":"","statusType":"auto","x":920,"y":2740,"wires":[]},{"id":"6d47e75b4fdba777","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Insert Database","func":"/// ** INSERT DATA ** ///\n\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][34] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\n\n\nif (!isNaN(Variables.Number[0][30])) {\n    if ((Variables.Number[0][31]) > 0) {\n        if (Variables.ListString[0][32].length > 0) {\n            msg.payload = 1;\n            node.send(msg);\n        } else {\n            let tempData = global.get('Set_Mqtt_DataAlarm')\n            if (!Array.isArray(tempData)) tempData = []\n            let data = {\n                Type: 'error',\n                Message: 'Chưa Nhập Thông Tin Người Bán'\n            }\n            tempData.push(data)\n            global.set('Set_Mqtt_DataAlarm', tempData)\n        }\n\n    } else {\n        let tempData = global.get('Set_Mqtt_DataAlarm')\n        if (!Array.isArray(tempData)) tempData = []\n        let data = {\n            Type: 'error',\n            Message: 'Chưa Lấy Số Cân Tổng'\n        }\n        tempData.push(data)\n        global.set('Set_Mqtt_DataAlarm', tempData)\n    }\n\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Chưa Thêm Phiếu Cân'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":730,"y":220,"wires":[["554179bcf518c11b"]]},{"id":"d5122ff53b0e51b6","type":"mqtt in","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"","topic":"Mqtt_CheckWeigh_CanTongLuu_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":220,"wires":[["500f8ae4139e699d"]]},{"id":"554179bcf518c11b","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Query Max Phieu Can","func":"msg.topic = `SELECT MAX(PhieuCan) as max_PhieuCan FROM TeaCheckWeigh_Cui`\nmsg.payload = [];\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":220,"wires":[["7e80a295aef8f76a"]]},{"id":"7e80a295aef8f76a","type":"sqlite","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":1130,"y":220,"wires":[["bc5cc4c5f675e8dc"]]},{"id":"5f1104e22d43d5f9","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Set Empty Store Image","func":"msg.timeout = 10000;\nglobal.set('StoreImage1_Cui','')\nglobal.set('StoreImage2_Cui','')\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1740,"y":240,"wires":[["b8c8a47aac88d62e"]]},{"id":"2686a9cd55bdd59f","type":"http request","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Fetch Image","method":"GET","ret":"bin","paytoqs":"ignore","url":"http://192.168.1.49:3001/snapshot/camera1","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":2000,"y":180,"wires":[["b7793ce1433628a2"]]},{"id":"a24d81d2c7ff998c","type":"http request","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Fetch Image","method":"GET","ret":"bin","paytoqs":"ignore","url":"http://192.168.1.49:3001/snapshot/camera2","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":2000,"y":300,"wires":[["15021452cf4d1f36"]]},{"id":"76a574bf82434ae1","type":"mqtt out","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"","topic":"Mqtt_Image1_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":2020,"y":220,"wires":[]},{"id":"1a6d6f0203a7da4a","type":"mqtt out","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"","topic":"Mqtt_Image2_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":2020,"y":260,"wires":[]},{"id":"b7793ce1433628a2","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"CheckCameraIsOnline","func":"if(msg.payload.toString()=='Camera is offline'){\n    let msg2 = {payload:1};\n    node.send([, msg2]);\n}else{\n    node.send(msg);\n}    ","outputs":2,"timeout":"0","noerr":0,"initialize":"","finalize":"","libs":[],"x":2190,"y":180,"wires":[["3c5bb67d535946cb"],["4638593038e23d53"]]},{"id":"15021452cf4d1f36","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"CheckCameraIsOnline","func":"if(msg.payload.toString()=='Camera is offline'){\n    let msg2 = {payload:1};\n    node.send([, msg2]);\n}else{\n    node.send(msg);\n}    ","outputs":2,"timeout":"0","noerr":0,"initialize":"","finalize":"","libs":[],"x":2190,"y":300,"wires":[["4907652656ea0a29"],["3d62f1b014ea2542"]]},{"id":"3c5bb67d535946cb","type":"base64","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Convert to Base64","action":"encode","property":"payload","x":2420,"y":160,"wires":[["196534adc840c302","0d8a42fb931c08ac"]]},{"id":"4638593038e23d53","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Process Camera Offline","func":"let tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'error',\n    Message: 'Camera 1 có vấn đề - lấy hình thất bại'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2440,"y":200,"wires":[["07b06be20d4af512"]]},{"id":"4907652656ea0a29","type":"base64","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Convert to Base64","action":"encode","property":"payload","x":2420,"y":320,"wires":[["7739d617873d7901","4e57ea9db37bc990"]]},{"id":"3d62f1b014ea2542","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Process Camera Offline","func":"let tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'error',\n    Message: 'Camera 2 có vấn đề - lấy hình thất bại'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2440,"y":280,"wires":[["95aa02d925d08af8"]]},{"id":"196534adc840c302","type":"mqtt out","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"","topic":"Mqtt_Image1_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":2660,"y":120,"wires":[]},{"id":"0d8a42fb931c08ac","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Save Image 1","func":"global.set('StoreImage1_Cui',msg.payload)\nif(msg.payload.length>200){\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Camera 1 có vấn đề - lấy hình thất bại'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n};","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2650,"y":180,"wires":[["26d9760d440f2131","07b06be20d4af512"]]},{"id":"7739d617873d7901","type":"mqtt out","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"","topic":"Mqtt_Image2_Cui","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":2660,"y":340,"wires":[]},{"id":"4e57ea9db37bc990","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Save Image 2","func":"global.set('StoreImage2_Cui',msg.payload)\nif (msg.payload.length > 200){\n    node.send(msg);\n} else {\n    let tempData=global.get('Set_Mqtt_DataAlarm')\n        if(!Array.isArray(tempData)) tempData=[]\n        let data = {\n            Type: 'warning',\n            Message: 'Camera 2 có vấn đề - lấy hình thất bại'\n        }\n        tempData.push(data)\n        global.set('Set_Mqtt_DataAlarm', tempData)\n} ;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2650,"y":300,"wires":[["8f93f3952cf9a602","95aa02d925d08af8"]]},{"id":"bc5cc4c5f675e8dc","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Insert Data","func":"//** INSET DATABASE **//\nvar Variable = global.get(\"Variable\");\nlet Id_2 = 'a' + Math.random().toString(36);\nlet BienSoXe_2 = Variable.ListString[0][30];\nlet PhieuCan_2 = Variable.Number[0][30];\nlet LoaiHang_2 = 'CỦI'; //Variable.ListString[0][24];\nlet DaiDienBenBan_2 = Variable.ListString[0][32];\nlet NguoiBan_2 = Variable.ListString[0][33];\nlet DaiDienBenMua_2 = Variable.ListString[0][34];\nlet DiaChi_DaiDienBenBan_2 = Variable.ListString[0][35];\nlet DiaChi_NguoiBan_2 = Variable.ListString[0][36];\nlet DiaChi_DaiDienBenMua_2 = Variable.ListString[0][37];\nlet GhiChu_2 = Variable.ListString[0][38];\nlet GioCanTong_2 = Variable.ListString[0][39];\nlet GioCanBi_2 = Variable.ListString[0][40];\nlet SoCanTong_2 = Variable.Number[0][31];\nlet SoCanBi_2 = Variable.Number[0][32];\nlet TrongLuongHienTai_2 = Variable.Number[0][33];\nlet PhanTramCuiKho_2 = Variable.Number[0][35];\nlet GiaTienCuiKho_2 = Variable.Number[0][36];\nlet PhanTramCuiTuoi_2 = Variable.Number[0][37];\nlet GiaTienCuiTuoi_2 = Variable.Number[0][38];\nlet TrongLuongCuiKho= Variable.Number[0][34];\nlet TrongLuongCuiTuoi= Variable.Number[0][50];\nlet ThanhTien_2 = Variable.Number[0][39];\nlet Image_CanTong1_2 = global.get('StoreImage1_Cui');\nlet Image_CanTong2_2 = global.get('StoreImage2_Cui');\nlet Image_CanBi1_2 = ''\nlet Image_CanBi2_2 = ''\nmsg.topic = `INSERT INTO TeaCheckWeigh_Cui (\n    _id, BienSoXe, PhieuCan, LoaiHang, DaiDienBenBan, NguoiBan, DaiDienBenMua, DiaChi_DaiDienBenBan, DiaChi_NguoiBan, DiaChi_DaiDienBenMua, GhiChu, GioCanTong, GioCanBi, SoCanTong, SoCanBi, TrongLuongHienTai, PhanTramCuiKho, GiaTienCuiKho, PhanTramCuiTuoi, GiaTienCuiTuoi, TrongLuongCuiKho, TrongLuongCuiTuoi, ThanhTien, Image_CanTong1, Image_CanTong2, Image_CanBi1, Image_CanBi2, TimeCreate)\n    VALUES (\n    $Id_2, $BienSoXe_2, $PhieuCan_2, $LoaiHang_2, $DaiDienBenBan_2, $NguoiBan_2, $DaiDienBenMua_2, $DiaChi_DaiDienBenBan_2, $DiaChi_NguoiBan_2, $DiaChi_DaiDienBenMua_2, $GhiChu_2, $GioCanTong_2, $GioCanBi_2, $SoCanTong_2, $SoCanBi_2, $TrongLuongHienTai_2, $PhanTramCuiKho_2, $GiaTienCuiKho_2, $PhanTramCuiTuoi_2, $GiaTienCuiTuoi_2, $TrongLuongCuiKho, $TrongLuongCuiTuoi, $ThanhTien_2, $Image_CanTong1_2, $Image_CanTong2_2, $Image_CanBi1_2, $Image_CanBi2_2, $TimeCreate)`\nmsg.payload = [Id_2, BienSoXe_2, PhieuCan_2, LoaiHang_2, DaiDienBenBan_2, NguoiBan_2, DaiDienBenMua_2, DiaChi_DaiDienBenBan_2, DiaChi_NguoiBan_2, DiaChi_DaiDienBenMua_2, GhiChu_2, GioCanTong_2, GioCanBi_2, SoCanTong_2, SoCanBi_2, TrongLuongHienTai_2, PhanTramCuiKho_2, GiaTienCuiKho_2, PhanTramCuiTuoi_2, GiaTienCuiTuoi_2, TrongLuongCuiKho, TrongLuongCuiTuoi, ThanhTien_2, Image_CanTong1_2, Image_CanTong2_2, Image_CanBi1_2, Image_CanBi2_2, Date.now()]\nnode.send(msg)","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":700,"y":300,"wires":[["4041e787ebbbbf31"]]},{"id":"4041e787ebbbbf31","type":"sqlite","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"","name":"Execute Insert Data","x":880,"y":300,"wires":[["2dfc0f9febbac860"]]},{"id":"2dfc0f9febbac860","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Success Message","func":"var Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nVariables.Bit[0][47] = false;\nVariables.Number[0][48] = 0;\n\n/// WRITE DATA TO PLC //\nif (VariableSystem.COMMUNICATION_PLC_MODBUS[2]) {\n    VariableSystem.COMMUNICATION_PLC_MODBUS[2].writeSingleCoil(2058, 1).then(function (resp) {\n}, console.error); // RESET BUZZER\n}\n\nlet tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Lưu Số Cân Tổng Thành Công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1080,"y":300,"wires":[["469d6905b31b3cd6"]]},{"id":"469d6905b31b3cd6","type":"link out","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"link out 18","mode":"link","links":["50184f745af805d3","56f7a1daf1ce8017"],"x":1215,"y":300,"wires":[]},{"id":"faa97c144836d350","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Check View Function","func":"/// ** CHECK VIEW FUNCTION ** ///\nvar Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][34] = false; //  NÚT NHẤN INSERT DATA\n}, 500);\nif ((Variables.Bit[0][47] == true) && (Variables.Number[0][48]) > 0 || (Variables.Number[0][47]) > 0) {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'error',\n        Message: 'Đã Cân Tổng Rồi - Cần Tạo Phiếu Cân Mới'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n} else {\n    node.send(msg);\n}\n    \n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":220,"wires":[["6d47e75b4fdba777"]]},{"id":"26d9760d440f2131","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Camera 1 Capture Complete","func":"let tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Camera 1 lấy hình thành công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2890,"y":180,"wires":[[]]},{"id":"8f93f3952cf9a602","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Camera 2 Capture Complete","func":"let tempData = global.get('Set_Mqtt_DataAlarm')\nif (!Array.isArray(tempData)) tempData = []\nlet data = {\n    Type: 'success',\n    Message: 'Camera 2 lấy hình thành công'\n}\ntempData.push(data)\nglobal.set('Set_Mqtt_DataAlarm', tempData)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2890,"y":300,"wires":[[]]},{"id":"6993cc339bb2b9fa","type":"mqtt in","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"","topic":"Mqtt_CheckWeigh_CanTongCui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":1480,"y":240,"wires":[["5f1104e22d43d5f9","c48f2e9008b7c03b"]]},{"id":"c48f2e9008b7c03b","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Disable Cam 1, 2 save","func":"global.set('Save_Camera1',false);\nglobal.set('Save_Camera2',false);\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1730,"y":300,"wires":[[]]},{"id":"07b06be20d4af512","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Enable Save Cam 1","func":"global.set('Save_Camera1',true);\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2860,"y":220,"wires":[[]]},{"id":"95aa02d925d08af8","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Enable Save Cam 2","func":"global.set('Save_Camera2',true);\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2860,"y":260,"wires":[[]]},{"id":"500f8ae4139e699d","type":"function","z":"a933b5fd7ed9762b","g":"e745699e9bf3f6e0","name":"Check Camera","func":"var Variables = global.get(\"Variable\");\nif (global.get('Save_Camera1') && global.get('Save_Camera2')) {\n    node.send(msg);\n} else {\n\n    setTimeout(() => {\n        Variables.Bit[0][34] = false; //  NÚT NHẤN INSERT DATA\n    }, 500);\n    \n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Chờ lấy hình camera'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":280,"wires":[["faa97c144836d350"]]},{"id":"fdf3cae4bdce29d1","type":"function","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","name":"Query Stop Time","func":"global.set('CheckWeigh_Query_Stop_Cui',msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":1200,"wires":[[]]},{"id":"9099851a13b54b6b","type":"mqtt in","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","name":"","topic":"Mqtt_DateTimePicker_StopTime_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":1160,"wires":[["fdf3cae4bdce29d1","6ae6f09b2856a4f9"]]},{"id":"cf97846dcc4d2dcb","type":"mqtt in","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","name":"","topic":"Mqtt_DateTimePicker_StartTime_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":1060,"wires":[["0673b64b0bf10526","da4448a7407fb7d3"]]},{"id":"0673b64b0bf10526","type":"function","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","name":"Query Start Time","func":"global.set('CheckWeigh_Query_Start_Cui',msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":1060,"wires":[[]]},{"id":"1e94ce493695505f","type":"mqtt in","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","name":"","topic":"Mqtt_CheckWeigh_TimPhieuCan_Cui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":1240,"wires":[["34df104c6c1972fb"]]},{"id":"34df104c6c1972fb","type":"function","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","name":"Query DB","func":"var Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nlet start_time_Cui = global.get('CheckWeigh_Query_Start_Cui');\nlet stop_time_Cui = global.get('CheckWeigh_Query_Stop_Cui');\n\nVariables.Bit[0][41] = false;\nVariables.Bit[0][42] = false;\nVariables.Bit[0][43] = false;\nVariables.Bit[0][40] = false;\nVariables.ListString[0][61] = ''; // RESET\nsetTimeout(() => {\n    Variables.Bit[0][36] = false; //   NÚT TÌM PHIẾU CÂN.\n}, 500);\n\nif (Variables.ListString[0][41] && Variables.ListString[0][41].length > 0) {\n    msg.topic = `SELECT * FROM TeaCheckWeigh_Cui WHERE TimeCreate BETWEEN($start_time_Cui) AND($stop_time_Cui) AND DaiDienBenBan = '${Variables.ListString[0][41]}' `\n    msg.payload = [start_time_Cui, stop_time_Cui]\n    node.send(msg);\n    node.warn(msg.topic);\n} else {\n    msg.topic = `SELECT * FROM TeaCheckWeigh_Cui WHERE TimeCreate BETWEEN($start_time_Cui) AND($stop_time_Cui)`\n    msg.payload = [start_time_Cui, stop_time_Cui]\n    node.send(msg);\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":1240,"wires":[["9ea401eef34fb016"]]},{"id":"9ea401eef34fb016","type":"sqlite","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":610,"y":1240,"wires":[["bf43dbe3f523ab77"]]},{"id":"bf43dbe3f523ab77","type":"function","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","name":"StoreQueryGridView","func":"var Variables = global.get(\"Variable\");\nglobal.set('StoreQueryGridView_Cui', msg.payload)\nlet tempData = msg.payload\nif (Variables.Bit[0][42]) {//Check Can Bi > 0\n    msg.payload = tempData.filter(item => item.SoCanBi > 0)\n    Variables.Number[0][40] = msg.payload.length\n    node.send(msg);\n}\nif (Variables.Bit[0][43]) {//Check Can Bi == 0\n    msg.payload = tempData.filter(item => item.SoCanBi == 0)\n    Variables.Number[0][40] = msg.payload.length\n    node.send(msg);\n}\nif (!Variables.Bit[0][42] && !Variables.Bit[0][43]) {\n    Variables.Number[0][40] = msg.payload.length\n    node.send(msg);\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":850,"y":1240,"wires":[["99a5ef98a7e56903"]]},{"id":"da4448a7407fb7d3","type":"mqtt out","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","name":"","topic":"Mqtt_DateTimePicker_StartTime_Cui_CurrentValue","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":600,"y":1100,"wires":[]},{"id":"6ae6f09b2856a4f9","type":"mqtt out","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","name":"","topic":"Mqtt_DateTimePicker_StopTime_Cui_CurrentValue","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":600,"y":1160,"wires":[]},{"id":"28edca8f3474988e","type":"function","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","name":"null","func":"msg.payload = null;\nglobal.set('CheckWeigh_Query_Start_Cui',0)\nglobal.set('CheckWeigh_Query_Stop_Cui',0)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":1100,"wires":[["da4448a7407fb7d3","6ae6f09b2856a4f9"]]},{"id":"bbef2de2fbc5401c","type":"link in","z":"a933b5fd7ed9762b","g":"b0f6064afcacdb86","name":"link in 34","links":["161c753392696654","7058763e40782af6"],"x":185,"y":1100,"wires":[["28edca8f3474988e"]]},{"id":"f3ec12f70da1758a","type":"mqtt in","z":"a933b5fd7ed9762b","g":"3690273b0bdef213","name":"","topic":"Mqtt_CheckWeigh_Check_LanCanTrongNgay_DanhGiaCui","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":280,"y":3100,"wires":[["02f1b120385188ee"]]},{"id":"02f1b120385188ee","type":"function","z":"a933b5fd7ed9762b","g":"3690273b0bdef213","name":"Query DB","func":"\n// Get current date and time\nconst currentDate = new Date();\n\n// Set hours, minutes, seconds, and milliseconds to 0 to get midnight of the current day\ncurrentDate.setHours(0, 0, 0);\n\n// Convert this midnight timestamp to milliseconds\nconst StartTimestamp = currentDate.getTime();\n\n// Get current timestamp\nconst EndTimestamp = Date.now(); // This gives you the current timestamp in milliseconds\n\n// Now you have startTimestamp (beginning of the current day) and endTimestamp (current time)\n// You can use these values to search or perform any operations within this range\nconsole.log(\"Start Timestamp (midnight of current day):\", StartTimestamp);\nconsole.log(\"End Timestamp (current time):\", EndTimestamp);\nnode.warn(StartTimestamp);\nnode.warn(EndTimestamp);\n\nvar Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nlet start_time = StartTimestamp\nlet stop_time = EndTimestamp\nVariables.Number[0][63] = 0; // Mặc định khi bấm nút xem lần cân trong cân.\nsetTimeout(() => {\n    Variables.Bit[0][62] = false; //   NÚT CÁC LẦN CÂN TRONG NGÀY.\n}, 500);\n\nmsg.topic = `SELECT * FROM TeaCheckWeigh_Cui WHERE TimeCreate BETWEEN ($start_time) AND ($stop_time) AND SoCanBi = 0 `\nmsg.payload = [start_time, stop_time]\nnode.send(msg);\nnode.warn(msg.topic);\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":610,"y":3100,"wires":[["30e686d55a5a84ce"]]},{"id":"30e686d55a5a84ce","type":"sqlite","z":"a933b5fd7ed9762b","g":"3690273b0bdef213","mydb":"4da24c56a89316ed","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":790,"y":3100,"wires":[["04251c98d97eb308"]]},{"id":"04251c98d97eb308","type":"function","z":"a933b5fd7ed9762b","g":"3690273b0bdef213","name":"Convert Time","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1010,"y":3100,"wires":[["2f3a6c71a5a737a0"]]},{"id":"2f3a6c71a5a737a0","type":"mqtt out","z":"a933b5fd7ed9762b","g":"3690273b0bdef213","name":"","topic":"Mqtt_CheckWeigh_DataGrid_DanhGiaCui","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1330,"y":3100,"wires":[]},{"id":"56f7a1daf1ce8017","type":"link in","z":"a933b5fd7ed9762b","g":"3690273b0bdef213","name":"link in 37","links":["ddc42efca54c9ece","38edd92f1b2506c6","469d6905b31b3cd6"],"x":465,"y":3180,"wires":[["02f1b120385188ee"]]},{"id":"f222a4c2e0e21c25","type":"function","z":"7168a62b46319832","name":"Convert Time","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":400,"wires":[["4aa412aa8fff9be7"]]},{"id":"f4bdfde8263cfe45","type":"mqtt out","z":"7168a62b46319832","name":"","topic":"Mqtt_CheckWeigh_DataGrid_VO1","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1770,"y":400,"wires":[]},{"id":"c03ef450d1e435af","type":"function","z":"7168a62b46319832","name":"Generate Layout History","func":"let Data = msg.payload[0]\nvar Variable = global.get(\"Variable\");\n\nVariable.Number[0][70] = Data.PhieuCan;\nVariable.ListString[0][70] = Data.BienSoXe;\nVariable.ListString[0][71] = Data.DaiDienBenBan;\nVariable.ListString[0][72] = Data.NguoiBan;\nVariable.ListString[0][73] = Data.DaiDienBenMua;\nVariable.ListString[0][74] = Data.DiaChi_DaiDienBenBan;\nVariable.ListString[0][75] = Data.DiaChi_NguoiBan;\nVariable.ListString[0][76] = Data.DiaChi_DaiDienBenMua;\nVariable.ListString[0][77] = Data.GhiChu;\nVariable.ListString[0][79] = Data.GioCanTong;\nVariable.ListString[0][80] = Data.GioCanBi;\nVariable.Number[0][71] = Data.SoCanTong;\nVariable.Number[0][72] = Data.SoCanBi;\nVariable.Number[0][73] = Data.TrongLuongHienTai;\nVariable.Number[0][75] = Data.PhanTramNuoc;\nVariable.Number[0][74] = Data.TrongLuongThucTe;\nVariable.Number[0][76] = Data.GiaTien;\nVariable.Number[0][77] = Data.ThanhTien;\n\nvar msg1 = { payload: Data.Image_CanTong1 };\nvar msg2 = { payload: Data.Image_CanTong2 };\nvar msg3 = { payload: Data.Image_CanBi1 };\nvar msg4 = { payload: Data.Image_CanBi2 };\n\nnode.send([msg1, msg2, msg3, msg4]);\n","outputs":4,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1320,"y":980,"wires":[["c5f2f2ebac6a6a9d"],["aa84e634de112413"],["6525d2af268504c0"],["1c1b541c8a70ed38"]]},{"id":"c5f2f2ebac6a6a9d","type":"mqtt out","z":"7168a62b46319832","name":"","topic":"Mqtt_Image1_VO1","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1580,"y":920,"wires":[]},{"id":"aa84e634de112413","type":"mqtt out","z":"7168a62b46319832","name":"","topic":"Mqtt_Image2_VO1","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1580,"y":960,"wires":[]},{"id":"6525d2af268504c0","type":"mqtt out","z":"7168a62b46319832","name":"","topic":"Mqtt_Image3_VO1","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1580,"y":1000,"wires":[]},{"id":"1c1b541c8a70ed38","type":"mqtt out","z":"7168a62b46319832","name":"","topic":"Mqtt_Image4_VO1","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1580,"y":1040,"wires":[]},{"id":"f571a9844ee8ecc5","type":"mqtt in","z":"7168a62b46319832","name":"","topic":"Mqtt_CheckWeigh_DataGrid_Response_VO1_Change_Data","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":250,"y":1160,"wires":[["3fd0f134f427d1fa","67a4c9485c345b83"]]},{"id":"3fd0f134f427d1fa","type":"function","z":"7168a62b46319832","name":"Summary Data","func":"function convertToNumber(input) {\n  // Replace period (.) with nothing to remove thousands separator\n  // Replace comma (,) with a period (.) for decimal separator\n  let formattedString = input.replace(/\\./g, '').replace(',', '.');\n  \n  // Convert the formatted string to a number\n  return parseFloat(formattedString);\n}\n\nlet SoCanTong_Sum_VO1 = 0;\nlet SoCanBi_Sum_VO1 = 0;\nlet TrongLuongHienTai_Sum_VO1 = 0;\nlet TrongLuongThucTe_Sum_VO1 = 0;\nlet ThanhTien_Sum_VO1 = 0;\n\nmsg.payload.forEach(function (element) {\n    SoCanTong_Sum_VO1 = SoCanTong_Sum_VO1 + convertToNumber(element.SoCanTong);\n    SoCanBi_Sum_VO1 = SoCanBi_Sum_VO1 + convertToNumber(element.SoCanBi);\n    TrongLuongHienTai_Sum_VO1 = TrongLuongHienTai_Sum_VO1 + convertToNumber(element.TrongLuongHienTai);\n    TrongLuongThucTe_Sum_VO1 = TrongLuongThucTe_Sum_VO1 + convertToNumber(element.TrongLuongThucTe);\n    ThanhTien_Sum_VO1 = ThanhTien_Sum_VO1 + convertToNumber(element.ThanhTien);\n});\nmsg.payload = {\n    data: [{\n        SoCanTong: SoCanTong_Sum_VO1,\n        SoCanBi: SoCanBi_Sum_VO1,\n        TrongLuongHienTai: TrongLuongHienTai_Sum_VO1,\n        TrongLuongThucTe: TrongLuongThucTe_Sum_VO1,\n        ThanhTien: ThanhTien_Sum_VO1,\n    }]\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":630,"y":1160,"wires":[["45577133301078d1"]]},{"id":"45577133301078d1","type":"mqtt out","z":"7168a62b46319832","name":"","topic":"Mqtt_CheckWeigh_DataGrid_Summary_VO1","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":980,"y":1160,"wires":[]},{"id":"67a4c9485c345b83","type":"function","z":"7168a62b46319832","name":"Reset Choice Ticks","func":"var Variables = global.get(\"Variable\");\nif (Variables.ListString[0][81].length > 0) {\n    Variables.Bit[0][70] = false;\n    Variables.Bit[0][71] = false;\n    Variables.Bit[0][72] = false;\n    Variables.Bit[0][77] = false;\n}\nVariables.Number[0][78] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":640,"y":1220,"wires":[[]]},{"id":"1a708703c7292eea","type":"link out","z":"7168a62b46319832","name":"link out 23","mode":"link","links":["9d214199d5f73edd","718f0add1bd383bf"],"x":755,"y":380,"wires":[]},{"id":"14a50b8ac0f77b10","type":"mqtt out","z":"7168a62b46319832","name":"","topic":"Mqtt_Image1_VO1","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1600,"y":520,"wires":[]},{"id":"a41d97f2a8159c42","type":"mqtt out","z":"7168a62b46319832","name":"","topic":"Mqtt_Image2_VO1","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1600,"y":560,"wires":[]},{"id":"134e42cfa41e54d4","type":"mqtt out","z":"7168a62b46319832","name":"","topic":"Mqtt_Image3_VO1","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1600,"y":620,"wires":[]},{"id":"47d891d1e9a32e0a","type":"mqtt out","z":"7168a62b46319832","name":"","topic":"Mqtt_Image4_VO1","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1600,"y":660,"wires":[]},{"id":"718f0add1bd383bf","type":"link in","z":"7168a62b46319832","name":"link in 45","links":["1a708703c7292eea","f85f899191469e22"],"x":1415,"y":600,"wires":[["14a50b8ac0f77b10","a41d97f2a8159c42","134e42cfa41e54d4","47d891d1e9a32e0a"]]},{"id":"4aa412aa8fff9be7","type":"function","z":"7168a62b46319832","name":"Delete Images","func":"/// DELETE 4 COLUMNS ///\n\nlet TempTable = msg.payload.data\nTempTable.forEach(obj => {\n  delete obj.Image_CanTong1;\n  delete obj.Image_CanTong2;\n  delete obj.Image_CanBi1;\n  delete obj.Image_CanBi2;\n});\nmsg.payload = { data: TempTable }\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1510,"y":400,"wires":[["f4bdfde8263cfe45"]]},{"id":"82927573c29f30f3","type":"function","z":"7168a62b46319832","g":"807926c678ce52c6","name":"Query Stop Time","func":"global.set('CheckWeigh_Query_Stop_VO1',msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":460,"y":200,"wires":[[]]},{"id":"d54edfc8a3541aed","type":"mqtt in","z":"7168a62b46319832","g":"807926c678ce52c6","name":"","topic":"Mqtt_DateTimePicker_StopTime_VO1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":160,"wires":[["82927573c29f30f3","dace1637b5f99d13"]]},{"id":"a41c2c61ff2a4d0b","type":"mqtt in","z":"7168a62b46319832","g":"807926c678ce52c6","name":"","topic":"Mqtt_DateTimePicker_StartTime_VO1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":60,"wires":[["134e3d16c90c39d7","6a4bada7a1f80962"]]},{"id":"134e3d16c90c39d7","type":"function","z":"7168a62b46319832","g":"807926c678ce52c6","name":"Query Start Time","func":"global.set('CheckWeigh_Query_Start_VO1',msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":60,"wires":[[]]},{"id":"5b0d5926567ed0aa","type":"mqtt in","z":"7168a62b46319832","g":"807926c678ce52c6","name":"","topic":"Mqtt_CheckWeigh_TimPhieuCan_VO1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":240,"wires":[["0e0ac98171259bad"]]},{"id":"0e0ac98171259bad","type":"function","z":"7168a62b46319832","g":"807926c678ce52c6","name":"Query DB","func":"var Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nlet start_time = global.get('CheckWeigh_Query_Start_VO1');\nlet stop_time = global.get('CheckWeigh_Query_Stop_VO1');\n\nVariables.Bit[0][70] = false;\nVariables.Bit[0][71] = false;\nVariables.Bit[0][72] = false;\nVariables.Bit[0][77] = false;\nVariables.ListString[0][81] = ''; // RESET\nsetTimeout(() => {\n    Variables.Bit[0][73] = false; //   NÚT TÌM PHIẾU CÂN.\n}, 500);\n\nif (Variables.ListString[0][78] && Variables.ListString[0][78].length > 0) {\n    msg.topic = `SELECT * FROM TeaCheckWeigh WHERE TimeCreate BETWEEN($start_time) AND($stop_time) AND DaiDienBenBan = '${Variables.ListString[0][78]}' `\n    msg.payload = [start_time, stop_time]\n    node.send(msg);\n    node.warn(msg.topic);\n} else {\n    msg.topic = `SELECT * FROM TeaCheckWeigh WHERE TimeCreate BETWEEN($start_time) AND($stop_time)`\n    msg.payload = [start_time, stop_time]\n    node.send(msg);\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":240,"wires":[["fba71ac808c3dce7"]]},{"id":"fba71ac808c3dce7","type":"sqlite","z":"7168a62b46319832","g":"807926c678ce52c6","mydb":"1fb1d414ca07ad2c","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":610,"y":240,"wires":[["55806c535c6021e5"]]},{"id":"55806c535c6021e5","type":"function","z":"7168a62b46319832","g":"807926c678ce52c6","name":"StoreQueryGridView","func":"var Variables = global.get(\"Variable\");\nglobal.set('StoreQueryGridView_VO1', msg.payload)\n\nlet tempData = msg.payload\nif (Variables.Bit[0][71]) {//Check Can Bi > 0\n    msg.payload = tempData.filter(item => item.SoCanBi > 0)\n    Variables.Number[0][78] = msg.payload.length\n    node.send(msg);\n}\nif (Variables.Bit[0][72]) {//Check Can Bi == 0\n    msg.payload = tempData.filter(item => item.SoCanBi == 0)\n    Variables.Number[0][78] = msg.payload.length\n    node.send(msg);\n}\nif (!Variables.Bit[0][71] && !Variables.Bit[0][72]) {\n    Variables.Number[0][78] = msg.payload.length\n    node.send(msg);\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":850,"y":240,"wires":[["f222a4c2e0e21c25"]]},{"id":"6a4bada7a1f80962","type":"mqtt out","z":"7168a62b46319832","g":"807926c678ce52c6","name":"","topic":"Mqtt_DateTimePicker_StartTime_VO1_CurrentValue","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":630,"y":100,"wires":[]},{"id":"dace1637b5f99d13","type":"mqtt out","z":"7168a62b46319832","g":"807926c678ce52c6","name":"","topic":"Mqtt_DateTimePicker_StopTime_VO1_CurrentValue","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":630,"y":160,"wires":[]},{"id":"0f561a2a8aadf63a","type":"function","z":"7168a62b46319832","g":"807926c678ce52c6","name":"null","func":"msg.payload = null;\nglobal.set('CheckWeigh_Query_Start_VO1',0)\nglobal.set('CheckWeigh_Query_Stop_VO1',0)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":300,"y":100,"wires":[["6a4bada7a1f80962","dace1637b5f99d13"]]},{"id":"9d214199d5f73edd","type":"link in","z":"7168a62b46319832","g":"807926c678ce52c6","name":"link in 41","links":["1a708703c7292eea"],"x":205,"y":100,"wires":[["0f561a2a8aadf63a"]]},{"id":"e164fcf39dd744cd","type":"mqtt in","z":"7168a62b46319832","g":"a0ae0a6f6a73176c","name":"","topic":"Mqtt_CheckWeigh_XoaTimKiem_VO1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":340,"wires":[["61ce87e6193f74f3"]]},{"id":"61ce87e6193f74f3","type":"function","z":"7168a62b46319832","g":"a0ae0a6f6a73176c","name":"Query DB","func":"var Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nVariables.ListString[0][78] = ''; // RESET\nVariables.Number[0][78] = 0; // RESET\nVariables.Number[0][79] = 0; // RESET\nVariables.ListString[0][81] = ''; // RESET\nsetTimeout(() => {\n    Variables.Bit[0][74] = false; //   NÚT XÓA TÌM KIẾM.\n}, 500);\n\nmsg.payload = []\nnode.send(msg);","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":610,"y":340,"wires":[["f222a4c2e0e21c25","1a708703c7292eea"]]},{"id":"bfabc4152cb7e69e","type":"mqtt in","z":"7168a62b46319832","g":"05f42549fc5b28af","name":"","topic":"Mqtt_CheckWeigh_Check_Phieu2Lan_VO1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":500,"wires":[["0c37073e1675086d"]]},{"id":"a4743d75207e37ef","type":"mqtt in","z":"7168a62b46319832","g":"05f42549fc5b28af","name":"","topic":"Mqtt_CheckWeigh_Check_All_VO1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":440,"wires":[["b59b5b2bbca2d0fc"]]},{"id":"b59b5b2bbca2d0fc","type":"function","z":"7168a62b46319832","g":"05f42549fc5b28af","name":"Filter","func":"var Variables = global.get(\"Variable\");\nVariables.Bit[0][70] = true;\nVariables.Bit[0][71] = false;\nVariables.Bit[0][72] = false;\nVariables.Bit[0][77] = false;\nVariables.ListString[0][81] = ''; // RESET\nmsg.payload = global.get('StoreQueryGridView_VO1')\nVariables.Number[0][78] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":440,"wires":[["f222a4c2e0e21c25"]]},{"id":"0c37073e1675086d","type":"function","z":"7168a62b46319832","g":"05f42549fc5b28af","name":"Filter","func":"var Variables = global.get(\"Variable\");\nVariables.Bit[0][70] = false;\nVariables.Bit[0][71] = true;\nVariables.Bit[0][72] = false;\nVariables.Bit[0][77] = false;\nVariables.ListString[0][81] = ''; // RESET\nmsg.payload = global.get('StoreQueryGridView_VO1').filter(item => item.SoCanBi > 0)\nVariables.Number[0][78] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":500,"wires":[["f222a4c2e0e21c25"]]},{"id":"0402696a6393f795","type":"mqtt in","z":"7168a62b46319832","g":"05f42549fc5b28af","name":"","topic":"Mqtt_CheckWeigh_Check_Phieu1Lan_VO1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":560,"wires":[["2d7f93a821034675"]]},{"id":"2d7f93a821034675","type":"function","z":"7168a62b46319832","g":"05f42549fc5b28af","name":"Filter","func":"var Variables = global.get(\"Variable\");\nVariables.Bit[0][70] = false;\nVariables.Bit[0][71] = false;\nVariables.Bit[0][72] = true;\nVariables.Bit[0][77] = false;\nVariables.ListString[0][81] = ''; // RESET\nmsg.payload = global.get('StoreQueryGridView_VO1').filter(item => item.SoCanBi == 0)\nVariables.Number[0][78] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":560,"wires":[["f222a4c2e0e21c25"]]},{"id":"93f9065f57830dbe","type":"mqtt in","z":"7168a62b46319832","g":"8e0b4d610b7d21e0","name":"","topic":"Mqtt_CheckWeigh_Check_LanCanTrongNgay_VO1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":240,"y":660,"wires":[["d39eaa9be9566c27"]]},{"id":"337f77872445aacc","type":"link in","z":"7168a62b46319832","g":"8e0b4d610b7d21e0","name":"link in 42","links":[],"x":455,"y":700,"wires":[["d39eaa9be9566c27"]]},{"id":"d39eaa9be9566c27","type":"function","z":"7168a62b46319832","g":"8e0b4d610b7d21e0","name":"Query DB","func":"\n// Get current date and time\nconst currentDate = new Date();\n\n// Set hours, minutes, seconds, and milliseconds to 0 to get midnight of the current day\ncurrentDate.setHours(0, 0, 0);\n\n// Convert this midnight timestamp to milliseconds\nconst StartTimestamp = currentDate.getTime();\n\n// Get current timestamp\nconst EndTimestamp = Date.now(); // This gives you the current timestamp in milliseconds\n\n// Now you have startTimestamp (beginning of the current day) and endTimestamp (current time)\n// You can use these values to search or perform any operations within this range\nconsole.log(\"Start Timestamp (midnight of current day):\", StartTimestamp);\nconsole.log(\"End Timestamp (current time):\", EndTimestamp);\nnode.warn(StartTimestamp);\nnode.warn(EndTimestamp);\n\nvar Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nlet start_time = StartTimestamp\nlet stop_time = EndTimestamp\n\nsetTimeout(() => {\n    Variables.Bit[0][77] = false; //   NÚT CÁC LẦN CÂN TRONG NGÀY.\n}, 500);\nVariables.ListString[0][81] = ''; // RESET\nmsg.topic = `SELECT * FROM TeaCheckWeigh WHERE TimeCreate BETWEEN ($start_time) AND ($stop_time) `\nmsg.payload = [start_time, stop_time]\nnode.send(msg);\nnode.warn(msg.topic);\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":590,"y":660,"wires":[["d08d532747632164"]]},{"id":"d08d532747632164","type":"sqlite","z":"7168a62b46319832","g":"8e0b4d610b7d21e0","mydb":"1fb1d414ca07ad2c","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":850,"y":660,"wires":[["0cb8c190329ba3f9"]]},{"id":"0cb8c190329ba3f9","type":"function","z":"7168a62b46319832","g":"8e0b4d610b7d21e0","name":"Filter","func":"var Variables = global.get(\"Variable\");\nglobal.set('StoreQueryGridView_VO1', msg.payload)\nVariables.Bit[0][70] = false;\nVariables.Bit[0][71] = false;\nVariables.Bit[0][72] = false;\nVariables.Number[0][78] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1040,"y":660,"wires":[["f222a4c2e0e21c25"]]},{"id":"e30d0ffcb247519f","type":"function","z":"7168a62b46319832","g":"f2be9b36b3a5153d","name":"Export Excel","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][75] = false; //   NÚT XUẤT EXCEL\n}, 500);\nmsg.payload = {\n    exportExcel: 1\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":800,"wires":[["33f16849951e6b40"]]},{"id":"0eea6b74a0bc21f5","type":"mqtt in","z":"7168a62b46319832","g":"f2be9b36b3a5153d","name":"","topic":"Mqtt_CheckWeigh_ExportExcel_VO1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":800,"wires":[["e30d0ffcb247519f"]]},{"id":"33f16849951e6b40","type":"mqtt out","z":"7168a62b46319832","g":"f2be9b36b3a5153d","name":"","topic":"Mqtt_CheckWeigh_DataGrid_VO1","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":750,"y":800,"wires":[]},{"id":"e18583aad6643ebd","type":"mqtt in","z":"7168a62b46319832","g":"625c62fffb738971","name":"","topic":"Mqtt_CheckWeigh_DataGrid_Response_VO1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":220,"y":1040,"wires":[["6a18da8244c4c225","23073acf2ac69b65"]]},{"id":"6a18da8244c4c225","type":"function","z":"7168a62b46319832","g":"625c62fffb738971","name":"Get Data Current Row","func":"msg.payload[0] = msg.payload.record;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":550,"y":1040,"wires":[["e21c7bd934ebb743"]]},{"id":"e21c7bd934ebb743","type":"function","z":"7168a62b46319832","g":"625c62fffb738971","name":"Query DB Get 4 Images","func":"\nlet data=msg.payload[0]\nmsg.topic = `SELECT * FROM TeaCheckWeigh WHERE PhieuCan=\"${data.PhieuCan}\"`\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":1040,"wires":[["d1173ef87404f0f2"]]},{"id":"d1173ef87404f0f2","type":"sqlite","z":"7168a62b46319832","g":"625c62fffb738971","mydb":"1fb1d414ca07ad2c","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":1010,"y":1040,"wires":[["c03ef450d1e435af"]]},{"id":"23073acf2ac69b65","type":"function","z":"7168a62b46319832","g":"625c62fffb738971","name":"Reset value","func":"msg.payload = \" \"\nreturn msg\n\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":540,"y":1100,"wires":[["f85f899191469e22"]]},{"id":"f85f899191469e22","type":"link out","z":"7168a62b46319832","g":"625c62fffb738971","name":"link out 25","mode":"link","links":["718f0add1bd383bf"],"x":645,"y":1100,"wires":[]},{"id":"59f72150a0f24ba1","type":"mqtt in","z":"7168a62b46319832","g":"67dd845a8177ff20","name":"","topic":"Mqtt_CheckWeigh_Check_XemPhieu_VO1","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":900,"wires":[["57f7f1f8b92b30c7"]]},{"id":"57f7f1f8b92b30c7","type":"function","z":"7168a62b46319832","g":"67dd845a8177ff20","name":"Query DB","func":"var Variables = global.get(\"Variable\");\n\nVariables.ListString[0][81] = ''; // RESET\nsetTimeout(() => {\n    Variables.Bit[0][76] = false; //   NÚT TÌM PHIẾU CÂN.\n}, 500);\n\nif (Variables.Number[0][79] > 0) {\n    msg.topic = `SELECT * FROM TeaCheckWeigh WHERE PhieuCan = '${Variables.Number[0][79]}' `\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Chưa Nhập Số Phiếu Cần Tìm'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":900,"wires":[["f9485e5a2541f965"]]},{"id":"f9485e5a2541f965","type":"sqlite","z":"7168a62b46319832","g":"67dd845a8177ff20","mydb":"1fb1d414ca07ad2c","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":650,"y":900,"wires":[["c03ef450d1e435af"]]},{"id":"e2cb9f63086aae34","type":"function","z":"30ede05c4a2bcbbc","name":"Convert Time","func":"function convertTimestamps(dataArray) {\n    return dataArray.map(item => {\n        let date = new Date(item.TimeCreate);\n        let currDate = new Date(date.toLocaleString('en-US', { timeZone: \"Asia/Ho_Chi_Minh\" }));\n\n        // Format the date part (Day/Month/Year)\n        let day = currDate.getDate();\n        let month = currDate.getMonth() + 1; // Months are zero based\n        let year = currDate.getFullYear();\n        let datePart = `${(day < 10 ? '0' : '')}${day}-${(month < 10 ? '0' : '')}${month}-${year}`;\n\n        // Format the time part (Hour-Minute-Second)\n        let hour = currDate.getHours();\n        let minute = currDate.getMinutes();\n        let second = currDate.getSeconds();\n        let timePart = `${(hour < 10 ? '0' : '')}${hour}:${(minute < 10 ? '0' : '')}${minute}:${(second < 10 ? '0' : '')}${second}`;\n\n        // Combine date and time parts\n        let ConvertTime = `${datePart}   ${timePart}`;\n\n        return { ...item, TimeCreate: ConvertTime };\n    });\n}\n\nvar currentdate = new Date();\nvar datetime = currentdate.getDate() + \"/\"\n    + (currentdate.getMonth() + 1) + \"/\"\n    + currentdate.getFullYear() + \" _ \"\n    + currentdate.getHours() + \":\"\n    + currentdate.getMinutes() + \":\"\n    + currentdate.getSeconds();\n\nmsg.payload = {\n    data: convertTimestamps(msg.payload),\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":400,"wires":[["faa0936cb143c727"]]},{"id":"514e2d8b91cd59c4","type":"mqtt out","z":"30ede05c4a2bcbbc","name":"","topic":"Mqtt_CheckWeigh_DataGrid_VO2","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1770,"y":400,"wires":[]},{"id":"5f8957437b5e96d8","type":"function","z":"30ede05c4a2bcbbc","name":"Generate Layout History","func":"let Data = msg.payload[0]\nvar Variable = global.get(\"Variable\");\n\nVariable.Number[0][90] = Data.PhieuCan;\nVariable.ListString[0][90] = Data.BienSoXe;\nVariable.ListString[0][91] = Data.DaiDienBenBan;\nVariable.ListString[0][92] = Data.NguoiBan;\nVariable.ListString[0][93] = Data.DaiDienBenMua;\nVariable.ListString[0][94] = Data.DiaChi_DaiDienBenBan;\nVariable.ListString[0][95] = Data.DiaChi_NguoiBan;\nVariable.ListString[0][96] = Data.DiaChi_DaiDienBenMua;\nVariable.ListString[0][97] = Data.GhiChu;\nVariable.ListString[0][98] = Data.GioCanTong;\nVariable.ListString[0][99] = Data.GioCanBi;\nVariable.Number[0][91] = Data.SoCanTong;\nVariable.Number[0][92] = Data.SoCanBi;\nVariable.Number[0][93] = Data.TrongLuongHienTai;\nVariable.Number[0][95] = Data.PhanTramCuiKho;\nVariable.Number[0][97] = Data.PhanTramCuiTuoi;\nVariable.Number[0][94] = Data.TrongLuongCuiKho;\nVariable.Number[0][102] = Data.TrongLuongCuiTuoi;\nVariable.Number[0][96] = Data.GiaTienCuiKho;\nVariable.Number[0][98] = Data.GiaTienCuiTuoi;\nVariable.Number[0][99] = Data.ThanhTien;\n\nvar msg1 = { payload: Data.Image_CanTong1 };\nvar msg2 = { payload: Data.Image_CanTong2 };\nvar msg3 = { payload: Data.Image_CanBi1 };\nvar msg4 = { payload: Data.Image_CanBi2 };\n\nnode.send([msg1, msg2, msg3, msg4]);\n","outputs":4,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1260,"y":980,"wires":[["0cc450ba118e7103"],["f5d5465ccdc8c54a"],["218c10672dbf577d"],["5acc5f11ad2463b3"]]},{"id":"0cc450ba118e7103","type":"mqtt out","z":"30ede05c4a2bcbbc","name":"","topic":"Mqtt_Image1_VO2","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":920,"wires":[]},{"id":"f5d5465ccdc8c54a","type":"mqtt out","z":"30ede05c4a2bcbbc","name":"","topic":"Mqtt_Image2_VO2","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":960,"wires":[]},{"id":"218c10672dbf577d","type":"mqtt out","z":"30ede05c4a2bcbbc","name":"","topic":"Mqtt_Image3_VO2","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":1000,"wires":[]},{"id":"5acc5f11ad2463b3","type":"mqtt out","z":"30ede05c4a2bcbbc","name":"","topic":"Mqtt_Image4_VO2","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":1040,"wires":[]},{"id":"596801ca73ed658a","type":"mqtt in","z":"30ede05c4a2bcbbc","name":"","topic":"Mqtt_CheckWeigh_DataGrid_Response_VO2_Change_Data","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":250,"y":1160,"wires":[["ff180eeedf59e681","e219b102e0bba52b"]]},{"id":"ff180eeedf59e681","type":"function","z":"30ede05c4a2bcbbc","name":"Summary Data","func":"function convertToNumber(input) {\n    // Replace period (.) with nothing to remove thousands separator\n    // Replace comma (,) with a period (.) for decimal separator\n    if (input) {\n        let formattedString = input.replace(/\\./g, '').replace(',', '.');\n        // Convert the formatted string to a number\n        return parseFloat(formattedString);\n    }else{\n        return 0\n    }\n\n}\n\nlet SoCanTong_Sum_VO2 = 0;\nlet SoCanBi_Sum_VO2 = 0;\nlet TrongLuongHienTai_Sum_VO2 = 0;\nlet TrongLuongCuiKho_Sum_VO2 = 0;\nlet TrongLuongCuiTuoi_Sum_VO2 = 0;\nlet ThanhTien_Sum_VO2 = 0;\n\nmsg.payload.forEach(function (element) {\n    SoCanTong_Sum_VO2 = SoCanTong_Sum_VO2 + convertToNumber(element.SoCanTong);\n    SoCanBi_Sum_VO2 = SoCanBi_Sum_VO2 + convertToNumber(element.SoCanBi);\n    TrongLuongHienTai_Sum_VO2 = TrongLuongHienTai_Sum_VO2 + convertToNumber(element.TrongLuongHienTai);\n    TrongLuongCuiKho_Sum_VO2 = TrongLuongCuiKho_Sum_VO2 + convertToNumber(element.TrongLuongCuiKho);\n    TrongLuongCuiTuoi_Sum_VO2 = TrongLuongCuiTuoi_Sum_VO2 + convertToNumber(element.TrongLuongCuiTuoi);\n    ThanhTien_Sum_VO2 = ThanhTien_Sum_VO2 + convertToNumber(element.ThanhTien);\n});\nmsg.payload = {\n    data: [{\n        SoCanTong: (SoCanTong_Sum_VO2).toFixed(0),\n        SoCanBi: (SoCanBi_Sum_VO2).toFixed(0),\n        TrongLuongHienTai: TrongLuongHienTai_Sum_VO2,\n        TrongLuongCuiKho: TrongLuongCuiKho_Sum_VO2,\n        TrongLuongCuiTuoi: TrongLuongCuiTuoi_Sum_VO2,\n        ThanhTien: ThanhTien_Sum_VO2,\n    }]\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":630,"y":1160,"wires":[["08d84b27efad853a"]]},{"id":"08d84b27efad853a","type":"mqtt out","z":"30ede05c4a2bcbbc","name":"","topic":"Mqtt_CheckWeigh_DataGrid_Summary_VO2","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":980,"y":1160,"wires":[]},{"id":"e219b102e0bba52b","type":"function","z":"30ede05c4a2bcbbc","name":"Reset Choice Ticks","func":"var Variables = global.get(\"Variable\");\nif (Variables.ListString[0][101].length > 0) {\n    Variables.Bit[0][90] = false;\n    Variables.Bit[0][91] = false;\n    Variables.Bit[0][92] = false;\n    Variables.Bit[0][97] = false;\n}\nVariables.Number[0][100] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":640,"y":1220,"wires":[[]]},{"id":"2aa390b97d50c6a1","type":"link out","z":"30ede05c4a2bcbbc","name":"link out 24","mode":"link","links":["5680c9f3f1ac1015","69ec631c330598bd"],"x":755,"y":380,"wires":[]},{"id":"b0f06606f0655895","type":"inject","z":"30ede05c4a2bcbbc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1100,"y":40,"wires":[["cd60f5513bfb98af"]]},{"id":"cd60f5513bfb98af","type":"trigger","z":"30ede05c4a2bcbbc","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-500","extend":false,"overrideDelay":false,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":1310,"y":40,"wires":[["c6508595308a5719"]]},{"id":"c6508595308a5719","type":"function","z":"30ede05c4a2bcbbc","name":"Get Weigh","func":"var Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\n\nVariables.Number[0][105] = (Variables.Number[0][99] / Variables.Number[0][93]).toFixed(0); // GIÁ MUA BÌNH QUÂN.\nVariables.Number[0][106] = (Variables.Number[0][94] * Variables.Number[0][96]).toFixed(0); // THÀNH TIỀN CỦI KHÔ.\nVariables.Number[0][107] = (Variables.Number[0][102] * Variables.Number[0][98]).toFixed(0); // THÀNH TIỀN CỦI TƯƠI.","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1540,"y":40,"wires":[[]]},{"id":"79cff11b2baa1e06","type":"mqtt out","z":"30ede05c4a2bcbbc","name":"","topic":"Mqtt_Image1_VO2","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":520,"wires":[]},{"id":"d7078079d6302de1","type":"mqtt out","z":"30ede05c4a2bcbbc","name":"","topic":"Mqtt_Image2_VO2","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":560,"wires":[]},{"id":"524604ec2772ab37","type":"mqtt out","z":"30ede05c4a2bcbbc","name":"","topic":"Mqtt_Image3_VO2","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":600,"wires":[]},{"id":"e5b75368cb3f5f90","type":"mqtt out","z":"30ede05c4a2bcbbc","name":"","topic":"Mqtt_Image4_VO2","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":1520,"y":640,"wires":[]},{"id":"69ec631c330598bd","type":"link in","z":"30ede05c4a2bcbbc","name":"link in 46","links":["2aa390b97d50c6a1","7b99864a1a079f4b"],"x":1295,"y":580,"wires":[["79cff11b2baa1e06","d7078079d6302de1","524604ec2772ab37","e5b75368cb3f5f90"]]},{"id":"faa0936cb143c727","type":"function","z":"30ede05c4a2bcbbc","name":"Delete Images","func":"/// DELETE 4 COLUMNS ///\n\nlet TempTable = msg.payload.data\nTempTable.forEach(obj => {\n  delete obj.Image_CanTong1;\n  delete obj.Image_CanTong2;\n  delete obj.Image_CanBi1;\n  delete obj.Image_CanBi2;\n});\nmsg.payload = { data: TempTable }\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1510,"y":400,"wires":[["514e2d8b91cd59c4"]]},{"id":"d78811bd8b880154","type":"function","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","name":"Query Stop Time","func":"global.set('CheckWeigh_Query_Stop_VO2',msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":460,"y":200,"wires":[[]]},{"id":"b7a628e8c4f7b7aa","type":"mqtt in","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","name":"","topic":"Mqtt_DateTimePicker_StopTime_VO2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":160,"wires":[["d78811bd8b880154","1fb34dc5801aad67"]]},{"id":"28bbd4c1982ef2f4","type":"mqtt in","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","name":"","topic":"Mqtt_DateTimePicker_StartTime_VO2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":60,"wires":[["377a7bcd3a3a5a14","957171f76dcb450c"]]},{"id":"377a7bcd3a3a5a14","type":"function","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","name":"Query Start Time","func":"global.set('CheckWeigh_Query_Start_VO2',msg.payload)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":60,"wires":[[]]},{"id":"cf126be0701ea591","type":"mqtt in","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","name":"","topic":"Mqtt_CheckWeigh_TimPhieuCan_VO2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":240,"wires":[["627121881939311a"]]},{"id":"627121881939311a","type":"function","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","name":"Query DB","func":"var Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nlet start_time = global.get('CheckWeigh_Query_Start_VO2');\nlet stop_time = global.get('CheckWeigh_Query_Stop_VO2');\n\nVariables.Bit[0][90] = false;\nVariables.Bit[0][91] = false;\nVariables.Bit[0][92] = false;\nVariables.Bit[0][97] = false;\nVariables.ListString[0][101] = ''; // RESET\nsetTimeout(() => {\n    Variables.Bit[0][93] = false; //   NÚT TÌM PHIẾU CÂN.\n}, 500);\n\nif (Variables.ListString[0][100] && Variables.ListString[0][100].length > 0) {\n    msg.topic = `SELECT * FROM TeaCheckWeigh_Cui WHERE TimeCreate BETWEEN($start_time) AND($stop_time) AND DaiDienBenBan = '${Variables.ListString[0][100]}' `\n    msg.payload = [start_time, stop_time]\n    node.send(msg);\n    node.warn(msg.topic);\n} else {\n    msg.topic = `SELECT * FROM TeaCheckWeigh_Cui WHERE TimeCreate BETWEEN($start_time) AND($stop_time)`\n    msg.payload = [start_time, stop_time]\n    node.send(msg);\n}\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":240,"wires":[["2cd7d757f59fea65"]]},{"id":"2cd7d757f59fea65","type":"sqlite","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","mydb":"4cabebdcc173f658","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":610,"y":240,"wires":[["43d6e7115584daa6"]]},{"id":"43d6e7115584daa6","type":"function","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","name":"StoreQueryGridView","func":"var Variables = global.get(\"Variable\");\nglobal.set('StoreQueryGridView_VO2', msg.payload)\n\nlet tempData = msg.payload\nif (Variables.Bit[0][91]) {//Check Can Bi > 0\n    msg.payload = tempData.filter(item => item.SoCanBi > 0)\n    Variables.Number[0][100] = msg.payload.length\n    node.send(msg);\n}\nif (Variables.Bit[0][92]) {//Check Can Bi == 0\n    msg.payload = tempData.filter(item => item.SoCanBi == 0)\n    Variables.Number[0][100] = msg.payload.length\n    node.send(msg);\n}\nif (!Variables.Bit[0][91] && !Variables.Bit[0][92]) {\n    Variables.Number[0][100] = msg.payload.length\n    node.send(msg);\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":850,"y":240,"wires":[["e2cb9f63086aae34"]]},{"id":"957171f76dcb450c","type":"mqtt out","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","name":"","topic":"Mqtt_DateTimePicker_StartTime_VO2_CurrentValue","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":630,"y":100,"wires":[]},{"id":"1fb34dc5801aad67","type":"mqtt out","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","name":"","topic":"Mqtt_DateTimePicker_StopTime_VO2_CurrentValue","qos":"1","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":630,"y":160,"wires":[]},{"id":"092f063c63315a9d","type":"function","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","name":"null","func":"msg.payload = null;\nglobal.set('CheckWeigh_Query_Start_VO2',0)\nglobal.set('CheckWeigh_Query_Stop_VO2',0)\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":300,"y":100,"wires":[["957171f76dcb450c","1fb34dc5801aad67"]]},{"id":"5680c9f3f1ac1015","type":"link in","z":"30ede05c4a2bcbbc","g":"abd82c3f30e9608d","name":"link in 43","links":["2aa390b97d50c6a1"],"x":205,"y":100,"wires":[["092f063c63315a9d"]]},{"id":"c8d5ceac4a39cfe4","type":"mqtt in","z":"30ede05c4a2bcbbc","g":"44434626bc9ac8f2","name":"","topic":"Mqtt_CheckWeigh_XoaTimKiem_VO2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":340,"wires":[["48cb516c008e0b7b"]]},{"id":"48cb516c008e0b7b","type":"function","z":"30ede05c4a2bcbbc","g":"44434626bc9ac8f2","name":"Query DB","func":"var Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nVariables.ListString[0][100] = ''; // RESET\nVariables.Number[0][100] = 0; // RESET\nVariables.Number[0][101] = 0; // RESET\nVariables.ListString[0][101] = ''; // RESET\nsetTimeout(() => {\n    Variables.Bit[0][94] = false; //   NÚT XÓA TÌM KIẾM.\n}, 500);\n\nmsg.payload = []\nnode.send(msg);","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":610,"y":340,"wires":[["e2cb9f63086aae34","2aa390b97d50c6a1"]]},{"id":"95c4ab3c9bc4c113","type":"mqtt in","z":"30ede05c4a2bcbbc","g":"34de929a3139f5a5","name":"","topic":"Mqtt_CheckWeigh_Check_Phieu2Lan_VO2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":500,"wires":[["e6ca3384d59fbd5d"]]},{"id":"da91b118563e2f87","type":"mqtt in","z":"30ede05c4a2bcbbc","g":"34de929a3139f5a5","name":"","topic":"Mqtt_CheckWeigh_Check_All_VO2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":440,"wires":[["ffcce35ddef5e5b7"]]},{"id":"ffcce35ddef5e5b7","type":"function","z":"30ede05c4a2bcbbc","g":"34de929a3139f5a5","name":"Filter","func":"var Variables = global.get(\"Variable\");\nVariables.Bit[0][90] = true;\nVariables.Bit[0][91] = false;\nVariables.Bit[0][92] = false;\nVariables.Bit[0][97] = false;\nVariables.ListString[0][101] = ''; // RESET\nmsg.payload = global.get('StoreQueryGridView_VO2')\nVariables.Number[0][100] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":440,"wires":[["e2cb9f63086aae34"]]},{"id":"e6ca3384d59fbd5d","type":"function","z":"30ede05c4a2bcbbc","g":"34de929a3139f5a5","name":"Filter","func":"var Variables = global.get(\"Variable\");\nVariables.Bit[0][90] = false;\nVariables.Bit[0][91] = true;\nVariables.Bit[0][92] = false;\nVariables.Bit[0][97] = false;\nVariables.ListString[0][101] = ''; // RESET\nmsg.payload = global.get('StoreQueryGridView_VO2').filter(item => item.SoCanBi > 0)\nVariables.Number[0][100] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":500,"wires":[["e2cb9f63086aae34"]]},{"id":"13da34727aa8c046","type":"mqtt in","z":"30ede05c4a2bcbbc","g":"34de929a3139f5a5","name":"","topic":"Mqtt_CheckWeigh_Check_Phieu1Lan_VO2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":560,"wires":[["9ab1b5b2f774aac7"]]},{"id":"9ab1b5b2f774aac7","type":"function","z":"30ede05c4a2bcbbc","g":"34de929a3139f5a5","name":"Filter","func":"var Variables = global.get(\"Variable\");\nVariables.Bit[0][90] = false;\nVariables.Bit[0][91] = false;\nVariables.Bit[0][92] = true;\nVariables.Bit[0][97] = false;\nVariables.ListString[0][101] = ''; // RESET\nmsg.payload = global.get('StoreQueryGridView_VO2').filter(item => item.SoCanBi == 0)\nVariables.Number[0][100] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":560,"wires":[["e2cb9f63086aae34"]]},{"id":"6c35c485fdc6cd6d","type":"mqtt in","z":"30ede05c4a2bcbbc","g":"698caf96aff53ebc","name":"","topic":"Mqtt_CheckWeigh_Check_LanCanTrongNgay_VO2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":240,"y":660,"wires":[["d86d4b38c4a6fb09"]]},{"id":"f9a108a50a9b838e","type":"link in","z":"30ede05c4a2bcbbc","g":"698caf96aff53ebc","name":"link in 44","links":[],"x":455,"y":700,"wires":[["d86d4b38c4a6fb09"]]},{"id":"d86d4b38c4a6fb09","type":"function","z":"30ede05c4a2bcbbc","g":"698caf96aff53ebc","name":"Query DB","func":"\n// Get current date and time\nconst currentDate = new Date();\n\n// Set hours, minutes, seconds, and milliseconds to 0 to get midnight of the current day\ncurrentDate.setHours(0, 0, 0);\n\n// Convert this midnight timestamp to milliseconds\nconst StartTimestamp = currentDate.getTime();\n\n// Get current timestamp\nconst EndTimestamp = Date.now(); // This gives you the current timestamp in milliseconds\n\n// Now you have startTimestamp (beginning of the current day) and endTimestamp (current time)\n// You can use these values to search or perform any operations within this range\nconsole.log(\"Start Timestamp (midnight of current day):\", StartTimestamp);\nconsole.log(\"End Timestamp (current time):\", EndTimestamp);\nnode.warn(StartTimestamp);\nnode.warn(EndTimestamp);\n\nvar Variables = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nlet start_time = StartTimestamp\nlet stop_time = EndTimestamp\n\nsetTimeout(() => {\n    Variables.Bit[0][97] = false; //   NÚT CÁC LẦN CÂN TRONG NGÀY.\n}, 500);\nVariables.ListString[0][101] = ''; // RESET\nmsg.topic = `SELECT * FROM TeaCheckWeigh_Cui WHERE TimeCreate BETWEEN ($start_time) AND ($stop_time) `\nmsg.payload = [start_time, stop_time]\nnode.send(msg);\nnode.warn(msg.topic);\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":590,"y":660,"wires":[["a7b5257b3be1a9b1"]]},{"id":"a7b5257b3be1a9b1","type":"sqlite","z":"30ede05c4a2bcbbc","g":"698caf96aff53ebc","mydb":"4cabebdcc173f658","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":850,"y":660,"wires":[["4e2f4fd013f9a228"]]},{"id":"4e2f4fd013f9a228","type":"function","z":"30ede05c4a2bcbbc","g":"698caf96aff53ebc","name":"Filter","func":"var Variables = global.get(\"Variable\");\nglobal.set('StoreQueryGridView_VO2', msg.payload)\nVariables.Bit[0][90] = false;\nVariables.Bit[0][91] = false;\nVariables.Bit[0][92] = false;\nVariables.Number[0][100] = msg.payload.length\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1040,"y":660,"wires":[["e2cb9f63086aae34"]]},{"id":"4a4895ab66c4c20c","type":"function","z":"30ede05c4a2bcbbc","g":"5bc96253944fe7e8","name":"Export Excel","func":"var Variables = global.get(\"Variable\");\nsetTimeout(() => {\n    Variables.Bit[0][95] = false; //   NÚT XUẤT EXCEL\n}, 500);\nmsg.payload = {\n    exportExcel: 1\n}\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":800,"wires":[["8be832f1b317064b"]]},{"id":"0fe051786f512bb3","type":"mqtt in","z":"30ede05c4a2bcbbc","g":"5bc96253944fe7e8","name":"","topic":"Mqtt_CheckWeigh_ExportExcel_VO2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":200,"y":800,"wires":[["4a4895ab66c4c20c"]]},{"id":"8be832f1b317064b","type":"mqtt out","z":"30ede05c4a2bcbbc","g":"5bc96253944fe7e8","name":"","topic":"Mqtt_CheckWeigh_DataGrid_VO2","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":750,"y":800,"wires":[]},{"id":"3a79e0a6666a5b0a","type":"mqtt in","z":"30ede05c4a2bcbbc","g":"45c86fcef02882e7","name":"","topic":"Mqtt_CheckWeigh_DataGrid_Response_VO2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":220,"y":1040,"wires":[["72d0e0001b24eb22","30700496f1c7bbc2"]]},{"id":"72d0e0001b24eb22","type":"function","z":"30ede05c4a2bcbbc","g":"45c86fcef02882e7","name":"Get Data Current Row","func":"msg.payload[0] = msg.payload.record;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":1040,"wires":[["fca01e639cb14a53"]]},{"id":"fca01e639cb14a53","type":"function","z":"30ede05c4a2bcbbc","g":"45c86fcef02882e7","name":"Query DB Get 4 Images","func":"\nlet data=msg.payload[0]\nmsg.topic = `SELECT * FROM TeaCheckWeigh_Cui WHERE PhieuCan=\"${data.PhieuCan}\"`\nnode.send(msg);","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":780,"y":1040,"wires":[["60bf45a68b0b8a1a"]]},{"id":"60bf45a68b0b8a1a","type":"sqlite","z":"30ede05c4a2bcbbc","g":"45c86fcef02882e7","mydb":"4cabebdcc173f658","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":990,"y":1040,"wires":[["5f8957437b5e96d8"]]},{"id":"30700496f1c7bbc2","type":"function","z":"30ede05c4a2bcbbc","g":"45c86fcef02882e7","name":"Reset value","func":"msg.payload = \" \"\nreturn msg\n\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":1100,"wires":[["7b99864a1a079f4b"]]},{"id":"7b99864a1a079f4b","type":"link out","z":"30ede05c4a2bcbbc","g":"45c86fcef02882e7","name":"link out 26","mode":"link","links":["69ec631c330598bd"],"x":615,"y":1100,"wires":[]},{"id":"de209f14f6d7ff06","type":"mqtt in","z":"30ede05c4a2bcbbc","g":"58180124e6c51634","name":"","topic":"Mqtt_CheckWeigh_Check_XemPhieu_VO2","qos":"2","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":900,"wires":[["7412508079f5b166"]]},{"id":"7412508079f5b166","type":"function","z":"30ede05c4a2bcbbc","g":"58180124e6c51634","name":"Query DB","func":"var Variables = global.get(\"Variable\");\n\nVariables.ListString[0][101] = ''; // RESET\nsetTimeout(() => {\n    Variables.Bit[0][96] = false; //   NÚT TÌM PHIẾU CÂN.\n}, 500);\n\nif (Variables.Number[0][101] > 0) {\n    msg.topic = `SELECT * FROM TeaCheckWeigh_Cui WHERE PhieuCan = '${Variables.Number[0][101]}' `\n    node.send(msg);\n} else {\n    let tempData = global.get('Set_Mqtt_DataAlarm')\n    if (!Array.isArray(tempData)) tempData = []\n    let data = {\n        Type: 'warning',\n        Message: 'Chưa Nhập Số Phiếu Cần Tìm'\n    }\n    tempData.push(data)\n    global.set('Set_Mqtt_DataAlarm', tempData)\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":900,"wires":[["5992461f56380894"]]},{"id":"5992461f56380894","type":"sqlite","z":"30ede05c4a2bcbbc","g":"58180124e6c51634","mydb":"4cabebdcc173f658","sqlquery":"msg.topic","sql":"","name":"Execute Query","x":650,"y":900,"wires":[["5f8957437b5e96d8"]]},{"id":"776c07c18bf1d337","type":"inject","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name":"START_SYSTEM","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":170,"y":220,"wires":[["7d16a5dbf24706eb","663794cae69f2dc9","48f465887ee74f07"]]},{"id":"07932b804d90fb1d","type":"http in","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name":"/ConfigPage","url":"/ConfigPage","method":"get","upload":false,"swaggerDoc":"","x":170,"y":840,"wires":[["dc7437e2487c517a"]]},{"id":"dc7437e2487c517a","type":"function","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name":"Get DB","func":"\nmsg.payload=global.get(\"ConfigPageServer\")\nnode.send(msg);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":840,"wires":[["d447fcf0151bc46c"]]},{"id":"d447fcf0151bc46c","type":"http response","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name":"Response","statusCode":"200","headers":{"content-type":"application/json"},"x":500,"y":840,"wires":[]},{"id":"7d16a5dbf24706eb","type":"function","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name":"PROCESS","func":"// var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nvar SubFunction = global.get(\"SubFunction\");\nvar Variables = global.get(\"Variable\");\n\nVariables.Percent[0] = new Array(20).fill(0);\nVariables.BitAdjust[0] = new Array(20).fill(0);\nVariables.BitDisplay[0] = new Array(20).fill(0);\nVariables.WordAdjust[0] = new Array(20).fill(0);\nVariables.WordDisplay[0] = new Array(20).fill(0);\nVariables.DWordAdjust[0] = new Array(20).fill(0);\nVariables.DWordDisplay[0] = new Array(20).fill(0);\n// Variables.ListString[0] = new Array(20).fill('---');\n// Variables.TextField[0] = new Array(20).fill('---');\nVariables.TextFieldInput[0] = new Array(10).fill(0);\n\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":390,"y":220,"wires":[[]]},{"id":"48f465887ee74f07","type":"plc_omron","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name":"PLC ePLC","host":"192.168.50.30","port":"9600","indexPLC":"1","topic":"","PLC_Interval":"500","PLC_Length_ReadWrite":"5000","PLC_Word_Start_ReadWrite":"30000","x":590,"y":260,"wires":[["8ff736f07756119d"]]},{"id":"663794cae69f2dc9","type":"Scada Web Begin","z":"67999b1b4961f212","g":"eeb9418b742f7b21","x":360,"y":340,"wires":[["d4987891d11ae519"]]},{"id":"6168279b7105182f","type":"inject","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name":"","props":[{"p":"payload"},{"p":"topic","v":"[{\"dataField\":\"Package\",\"capture\":\"Package\",\"width\":\"auto\"},{\"dataField\":\"Product\",\"capture\":\"Product\",\"width\":\"auto\"},{\"dataField\":\"LotId\",\"capture\":\"LotID\",\"width\":\"auto\"},{\"dataField\":\"Destination\",\"capture\":\"Destination\",\"width\":\"100\"},{\"dataField\":\"Quantity\",\"capture\":\"Quantity\",\"width\":\"100\"},{\"dataField\":\"Remark\",\"capture\":\"Remark\",\"width\":\"auto\"},{\"dataField\":\"User\",\"capture\":\"User\",\"width\":\"80\"},{\"dataField\":\"TypeReport\",\"capture\":\"TypeReport\",\"width\":\"100\"}]","vt":"json"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":200,"y":340,"wires":[["663794cae69f2dc9"]]},{"id":"d4987891d11ae519","type":"Scada Web Setup Alarm","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"Setup Alarm","levelAccess":0,"x":510,"y":340,"wires":[["fa950d1ee7f78146"]]},{"id":"fa950d1ee7f78146","type":"Scada Web User","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"User","levelAccess":10,"x":690,"y":340,"wires":[["b24d6e65c477ec1c"]]},{"id":"b24d6e65c477ec1c","type":"Scada Web Manage Variable","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"Manage Variables","levelAccess":"0","x":890,"y":340,"wires":[["33affa111ccac192"]]},{"id":"cbfd04613518d292","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - OHV-Main","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Main","idPage":"OHV_Main","require_login":"false","nameIcon":"","x":230,"y":400,"wires":[["29fb38df8a686859"]]},{"id":"b4b73431a8c802cc","type":"Scada Web End","z":"67999b1b4961f212","g":"eeb9418b742f7b21","x":990,"y":780,"wires":[]},{"id":"301247b91708fa7e","type":"Config Project","z":"67999b1b4961f212","g":"ac517e0cad9b6025","license":"$2a$12$X/jvLif/zVDzVOBmWrBVWeM.jRTtsDq0WVuBZwS.mXbg6FFZ3/zma","port":"8001","mqtt_host":"localhost","mqtt_port":"1883","dbpath":"OHV","x":410,"y":80,"wires":[[]]},{"id":"25eff11bc9c33081","type":"inject","z":"67999b1b4961f212","g":"ac517e0cad9b6025","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"WRITE","payloadType":"str","x":170,"y":100,"wires":[["502c8c85d858de38"]]},{"id":"37902e2711d71c89","type":"inject","z":"67999b1b4961f212","g":"ac517e0cad9b6025","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"TURN_OFF","payloadType":"str","x":190,"y":60,"wires":[["301247b91708fa7e"]]},{"id":"3ac79b30c9339c67","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - Supply Air Connector 1","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Supply_Air_Connector1","idPage":"OHV_Supply_Air_Connector1","require_login":"false","nameIcon":"","x":270,"y":440,"wires":[["bb1b3e1af86b0a20"]]},{"id":"bb1b3e1af86b0a20","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - Supply O Ring","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Supply_O_Ring","idPage":"OHV_Supply_O_Ring","require_login":"false","nameIcon":"","x":560,"y":440,"wires":[["4b0c0561567d8568"]]},{"id":"29fb38df8a686859","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - Transfer JIG AirConnector","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Transfer_Jig","idPage":"OHV_Transfer_Jig","require_login":"false","nameIcon":"","x":520,"y":400,"wires":[["3ac79b30c9339c67"]]},{"id":"89c2edc78a914198","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - Supply Air Connector 2","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Supply_Air_Connector2","idPage":"OHV_Supply_Air_Connector2","require_login":"false","nameIcon":"","x":270,"y":480,"wires":[["5599c3f563951148"]]},{"id":"4b0c0561567d8568","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - FQ2-Reject-SS-Robot","width":"3665","height":"2108","backgroundColor":"457b9d","backgroundImage":"FQ_Reject_Robot","idPage":"OHV_Check_Out_NG_O_Ring","require_login":"false","nameIcon":"","x":850,"y":440,"wires":[["89c2edc78a914198"]]},{"id":"5599c3f563951148","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - Transfer JIG Tube","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Transfer_Jig_Tube","idPage":"OHV_Transfer_Jig_Tube","require_login":"false","nameIcon":"","x":260,"y":540,"wires":[["7768009fd03eed3d"]]},{"id":"7768009fd03eed3d","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - Supply Joint Tube","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Supply_Joint_Tube","idPage":"OHV_Supply_Joint_Tube","require_login":"false","nameIcon":"","x":550,"y":540,"wires":[["b54ea242671d944e"]]},{"id":"b54ea242671d944e","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - Locate Joint Tube","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Locate_Joint_Tube","idPage":"OHV_Locate_Joint_Tube","require_login":"false","nameIcon":"","x":830,"y":540,"wires":[["96910ec25800b225"]]},{"id":"96910ec25800b225","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - Input Joint Tube","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Input_Joint_Tube","idPage":"OHV_Input_Joint_Tube","require_login":"false","nameIcon":"","x":1110,"y":540,"wires":[["7da0cea37c37c16b"]]},{"id":"7da0cea37c37c16b","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - Camera FH Check Tube","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Camera_FH_Tube","idPage":"OHV_Camera_FH_Tube","require_login":"false","nameIcon":"","x":270,"y":580,"wires":[["b3c756fcf338ed52"]]},{"id":"b3c756fcf338ed52","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - Output Joint Tube ASSY","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Output_Joint_Tube_Assy","idPage":"OHV_Ouput_Joint_Tube_Assy","require_login":"false","nameIcon":"","x":590,"y":580,"wires":[["436c6123ed3da4e9"]]},{"id":"436c6123ed3da4e9","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC03 - Conveyer Output","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"Conveyer_Output","idPage":"OHV_Conveyer_Output","require_login":"false","nameIcon":"","x":250,"y":640,"wires":[["5a8ca271d3e08d33"]]},{"id":"4634640b4351bc23","type":"function","z":"67999b1b4961f212","name":"function 57","func":"var Variable = global.get('Variable')\nsetInterval(() => {\n    if (!global.get('old')) {\n        global.set('old', Variable.WordDisplay[1][20054])\n        msg.payload = Variable.WordDisplay[1][20054]\n        node.send(msg)\n    }\n    if (global.get('old') !== Variable.WordDisplay[1][20054]) {\n        global.set('old', Variable.WordDisplay[1][20054])\n        msg.payload = Variable.WordDisplay[1][20054]\n        node.send(msg)\n    }\n}, 200)\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":310,"y":920,"wires":[["eea76e2f3b41ca10"]]},{"id":"eea76e2f3b41ca10","type":"mqtt out","z":"67999b1b4961f212","name":"","topic":"Mqtt_JigTransfer_PosServo","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":540,"y":920,"wires":[]},{"id":"76336051549a2929","type":"status","z":"67999b1b4961f212","name":"","scope":["eea76e2f3b41ca10"],"x":160,"y":920,"wires":[["4634640b4351bc23"]]},{"id":"05e52e5e404217ea","type":"inject","z":"67999b1b4961f212","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"123","payloadType":"num","x":200,"y":980,"wires":[["eea76e2f3b41ca10"]]},{"id":"8ff736f07756119d","type":"mqtt out","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name":"","topic":"Connection/NX102","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":850,"y":260,"wires":[]},{"id":"33affa111ccac192","type":"Scada Web Main Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"Main Page","width":1920,"height":1080,"backgroundColor":"transparent","backgroundImage":"","idPage":"MainPage","notShowOnMenu":true,"nameIcon":"","x":1090,"y":340,"wires":[["cbfd04613518d292"]]},{"id":"99f95b233c1e1df5","type":"mqtt in","z":"67999b1b4961f212","g":"934ddc593056ce42","name":"","topic":"Variable/Bit","qos":"0","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":170,"y":1060,"wires":[["4844c10ed85e1d2b"]]},{"id":"4844c10ed85e1d2b","type":"function","z":"67999b1b4961f212","g":"934ddc593056ce42","name":"Convert Bit Omron","func":"let data = '';\nif (Array.isArray(msg.payload)) {\n    msg.payload.forEach(function (element) {\n        data += `${element.nameTag}\\tBOOL\\t\\t%D${element.tag}\\tTRUE\\tFALSE\\tDo not publish\\n`;\n    });\n}\nmsg.payload = data; // Remove any trailing newlines\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":390,"y":1060,"wires":[["e45a353be274e1e7"]]},{"id":"e45a353be274e1e7","type":"mqtt out","z":"67999b1b4961f212","g":"934ddc593056ce42","name":"","topic":"Variable/BitProcess","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":710,"y":1060,"wires":[]},{"id":"c3b5e61d5adc146f","type":"function","z":"67999b1b4961f212","g":"934ddc593056ce42","name":"Convert String Omron","func":"let data = '';\nif (Array.isArray(msg.payload)) {\n    msg.payload.forEach(function (element) {\n        data += `${element.nameTag}\\tSTRING[40]\\t\\t%D${element.tag}\\tTRUE\\tFALSE\\tDo not publish\\n`;\n    });\n}\nmsg.payload = data; // Remove any trailing newlines\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":400,"y":1180,"wires":[["53d2398750967bf7"]]},{"id":"0befd9af502471d7","type":"mqtt in","z":"67999b1b4961f212","g":"934ddc593056ce42","name":"","topic":"Variable/String","qos":"0","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":180,"y":1180,"wires":[["c3b5e61d5adc146f"]]},{"id":"53d2398750967bf7","type":"mqtt out","z":"67999b1b4961f212","g":"934ddc593056ce42","name":"","topic":"Variable/StringProcess","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":720,"y":1180,"wires":[]},{"id":"f92421bc8092cd49","type":"function","z":"67999b1b4961f212","g":"934ddc593056ce42","name":"Convert Number Omron","func":"let data = '';\nif (Array.isArray(msg.payload)) {\n    msg.payload.forEach(function (element) {\n        data += `${element.nameTag}\\tInt\\t\\t%D${element.tag}\\tTRUE\\tFALSE\\tDo not publish\\n`;\n    });\n}\nmsg.payload = data; // Remove any trailing newlines\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":410,"y":1120,"wires":[["800c693427b5f4a9"]]},{"id":"c81ea12a9fd7fed0","type":"mqtt in","z":"67999b1b4961f212","g":"934ddc593056ce42","name":"","topic":"Variable/Number","qos":"0","datatype":"auto-detect","broker":"cf0ae1d58e6000b5","nl":false,"rap":true,"rh":0,"inputs":0,"x":180,"y":1120,"wires":[["f92421bc8092cd49"]]},{"id":"800c693427b5f4a9","type":"mqtt out","z":"67999b1b4961f212","g":"934ddc593056ce42","name":"","topic":"Variable/NumberProcess","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":730,"y":1120,"wires":[]},{"id":"dc83b70a56b31d50","type":"function","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name":"function 60","func":"let temp_arr=msg.payload\nnode.warn(temp_arr.length)\ntemp_arr.forEach(function(element) {\n    if (element) node.warn(element);\n});\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1040,"y":280,"wires":[[]]},{"id":"3032f921015bd322","type":"function","z":"67999b1b4961f212","name":"function 59","func":"var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nnode.warn(Variable);\nnode.warn(Variable.Number[5]);\n\nlet a = -8.67592E-04\n// node.warn(parseFloat(a).toFixed(5))\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":60,"wires":[[]]},{"id":"470d8d464d2652dd","type":"inject","z":"67999b1b4961f212","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":680,"y":60,"wires":[["3032f921015bd322"]]},{"id":"d478b3a85f447902","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC08 - Station 01","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"MC08_ST01","idPage":"MC08_ST01","require_login":"false","nameIcon":"","x":470,"y":700,"wires":[["5176536b248d5c01"]]},{"id":"5176536b248d5c01","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC08 - Station 02","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"MC08_ST02","idPage":"MC08_ST02","require_login":"false","nameIcon":"","x":710,"y":700,"wires":[["326983c477c65328"]]},{"id":"326983c477c65328","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC08 - Station 03","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"MC08_ST03","idPage":"MC08_ST03","require_login":"false","nameIcon":"","x":230,"y":740,"wires":[["ca1a1456c98d09ec"]]},{"id":"ca1a1456c98d09ec","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC08 - Station 04","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"MC08_ST04","idPage":"MC08_ST04","require_login":"false","nameIcon":"","x":470,"y":740,"wires":[["ee38413a2c5b1fc0"]]},{"id":"ee38413a2c5b1fc0","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC08 - Station 05","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"MC08_ST05","idPage":"MC08_ST05","require_login":"false","nameIcon":"","x":710,"y":740,"wires":[["f3f3fd883529b8c8"]]},{"id":"f3f3fd883529b8c8","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC08 - Station 06","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"MC08_ST06","idPage":"MC08_ST06","require_login":"false","nameIcon":"","x":230,"y":780,"wires":[["b1b4806c1a2fcc55"]]},{"id":"b1b4806c1a2fcc55","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC08 - Station 07","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"MC08_ST07","idPage":"MC08_ST07","require_login":"false","nameIcon":"","x":470,"y":780,"wires":[["b4b73431a8c802cc"]]},{"id":"51d8226bc36ea976","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC08 - MAIN","width":"3128","height":"1799","backgroundColor":"457b9d","backgroundImage":"","idPage":"MC08_MAIN","require_login":"false","nameIcon":"","x":220,"y":700,"wires":[["d478b3a85f447902"]]},{"id":"5a8ca271d3e08d33","type":"Scada Web Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"MC04 - ROBOT","width":"2066","height":"1202","backgroundColor":"457b9d","backgroundImage":"MC04_Robot","idPage":"MC04_Robot","require_login":"false","nameIcon":"","x":540,"y":640,"wires":[["51d8226bc36ea976"]]},{"id":"4c2821678526c17f","type":"ACE","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name":"","host":"localhost","port":"5000","indexPLC":"5","interval":"100","x":460,"y":300,"wires":[[]]},{"id":"98a79b8bbfb980e7","type":"Scada Web Design Header Page","z":"67999b1b4961f212","g":"eeb9418b742f7b21","name_page":"Header Page","width":496,"height":277,"backgroundColor":"457b9d","backgroundImage":"","idPage":"HeaderPage","levelAccess":0,"nameIcon":"","x":1340,"y":340,"wires":[["cbfd04613518d292"]]},{"id":"d1f1c9200a7b63d8","type":"inject","z":"d31a96bcefded53b","name":"Trigger Request","props":[],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":150,"y":60,"wires":[["6ffda15a4f9e7f61"]]},{"id":"6ffda15a4f9e7f61","type":"function","z":"d31a96bcefded53b","name":"Add Token Header","func":"// Add the Authorization header with the token\nmsg.headers = {\n    Authorization: 'Bearer a549398e-213a-432a-a87a-a6c86f5559c3'\n};\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":60,"wires":[["8dfe4c4e6e3a3d42"]]},{"id":"8dfe4c4e6e3a3d42","type":"http request","z":"d31a96bcefded53b","name":"HTTP GET Request","method":"GET","ret":"bin","paytoqs":"body","url":"https://kcs.chusekptrubber.vn/api/inspector?param_target=mooney&page=1&status=0&per_page=10","tls":"72e48ed5298b1b7a","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"bearer","senderr":false,"headers":[],"x":560,"y":60,"wires":[["9cd02b5e5b153c12"]]},{"id":"9cd02b5e5b153c12","type":"debug","z":"d31a96bcefded53b","name":"Response","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":760,"y":60,"wires":[]},{"id":"db9eec0636b60b46","type":"inject","z":"d31a96bcefded53b","name":"Trigger Post","props":[],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":140,"y":120,"wires":[["858ddc64001d7b70"]]},{"id":"777bc6c1744828ab","type":"http request","z":"d31a96bcefded53b","name":"HTTP POST Request","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://kcs.chusekptrubber.vn/api/login","tls":"72e48ed5298b1b7a","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":560,"y":120,"wires":[["d5034a9cb6511a32"]]},{"id":"d5034a9cb6511a32","type":"debug","z":"d31a96bcefded53b","name":"Response","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":760,"y":120,"wires":[]},{"id":"858ddc64001d7b70","type":"function","z":"d31a96bcefded53b","name":"Add Email, Pass","func":"let email = \"admin@admin.com\";\nlet password = \"123\";\n\n// Prepare the payload for POST request\nmsg.payload = {\n    email: email,\n    password: password\n};\n\n// Specify request headers (optional)\nmsg.headers = {\n    'Content-Type': 'application/json'\n};\n\n// Return the modified message object\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":120,"wires":[["777bc6c1744828ab"]]},{"id":"d0c1b78a4120dbf7","type":"inject","z":"d31a96bcefded53b","name":"Trigger Post","props":[],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":350,"y":220,"wires":[["4130b320168451ee"]]},{"id":"25ae8135359508f4","type":"http request","z":"d31a96bcefded53b","name":"HTTP POST Request","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://app.chusekrubber.vn/api/insert-material","tls":"72e48ed5298b1b7a","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"bearer","senderr":false,"headers":[],"x":770,"y":220,"wires":[["8c3f0c505858bf7b"]]},{"id":"8c3f0c505858bf7b","type":"debug","z":"d31a96bcefded53b","name":"Response","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":970,"y":220,"wires":[]},{"id":"4130b320168451ee","type":"function","z":"d31a96bcefded53b","name":"Add Field Object","func":"\n\n// Prepare the payload for POST request\nmsg.payload ={\n    \"bien_so_xe\":\"3A-1256\",\n    \"nguon_goc\":\"NT8\",\n    \"khoi_luong_mu\":\"83001\",\n    \"chung_loai\":\"Mủ đông chén\",\n    \"pack_id\":\"w1231\"\n}\n\n// Specify request headers (optional)\nmsg.headers = {\n    'Content-Type': 'application/json'\n};\n\n// Return the modified message object\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":220,"wires":[["25ae8135359508f4"]]},{"id":"5f5a63ddeb0a9b60","type":"inject","z":"d31a96bcefded53b","name":"Trigger Post","props":[],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":370,"y":280,"wires":[["b5f2e3cee42d5e74"]]},{"id":"fd69aeeb067566df","type":"http request","z":"d31a96bcefded53b","name":"HTTP POST Request","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://app.chusekrubber.vn/api/insert-material","tls":"72e48ed5298b1b7a","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"bearer","senderr":false,"headers":[],"x":790,"y":280,"wires":[["5ed5fbfc15917b60"]]},{"id":"5ed5fbfc15917b60","type":"debug","z":"d31a96bcefded53b","name":"Response","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":990,"y":280,"wires":[]},{"id":"b5f2e3cee42d5e74","type":"function","z":"d31a96bcefded53b","name":"Add Many Field","func":"var Variable = global.get(\"Variable\");\nVariable.Number[1][4] = 123\nVariable.ListString[1][4] = 'NT8'\n// Prepare the payload for POST request\nmsg.payload = \n[{\n    \"bien_so_xe\": \"3A-12156\",\n    \"nguon_goc\": Variable.ListString[1][4],\n    \"khoi_luong_mu\": Variable.Number[1][4],\n    \"chung_loai\": \"Mủ đông chén\",\n    \"ngay\": \"2023/09/24\",\n    \"gio\": \"15:10\"\n}\n]\n\n// Specify request headers (optional)\nmsg.headers = {\n    'Content-Type': 'application/json'\n};\n\n// Return the modified message object\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":550,"y":280,"wires":[["fd69aeeb067566df"]]},{"id":"3c6f90bab055a6bf","type":"function","z":"d31a96bcefded53b","name":"Add Many Field","func":"\n\n// Prepare the payload for POST request\nmsg.payload = \n[{\n    \"bien_so_xe\": \"3A-1256\",\n    \"nguon_goc\": \"NT8\",\n    \"khoi_luong_mu\": \"83001\",\n    \"chung_loai\": \"Mủ đông chén\",\n    \"ngay\": \"2023/09/24\",\n    \"gio\": \"15:00\"\n},\n    {\n        \"bien_so_xe\": \"3A-1111\",\n        \"nguon_goc\": \"NT2\",\n        \"khoi_luong_mu\": \"83001\",\n        \"chung_loai\": \"Mủ dây\",\n        \"ngay\": \"2023/09/24\",\n        \"gio\": \"15:00\"\n    },\n    {\n        \"bien_so_xe\": \"3A-1111\",\n        \"nguon_goc\": \"NT6\",\n        \"khoi_luong_mu\": \"83001\",\n        \"chung_loai\": \"Tạp chất\",\n        \"ngay\": \"2023/09/24\",\n        \"gio\": \"15:00\"\n    }\n]\n\n// Specify request headers (optional)\nmsg.headers = {\n    'Content-Type': 'application/json'\n};\n\n// Return the modified message object\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":380,"wires":[[]]},{"id":"541a6631cb259df0","type":"inject","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"START_SYSTEM","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":190,"y":240,"wires":[["3d6d9dd586ea055e","f58316c1359e5791","44aaf28bdab96e43","e3a065ec2ee797c1"]]},{"id":"350e73805a7f9eab","type":"http in","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"/ConfigPage","url":"/ConfigPage","method":"get","upload":false,"swaggerDoc":"","x":230,"y":520,"wires":[["9093a7e03e67a79d"]]},{"id":"9093a7e03e67a79d","type":"function","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"Get DB","func":"\nmsg.payload=global.get(\"ConfigPageServer\")\nnode.send(msg);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":520,"wires":[["fb8f5044f91677b3"]]},{"id":"fb8f5044f91677b3","type":"http response","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"Response","statusCode":"200","headers":{"content-type":"application/json"},"x":580,"y":520,"wires":[]},{"id":"3d6d9dd586ea055e","type":"function","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"PROCESS","func":"// var Variable = global.get(\"Variable\");\nvar VariableSystem = global.get(\"VariableSystem\");\nvar SubFunction = global.get(\"SubFunction\");\nvar Variables = global.get(\"Variable\");\n\nVariables.Percent[0] = new Array(20).fill(0);\nVariables.BitAdjust[0] = new Array(20).fill(0);\nVariables.BitDisplay[0] = new Array(20).fill(0);\nVariables.WordAdjust[0] = new Array(20).fill(0);\nVariables.WordDisplay[0] = new Array(20).fill(0);\nVariables.DWordAdjust[0] = new Array(20).fill(0);\nVariables.DWordDisplay[0] = new Array(20).fill(0);\n// Variables.ListString[0] = new Array(20).fill('---');\n// Variables.TextField[0] = new Array(20).fill('---');\nVariables.TextFieldInput[0] = new Array(10).fill(0);\n\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":200,"wires":[[]]},{"id":"44aaf28bdab96e43","type":"plc_omron","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"NJR (1)","host":"192.168.250.30","port":"9600","indexPLC":"1","topic":"","PLC_Interval":"300","PLC_Length_ReadWrite":"1000","PLC_Word_Start_ReadWrite":"0","x":480,"y":240,"wires":[["3e09eb7001c26f7a"]]},{"id":"f58316c1359e5791","type":"Scada Web Begin","z":"740cb21391be927b","g":"b1ddab9950f391b1","x":380,"y":360,"wires":[["b87bdcbde205570b"]]},{"id":"8116ef1dbc696eb6","type":"inject","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"","props":[{"p":"payload"},{"p":"topic","v":"[{\"dataField\":\"Package\",\"capture\":\"Package\",\"width\":\"auto\"},{\"dataField\":\"Product\",\"capture\":\"Product\",\"width\":\"auto\"},{\"dataField\":\"LotId\",\"capture\":\"LotID\",\"width\":\"auto\"},{\"dataField\":\"Destination\",\"capture\":\"Destination\",\"width\":\"100\"},{\"dataField\":\"Quantity\",\"capture\":\"Quantity\",\"width\":\"100\"},{\"dataField\":\"Remark\",\"capture\":\"Remark\",\"width\":\"auto\"},{\"dataField\":\"User\",\"capture\":\"User\",\"width\":\"80\"},{\"dataField\":\"TypeReport\",\"capture\":\"TypeReport\",\"width\":\"100\"}]","vt":"json"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":220,"y":360,"wires":[["f58316c1359e5791"]]},{"id":"b87bdcbde205570b","type":"Scada Web Setup Alarm","z":"740cb21391be927b","g":"b1ddab9950f391b1","name_page":"Setup Alarm","levelAccess":0,"x":530,"y":360,"wires":[["ae3581a7e9744c6f"]]},{"id":"ae3581a7e9744c6f","type":"Scada Web User","z":"740cb21391be927b","g":"b1ddab9950f391b1","name_page":"User","levelAccess":10,"x":710,"y":360,"wires":[["88ed6de0ef9fe38e"]]},{"id":"88ed6de0ef9fe38e","type":"Scada Web Manage Variable","z":"740cb21391be927b","g":"b1ddab9950f391b1","name_page":"Manage Variables","levelAccess":"0","x":910,"y":360,"wires":[["b42794c4ceb1a4b6"]]},{"id":"cc8142c727422b7f","type":"Scada Web End","z":"740cb21391be927b","g":"b1ddab9950f391b1","x":830,"y":420,"wires":[]},{"id":"db96e2d02dbc9439","type":"Config Project","z":"740cb21391be927b","g":"06ab24c9391def6c","license":"","port":"8001","mqtt_host":"localhost","mqtt_port":"2883","dbpath":"SanofiLine2","x":420,"y":80,"wires":[[]]},{"id":"850a53c0a9541179","type":"inject","z":"740cb21391be927b","g":"06ab24c9391def6c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"WRITE","payloadType":"str","x":150,"y":100,"wires":[["533b8bfb6022db93"]]},{"id":"bc4963e68281385b","type":"inject","z":"740cb21391be927b","g":"06ab24c9391def6c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"TURN_OFF","payloadType":"str","x":170,"y":60,"wires":[["db96e2d02dbc9439"]]},{"id":"b42794c4ceb1a4b6","type":"Scada Web Page","z":"740cb21391be927b","g":"b1ddab9950f391b1","name_page":"Main","width":"2528","height":"1299","backgroundColor":"457b9d","backgroundImage":"Main","idPage":"Main","require_login":"false","nameIcon":"","x":210,"y":420,"wires":[["3ca0d6de8940b365"]]},{"id":"89c9b4a00d9005ab","type":"Scada Web Page","z":"740cb21391be927b","g":"b1ddab9950f391b1","name_page":"Viper","width":"2528","height":"1299","backgroundColor":"457b9d","backgroundImage":"","idPage":"Viper","require_login":"false","nameIcon":"","x":630,"y":420,"wires":[["cc8142c727422b7f"]]},{"id":"dc7f04a9cb15cecb","type":"function","z":"740cb21391be927b","name":"function 56","func":"var Variable = global.get('Variable')\nif(!global.get('old')){\n    global.set('old', Variable.Number[0][1])\n    msg.payload=Variable.Number[0][1]\n    node.send(msg)\n}\nif (global.get('old') !== Variable.Number[0][1]){\n    global.set('old', Variable.Number[0][1])\n    msg.payload=Variable.Number[0][1]\n    node.send(msg)\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":410,"y":680,"wires":[["25c3834fbf31f5ec"]]},{"id":"50ec694fb9294199","type":"inject","z":"740cb21391be927b","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":240,"y":680,"wires":[["dc7f04a9cb15cecb"]]},{"id":"25c3834fbf31f5ec","type":"mqtt out","z":"740cb21391be927b","name":"","topic":"Mqtt_Viper_Speed_Move","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":630,"y":680,"wires":[]},{"id":"e3a065ec2ee797c1","type":"plc_omron","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"NX102 (2)","host":"192.168.251.10","port":"9600","indexPLC":"2","topic":"","PLC_Interval":"300","PLC_Length_ReadWrite":"1000","PLC_Word_Start_ReadWrite":"0","x":490,"y":300,"wires":[["451efcfab6142f00"]]},{"id":"d08c5bea8f497984","type":"mqtt out","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"","topic":"Connection/NJR","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":900,"y":240,"wires":[]},{"id":"3e09eb7001c26f7a","type":"function","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"Send Status","func":"if(msg.payload != global.get('CurrentStatus1')){\n    global.set('CurrentStatus1',msg.payload)\n    msg.payload={status:msg.payload}\n    node.send(msg)\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":730,"y":240,"wires":[["d08c5bea8f497984"]]},{"id":"cbc1ae33833e474f","type":"mqtt out","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"","topic":"Connection/NX102","qos":"0","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"cf0ae1d58e6000b5","x":910,"y":300,"wires":[]},{"id":"451efcfab6142f00","type":"function","z":"740cb21391be927b","g":"b1ddab9950f391b1","name":"Send Status","func":"if(msg.payload != global.get('CurrentStatus2')){\n    global.set('CurrentStatus2',msg.payload)\n    msg.payload={status:msg.payload}\n    node.send(msg)\n}","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":730,"y":300,"wires":[["cbc1ae33833e474f"]]},{"id":"3ca0d6de8940b365","type":"Scada Web Page","z":"740cb21391be927b","g":"b1ddab9950f391b1","name_page":"ShowTagAlarm","width":"2528","height":"1299","backgroundColor":"457b9d","backgroundImage":"","idPage":"ShowTagAlarm","require_login":"true","nameIcon":"","x":420,"y":420,"wires":[["89c9b4a00d9005ab"]]},{"id":"96a29d0df7745f8b","type":"function","z":"740cb21391be927b","name":"function 42","func":"var Variables = global.get(\"Variable\");\nnode.warn(Variables.Bit[2])","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":390,"y":740,"wires":[[]]},{"id":"0b658e4923f1c017","type":"inject","z":"740cb21391be927b","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":220,"y":740,"wires":[["96a29d0df7745f8b"]]}]