(()=>{var __webpack_modules__={4780:e=>{e.exports={active:!1}},5407:e=>{e.exports.DefaultHostValues={host:"127.0.0.1",port:9600},e.exports.DefaultOptions={timeout:2e3},e.exports.DefaultFinsHeader={ICF:128,RSV:0,GCT:2,DNA:0,DA1:0,DA2:0,SNA:0,SA1:34,SA2:0,SID:0},e.exports.Commands={CONTROLLER_STATUS_READ:[6,1],MEMORY_AREA_READ:[1,1],MEMORY_AREA_WRITE:[1,2],MEMORY_AREA_FILL:[1,3],RUN:[4,1],STOP:[4,2]},e.exports.FatalErrorData={SYSTEM_ERROR:64,IO_SETTING_ERROR:1024,IO_POINT_OVERFLOW:2048,CPU_BUS_ERROR:16384,MEMORY_ERROR:32768},e.exports.NonFatalErrorData={PC_LINK_ERROR:1,HOST_LINK_ERROR:2,BATTERY_ERROR:16,REMOTE_IO_ERROR:32,SPECIAL_IO_UNIT_ERROR:256,IO_COLLATE_ERROR:512,SYSTEM_ERROR:32768},e.exports.Status={CPU_STANDBY:128,STOP:0,RUN:1},e.exports.Modes={MONITOR:2,DEBUG:1,RUN:4},e.exports.MemoryAreas={E:160,C:176,W:177,H:178,A:179,D:130},e.exports.Errors={"0000":"Completed normally","0001":"Service was interrupted","0101":"Local node not part of Network","0102":"Token time-out, node number too large","0103":"Number of transmit retries exceeded","0104":"Maximum number of frames exceeded","0105":"Node number setting error (range)","0106":"Node number duplication error"}},9317:(e,t,r)=>{var a=r(7194),i=r(2460).inherits,n=r(6261).EventEmitter,o=r(5407);function s(e,t,r){if(!(this instanceof s))return new s(e,t,r);n.call(this),s.init.call(this,e,t,r)}e.exports=s,i(s,n),_compareArrays=function(e,t){if(e.length!==t.length)return!1;for(var r=e.length;r--;)if(e[r]!==t[r])return!1;return!0},_mergeArrays=function(e){for(var t=[],r=0,a=e.length;r<a;r++){var i=Object.prototype.toString.call(e[r]).split(" ").pop().split("]").shift().toLowerCase();i&&(t=t.concat(/^(array|collection|arguments|object)$/.test(i)?_mergeArrays(e[r]):e[r]))}return t},_keyFromValue=function(e,t){return Object.keys(e).filter((function(r){return e[r]===t}))[0]},_padHex=function(e,t){return"0"*e+t.toString(16).substr(-e)},_wordsToBytes=function(e){var t=[];if(e.length)for(var r in e)t.push((65280&e[r])>>8),t.push(255&e[r]);else t.push((65280&e)>>8),t.push(255&e);return t},_translateMemoryAddress=function(e){var t=e.match(/(.)([0-9]*):?([0-9]*)/),r={MemoryArea:t[1],Address:t[2],Bit:t[3]},a=[];return o.MemoryAreas[r.MemoryArea]?a.push([o.MemoryAreas[r.MemoryArea]]):a.push([130]),a.push(_wordsToBytes([r.Address])),a.push([0]),_mergeArrays(a)},_incrementSID=function(e){return e%254+1},_buildHeader=function(e){return[e.ICF,e.RSV,e.GCT,e.DNA,e.DA1,e.DA2,e.SNA,e.SA1,e.SA2,e.SID]},_buildPacket=function(e){return _mergeArrays(e)},_getResponseType=function(e){var t=[];return t.push(e[10]),t.push(e[11]),t},_processDefault=function(e,t){var r=e[9],a=e.slice(10,12).toString("hex"),i=e.slice(12,14).toString("hex");return{remotehost:t.address,sid:r,command:a,response:i}},_processStatusRead=function(e,t){var r=e[9],a=e.slice(10,12).toString("hex"),i=e.slice(12,14).toString("hex"),n=e[14],s=e[15],l={},c={};for(var d in o.FatalErrorData)e.readInt16BE(17)&o.FatalErrorData[d]&&l.push(d);for(var d in o.nonFatalErrorData)e.readInt16BE(18)&o.nonFatalErrorData[d]&&c.push(d);var u=o.Status,p=o.Modes;return{remotehost:t.address,sid:r,command:a,response:i,status:_keyFromValue(u,n),mode:_keyFromValue(p,s),fatalErrorData:l||null,nonFatalErrorData:c||null}},_processMemoryAreaRead=function(e,t){for(var r=[],a=e[9],i=e.slice(10,12).toString("hex"),n=e.slice(12,14).toString("hex"),o=e.slice(14,e.length),s=0;s<o.length;s+=2)r.push(o.readInt16BE(s));return{remotehost:t.address,sid:a,command:i,response:n,values:r}},_processReply=function(e,t){var r=o.Commands;switch(_getResponseType(e).join(" ")){case r.CONTROLLER_STATUS_READ.join(" "):return _processStatusRead(e,t);case r.MEMORY_AREA_READ.join(" "):return _processMemoryAreaRead(e,t);default:return _processDefault(e,t)}},_decodePacket=function(e,t){for(var r=[],a=e.slice(10,12).toString("hex"),i=e.slice(12,14).toString("hex"),n=e.slice(14,e.length),o=0;o<n.length;o+=2)r.push(n.readInt16BE(o));return{remotehost:t.address,command:a,code:i,values:r}},s.init=function(e,t,r){var i=this,n=o.DefaultHostValues,s=o.DefaultOptions;this.port=e||n.port,this.host=t||n.host,this.timeout=r&&r.timeout||s.timeout,this.socket=a.createSocket("udp4"),this.responded=!1,this.header=o.DefaultFinsHeader,this.socket.on("message",(function(e,t){i.responded=!0;var r=_processReply(e,t);i.emit("reply",r)})),this.socket.on("listening",(function(){i.emit("open")})),this.socket.on("close",(function(){i.emit("close")})),this.socket.on("error",(function(e){i.emit("error",e)})),this.timeout&&setTimeout((function(){0==i.responded&&i.emit("timeout",i.host)}),i.timeout)},s.prototype.read=function(e,t,r){var a=this;a.header.SID=_incrementSID(a.header.SID);var i=_buildHeader(a.header),n=(e=_translateMemoryAddress(e),t=_wordsToBytes(t),o.Commands.MEMORY_AREA_READ),s=_buildPacket([i,n,[e,t]]),l=new Buffer(s);this.socket.send(l,0,l.length,a.port,a.host,r)},s.prototype.write=function(e,t,r){var a=this;a.header.SID=_incrementSID(a.header.SID);var i=_buildHeader(a.header),n=(e=_translateMemoryAddress(e),_wordsToBytes(t.length||1)),s=o.Commands.MEMORY_AREA_WRITE,l=(t=_wordsToBytes(t),_buildPacket([i,s,[e,n,t]])),c=new Buffer(l);this.socket.send(c,0,c.length,a.port,a.host,r)},s.prototype.fill=function(e,t,r,a){var i=this;i.header.SID=_incrementSID(i.header.SID);var n=_buildHeader(i.header),s=(e=_translateMemoryAddress(e),r=_wordsToBytes(r),o.Commands.MEMORY_AREA_FILL),l=(t=_wordsToBytes(t),_buildPacket([n,s,[e,r,t]])),c=new Buffer(l);this.socket.send(c,0,c.length,i.port,i.host,a)},s.prototype.run=function(e){var t=this;t.header.SID=_incrementSID(t.header.SID);var r=_buildHeader(t.header),a=o.Commands.RUN,i=_buildPacket([r,a]),n=new Buffer(i);this.socket.send(n,0,n.length,t.port,t.host,e)},s.prototype.stop=function(e){var t=this;t.header.SID=_incrementSID(t.header.SID);var r=_buildHeader(t.header),a=o.Commands.STOP,i=_buildPacket([r,a]),n=new Buffer(i);this.socket.send(n,0,n.length,t.port,t.host,e)},s.prototype.status=function(e){var t=this;t.header.SID=_incrementSID(t.header.SID);var r=_buildHeader(t.header),a=o.Commands.CONTROLLER_STATUS_READ,i=_buildPacket([r,a]),n=new Buffer(i);this.socket.send(n,0,n.length,t.port,t.host,e)},s.prototype.close=function(){this.socket.close()}},7557:(e,t,r)=>{var a=r(9317);t.FinsClient=a},5317:(e,t,r)=>{var a=r(9278),i=r(2460);function n(e){(e=e||{}).silent,e.debug;var t=this;t.connectReq=Buffer.from([3,0,0,22,17,224,0,0,0,2,0,192,1,10,193,2,1,0,194,2,1,2]),t.negotiatePDU=Buffer.from([3,0,0,25,2,240,128,50,1,0,0,0,0,0,8,0,0,240,0,0,8,0,8,3,192]),t.readReqHeader=Buffer.from([3,0,0,31,2,240,128,50,1,0,0,8,0,0,14,0,0,4,1]),t.readReq=Buffer.alloc(1500),t.writeReqHeader=Buffer.from([3,0,0,31,2,240,128,50,1,0,0,8,0,0,14,0,0,5,1]),t.writeReq=Buffer.alloc(1500),t.resetPending=!1,t.resetTimeout=void 0,t.isoclient=void 0,t.isoConnectionState=0,t.requestMaxPDU=960,t.maxPDU=960,t.requestMaxParallel=8,t.maxParallel=8,t.parallelJobsNow=0,t.maxGap=5,t.doNotOptimize=!1,t.connectCallback=void 0,t.readDoneCallback=void 0,t.writeDoneCallback=void 0,t.connectTimeout=void 0,t.PDUTimeout=void 0,t.globalTimeout=1500,t.rack=0,t.slot=2,t.localTSAP=null,t.remoteTSAP=null,t.readPacketArray=[],t.writePacketArray=[],t.polledReadBlockList=[],t.instantWriteBlockList=[],t.globalReadBlockList=[],t.globalWriteBlockList=[],t.masterSequenceNumber=1,t.translationCB=C,t.connectionParams=void 0,t.connectionID="UNDEF",t.addRemoveArray=[],t.readPacketValid=!1,t.writeInQueue=!1,t.connectCBIssued=!1,t.dropConnectionCallback=null,t.dropConnectionTimer=null,t.reconnectTimer=void 0,t.rereadTimer=void 0}function o(e){return!(!e.sent||!e.rcvd)}function s(e){var t=e[0],r=e.readInt16BE(2),a=e[5],i=e[6];return 3!==t&&240!==a?"error":i>>7||r!=e.length||7!==e.length?i>>7==1&&r<=e.length?e:i>>7||r===e.length?"error":e.slice(7,e.length):"fastACK"}function l(e,t){var r=0,a=Buffer.from([18,10,16,0,0,0,0,0,0,0,0,0]);return a[3]=2,"X"===e.datatype?(a.writeUInt16BE(e.byteLength,4),t&&1===e.arrayLength&&(a[3]=1,r=e.bitOffset)):"TIMER"===e.datatype||"COUNTER"===e.datatype?(a.writeUInt16BE(1,4),a.writeUInt8(e.areaS7Code,3)):a.writeUInt16BE(e.byteLength,4),a.writeUInt16BE(e.dbNumber,6),a.writeUInt32BE(8*e.offset+r,8),a[8]|=e.areaS7Code,a}function c(e,t,r,a){var i;if(void 0===e)i=0;else{if(isNaN(t.byteLength))return 0;i=e.length-r}var n,o=r;if(t.qualityBuffer=Buffer.alloc(t.byteLength),t.qualityBuffer.fill(255),i<4)return t.valid=!1,t.errCode=void 0!==e?"Malformed Packet - Less Than 4 Bytes.  TDL"+e.length+"TP"+r+"RL"+i:"Timeout error - zero length packet",t.errCode,0;n=4==t.readTransportCode?e.readUInt16BE(r+2)/8:e.readUInt16BE(r+2);var s=e[r],l=e[r+1];if(i<n+2)return t.valid=!1,t.errCode="Malformed Packet - Item Data Length and Packet Length Disagree.  RDL+2 "+(n+2)+" remainingLength "+i,t.errCode,0;if(255!==s)return t.valid=!1,t.errCode="Invalid Response Code - "+s,t.errCode,r+n+4;if(l!==t.readTransportCode)return t.valid=!1,t.errCode="Invalid Transport Code - "+l,t.errCode,r+n+4;var c=t.byteLength;return n!==c?(t.valid=!1,t.errCode="Invalid Response Length - Expected "+c+" but got "+n+" bytes.",t.errCode,n+2):(r+=4,t.valid=!0,t.byteBuffer=e.slice(r,r+n),t.qualityBuffer.fill(192),((r+=t.byteLength)-o)%2&&(r+=1),r)}function d(e,t,r){var a;if(!e)return t.writeQualityBuffer.fill(255),t.valid=!1,t.errCode="We must have timed Out - we have no response to process",t.errCode,0;if((a=e.length-r)<1)return t.writeQualityBuffer.fill(255),t.valid=!1,t.errCode="Malformed Packet - Less Than 1 Byte.  TDL "+e.length+" TP"+r+" RL"+a,t.errCode,0;var i=e.readUInt8(r);return t.writeResponse=i,255!==i?(t.writeResponse,t.addr,t.writeQualityBuffer.fill(255)):t.writeQualityBuffer.fill(192),r+1}function u(e){var t=0;if(1===e.arrayLength)255===e.writeQualityBuffer[0]?e.writeQuality="BAD":e.writeQuality="OK";else{e.writeQuality=[];for(var r=0;r<e.arrayLength;r++)255===e.writeQualityBuffer[t]?e.writeQuality[r]="BAD":e.writeQuality[r]="OK","X"==e.datatype&&(r+e.bitOffset+1)%8!=0&&r!=e.arrayLength-1||(t+=e.dtypelen)}}function p(e){return 10*(e>>4)+(15&e)}function y(e){return e/10<<4|e%10}function g(e,t,r){let a,i=p(e.readUInt8(t)),n=p(e.readUInt8(t+1)),o=p(e.readUInt8(t+2)),s=p(e.readUInt8(t+3)),l=p(e.readUInt8(t+4)),c=p(e.readUInt8(t+5)),d=p(e.readUInt8(t+6)),u=p(240&e.readUInt8(t+7));return a=r?new Date(Date.UTC((i>89?1900:2e3)+i,n-1,o,s,l,c,10*d+u/10)):new Date((i>89?1900:2e3)+i,n-1,o,s,l,c,10*d+u/10),a}function f(e,t,r,a){if(!(e instanceof Date)){if(!(e>631152e6&&e<3786911999999))return;e=new Date(e)}a?(t.writeUInt8(y(e.getUTCFullYear()%100),r),t.writeUInt8(y(e.getUTCMonth()+1),r+1),t.writeUInt8(y(e.getUTCDate()),r+2),t.writeUInt8(y(e.getUTCHours()),r+3),t.writeUInt8(y(e.getUTCMinutes()),r+4),t.writeUInt8(y(e.getUTCSeconds()),r+5),t.writeUInt8(y(e.getUTCMilliseconds()/10|0),r+6),t.writeUInt8(y(e.getUTCMilliseconds()%10*10+(e.getUTCDay()+1)),r+7)):(t.writeUInt8(y(e.getFullYear()%100),r),t.writeUInt8(y(e.getMonth()+1),r+1),t.writeUInt8(y(e.getDate()),r+2),t.writeUInt8(y(e.getHours()),r+3),t.writeUInt8(y(e.getMinutes()),r+4),t.writeUInt8(y(e.getSeconds()),r+5),t.writeUInt8(y(e.getMilliseconds()/10|0),r+6),t.writeUInt8(y(e.getMilliseconds()%10*10+(e.getDay()+1)),r+7))}function m(e,t,r){let a,i=e.readUInt16BE(t),n=e.readUInt8(t+2),o=e.readUInt8(t+3),s=e.readUInt8(t+5),l=e.readUInt8(t+6),c=e.readUInt8(t+7),d=e.readUInt32BE(t+8);return a=r?new Date(Date.UTC(i,n-1,o,s,l,c,d/1e6)):new Date(i,n-1,o,s,l,c,d/1e6),a}function h(e,t,r,a){if(!(e instanceof Date)){if(!(e>=0&&e<9223382836854))return;e=new Date(e)}a?(t.writeUInt16BE(e.getUTCFullYear(),r),t.writeUInt8(e.getUTCMonth()+1,r+2),t.writeUInt8(e.getUTCDate(),r+3),t.writeUInt8(e.getUTCDay()+1,r+4),t.writeUInt8(e.getUTCHours(),r+5),t.writeUInt8(e.getUTCMinutes(),r+6),t.writeUInt8(e.getUTCSeconds(),r+7),t.writeUInt32BE(1e6*e.getUTCMilliseconds(),r+8)):(t.writeUInt16BE(e.getFullYear(),r),t.writeUInt8(e.getMonth()+1,r+2),t.writeUInt8(e.getDate(),r+3),t.writeUInt8(e.getDay()+1,r+4),t.writeUInt8(e.getHours(),r+5),t.writeUInt8(e.getMinutes(),r+6),t.writeUInt8(e.getSeconds(),r+7),t.writeUInt32BE(1e6*e.getMilliseconds(),r+8))}function v(e){var t=0,r=0,a="";if(e.arrayLength>1){"C"!=e.datatype&&"CHAR"!=e.datatype?(e.value=[],e.quality=[]):(e.value="",e.quality="");for(var i=e.bitOffset,n=0;n<e.arrayLength;n++){if(192!==e.qualityBuffer[t])e.quality instanceof Array?(e.value.push(e.badValue()),e.quality.push("BAD "+e.qualityBuffer[t])):(e.value=e.badValue(),e.quality="BAD "+e.qualityBuffer[t]);else switch(e.quality instanceof Array?e.quality.push("OK"):e.quality="OK",e.datatype){case"DT":e.value.push(g(e.byteBuffer,t,!1));break;case"DTZ":e.value.push(g(e.byteBuffer,t,!0));break;case"DTL":e.value.push(m(e.byteBuffer,t,!1));break;case"DTLZ":e.value.push(m(e.byteBuffer,t,!0));break;case"REAL":e.value.push(e.byteBuffer.readFloatBE(t));break;case"LREAL":e.value.push(e.byteBuffer.readDoubleBE(t));break;case"LINT":break;case"DWORD":e.value.push(e.byteBuffer.readUInt32BE(t));break;case"DINT":e.value.push(e.byteBuffer.readInt32BE(t));break;case"INT":case"TIMER":case"COUNTER":e.value.push(e.byteBuffer.readInt16BE(t));break;case"WORD":e.value.push(e.byteBuffer.readUInt16BE(t));break;case"X":e.value.push(!!(e.byteBuffer.readUInt8(t)>>i&1));break;case"B":case"BYTE":e.value.push(e.byteBuffer.readUInt8(t));break;case"S":case"STRING":r=e.byteBuffer.readUInt8(t+1),a="";for(var o=2;o<e.dtypelen&&o-2<r;o++)a+=String.fromCharCode(e.byteBuffer.readUInt8(t+o));e.value.push(a);break;case"C":case"CHAR":e.value+=String.fromCharCode(e.byteBuffer.readUInt8(t));break;default:return e.datatype,0}"X"==e.datatype?(i++,(n+e.bitOffset+1)%8!=0&&n!=e.arrayLength-1||(t+=e.dtypelen,i=0)):t+=e.dtypelen}}else{if(192!==e.qualityBuffer[t])e.value=e.badValue(),e.quality="BAD "+e.qualityBuffer[t];else switch(e.quality="OK",e.datatype){case"DT":e.value=g(e.byteBuffer,t,!1);break;case"DTZ":e.value=g(e.byteBuffer,t,!0);break;case"DTL":e.value=m(e.byteBuffer,t,!1);break;case"DTLZ":e.value=m(e.byteBuffer,t,!0);break;case"REAL":e.value=e.byteBuffer.readFloatBE(t);break;case"LREAL":e.value=e.byteBuffer.readDoubleBE(t);break;case"LINT":break;case"DWORD":e.value=e.byteBuffer.readUInt32BE(t);break;case"DINT":e.value=e.byteBuffer.readInt32BE(t);break;case"INT":case"TIMER":case"COUNTER":e.value=e.byteBuffer.readInt16BE(t);break;case"WORD":e.value=e.byteBuffer.readUInt16BE(t);break;case"X":e.value=!!(e.byteBuffer.readUInt8(t)>>e.bitOffset&1);break;case"B":case"BYTE":e.value=e.byteBuffer.readUInt8(t);break;case"S":case"STRING":for(r=e.byteBuffer.readUInt8(t+1),e.value="",o=2;o<e.dtypelen&&o-2<r;o++)e.value+=String.fromCharCode(e.byteBuffer.readUInt8(t+o));break;case"C":case"CHAR":e.value=String.fromCharCode(e.byteBuffer.readUInt8(t));break;default:return e.datatype,0}t+=e.dtypelen}return t%2&&(t+=1),t}function b(e){var t,r;if(r=0,t=0,e.arrayLength>1)for(var a=e.bitOffset,i=0;i<e.arrayLength;i++){switch(e.datatype){case"DT":f(e.writeValue[i],e.writeBuffer,t,!1);break;case"DTZ":f(e.writeValue[i],e.writeBuffer,t,!0);break;case"DTL":h(e.writeValue[i],e.writeBuffer,t,!1);break;case"DTLZ":h(e.writeValue[i],e.writeBuffer,t,!0);break;case"REAL":e.writeBuffer.writeFloatBE(e.writeValue[i],t);break;case"LREAL":e.writeBuffer.writeDoubleBE(e.writeValue[i],t);break;case"LINT":break;case"DWORD":case"DINT":e.writeBuffer.writeInt32BE(e.writeValue[i],t);break;case"INT":case"TIMER":case"COUNTER":e.writeBuffer.writeInt16BE(e.writeValue[i],t);break;case"WORD":e.writeBuffer.writeUInt16BE(e.writeValue[i],t);break;case"X":r|=(!0===e.writeValue[i]?1:0)<<a,e.writeBuffer.writeUInt8(r,t),a++;break;case"B":case"BYTE":e.writeBuffer.writeUInt8(e.writeValue[i],t);break;case"C":case"CHAR":e.writeBuffer.writeUInt8(e.writeValue.charCodeAt(i),t);break;case"S":case"STRING":e.writeBuffer.writeUInt8(e.dtypelen-2,t),e.writeBuffer.writeUInt8(Math.min(e.dtypelen-2,e.writeValue[i].length),t+1);for(var n=2;n<e.dtypelen;n++)n<e.writeValue[i].length+2?e.writeBuffer.writeUInt8(e.writeValue[i].charCodeAt(n-2),t+n):e.writeBuffer.writeUInt8(32,t+n);break;default:return e.datatype,0}"X"==e.datatype?(i+e.bitOffset+1)%8!=0&&i!=e.arrayLength-1||(t+=e.dtypelen,a=0,r=0):t+=e.dtypelen}else{switch(e.datatype){case"DT":f(e.writeValue,e.writeBuffer,t,!1);break;case"DTZ":f(e.writeValue,e.writeBuffer,t,!0);break;case"DTL":h(e.writeValue,e.writeBuffer,t,!1);break;case"DTLZ":h(e.writeValue,e.writeBuffer,t,!0);break;case"REAL":e.writeBuffer.writeFloatBE(e.writeValue,t);break;case"LREAL":e.writeBuffer.writeDoubleBE(e.writeValue,t);break;case"LINT":break;case"DWORD":e.writeBuffer.writeUInt32BE(e.writeValue,t);break;case"DINT":e.writeBuffer.writeInt32BE(e.writeValue,t);break;case"INT":case"TIMER":case"COUNTER":e.writeBuffer.writeInt16BE(e.writeValue,t);break;case"WORD":e.writeBuffer.writeUInt16BE(e.writeValue,t);break;case"X":e.writeBuffer.writeUInt8(!0===e.writeValue?1:0,t);break;case"B":case"BYTE":e.writeBuffer.writeUInt8(e.writeValue,t);break;case"C":case"CHAR":e.writeBuffer.writeUInt8(e.writeValue.charCodeAt(0),t);break;case"S":case"STRING":for(e.writeBuffer.writeUInt8(e.dtypelen-2,t),e.writeBuffer.writeUInt8(Math.min(e.dtypelen-2,e.writeValue.length),t+1),n=2;n<e.dtypelen;n++)n<e.writeValue.length+2?e.writeBuffer.writeUInt8(e.writeValue.charCodeAt(n-2),t+n):e.writeBuffer.writeUInt8(32,t+n);break;default:return e.datatype,0}t+=e.dtypelen}}function S(e,t,r){"use strict";var a,i,n;if("_COMMERR"!==t&&(a=new _,!(0===(i=e.split(",")).length||i.length>2))){if(i.length>1){if(a.addrtype="DB",n=i[1].split("."),a.datatype=n[0].replace(/[0-9]/gi,"").toUpperCase(),"X"===a.datatype&&3===n.length?a.arrayLength=parseInt(n[2],10):"S"!==a.datatype&&"STRING"!==a.datatype||3!==n.length?"S"!==a.datatype&&"STRING"!==a.datatype||2!==n.length?"X"!==a.datatype&&2===n.length?a.arrayLength=parseInt(n[1],10):a.arrayLength=1:(a.dtypelen=parseInt(n[1],10)+2,a.arrayLength=1):(a.dtypelen=parseInt(n[1],10)+2,a.arrayLength=parseInt(n[2],10)),a.arrayLength<=0)return;if(a.dbNumber=parseInt(i[0].replace(/[A-z]/gi,""),10),a.offset=parseInt(n[0].replace(/[A-z]/gi,""),10),n.length>1&&"X"===a.datatype&&(a.bitOffset=parseInt(n[1],10),a.bitOffset>7))return}else{switch((n=e.split("."))[0].replace(/[0-9]/gi,"")){case"PIB":case"PEB":case"PQB":case"PAB":a.addrtype="P",a.datatype="BYTE";break;case"PIC":case"PEC":case"PQC":case"PAC":a.addrtype="P",a.datatype="CHAR";break;case"PIW":case"PEW":case"PQW":case"PAW":a.addrtype="P",a.datatype="WORD";break;case"PII":case"PEI":case"PQI":case"PAI":a.addrtype="P",a.datatype="INT";break;case"PID":case"PED":case"PQD":case"PAD":a.addrtype="P",a.datatype="DWORD";break;case"PIDI":case"PEDI":case"PQDI":case"PADI":a.addrtype="P",a.datatype="DINT";break;case"PIR":case"PER":case"PQR":case"PAR":a.addrtype="P",a.datatype="REAL";break;case"I":case"E":a.addrtype="I",a.datatype="X";break;case"IB":case"EB":a.addrtype="I",a.datatype="BYTE";break;case"IC":case"EC":a.addrtype="I",a.datatype="CHAR";break;case"IW":case"EW":a.addrtype="I",a.datatype="WORD";break;case"II":case"EI":a.addrtype="I",a.datatype="INT";break;case"ID":case"ED":a.addrtype="I",a.datatype="DWORD";break;case"IDI":case"EDI":a.addrtype="I",a.datatype="DINT";break;case"IR":case"ER":a.addrtype="I",a.datatype="REAL";break;case"ILR":case"ELR":a.addrtype="I",a.datatype="LREAL";break;case"ILI":case"ELI":a.addrtype="I",a.datatype="LINT";break;case"Q":case"A":a.addrtype="Q",a.datatype="X";break;case"QB":case"AB":a.addrtype="Q",a.datatype="BYTE";break;case"QC":case"AC":a.addrtype="Q",a.datatype="CHAR";break;case"QW":case"AW":a.addrtype="Q",a.datatype="WORD";break;case"QI":case"AI":a.addrtype="Q",a.datatype="INT";break;case"QD":case"AD":a.addrtype="Q",a.datatype="DWORD";break;case"QDI":case"ADI":a.addrtype="Q",a.datatype="DINT";break;case"QR":case"AR":a.addrtype="Q",a.datatype="REAL";break;case"QLR":case"ALR":a.addrtype="Q",a.datatype="LREAL";break;case"QLI":case"ALI":a.addrtype="Q",a.datatype="LINT";break;case"M":a.addrtype="M",a.datatype="X";break;case"MB":a.addrtype="M",a.datatype="BYTE";break;case"MC":a.addrtype="M",a.datatype="CHAR";break;case"MW":a.addrtype="M",a.datatype="WORD";break;case"MI":a.addrtype="M",a.datatype="INT";break;case"MD":a.addrtype="M",a.datatype="DWORD";break;case"MDI":a.addrtype="M",a.datatype="DINT";break;case"MR":a.addrtype="M",a.datatype="REAL";break;case"MLR":a.addrtype="M",a.datatype="LREAL";break;case"MLI":a.addrtype="M",a.datatype="LINT";break;case"T":a.addrtype="T",a.datatype="TIMER";break;case"C":a.addrtype="C",a.datatype="COUNTER";break;default:return void n[0]}a.bitOffset=0,n.length>1&&"X"===a.datatype?(a.bitOffset=parseInt(n[1].replace(/[A-z]/gi,""),10),n.length>2?a.arrayLength=parseInt(n[2].replace(/[A-z]/gi,""),10):a.arrayLength=1):n.length>1&&"X"!==a.datatype?a.arrayLength=parseInt(n[1].replace(/[A-z]/gi,""),10):a.arrayLength=1,a.dbNumber=0,a.offset=parseInt(n[0].replace(/[A-z]/gi,""),10)}switch("DI"===a.datatype&&(a.datatype="DINT"),"I"===a.datatype&&(a.datatype="INT"),"DW"!==a.datatype&&"DWT"!==a.datatype||(a.datatype="DWORD"),"WDT"===a.datatype&&(r.wdtAsUTC?a.datatype="DTZ":a.datatype="DT"),"W"===a.datatype&&(a.datatype="WORD"),"R"===a.datatype&&(a.datatype="REAL"),"LR"===a.datatype&&(a.datatype="LREAL"),"LI"===a.datatype&&(a.datatype="LINT"),a.datatype){case"DTL":case"DTLZ":a.dtypelen=12;break;case"LREAL":case"LINT":case"DT":case"DTZ":a.dtypelen=8;break;case"REAL":case"DWORD":case"DINT":a.dtypelen=4;break;case"INT":case"WORD":case"TIMER":case"COUNTER":a.dtypelen=2;break;case"X":case"B":case"C":case"BYTE":case"CHAR":a.dtypelen=1;break;case"S":case"STRING":break;default:return void a.datatype}switch(a.readTransportCode=4,a.addrtype){case"DB":case"DI":a.areaS7Code=132;break;case"I":case"E":a.areaS7Code=129;break;case"Q":case"A":a.areaS7Code=130;break;case"M":a.areaS7Code=131;break;case"P":a.areaS7Code=128;break;case"C":a.areaS7Code=28,a.readTransportCode=9;break;case"T":a.areaS7Code=29,a.readTransportCode=9;break;default:return void a.addrtype}return"X"===a.datatype&&1===a.arrayLength?a.writeTransportCode=3:a.writeTransportCode=a.readTransportCode,a.addr=e,a.useraddr=void 0===t?e:t,"X"===a.datatype?a.byteLength=Math.ceil((a.bitOffset+a.arrayLength)/8):a.byteLength=a.arrayLength*a.dtypelen,a.byteLengthWithFill=a.byteLength,a.byteLengthWithFill%2&&(a.byteLengthWithFill+=1),a}}function D(){this.seqNum=void 0,this.itemList=void 0,this.reqTime=void 0,this.sent=!1,this.rcvd=!1,this.timeoutError=void 0,this.timeout=void 0}function _(){this.addr=void 0,this.useraddr=void 0,this.addrtype=void 0,this.datatype=void 0,this.dbNumber=void 0,this.bitOffset=void 0,this.offset=void 0,this.arrayLength=void 0,this.dtypelen=void 0,this.areaS7Code=void 0,this.byteLength=void 0,this.byteLengthWithFill=void 0,this.readTransportCode=void 0,this.writeTransportCode=void 0,this.byteBuffer=Buffer.alloc(8192),this.writeBuffer=Buffer.alloc(8192),this.qualityBuffer=Buffer.alloc(8192),this.writeQualityBuffer=Buffer.alloc(8192),this.value=void 0,this.writeValue=void 0,this.valid=!1,this.errCode=void 0,this.part=void 0,this.maxPart=void 0,this.isOptimized=!1,this.resultReference=void 0,this.itemReference=void 0,this.clone=function(){var e=new _;for(var t in this)"clone"!=t&&(e[t]=this[t]);return e},this.badValue=function(){switch(this.datatype){case"DT":case"DTZ":case"DTL":case"DTLZ":return new Date(NaN);case"REAL":case"LREAL":case"DWORD":case"DINT":case"INT":case"LINT":case"WORD":case"B":case"BYTE":case"TIMER":case"COUNTER":return 0;case"X":return!1;case"C":case"CHAR":case"S":case"STRING":return"";default:return this.datatype,0}}}function I(e,t){if(e.areaS7Code<t.areaS7Code)return-1;if(e.areaS7Code>t.areaS7Code)return 1;if("DB"===e.addrtype){if(e.dbNumber<t.dbNumber)return-1;if(e.dbNumber>t.dbNumber)return 1}return e.offset<t.offset?-1:e.offset>t.offset?1:e.bitOffset<t.bitOffset?-1:e.bitOffset>t.bitOffset?1:e.byteLength>t.byteLength?-1:e.byteLength<t.byteLength?1:void 0}function C(e){return e}function R(e){if("string"==typeof e){if("OK"!==e)return!1}else if(Array.isArray(e))for(var t=0;t<e.length;t++)if("string"!=typeof e[t]||"OK"!==e[t])return!1;return!0}e.exports=n,n.prototype.getNextSeqNum=function(){var e=this;return e.masterSequenceNumber+=1,e.masterSequenceNumber>32767&&(e.masterSequenceNumber=1),e.masterSequenceNumber,e.connectionID,e.masterSequenceNumber},n.prototype.setTranslationCB=function(e){"function"==typeof e&&(this.translationCB=e)},n.prototype.initiateConnection=function(e,t){var r=this;void 0===e&&(e={port:102,host:"192.168.8.106"}),void 0!==e.rack&&(r.rack=e.rack),void 0!==e.slot&&(r.slot=e.slot),void 0!==e.localTSAP&&(r.localTSAP=e.localTSAP),void 0!==e.remoteTSAP&&(r.remoteTSAP=e.remoteTSAP),void 0===e.connection_name?r.connectionID=e.host+" S"+r.slot:r.connectionID=e.connection_name,void 0!==e.doNotOptimize&&(r.doNotOptimize=e.doNotOptimize),void 0!==e.timeout&&(r.globalTimeout=e.timeout),r.connectionParams=e,r.connectCallback=t,r.connectCBIssued=!1,r.connectNow(r.connectionParams,!1)},n.prototype.dropConnection=function(e){var t=this;clearTimeout(t.reconnectTimer),clearTimeout(t.rereadTimer),clearTimeout(t.connectTimeout),clearTimeout(t.PDUTimeout),t.reconnectTimer=void 0,t.rereadTimer=void 0,t.connectTimeout=void 0,t.PDUTimeout=void 0,void 0!==t.isoclient?(t.dropConnectionCallback=e,t.isoclient.end(),t.dropConnectionTimer=setTimeout((function(){t.dropConnectionCallback&&(t.connectionCleanup(),t.dropConnectionCallback(),t.dropConnectionCallback=null)}),2500)):e()},n.prototype.connectNow=function(e){var t=this;clearTimeout(t.reconnectTimer),t.reconnectTimer=void 0,t.isoConnectionState>=1||(t.connectionCleanup(),t.isoclient=a.connect(e),t.isoclient.setTimeout(e.timeout||5e3,(()=>{t.isoclient.destroy(),t.connectError.apply(t,[{code:"EUSERTIMEOUT"}])})),t.isoclient.once("connect",(()=>{t.isoclient.setTimeout(0),t.onTCPConnect.apply(t,arguments)})),t.isoConnectionState=1,t.isoclient.on("error",(function(){t.connectError.apply(t,arguments)})),Date(),t.connectionID,t.connectionID)},n.prototype.connectError=function(e){var t=this;e.code,t.connectionID,t.connectCBIssued||"function"!=typeof t.connectCallback||(t.connectCBIssued=!0,t.connectCallback(e)),t.isoConnectionState=0},n.prototype.readWriteError=function(e){e.code,this.isoConnectionState=0,this.connectionReset()},n.prototype.packetTimeout=function(e,t){var r=this;return r.connectionID,"connect"===e?(r.connectionID,r.connectionID,r.connectionReset(),r.connectionID,clearTimeout(r.reconnectTimer),void(r.reconnectTimer=setTimeout((function(){r.connectionID,0===r.isoConnectionState&&r.connectNow.apply(r,arguments)}),2e3,r.connectionParams))):"PDU"===e?(r.connectionID,r.connectionReset(),r.connectionID,clearTimeout(r.reconnectTimer),void(r.reconnectTimer=setTimeout((function(){r.connectionID,r.connectNow.apply(r,arguments)}),2e3,r.connectionParams))):"read"===e?(r.connectionID,4===r.isoConnectionState&&(r.connectionID,r.connectionReset()),void r.readResponse(void 0,r.findReadIndexOfSeqNum(t))):"write"===e?(r.connectionID,4===r.isoConnectionState&&(r.connectionID,r.connectionReset()),void r.writeResponse(void 0,r.findWriteIndexOfSeqNum(t))):void 0},n.prototype.onTCPConnect=function(){var e,t=this;t.isoclient.remoteAddress,t.isoclient.remotePort,t.connectionID,t.connectionID,t.isoConnectionState=2,t.connectTimeout=setTimeout((function(){t.packetTimeout.apply(t,arguments)}),t.globalTimeout,"connect"),e=t.connectReq.slice(),null!==t.localTSAP&&null!==t.remoteTSAP?(t.localTSAP.toString(16),t.remoteTSAP.toString(16),t.connectionID,e.writeUInt16BE(t.localTSAP,16),e.writeUInt16BE(t.remoteTSAP,20)):(t.rack,t.slot,t.connectionID,e[21]=32*t.rack+t.slot),t.isoclient.write(e),t.isoclient.on("data",(function(){t.onISOConnectReply.apply(t,arguments)})),t.isoclient.on("end",(function(){t.onClientDisconnect.apply(t,arguments)})),t.isoclient.on("close",(function(){t.onClientClose.apply(t,arguments)}))},n.prototype.onISOConnectReply=function(e){var t=this;if(t.isoclient.removeAllListeners("data"),clearTimeout(t.connectTimeout),2==t.isoConnectionState){if(t.isoConnectionState=3,e.readInt16BE(2)!==e.length||e.length<22||208!==e[5]||e[4]!==e.length-5)return e.readInt16BE(2),e.length,e.readUInt8(4),e[5],t.connectionReset(),null;t.connectionID,t.negotiatePDU.writeInt16BE(t.requestMaxParallel,19),t.negotiatePDU.writeInt16BE(t.requestMaxParallel,21),t.negotiatePDU.writeInt16BE(t.requestMaxPDU,23),t.PDUTimeout=setTimeout((function(){t.packetTimeout.apply(t,arguments)}),t.globalTimeout,"PDU"),t.isoclient.write(t.negotiatePDU.slice(0,25)),t.isoclient.on("data",(function(){t.onPDUReply.apply(t,arguments)})),t.isoclient.removeAllListeners("error"),t.isoclient.on("error",(function(){t.readWriteError.apply(t,arguments)}))}else t.isoConnectionState,t.connectionID},n.prototype.onPDUReply=function(e){var t=this;t.isoclient.removeAllListeners("data"),t.isoclient.removeAllListeners("error"),clearTimeout(t.PDUTimeout);var r=s(e);if("fastACK"===r)t.connectionID,t.isoclient.removeAllListeners("error"),t.isoclient.removeAllListeners("data"),t.isoclient.on("data",(function(){t.onPDUReply.apply(t,arguments)})),t.isoclient.on("error",(function(){t.readWriteError.apply(t,arguments)}));else{if(r[4]+1+12+r.readInt16BE(13)!==r.readInt16BE(2)-4)return t.connectionID,e[0],e[5],t.connectionID,t.connectionID,e.readInt16BE(2),e.length,e.readUInt8(4),e[6],t.connectionID,t.isoclient.end(),clearTimeout(t.reconnectTimer),t.reconnectTimer=setTimeout((function(){t.connectNow.apply(t,arguments)}),2e3,t.connectionParams),null;t.isoConnectionState=4,t.parallelJobsNow=0;var a=r.readInt16BE(21),i=r.readInt16BE(23),n=r.readInt16BE(25);t.maxParallel=t.requestMaxParallel,a<t.requestMaxParallel&&(t.maxParallel=a),i<t.requestMaxParallel&&(t.maxParallel=i),n<t.requestMaxPDU?t.maxPDU=n:t.maxPDU=t.requestMaxPDU,t.maxPDU,t.maxParallel,t.connectionID,t.isoclient.on("data",(function(){t.onResponse.apply(t,arguments)})),t.isoclient.on("error",(function(){t.readWriteError.apply(t,arguments)})),t.connectCBIssued||"function"!=typeof t.connectCallback||(t.connectCBIssued=!0,t.connectCallback())}},n.prototype.writeItems=function(e,t,r){var a,i=this;if(i.connectionID,i.isWriting()||i.writeInQueue)return i.connectionID,1;if(i.writeDoneCallback="function"==typeof r?r:C,i.instantWriteBlockList=[],"string"==typeof e)i.instantWriteBlockList.push(S(i.translationCB(e),e,i.connectionParams)),void 0!==i.instantWriteBlockList[i.instantWriteBlockList.length-1]&&(i.instantWriteBlockList[i.instantWriteBlockList.length-1].writeValue=t);else if(Array.isArray(e)&&Array.isArray(t)&&e.length==t.length)for(a=0;a<e.length;a++)"string"==typeof e[a]&&(i.instantWriteBlockList.push(S(i.translationCB(e[a]),e[a],i.connectionParams)),void 0!==i.instantWriteBlockList[i.instantWriteBlockList.length-1]&&(i.instantWriteBlockList[i.instantWriteBlockList.length-1].writeValue=t[a]));for(a=i.instantWriteBlockList.length-1;a>=0;a--)void 0===i.instantWriteBlockList[a]&&i.instantWriteBlockList.splice(a,1);return i.prepareWritePacket(),i.isReading()?(i.writeInQueue&&i.connectionID,i.writeInQueue=!0):i.sendWritePacket(),0},n.prototype.findItem=function(e){var t,r=this,a={value:4!==r.isoConnectionState,quality:"OK"};if("_COMMERR"===e)return a;for(t=0;t<r.polledReadBlockList.length;t++)if(r.polledReadBlockList[t].useraddr===e)return r.polledReadBlockList[t]},n.prototype.addItems=function(e){this.addRemoveArray.push({arg:e,action:"add"})},n.prototype.addItemsNow=function(e){var t,r=this;if(r.connectionID,"string"==typeof e&&"_COMMERR"!==e)r.polledReadBlockList.push(S(r.translationCB(e),e,r.connectionParams));else if(Array.isArray(e))for(t=0;t<e.length;t++)"string"==typeof e[t]&&"_COMMERR"!==e[t]&&r.polledReadBlockList.push(S(r.translationCB(e[t]),e[t],r.connectionParams));for(t=r.polledReadBlockList.length-1;t>=0;t--)void 0===r.polledReadBlockList[t]&&(r.polledReadBlockList.splice(t,1),r.connectionID);r.readPacketValid=!1},n.prototype.removeItems=function(e){this.addRemoveArray.push({arg:e,action:"remove"})},n.prototype.removeItemsNow=function(e){var t,r=this;if(void 0===e)r.polledReadBlockList=[];else if("string"==typeof e)for(t=0;t<r.polledReadBlockList.length;t++)r.translationCB(e),r.polledReadBlockList[t].addr===r.translationCB(e)&&r.polledReadBlockList.splice(t,1);else if(Array.isArray(e))for(t=0;t<r.polledReadBlockList.length;t++)for(var a=0;a<e.length;a++)r.polledReadBlockList[t].addr===r.translationCB(e[a])&&r.polledReadBlockList.splice(t,1);r.readPacketValid=!1},n.prototype.readAllItems=function(e){var t=this;if(t.connectionID,t.readDoneCallback="function"==typeof e?e:C,4!==t.isoConnectionState&&t.connectionID,t.isWaiting())return t.connectionID,clearTimeout(t.rereadTimer),void(t.rereadTimer=setTimeout((function(){t.rereadTimer=void 0,t.readAllItems.apply(t,arguments)}),100,e));t.addRemoveArray.forEach((function(e){i.format(e),t.connectionID,"remove"===e.action&&t.removeItemsNow(e.arg),"add"===e.action&&t.addItemsNow(e.arg)})),t.addRemoveArray=[],t.readPacketValid||t.prepareReadPacket(),t.connectionID,t.sendReadPacket()},n.prototype.isWaiting=function(){return this.isReading()||this.isWriting()},n.prototype.isReading=function(){var e;for(e=0;e<this.readPacketArray.length;e++)if(!0===this.readPacketArray[e].sent)return!0;return!1},n.prototype.isWriting=function(){var e;for(e=0;e<this.writePacketArray.length;e++)if(!0===this.writePacketArray[e].sent)return!0;return!1},n.prototype.clearReadPacketTimeouts=function(){var e,t=this;for(t.connectionID,e=0;e<t.readPacketArray.length;e++)clearTimeout(t.readPacketArray[e].timeout),t.readPacketArray[e].sent=!1,t.readPacketArray[e].rcvd=!1},n.prototype.clearWritePacketTimeouts=function(){var e,t=this;for(t.connectionID,e=0;e<t.writePacketArray.length;e++)clearTimeout(t.writePacketArray[e].timeout),t.writePacketArray[e].sent=!1,t.writePacketArray[e].rcvd=!1},n.prototype.prepareWritePacket=function(){var e,t=this,r=t.instantWriteBlockList,a=[],i=0;if(r.sort(I),0!==r.length){t.globalWriteBlockList=[],t.globalWriteBlockList[0]=r[0],t.globalWriteBlockList[0].itemReference=[],t.globalWriteBlockList[0].itemReference.push(r[0]),r[0].block=0;var n=Math.floor((t.maxPDU-18-12)/4);for(n=8*Math.floor((t.maxPDU-18-12)/8),e=0;e<r.length;e++)t.globalWriteBlockList[e]=r[e],t.globalWriteBlockList[e].isOptimized=!1,t.globalWriteBlockList[e].itemReference=[],t.globalWriteBlockList[e].itemReference.push(r[e]),b(r[e]);var o=0;for(e=0;e<t.globalWriteBlockList.length;e++){var s=t.globalWriteBlockList[e].offset,l=t.globalWriteBlockList[e].byteLength,c=0;a[o]=t.globalWriteBlockList[e].clone(),t.globalWriteBlockList[e].parts=Math.ceil(t.globalWriteBlockList[e].byteLength/n),t.globalWriteBlockList[e].requestReference=[];for(var d=0;d<t.globalWriteBlockList[e].parts;d++)a[o]=t.globalWriteBlockList[e].clone(),t.globalWriteBlockList[e].requestReference.push(a[o]),a[o].offset=s,a[o].byteLength=Math.min(n,l),a[o].byteLengthWithFill=a[o].byteLength,a[o].byteLengthWithFill%2&&(a[o].byteLengthWithFill+=1),a[o].writeBuffer=t.globalWriteBlockList[e].writeBuffer.slice(c,c+a[o].byteLengthWithFill),a[o].writeQualityBuffer=t.globalWriteBlockList[e].writeQualityBuffer.slice(c,c+a[o].byteLengthWithFill),c+=t.globalWriteBlockList[e].requestReference[d].byteLength,t.globalWriteBlockList[e].parts>1&&(a[o].datatype="BYTE",a[o].dtypelen=1,a[o].arrayLength=a[o].byteLength),l-=n,o++,s+=n}for(t.clearWritePacketTimeouts(),t.writePacketArray=[];i<a.length;){var u=0;t.writeReqHeader.copy(t.writeReq,0);var p=14;t.writePacketArray.push(new D);var y=t.writePacketArray.length-1;for(t.writePacketArray[y].seqNum=t.getNextSeqNum(),t.writePacketArray[y].itemList=[],e=i;e<a.length;e++){if(a[e].byteLengthWithFill+12+4+p>t.maxPDU){if(0===u)throw a[e].byteLengthWithFill,t.connectionID,new Error("Somehow write request didn't split properly - exiting.  Report this as a bug.");break}i++,u++,p+=a[e].byteLengthWithFill+12+4,t.writePacketArray[y].itemList.push(a[e])}}}},n.prototype.prepareReadPacket=function(){var e,t=this,r=t.polledReadBlockList,a=[];for(e=r.length-1;e>=0;e--)void 0===r[e]&&(r.splice(e,1),t.connectionID);if(r.sort(I),0!==r.length){t.globalReadBlockList=[],t.globalReadBlockList[0]=r[0],t.globalReadBlockList[0].itemReference=[],t.globalReadBlockList[0].itemReference.push(r[0]);var i=0;r[0].block=i;var n=4*Math.floor((t.maxPDU-18)/4);for(e=1;e<r.length;e++)r[e].areaS7Code!==t.globalReadBlockList[i].areaS7Code||r[e].dbNumber!==t.globalReadBlockList[i].dbNumber||!t.isOptimizableArea(r[e].areaS7Code)||r[e].offset-t.globalReadBlockList[i].offset+r[e].byteLength>n||r[e].offset-(t.globalReadBlockList[i].offset+t.globalReadBlockList[i].byteLength)>t.maxGap?(r[e].addr,t.connectionID,i+=1,t.globalReadBlockList[i]=r[e],t.globalReadBlockList[i].isOptimized=!1,t.globalReadBlockList[i].itemReference=[],t.globalReadBlockList[i].itemReference.push(r[e])):(r[e].addr,t.globalReadBlockList[i].addr,t.connectionID,t.globalReadBlockList[i].byteLength=Math.max(t.globalReadBlockList[i].byteLength,r[e].offset-t.globalReadBlockList[i].offset+r[e].byteLength),r[e].byteBuffer=t.globalReadBlockList[i].byteBuffer.slice(r[e].offset-t.globalReadBlockList[i].offset,r[e].offset-t.globalReadBlockList[i].offset+r[e].byteLength),r[e].qualityBuffer=t.globalReadBlockList[i].qualityBuffer.slice(r[e].offset-t.globalReadBlockList[i].offset,r[e].offset-t.globalReadBlockList[i].offset+r[e].byteLength),t.globalReadBlockList[i].isOptimized=!0,t.globalReadBlockList[i].itemReference.push(r[e]));var o=0;for(e=0;e<t.globalReadBlockList.length;e++){a[o]=t.globalReadBlockList[e].clone(),t.globalReadBlockList[e].parts=Math.ceil(t.globalReadBlockList[e].byteLength/n),t.globalReadBlockList[e].parts,t.globalReadBlockList[e].offset,t.connectionID;var s=t.globalReadBlockList[e].offset,l=t.globalReadBlockList[e].byteLength;t.globalReadBlockList[e].requestReference=[];for(var c=0;c<t.globalReadBlockList[e].parts;c++)a[o]=t.globalReadBlockList[e].clone(),t.globalReadBlockList[e].requestReference.push(a[o]),a[o].offset=s,a[o].byteLength=Math.min(n,l),a[o].byteLengthWithFill=a[o].byteLength,a[o].byteLengthWithFill%2&&(a[o].byteLengthWithFill+=1),t.globalReadBlockList[e].parts>1&&(a[o].datatype="BYTE",a[o].dtypelen=1,a[o].arrayLength=a[o].byteLength),l-=n,o++,s+=n}var d=0;for(t.clearReadPacketTimeouts(),t.readPacketArray=[];d<a.length;){var u=0;t.readReqHeader.copy(t.readReq,0);var p=14,y=12;t.readPacketArray.push(new D);var g=t.readPacketArray.length-1;for(t.readPacketArray[g].seqNum=0,t.readPacketArray[g].itemList=[],e=d;e<a.length;e++){if(a[e].byteLengthWithFill+4+p>t.maxPDU||y+12>t.maxPDU){if(a[e].byteLengthWithFill,t.maxPDU,t.connectionID,0===u)throw a[e].byteLengthWithFill,t.connectionID,new Error("Somehow write request didn't split properly - exiting.  Report this as a bug.");break}d++,u++,p+=a[e].byteLengthWithFill+4,y+=12,t.readPacketArray[g].itemList.push(a[e])}}t.readPacketValid=!0}},n.prototype.sendReadPacket=function(){var e,t,r=this,a=!1;for(r.connectionID,r.readPacketArray.length||"function"!=typeof r.readDoneCallback||r.readDoneCallback(!1,{}),e=0;e<r.readPacketArray.length;e++)if(!(r.readPacketArray[e].sent||r.parallelJobsNow>=r.maxParallel)){for(r.readPacketArray[e].seqNum=r.getNextSeqNum(),r.readPacketArray[e].reqTime=process.hrtime(),r.readReq.writeUInt8(r.readPacketArray[e].itemList.length,18),r.readReq.writeUInt16BE(19+12*r.readPacketArray[e].itemList.length,2),r.readReq.writeUInt16BE(r.readPacketArray[e].seqNum,11),r.readReq.writeUInt16BE(12*r.readPacketArray[e].itemList.length+2,13),t=0;t<r.readPacketArray[e].itemList.length;t++)l(r.readPacketArray[e].itemList[t],!1).copy(r.readReq,19+12*t);4==r.isoConnectionState?(r.readPacketArray[e].seqNum,r.connectionID,r.readPacketArray[e].timeout=setTimeout((function(){r.packetTimeout.apply(r,arguments)}),r.globalTimeout,"read",r.readPacketArray[e].seqNum),r.isoclient.write(r.readReq.slice(0,19+12*r.readPacketArray[e].itemList.length)),r.readPacketArray[e].sent=!0,r.readPacketArray[e].rcvd=!1,r.readPacketArray[e].timeoutError=!1,r.parallelJobsNow+=1):(r.readPacketArray[e].sent=!0,r.readPacketArray[e].rcvd=!1,r.readPacketArray[e].timeoutError=!0,a||(r.isoConnectionState,r.connectionID),0===r.isoConnectionState&&(a=!0),r.readPacketArray[e].seqNum,r.connectionID,r.readPacketArray[e].timeout=setTimeout((function(){r.packetTimeout.apply(r,arguments)}),0,"read",r.readPacketArray[e].seqNum))}},n.prototype.sendWritePacket=function(){var e,t,r,a,i,n,o=this;for(t=Buffer.alloc(8192),o.writeInQueue=!1,e=0;e<o.writePacketArray.length;e++)if(!(o.writePacketArray[e].sent||o.parallelJobsNow>=o.maxParallel)){o.writePacketArray[e].reqTime=process.hrtime(),o.writeReq.writeUInt8(o.writePacketArray[e].itemList.length,18),o.writeReq.writeUInt16BE(o.writePacketArray[e].seqNum,11),a=0;for(var s=0;s<o.writePacketArray[e].itemList.length;s++)l(o.writePacketArray[e].itemList[s],!0).copy(o.writeReq,19+12*s),(i=o.writePacketArray[e].itemList[s],n=void 0,"X"===i.datatype&&1===i.arrayLength?((n=Buffer.alloc(5)).fill(0),n.writeUInt16BE(1,2)):((n=Buffer.alloc(i.byteLength+4)).fill(0),n.writeUInt16BE(8*i.byteLength,2)),i.writeBuffer.length,i.byteLengthWithFill,n[0]=0,n[1]=i.writeTransportCode,i.writeBuffer.copy(n,4,0,i.byteLength),r=n).copy(t,a),a+=r.length,s<o.writePacketArray[e].itemList.length-1&&r.length%2&&(a+=1);o.writeReq.writeUInt16BE(19+12*o.writePacketArray[e].itemList.length+a,2),o.writeReq.writeUInt16BE(12*o.writePacketArray[e].itemList.length+2,13),o.writeReq.writeUInt16BE(a,15),t.copy(o.writeReq,19+12*o.writePacketArray[e].itemList.length,0,a),4===o.isoConnectionState?(o.writePacketArray[e].timeout=setTimeout((function(){o.packetTimeout.apply(o,arguments)}),o.globalTimeout,"write",o.writePacketArray[e].seqNum),o.isoclient.write(o.writeReq.slice(0,19+a+12*o.writePacketArray[e].itemList.length)),o.writePacketArray[e].sent=!0,o.writePacketArray[e].rcvd=!1,o.writePacketArray[e].timeoutError=!1,o.parallelJobsNow+=1,o.writePacketArray[e].seqNum,o.connectionID):(o.writePacketArray[e].sent=!0,o.writePacketArray[e].rcvd=!1,o.writePacketArray[e].timeoutError=!0,o.writePacketArray[e].timeout=setTimeout((function(){o.packetTimeout.apply(o,arguments)}),0,"write",o.writePacketArray[e].seqNum),o.isoConnectionState)}},n.prototype.isOptimizableArea=function(e){if(this.doNotOptimize)return!1;switch(e){case 132:case 129:case 130:case 131:return!0;default:return!1}},n.prototype.onResponse=function(e){var t=this;if(e&&e.length>6){var r=s(e);if("fastACK"===r)t.connectionID,t.isoclient.removeAllListeners("error"),t.isoclient.removeAllListeners("data"),t.isoclient.on("data",(function(){t.onResponse.apply(t,arguments)})),t.isoclient.on("error",(function(){t.readWriteError.apply(t,arguments)}));else{if(50!==r[7])return e.readInt16BE(2),e.length,e.readUInt8(4),e[6],t.connectionReset(),null;if(r.length>8&&3!=r[8])return r[8],t.connectionReset(),null;if(r.length>r.readInt16BE(2)&&(r.length,r.readInt16BE(2),setTimeout((function(){t.onResponse.apply(t,arguments)}),0,r.slice(r.readInt16BE(2)))),r.length<r.readInt16BE(2)||r.readInt16BE(2)<22||240!==r[5]||r[4]+1+12+4+r.readInt16BE(13)+r.readInt16BE(15)!==r.readInt16BE(2)||!(r[6]>>7)||50!==r[7]||3!==r[8])return r.readInt16BE(2),r.length,r.readUInt8(4),r[6],t.connectionReset(),null;var a,i,n;if(r.readUInt16BE(15),r.readUInt16BE(11),t.connectionID,void 0===(a=t.findReadIndexOfSeqNum(r.readUInt16BE(11)))?void 0!==(a=t.findWriteIndexOfSeqNum(r.readUInt16BE(11)))&&(t.writeResponse(r,a),n=!0):(i=!0,t.readResponse(r,a)),!i&&!n)return null}}else t.connectionReset()},n.prototype.findReadIndexOfSeqNum=function(e){var t;for(t=0;t<this.readPacketArray.length;t++)if(this.readPacketArray[t].seqNum==e)return t},n.prototype.findWriteIndexOfSeqNum=function(e){var t;for(t=0;t<this.writePacketArray.length;t++)if(this.writePacketArray[t].seqNum==e)return t},n.prototype.writeResponse=function(e,t){for(var r,a,i=this,n=21,s=0;s<i.writePacketArray[t].itemList.length&&(n=d(e,i.writePacketArray[t].itemList[s],n));s++);if(i.writePacketArray[t].reqTime=process.hrtime(i.writePacketArray[t].reqTime),i.writePacketArray[t].reqTime[0],Math.round(10*i.writePacketArray[t].reqTime[1]/1e6),i.connectionID,i.writePacketArray[t].rcvd||(i.writePacketArray[t].rcvd=!0,i.parallelJobsNow--),clearTimeout(i.writePacketArray[t].timeout),i.writePacketArray.every(o)){for(i.connectionID,r=0;r<i.writePacketArray.length;r++)i.writePacketArray[r].sent=!1,i.writePacketArray[r].rcvd=!1;for(a=!1,r=0;r<i.globalWriteBlockList.length;r++){u(i.globalWriteBlockList[r]);for(var l=0;l<i.globalWriteBlockList[r].itemReference.length;l++)i.globalWriteBlockList[r].itemReference[l].addr,i.globalWriteBlockList[r].itemReference[l].writeQuality,i.connectionID,R(i.globalWriteBlockList[r].itemReference[l].writeQuality)||(a=!0);R(i.globalWriteBlockList[r].writeQuality)||(a=!0)}i.resetPending&&(i.connectionID,i.resetNow()),0===i.isoConnectionState&&i.connectNow(i.connectionParams,!1),i.connectionID,"function"==typeof i.writeDoneCallback&&i.writeDoneCallback(a)}else i.connectionID,i.sendWritePacket()},n.prototype.readResponse=function(e,t){var r,a,i=this,n=21,s={};if(i.connectionID,!i.readPacketArray[t].sent)return i.connectionID,null;if(i.readPacketArray[t].rcvd)return i.connectionID,null;for(var l=0;l<i.readPacketArray[t].itemList.length;l++)(n=c(e,i.readPacketArray[t].itemList[l],n,i.connectionID))||i.connectionID;if(i.readPacketArray[t].reqTime=process.hrtime(i.readPacketArray[t].reqTime),i.readPacketArray[t].reqTime[0],Math.round(10*i.readPacketArray[t].reqTime[1]/1e6),i.connectionID,i.readPacketArray[t].rcvd||(i.readPacketArray[t].rcvd=!0,i.parallelJobsNow--),clearTimeout(i.readPacketArray[t].timeout),i.readPacketArray.every(o)){for(r=0;r<i.readPacketArray.length;r++)i.readPacketArray[r].sent=!1,i.readPacketArray[r].rcvd=!1;for(a=!1,r=0;r<i.globalReadBlockList.length;r++){for(var d=0,u=0;u<i.globalReadBlockList[r].requestReference.length;u++)i.globalReadBlockList[r].requestReference[u].byteBuffer.copy(i.globalReadBlockList[r].byteBuffer,d,0,i.globalReadBlockList[r].requestReference[u].byteLength),i.globalReadBlockList[r].requestReference[u].qualityBuffer.copy(i.globalReadBlockList[r].qualityBuffer,d,0,i.globalReadBlockList[r].requestReference[u].byteLength),d+=i.globalReadBlockList[r].requestReference[u].byteLength;for(var p=0;p<i.globalReadBlockList[r].itemReference.length;p++)v(i.globalReadBlockList[r].itemReference[p]),i.globalReadBlockList[r].itemReference[p].addr,i.globalReadBlockList[r].itemReference[p].value,i.globalReadBlockList[r].itemReference[p].quality,i.connectionID,R(i.globalReadBlockList[r].itemReference[p].quality)?s[i.globalReadBlockList[r].itemReference[p].useraddr]=i.globalReadBlockList[r].itemReference[p].value:(a=!0,s[i.globalReadBlockList[r].itemReference[p].useraddr]=i.globalReadBlockList[r].itemReference[p].quality)}i.writeInQueue?(i.isoConnectionState,i.resetPending,i.connectionID):(i.resetPending&&(i.connectionID,i.resetNow()),0===i.isoConnectionState&&i.connectNow(i.connectionParams,!1)),i.connectionID,"function"==typeof i.readDoneCallback&&i.readDoneCallback(a,s),!i.isReading()&&i.writeInQueue&&(i.connectionID,i.sendWritePacket())}else i.sendReadPacket()},n.prototype.onClientDisconnect=function(){var e=this;e.connectionID,e.connectCBIssued||"function"!=typeof e.connectCallback||(e.connectCBIssued=!0,e.connectCallback("Error - TCP connected, ISO didn't")),e.connectionReset()},n.prototype.onClientClose=function(){var e=this;e.connectionReset(),e.dropConnectionCallback&&(e.dropConnectionCallback(),e.dropConnectionCallback=null,clearTimeout(e.dropConnectionTimer))},n.prototype.connectionReset=function(){var e=this;e.isoConnectionState=0,e.resetPending=!0,e.connectionID,e.isReading()||e.isWriting()||e.writeInQueue||void 0!==e.resetTimeout||(e.resetTimeout=setTimeout((function(){e.connectionID,e.resetNow.apply(e,arguments)}),3500))},n.prototype.resetNow=function(){var e=this;e.isoConnectionState=0,e.isoclient.end(),e.connectionID,e.resetPending=!1,void 0!==e.resetTimeout&&(clearTimeout(e.resetTimeout),e.resetTimeout=void 0,e.connectionID)},n.prototype.connectionCleanup=function(){var e=this;e.isoConnectionState=0,e.connectionID,void 0!==e.isoclient&&(e.isoclient.destroy(),e.isoclient.removeAllListeners("data"),e.isoclient.removeAllListeners("error"),e.isoclient.removeAllListeners("connect"),e.isoclient.removeAllListeners("end"),e.isoclient.removeAllListeners("close"),e.isoclient.on("error",(function(){}))),clearTimeout(e.connectTimeout),clearTimeout(e.PDUTimeout),e.clearReadPacketTimeouts(),e.clearWritePacketTimeouts()}},5547:(e,t,r)=>{const a=r(9896);var i=r(6277),n=r(456);const{DataType:o}=r(3532),{node:s}=r(6807);function l(e){return"string"==typeof e&&!isNaN(Number(e))||"number"==typeof e}e.exports={saveLogData:function(e){try{n.LocalDB.serialize((()=>{let t="";t+="_id text,",t+="currentTime datetime,",t+="parent text,",t+="idDevice text,",t+="typeObject text,",t+="tag text,",t+="previousValue text,",t+="newValue text,",t+="action text,",t+="nameObject text,",t+="user text,";let r=t.substring(0,t.length-1);n.LocalDB.run("CREATE TABLE IF NOT EXISTS LogData("+r+")",(t=>{if(t)response.json({result:"error",data:{},message:t});else{let t=`INSERT INTO LogData(_id,currentTime,parent,idDevice,typeObject,tag,previousValue,newValue,action,nameObject,user)VALUES(\n                    '${"a"+Math.random().toString(36)}',\n                    '${Date.now()}',\n                    '${e.parent?e.parent:"___"}',\n                    '${e.idDevice?e.idDevice:""}',\n                    '${e.typeObject?e.typeObject:""}',\n                    '${e.tag?e.tag:0}',\n                    '${e.previousValue?e.previousValue:""}',\n                    '${e.newValue?e.newValue:""}',\n                    '${e.action?e.action:""}',\n                    '${e.nameObject?e.nameObject:""}',\n                    '${e.user?e.user:""}'\n                    )`;n.LocalDB.run(t,(e=>{if(e)throw console.log(e),e;i.refreshLogData=!0}))}}))}))}catch(e){console.log(e)}},saveAlarmData:function(e){try{n.LocalDB.serialize((()=>{let t="";t+="_id text,",t+="currentTime datetime,",t+="parent text,",t+="idDevice text,",t+="typeAlarm text,",t+="tag text,",t+="alarmText text,",t+="alarmAtOn int,",t+="alarmAtOff int,",t+="typeSnackBar text,";let r=t.substring(0,t.length-1);n.LocalDB.run("CREATE TABLE IF NOT EXISTS LogAlarmData("+r+")",(t=>{if(t)response.json({result:"error",data:{},message:t});else{let t=`INSERT INTO LogAlarmData(_id,currentTime,parent,idDevice,typeAlarm,tag,alarmText,alarmAtOn,alarmAtOff,typeSnackBar)VALUES(\n                    '${"a"+Math.random().toString(36)}',\n                    '${Date.now()}',\n                    '${e.parent?e.parent:"___"}',\n                    '${e.idDevice?e.idDevice:""}',\n                    '${e.typeAlarm?e.typeAlarm:""}',\n                    '${e.tag?e.tag:0}',\n                    '${e.alarmText?e.alarmText:""}',\n                    '${e.alarmAtOn?e.alarmAtOn:""}',\n                    '${e.alarmAtOff?e.alarmAtOff:""}',\n                    '${e.typeSnackBar?e.typeSnackBar:""}'\n                    )`;n.LocalDB.run(t,(e=>{if(e)throw console.log(e),e}))}}))}))}catch(e){console.log(e)}},setLogServer:function(e){console.log(e),i.logServer.push(e+"\n"),i.logServer.length>100&&i.logServer.shift()},ReadWordOfPlcToByte:function(e,t,r){for(var a=[],i=e;i<e+t;i++){var n=255&r[i];a[2*(i-e)]=n,r[i]=(r[i]-n)/256,a[2*(i-e)+1]=r[i]}return a},StringToAscii:function(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);var a=[],i=0,n=0;for(r=0;r<t.length;r++)r%2==0&&(n=t[r],r+1===t.length&&(a[i]=n)),r%2==1&&(n+=256*t[r],a[i]=n,i+=1);return a},ReadBitOfPLC:function(e,t,r){for(var a=[],i=e;i<e+t;i++)for(var n=Number(r[i]),o=0;o<16;o++)a[16*(i-e)+o]=1&n,n>>=1;return a},ReadBitOfPLCSiemens:function(e,t,r){for(var a=[],i=e;i<e+t;i++)for(var n=Number(r[i]),o=0;o<16;o++)o<8&&(a[16*(i-e)+o+8]=1&n,n>>=1),o>=8&&(a[16*(i-e)+o-8]=1&n,n>>=1);return a},ReadWordOfPLC:function(e,t,r){var a=[];if(Array.isArray(r))for(var i=e;i<e+t;i++)r[i]>=0?a[i-e]=r[i]:a[i-e]=65536+r[i];return a},ReadDWordOfPLCSiemens:function(e,t,r){for(var a=[],i=e;i<e+2*t;i++)i%2==1&&(r[i]<0&&(r[i]=r[i]+65536),r[i-1]<0&&(r[i-1]=r[i-1]+65536),a[(i-e-1)/2]=r[i]+65536*r[i-1],a[(i-e-1)/2]<0&&(a[(i-e-1)/2]=a[(i-e-1)/2]+65536));return a},ReadDWordOfPLC:function(e,t,r){for(var a=[],i=e;i<e+2*t;i++)(i-e)%2==1&&(r[i]<0&&(r[i]=r[i]+65536),r[i-1]<0&&(r[i-1]=r[i-1]+65536),a[(i-e-1)/2]=65536*r[i]+r[i-1],a[(i-e-1)/2]<0&&(a[(i-e-1)/2]=a[(i-e-1)/2]+65536));return a},ConvertArray2Text:function(e){for(var t="",r=0;r<e.length;r++)t=t+"|"+e[r];return t},CheckChangeValue:function(e,t){var r,a=!1;if(!(void 0===(r=e)||null==r||r.length<=0))for(var i=0;i<e.length;i++)e[i]!=t[i]&&(a=!0);return a},CheckNegativeNumber:function(e){return e<0?e+65536:e>32767?e-65536:e},getRandomInt:function(e){return Math.floor(Math.random()*Math.floor(e))},saveJsonFile:function(e,t){try{a.existsSync(e)||a.writeFile(e,JSON.stringify(t),"utf8",(function(e){if(e)return console.log("An error occured while writing JSON Object to File."),console.log(e);console.log("JSON file has been saved.")}))}catch(e){console.error(e)}},getJsonFile:function(e,t){try{a.existsSync(e)?a.readFile(e,"utf8",(function(e,r){e&&console.log(e),obj=JSON.parse(r),t(obj)})):t("update")}catch(e){console.error(e),t([])}},saveFeedbackFile:function(e,t){try{a.writeFile(e,t,"utf8",(function(e){if(e)return console.log("An error occured while writing JSON Object to File."),console.log(e);console.log("JSON file has been saved.")}))}catch(e){console.error(e)}},convertPosCobot:function(e,t){var r=[];return r[0]=parseInt(t%256),r[1]=parseInt(t/256),r[2]=parseInt(e%256),r[3]=parseInt(e/256),Buffer.from([r[3],r[2],r[1],r[0]]).readFloatBE(0)},getIndexCobotWriteMB:function(e,t){return t%10<=e?t/10:t/10+1},ReadStringOfPLC:function(e,t){for(var r=[],a=0;a<t.length/e;a++){let n=[];for(var i=0;i<e;i++)n.push(255&t[a*e+i]),n.push(parseInt(t[a*e+i]/256));r[a]=String.fromCharCode(...n).toString().replace(/[^ -~]+/g,""),0===r[a].length&&(r[a]="_")}return r},ReadStringOfPLCModbus:function(e,t,r,a){for(var i=[],n=e;n<e+t;n++)a[n]>=0?i[n-e]=a[n]:i[n-e]=65536+a[n];for(var o=[],s=0;s<i.length/r;s++){let e=[];for(var l=0;l<r;l++)s*r+l<i.length&&(e.push(255&i[s*r+l]),e.push(parseInt(a[s*r+l]/256)));o[s]=String.fromCharCode(...e).toString().replace(/[^ -~]+/g,""),0==o[s].length&&(o[s]="___")}return o},getDateTime:function(){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1;r=(r<10?"0":"")+r;var a=e.getUTCDate();a=(a<10?"0":"")+a;var i=e.getHours();i=(i<10?"0":"")+i;var n=e.getMinutes();n=(n<10?"0":"")+n;var o=e.getSeconds();return t+"/"+r+"/"+a+" "+i+":"+n+":"+(o<10?"0":"")+o},saveLog:function(e,t){var r="log/"+e+".log",i="["+this.getDateTime()+"] "+t.replace(/[^ -~]+/g,"")+"\r\n";try{a.existsSync(r)||(console.log(r),a.writeFile(r,"Data:\r\n",(function(e){e&&console.log("An error occured while writing JSON Object to File.")}))),a.appendFile(r,i,(function(e){if(e)return console.log(e);console.log('successfully appended "'+i+'"')}))}catch(e){console.error(e)}},getDate:function(){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1;r=(r<10?"0":"")+r;var a=e.getUTCDate();return t+"_"+r+"_"+(a<10?"0":"")+a},ReadReal2OfPLC:function(e,t,r){var a=[];if(t)for(var i=e;i<e+2*t;i++)if((i-e)%2==1){let t=new ArrayBuffer(4),o=new Uint16Array(t);o[0]=r[i-1],o[1]=r[i];var n=new Float32Array(t);a[(i-e-1)/2]=n[0]}return a},ReadStringOfPLC_NodeRed:function(e,t,r,a){var i=[];if(e+t<=a.length)for(var n=e;n<e+t/r;n++){let t=[];for(var o=0;o<r;o++)t.push(255&a[e+(n-e)*r+o]),t.push(parseInt(a[e+(n-e)*r+o]/256));i[n-e]=String.fromCharCode(...t).toString().replace(/[^ -~]+/g,""),0===i[n-e].length&&(i[n-e]="")}return i},ReadStringFlexible:function(e,t,r){let a=parseInt(e),i=parseInt(t);if(parseInt(a)+parseInt(i)/2<r.length){let e=[];for(var n=0;n<i/2;n++)e.push(255&r[a+n]),e.push(parseInt(r[a+n]/256));return String.fromCharCode(...e).toString().replace(/[^ -~]+/g,"")}return""},ProcessSocketIO_Fins:function(e){if("BitAdjustForce"===e.NameCommand&&!isNaN(e.tag)&&!isNaN(e.idDevice)&&"Fins-Omron"===e.typeDevice&&parseInt(e.idDevice))if(parseInt(n.PLC_WriteUnSafe[parseInt(e.idDevice)])){if(parseInt(e.tag)/16<=parseInt(n.PLC_LengthOfWordBitAdjust[parseInt(e.idDevice)])){n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]||(i.OldWordBitAdjust[parseInt(e.idDevice)]=i.WordBitAdjust[parseInt(e.idDevice)].slice());let t=1<<parseInt(e.tag)%16,r=parseInt(n.PLC_WordStartBitAdjust[parseInt(e.idDevice)])+parseInt(e.tag)/16,a=i.OldWordBitAdjust[e.idDevice][parseInt(parseInt(e.tag)/16)];2==e.mode&&(a^=t),0==e.mode&&(a&=~t),1==e.mode&&(a|=t),n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]=10,i.OldWordBitAdjust[parseInt(e.idDevice)][parseInt(parseInt(e.tag)/16)]=a,console.log("Write Bit To PLC"),n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+r,[a])}}else parseInt(e.enableLogData)&&SubFunction.saveLogData({parent:"logData",idDevice:e.idDevice,typeObject:"BitAdjust",tag:e.tag,previousValue:"old",newValue:"new",action:"Toggle",nameObject:"",user:e.currentUser}),n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D1000",[110,110,e.mode,e.mode,e.tag,e.tag]);if("WordAdjustForce"!==e.NameCommand||isNaN(e.tag)||"Fins-Omron"!==e.typeDevice||parseInt(e.idDevice)&&(n.PLC_WriteUnSafe[parseInt(e.idDevice)]?parseInt(e.tag)<=n.PLC_LengthOfWordWordAdjust[parseInt(e.idDevice)]&&n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+(parseInt(n.PLC_WordStartWordAdjust[parseInt(e.idDevice)])+parseInt(e.tag)),[e.value]):n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D1000",[111,111,e.tag,e.tag,e.value,e.value])),"DWordAdjustForce"===e.NameCommand&&!isNaN(e.tag)&&"Fins-Omron"===e.typeDevice&&parseInt(e.idDevice)){var t=parseInt(e.value/65536),r=parseInt(e.value%65536);n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+(parseInt(n.PLC_WordStartDWordAdjust[parseInt(e.idDevice)])+2*parseInt(e.tag)),[r,t])}if("TextFieldInput"===e.NameCommand&&!isNaN(e.tag)&&"Fins-Omron"===e.typeDevice){var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=e.value,s=new Buffer(o,"utf8");for(let e=0;e<s.length;e++)e<40&&(a[e]=s[e]);let t=[113,113,e.tag,e.tag,0,0,0,0,0,0,0].concat(a);"0"==e.idDevice?i.TextFieldInput[0][parseInt(e.tag)]=t:parseInt(e.idDevice)&&n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D1000",t)}},ProcessSocketIO_Fins_Flexible:function(e){if("BitForce"===e.NameCommand&&e.tag.length>0&&l(e.idDevice)&&"Fins-Omron"===e.typeDevice){if(/^\d+\.\d+$/.test(e.tag)){let t=e.tag.split("."),r=t[0],a=t[1];if(n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]||(i.OldWordBitAdjust[parseInt(e.idDevice)]=i.WordAdjust[parseInt(e.idDevice)].slice()),2==t.length&&!isNaN(r)&&!isNaN(a)){let t=1<<parseInt(a),o=i.Word[e.idDevice][parseInt(r)];2==e.mode&&(o^=t,n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]=10,n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+r,[o])),0==e.mode&&(o&=~t,n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]=10,n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+r,[o])),1==e.mode&&(o|=t,n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]=10,n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+r,[o])),3==e.mode&&(o|=t,n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]=10,n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+r,[o]),setTimeout((()=>{o&=~t,n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]=10,n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+r,[o])}),1e3))}}parseInt(e.enableLogData)&&SubFunction.saveLogData({parent:"logData",idDevice:e.idDevice,typeObject:"BitAdjust",tag:e.tag,previousValue:"old",newValue:"new",action:"Toggle",nameObject:"",user:e.currentUser})}if("BitAdjustForce"===e.NameCommand&&!isNaN(e.tag)&&!isNaN(e.idDevice)&&"Fins-Omron"===e.typeDevice&&parseInt(e.idDevice)){if(/^\d+\.\d+$/.test(e.tag)){let t=e.tag.split("."),r=t[0],a=t[1];if(n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]||(i.OldWordBitAdjust[parseInt(e.idDevice)]=i.WordAdjust[parseInt(e.idDevice)].slice()),2==t.length&&!isNaN(r)&&!isNaN(a)){let t=1<<parseInt(a),o=i.WordAdjust[e.idDevice][parseInt(r)];2==e.mode&&(o^=t),0==e.mode&&(o&=~t),1==e.mode&&(o|=t),n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]=10,n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+r,[o])}}else if(parseInt(e.tag)/16<=parseInt(n.PLC_LengthOfWordBitAdjust[parseInt(e.idDevice)])){n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]||(i.OldWordBitAdjust[parseInt(e.idDevice)]=i.WordBitAdjust[parseInt(e.idDevice)].slice());let t=1<<parseInt(e.tag)%16,r=parseInt(n.PLC_WordStartBitAdjust[parseInt(e.idDevice)])+parseInt(e.tag)/16,a=i.OldWordBitAdjust[e.idDevice][parseInt(parseInt(e.tag)/16)];2==e.mode&&(a^=t),0==e.mode&&(a&=~t),1==e.mode&&(a|=t),n.TimeDelayWriteWordBitAdjust[parseInt(e.idDevice)]=10,i.OldWordBitAdjust[parseInt(e.idDevice)][parseInt(parseInt(e.tag)/16)]=a,console.log("Write Bit To PLC"),n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+r,[a])}parseInt(e.enableLogData)&&SubFunction.saveLogData({parent:"logData",idDevice:e.idDevice,typeObject:"BitAdjust",tag:e.tag,previousValue:"old",newValue:"new",action:"Toggle",nameObject:"",user:e.currentUser})}if("NumberForce"===e.NameCommand&&e.tag.length>0&&"Fins-Omron"===e.typeDevice&&l(e.idDevice)){if("Word"===e.dataType&&l(e.tag)){let t;parseInt(e.value)>=0&&parseInt(e.value)<65536?(t=parseInt(e.value),n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+parseInt(e.tag),[t])):parseInt(e.value)<0&&parseInt(e.value)>-32767&&(t=parseInt(e.value)+65536,n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+parseInt(e.tag),[t]))}if("DWord"===e.dataType&&l(e.tag)){var t=0,r=0;if(parseInt(e.value)>=0&&parseInt(e.value)<4294967296&&(t=parseInt(e.value/65536),r=parseInt(e.value%65536),n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+parseInt(e.tag),[r,t])),parseInt(e.value)<0&&parseInt(e.value)>-2147483648){let a=4294967296+parseInt(e.value);t=parseInt(a/65536),r=parseInt(a%65536),n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+parseInt(e.tag),[r,t])}}}if("WordAdjustForce"===e.NameCommand&&!isNaN(e.tag)&&"Fins-Omron"===e.typeDevice&&parseInt(e.idDevice)){let t;parseInt(e.value)>=0&&parseInt(e.value)<65536?(t=parseInt(e.value),n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+parseInt(e.tag),[t])):parseInt(e.value)<0&&parseInt(e.value)>-32767&&(t=parseInt(e.value)+65536,n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+parseInt(e.tag),[t]))}if("DWordAdjustForce"===e.NameCommand&&!isNaN(e.tag)&&"Fins-Omron"===e.typeDevice&&parseInt(e.idDevice)&&(t=0,r=0,parseInt(e.value)>=0&&parseInt(e.value)<4294967296&&(t=parseInt(e.value/65536),r=parseInt(e.value%65536),n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+parseInt(e.tag),[r,t])),parseInt(e.value)<0&&parseInt(e.value)>-2147483648)){let a=4294967296+parseInt(e.value);t=parseInt(a/65536),r=parseInt(a%65536),n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D"+parseInt(e.tag),[r,t])}if("TextFieldInput"===e.NameCommand&&!isNaN(e.tag)&&"Fins-Omron"===e.typeDevice){var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=e.value,s=new Buffer(o,"utf8");for(let e=0;e<s.length;e++)e<40&&(a[e]=s[e]);let t=[113,113,e.tag,e.tag,0,0,0,0,0,0,0].concat(a);"0"==e.idDevice?i.TextFieldInput[0][parseInt(e.tag)]=t:parseInt(e.idDevice)&&n.COMMUNICATION_PLC_OMRON[parseInt(e.idDevice)].write("D1000",t)}},ProcessSocketIO_Modbus:function(e){if("BitAdjustForce"===e.NameCommand&&!isNaN(e.tag)&&"Modbus-Client"===e.typeDevice&&!isNaN(e.idDevice)&&!isNaN(e.tag)){if(2==e.mode){let t=i.BitAdjust[parseInt(e.idDevice)][parseInt(e.tag)];n.COMMUNICATION_PLC_MODBUS[parseInt(e.idDevice)].writeSingleCoil(parseInt(e.tag),!t).then((function(e){}),console.error)}1==e.mode&&n.COMMUNICATION_PLC_MODBUS[parseInt(e.idDevice)].writeSingleCoil(parseInt(e.tag),!0).then((function(e){}),console.error),0==e.mode&&n.COMMUNICATION_PLC_MODBUS[parseInt(e.idDevice)].writeSingleCoil(parseInt(e.tag),!1).then((function(e){}),console.error)}if("BitForce"===e.NameCommand&&l(e.tag)&&"Modbus-Client"===e.typeDevice&&l(e.idDevice)&&l(e.tag)&&i.Bit[parseInt(e.idDevice)]){if(2==e.mode&&"Coil"==e.dataType&&i.Bit[parseInt(e.idDevice)][e.tag]&&i.Bit[parseInt(e.idDevice)][e.tag].hasOwnProperty("Coil")){let t=i.Bit[parseInt(e.idDevice)][e.tag].Coil;n.COMMUNICATION_PLC_MODBUS[parseInt(e.idDevice)].writeSingleCoil(parseInt(e.tag),!t).then((function(e){}),console.error)}1==e.mode&&"Coil"==e.dataType&&i.Bit[parseInt(e.idDevice)][e.tag]&&i.Bit[parseInt(e.idDevice)][e.tag].hasOwnProperty("Coil")&&n.COMMUNICATION_PLC_MODBUS[parseInt(e.idDevice)].writeSingleCoil(parseInt(e.tag),1).then((function(e){}),console.error),0==e.mode&&"Coil"==e.dataType&&i.Bit[parseInt(e.idDevice)][e.tag]&&i.Bit[parseInt(e.idDevice)][e.tag].hasOwnProperty("Coil")&&n.COMMUNICATION_PLC_MODBUS[parseInt(e.idDevice)].writeSingleCoil(parseInt(e.tag),0).then((function(e){}),console.error),3==e.mode&&"Coil"==e.dataType&&i.Bit[parseInt(e.idDevice)][e.tag]&&i.Bit[parseInt(e.idDevice)][e.tag].hasOwnProperty("Coil")&&(n.COMMUNICATION_PLC_MODBUS[parseInt(e.idDevice)].writeSingleCoil(parseInt(e.tag),1).then((function(e){}),console.error),setTimeout((()=>{n.COMMUNICATION_PLC_MODBUS[parseInt(e.idDevice)].writeSingleCoil(parseInt(e.tag),0).then((function(e){}),console.error)}),1e3))}if("NumberForce"===e.NameCommand&&e.tag.length>0&&"Modbus-Client"===e.typeDevice&&l(e.idDevice)){if("HoldingRegister-Int16"===e.dataType&&l(e.tag)){let t;parseInt(e.value)>=0&&parseInt(e.value)<65536?(t=parseInt(e.value),n.COMMUNICATION_PLC_MODBUS[e.idDevice].writeSingleRegister(parseInt(e.tag),t).then((function(e){}),console.error)):parseInt(e.value)<0&&parseInt(e.value)>-32767&&(t=parseInt(e.value)+65536,n.COMMUNICATION_PLC_MODBUS[e.idDevice].writeSingleRegister(parseInt(e.tag),t).then((function(e){}),console.error))}if("HoldingRegister-Int32"===e.dataType&&l(e.tag)){var t=0,r=0;if(parseInt(e.value)>=0&&parseInt(e.value)<4294967296){t=parseInt(e.value/65536),r=parseInt(e.value%65536);const a=Buffer.alloc(4);a.writeUInt16BE(r,0),a.writeUInt16BE(t,2),n.COMMUNICATION_PLC_MODBUS[e.idDevice].writeMultipleRegisters(parseInt(e.tag),a).then((function(e){console.log(e)}),console.error)}if(parseInt(e.value)<0&&parseInt(e.value)>-2147483648){let a=4294967296+parseInt(e.value);t=parseInt(a/65536),r=parseInt(a%65536);const i=Buffer.alloc(4);i.writeUInt16BE(r,0),i.writeUInt16BE(t,2),n.COMMUNICATION_PLC_MODBUS[e.idDevice].writeMultipleRegisters(parseInt(e.tag),i).then((function(e){console.log(e)}),console.error)}}if("HoldingRegister-Float"===e.dataType&&l(e.tag)){const t=new ArrayBuffer(4),r=new DataView(t);r.setFloat32(0,e.value,!0);let a=r.getUint16(0,!0),i=r.getUint16(2,!0);const o=Buffer.alloc(4);o.writeUInt16BE(a,0),o.writeUInt16BE(i,2),n.COMMUNICATION_PLC_MODBUS[e.idDevice].writeMultipleRegisters(parseInt(e.tag),o).then((function(e){console.log(e)}),console.error)}}if("WordAdjustForce"===e.NameCommand&&!isNaN(e.tag)&&"Modbus-Client"===e.typeDevice){let t;parseInt(e.value)>=0&&parseInt(e.value)<65536?(t=parseInt(e.value),n.COMMUNICATION_PLC_MODBUS[e.idDevice].writeSingleRegister(parseInt(e.tag),t).then((function(e){}),console.error)):parseInt(e.value)<0&&parseInt(e.value)>-32767&&(t=parseInt(e.value)+65536,n.COMMUNICATION_PLC_MODBUS[e.idDevice].writeSingleRegister(parseInt(e.tag),t).then((function(e){}),console.error))}if("DWordAdjustForce"===e.NameCommand&&!isNaN(e.tag)&&"Modbus-Client"===e.typeDevice&&(t=0,r=0,parseInt(e.value)>=0&&parseInt(e.value)<4294967296&&(t=parseInt(e.value/65536),r=parseInt(e.value%65536),n.COMMUNICATION_PLC_MODBUS[e.idDevice].writeMultipleRegisters(parseInt(e.tag),[r,t]).then((function(e){console.log(e)}),console.error)),parseInt(e.value)<0&&parseInt(e.value)>-2147483648)){let a=4294967296+parseInt(e.value);t=parseInt(a/65536),r=parseInt(a%65536),n.COMMUNICATION_PLC_MODBUS[e.idDevice].writeMultipleRegisters(parseInt(e.tag),[r,t]).then((function(e){console.log(e)}),console.error)}if("TextFieldInput"===e.NameCommand&&!isNaN(e.tag)&&"Modbus-Client"===e.typeDevice){var a=new Array(n.PLC_NumberWordInString[parseInt(e.idDevice)]).fill(0),o=e.value,s=new Buffer(o,"utf8");for(let t=0;t<s.length;t++)t<2*n.PLC_NumberWordInString[parseInt(e.idDevice)]&&(a[t]=s[t]);n.COMMUNICATION_PLC_MODBUS[e.idDevice].writeMultipleRegisters(parseInt(n.PLC_WordStartString[parseInt(e.idDevice)])+parseInt(e.tag)*parseInt(n.PLC_NumberWordInString[parseInt(e.idDevice)]),a).then((function(e){console.log(e)}),console.error)}},ProcessSocketIO_Modbus_Server:function(e){if("BitAdjustForce"!==e.NameCommand||isNaN(e.tag)||"Modbus-Server"!==e.typeDevice||parseInt(e.idDevice)&&(i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]]=n.PLC_Code_BitAdjust[parseInt(e.idDevice)],i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]+1]=parseInt(e.tag),i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]+2]=parseInt(e.value)),"WordAdjustForce"!==e.NameCommand||isNaN(e.tag)||"Modbus-Server"!==e.typeDevice||(parseInt(e.value)>=0&&parseInt(e.value)<65536?(i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]]=n.PLC_Code_WordAdjust[parseInt(e.idDevice)],i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]+1]=parseInt(e.tag),i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]+2]=parseInt(e.value)):parseInt(e.value)<0&&parseInt(e.value)>-32767&&(i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]]=n.PLC_Code_WordAdjust[parseInt(e.idDevice)],i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]+1]=parseInt(e.tag),i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]+2]=parseInt(e.value)+65536)),"DWordAdjustForce"===e.NameCommand&&!isNaN(e.tag)&&"Modbus-Server"===e.typeDevice){var t=parseInt(e.value/65536),r=parseInt(e.value%65536);i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]]=n.PLC_Code_DWordAdjust[parseInt(e.idDevice)],i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]+1]=parseInt(e.tag),i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]+2]=t,i.StoreModbusServerReg[parseInt(e.idDevice)][n.PLC_WordStartComPC[parseInt(e.idDevice)]+3]=r}},ProcessSocketIO_ProfiNet:function(e){function t(e){let t=e.replace(/[^a-zA-Z0-9_$]/g,"");return/^[0-9]/.test(t)&&(t="_"+t),t}if("BitForce"===e.NameCommand&&e.tag.length>0&&"ProfiNet"===e.typeDevice&&l(e.idDevice)){if(2==e.mode){let r=i.Communication_Profinet_Raw_Result[parseInt(e.idDevice)][t(e._id+e.tag)];n.COMMUNICATION_SIEMENS[parseInt(e.idDevice)].writeItems(t(e._id+e.tag),!r)}1==e.mode&&n.COMMUNICATION_SIEMENS[parseInt(e.idDevice)].writeItems(t(e._id+e.tag),!0),0==e.mode&&n.COMMUNICATION_SIEMENS[parseInt(e.idDevice)].writeItems(t(e._id+e.tag),!1)}"NumberForce"===e.NameCommand&&e.tag.length>0&&"ProfiNet"===e.typeDevice&&l(e.idDevice)&&n.COMMUNICATION_SIEMENS[parseInt(e.idDevice)].writeItems(t(e._id),e.value),"StringForce"===e.NameCommand&&e.tag.length>0&&"ProfiNet"===e.typeDevice&&l(e.idDevice)&&n.COMMUNICATION_SIEMENS[parseInt(e.idDevice)].writeItems(t(e._id),e.value)},ProcessSocketIO_System:function(e){if("BitAdjustForce"!==e.NameCommand||isNaN(e.tag)||isNaN(e.idDevice)||"System"!==e.typeDevice||(2==e.mode&&(i.BitAdjust[parseInt(e.idDevice)][parseInt(e.tag)]=!i.BitAdjust[parseInt(e.idDevice)][parseInt(e.tag)],i.BitDisplay[parseInt(e.idDevice)][parseInt(e.tag)]=i.BitAdjust[parseInt(e.idDevice)][parseInt(e.tag)]),0==e.mode&&(i.BitAdjust[parseInt(e.idDevice)][parseInt(e.tag)]=0,i.BitDisplay[parseInt(e.idDevice)][parseInt(e.tag)]=0),1==e.mode&&(i.BitAdjust[parseInt(e.idDevice)][parseInt(e.tag)]=1,i.BitDisplay[parseInt(e.idDevice)][parseInt(e.tag)]=1)),"BitForce"!==e.NameCommand||isNaN(e.tag)||isNaN(e.idDevice)||"System"!==e.typeDevice||(2==e.mode&&(i.Bit[parseInt(e.idDevice)][parseInt(e.tag)]=!i.Bit[parseInt(e.idDevice)][parseInt(e.tag)]),0==e.mode&&(i.Bit[parseInt(e.idDevice)][parseInt(e.tag)]=0),1==e.mode&&(i.Bit[parseInt(e.idDevice)][parseInt(e.tag)]=1),3==e.mode&&(i.Bit[parseInt(e.idDevice)][parseInt(e.tag)]=1,setTimeout((()=>{i.Bit[parseInt(e.idDevice)][parseInt(e.tag)]=0}),1e3))),"NumberForce"===e.NameCommand&&e.tag.length>0&&"System"===e.typeDevice&&l(e.idDevice)&&("Number"===e.dataType&&l(e.tag)&&(i.Number[parseInt(e.idDevice)][parseInt(e.tag)]=e.value),"String"===e.dataType&&l(e.tag)&&(i.Number[parseInt(e.idDevice)][parseInt(e.tag)]=e.value)),"StringForce"===e.NameCommand&&e.tag.length>0&&"System"===e.typeDevice&&l(e.idDevice)&&l(e.tag)&&(i.ListString[parseInt(e.idDevice)][parseInt(e.tag)]=e.value),"WordAdjustForce"!==e.NameCommand||isNaN(e.tag)||"System"!==e.typeDevice||(i.WordAdjust[parseInt(e.idDevice)][parseInt(e.tag)]=e.value,i.WordDisplay[parseInt(e.idDevice)][parseInt(e.tag)]=e.value),"DWordAdjustForce"!==e.NameCommand||isNaN(e.tag)||"System"!==e.typeDevice||(i.DWordAdjust[parseInt(e.idDevice)][parseInt(e.tag)]=e.value,i.DWordDisplay[parseInt(e.idDevice)][parseInt(e.tag)]=e.value),"TextFieldInput"===e.NameCommand&&!isNaN(e.tag)&&"System"===e.typeDevice){var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=e.value,a=new Buffer(r,"utf8");for(let e=0;e<a.length;e++)e<40&&(t[e]=a[e]);let n=[113,113,e.tag,e.tag,0,0,0,0,0,0,0].concat(t);"0"==e.idDevice&&(i.TextFieldInput[parseInt(e.idDevice)][parseInt(e.tag)]=n)}},ProcessSocketIO_OPCUA:function(e){if("BitForce"===e.NameCommand&&e.tag.length>0&&"OPC-UA"===e.typeDevice&&l(e.idDevice)){if(2==e.mode)for(let t of i.Bit[parseInt(e.idDevice)])if(e.tag in t){let r=t[e.tag];const a=e.tag,i={dataType:o.Boolean,value:!r};n.COMMUNICATION_OPCUA[parseInt(e.idDevice)].writeSingleNode(a,i);break}if(1==e.mode){const t=e.tag,r={dataType:o[e.dataType],value:!0};n.COMMUNICATION_OPCUA[parseInt(e.idDevice)].writeSingleNode(t,r)}if(0==e.mode){const t=e.tag,r={dataType:o[e.dataType],value:!1};n.COMMUNICATION_OPCUA[parseInt(e.idDevice)].writeSingleNode(t,r)}if(3==e.mode){const t=e.tag,r={dataType:o[e.dataType],value:!0};n.COMMUNICATION_OPCUA[parseInt(e.idDevice)].writeSingleNode(t,r),setTimeout((()=>{const t=e.tag,r={dataType:o[e.dataType],value:!1};n.COMMUNICATION_OPCUA[parseInt(e.idDevice)].writeSingleNode(t,r)}),1e3)}}if("NumberForce"===e.NameCommand&&e.tag.length>0&&"OPC-UA"===e.typeDevice&&l(e.idDevice)){const t=e.tag,r={dataType:o[e.dataType],value:e.value};n.COMMUNICATION_OPCUA[parseInt(e.idDevice)].writeSingleNode(t,r)}if("TextFieldInput"===e.NameCommand&&!isNaN(e.tag)&&"Modbus-Client"===e.typeDevice){var t=new Array(n.PLC_NumberWordInString[parseInt(e.idDevice)]).fill(0),r=e.value,a=new Buffer(r,"utf8");for(let r=0;r<a.length;r++)r<2*n.PLC_NumberWordInString[parseInt(e.idDevice)]&&(t[r]=a[r]);n.COMMUNICATION_PLC_MODBUS[e.idDevice].writeMultipleRegisters(parseInt(n.PLC_WordStartString[parseInt(e.idDevice)])+parseInt(e.tag)*parseInt(n.PLC_NumberWordInString[parseInt(e.idDevice)]),t).then((function(e){console.log(e)}),console.error)}},ProcessSocketIO_ACE:function(e){if("BitForce"===e.NameCommand&&e.tag.length>0&&"ACE"===e.typeDevice&&l(e.idDevice)){if(2==e.mode)for(let t of i.Bit[parseInt(e.idDevice)])if(e.tag in t){let r=t[e.tag],a=null;a=0!==parseInt(r)?0:1,n.COMMUNICATION_ACE_SOCKET[parseInt(e.idDevice)].write(`write|${e.tag}|${a}`);break}1==e.mode&&n.COMMUNICATION_ACE_SOCKET[parseInt(e.idDevice)].write(`write|${e.tag}|1`),0==e.mode&&n.COMMUNICATION_ACE_SOCKET[parseInt(e.idDevice)].write(`write|${e.tag}|0`)}"NumberForce"===e.NameCommand&&e.tag.length>0&&"ACE"===e.typeDevice&&l(e.idDevice)&&n.COMMUNICATION_ACE_SOCKET[parseInt(e.idDevice)].write(`write|${e.tag}|${e.value}`),"StringForce"===e.NameCommand&&e.tag.length>0&&"ACE"===e.typeDevice&&l(e.idDevice)&&n.COMMUNICATION_ACE_SOCKET[parseInt(e.idDevice)].write(`writeString|${e.tag}|${e.value}`)}}},6277:e=>{var t=new Array(20).fill(!0),r=new Array(20).fill(!0),a=new Array(20).fill(!0),i=new Array(20).fill(!0),n=new Array(20).fill(!0),o=new Array(20).fill(!0),s=new Array(20).fill(!0),l=new Array(20).fill(!0),c=new Array(20).fill(!0),d=new Array(20).fill(!0),u=new Array(20).fill(!0),p=new Array(20).fill(!0),y=new Array(20).fill(!0),g=new Array(20).fill(!0),f=new Array(20).fill(!0),m=new Array(20).fill(!0),h=new Array(20).fill(!0),v=new Array(100).fill(null).map((()=>[])),b=new Array(100).fill(null).map((()=>[])),S=new Array(100).fill(null).map((()=>[])),D=new Array(100).fill(null).map((()=>[])),_=new Array(100).fill(null).map((()=>[])),I=new Array(100).fill(null).map((()=>[])),C=new Array(100).fill(null).map((()=>[])),R=new Array(100).fill(null).map((()=>[])),j=new Array(100).fill(null).map((()=>[])),P=new Array(100).fill(null).map((()=>[])),O=new Array(100).fill(null).map((()=>[])),w=new Array(100).fill(null).map((()=>[])),A=new Array(100).fill(null).map((()=>[])),B=new Array(100).fill(null).map((()=>[])),N=new Array(100).fill(null).map((()=>[])),M=new Array(100).fill(null).map((()=>[])),E=new Array(100).fill(null).map((()=>[])),L=new Array(100).fill(null).map((()=>[])),k=new Array(100).fill(null).map((()=>[])),T=new Array(100).fill(null).map((()=>[])),W=new Array(100).fill(null).map((()=>[])),G=new Array(100).fill(null).map((()=>[])),U=new Array(100).fill(null).map((()=>[])),F=new Array(100).fill(null).map((()=>[])),x=new Array(100).fill(null).map((()=>[])),V=new Array(100).fill(null).map((()=>[])),q=new Array(100).fill(null).map((()=>[])),H=new Array(100).fill(null).map((()=>[])),z=new Array(100).fill(null).map((()=>[])),J=new Array(100).fill(null).map((()=>[])),Q=new Array(100).fill(null).map((()=>[])),$=new Array(100).fill(null).map((()=>[]));e.exports={ListTagBit:[],ListTagNumber:[],ListTagString:[],turnOff:0,logs:[],Word:T,OldWord:W,DWord:L,OldDWord:k,logServer:[],oldLogServer:[],refreshLogData:!0,Plc_Connect_Status:[0,0,0,0,0,0,0,0,0,0,0,0],Timer_Check_Connect_Status:[3,3,3,3,3,3,3,3,3,3,3,3],namePallet:"",currentUser:"",ValueCommunicationPLC:[],ListUserPass:[],WritePosCobot:[],resultImage:[],refreshDataSubScreenImageLibrary:!0,refreshDataBitDisplayImageLibrary:!0,refreshDataBitAdjustImageLibrary:!0,resultBitImageLibrary:[],resultBitDisplayImageLibrary:[],resultBitAdjustImageLibrary:[],refreshDataMapImageLibrary:!0,resultSubScreenImageLibrary:[],resultMapImageLibrary:[],refreshDataElementImageLibrary:!0,resultElementImageLibrary:[],refreshDataElement:!0,refreshDataElementWord:!0,refreshDataBitAdjust:!0,refreshDataBit:!0,refreshDataBitDisplay:!0,refreshDataMap:!0,refreshDataWordAdjust:!0,refreshDataWordDisplay:!0,refreshDataNumber:!0,refreshDataDWordAdjust:!0,refreshDataDWordDisplay:!0,refreshDataImage:!0,refreshDataLabel:!0,refreshDataString:!0,refreshDataMemonic:!0,refreshDataLine:!0,refreshDataPoint:!0,refreshDataPointPickPlace:!0,refreshDataPanel:!0,refreshDataCameraStream:!0,refreshDataViewImage:!0,refreshDataGridView:!0,refreshDataDateTimePicker:!0,refreshDataChart:!0,refreshDataProjectCall:!0,refreshDataPalletizer:!0,refreshDataPalletizerProduct:!0,refreshDataTextField:!0,refreshDataTextFieldInput:!0,refreshDataGroupControl:!0,refreshDataRealDisplay:!0,refreshDataJoystick:!0,haveChangeElement:!1,haveChangeBitAdjust:!1,haveChangeBit:!1,haveChangeBitDisplay:!1,haveChangeMap:!1,haveChangeWordAdjust:!1,haveChangeWordDisplay:!1,haveChangeNumber:!1,haveChangeDWordAdjust:!1,haveChangeDWordDisplay:!1,haveChangeTextField:!1,haveChangeTextFieldInput:!1,haveChangeRealDisplay:!1,haveChangeJoystick:!0,Modbus_Client_HoldingRegister:[],Modbus_Client_InputRegister:[],Modbus_Client_Coil:[],Modbus_Client_DiscreteInput:[],Communication_OPC_Items:[],Communication_PLC_Number_Address:[],Communication_ACE_Items:[],Communication_PLC_Word_Address:[],Communication_PLC_Bit_Address:[],Communication_PLC_Bit_Address_String:[],Communication_Profinet_Items:[],Communication_Profinet_Items_Number:[],Communication_Profinet_Items_Bit:[],Communication_Profinet_Items_String:[],Communication_Profinet_Items_Number_Popup:[],Communication_Profinet_Items_Bit_Popup:[],Communication_Profinet_Items_String_Popup:[],Communication_Profinet_Items_Gauge:[],Communication_Profinet_Items_ProgressBar:[],Communication_Profinet_Items_Slider:[],Communication_Profinet_Raw_Result:[],Temp_ProfiNet_Items_Number:[],Temp_ProfiNet_Items_Bit:[],Communication_PLC_String_Start_Address:[],Communication_PLC_String_Length:[],StoreModbusServerReg:v,StoreModbusServerBit:b,refreshDataPercent:!0,resultPercent:[],Percent:[],OldPercent:[],haveChangePercent:!1,Element:S,OldElement:D,Map:[],BitDisplay:C,BitAdjust:j,Bit:_,OldBit:I,WordDisplay:O,Number:w,WordAdjust:N,DWordDisplay:E,Word:T,DWord:L,DWordAdjust:x,WordTag:[],DWordTag:[],OldBitDisplay:R,OldBitAdjust:P,OldWordDisplay:A,OldNumber:B,OldWordAdjust:M,OldDWordDisplay:G,OldDWordAdjust:V,TextField:q,OldTextField:H,TextFieldInput:z,OldTextFieldInput:J,WordBitAdjust:[],OldWordBitAdjust:[],RealDisplay:U,OldRealDisplay:F,IndexSocketInputSignal:2,IndexSocketBitAdjust:4,IndexSocketBitDisplay:3,IndexSocketWordDisplay:5,IndexSocketWordAdjust:6,IndexSocketDWordDisplay:7,IndexSocketDWordAdjust:8,CheckBitDisplay:"",CheckBitAdjust:"",CheckWordDisplay:"",CheckWordAdjust:"",CheckDWordDisplay:"",CheckDWordAdjust:"",resultlabel:[],resultline:[],resultElement:[],resultElementWord:[],resultBitDisplay:[],resultBitAdjust:[],resultBit:[],resultWordDisplay:[],resultNumber:[],resultWordAdjust:[],resultDWordDisplay:[],resultDWordAdjust:[],resultPanel:[],resultCameraStream:[],resultViewImage:[],resultGridView:[],resultDateTimePicker:[],resultChart:[],resultProjectCall:[],resultPalletizer:[],resultPalletizerProduct:[],resultTextField:[],resultTextFieldInput:[],resultRealDisplay:[],resultcustomeroperator:void 0,refreshdata:void 0,CustomerOperator:void 0,resultFlow:[],resultJoystick:[],resultDesign:[],resultDesignTable:[],resultPopup:[],refreshDataPosCobot:!0,resultPosCobot:[],resultGroupControl:[],ListString:Q,OldListString:$,haveChangeString:!1,ResultString:[],storeListString:[],refreshData3D:!0,refreshDataDesign:!0,refreshDataDesignTable:!0,refreshDataDesignImageLibrary:!0,refreshDataPopup:!0,refreshDataPopupImageLibrary:!0,refreshDataProduct:!0,resultProduct:[],refreshDataUser:!0,resultUser:[],LoadProductsToPLC:!1,refreshDataGoal:!0,resultGoal:[],refreshDataSampleRoute:!0,resultSampleRoute:[],refreshDataFormularProject:!0,resultFormularProject:[],resultFormularProjectConvertType:[],xlData:void 0,xlData2:void 0,refreshDataScaleProject:!0,resultScaleProject:[],refreshDataSearchBox:!0,resultSearchBox:[],refreshDataSearchBoxList:!0,resultSearchBoxList:[],refreshDataReportScaleProject:!0,resultReportScaleProject:[],refreshDataReportScaleProjectTonKho:!0,resultReportScaleProjectTonKho:[],refreshDataProjectNanoenvi:!0,resultProjectNanoenvi:[],resultProjectNanoenvi1:[],resultProjectNanoenvi2:[],resultProjectNanoenvi3:[],resultProjectNanoenvi4:[],refreshDataProjectStampingMachine:!0,resultStampingMachineStartTime:[],ValueRotate:[],OldValueRotate:[],haveChangeValueRotate:!1,StoreBoxPalletizer:[],StoragePallet:[],refreshStoragePallet:!0,StoragePallet2:[],refreshStoragePallet2:!0,StoragePalletManual:[],refreshStoragePalletManual:!0,refreshScreen_Label:!0,resultProjectScreen_Label:[],refreshScreen_Panel:!0,resultProjectScreen_Panel:[],refreshScreen_CameraStream:!0,resultProjectScreen_CameraStream:[],refreshScreen_Element:!0,resultProjectScreen_Element:[],refreshScreen_BitDisplay:!0,resultProjectScreen_BitDisplay:[],refreshScreen_BitAdjust:!0,resultProjectScreen_BitAdjust:[],refreshScreen_WordDisplay:!0,resultProjectScreen_WordDisplay:[],refreshScreen_WordAdjust:!0,resultProjectScreen_WordAdjust:[],refreshScreen_DWordDisplay:!0,resultProjectScreen_DWordDisplay:[],refreshScreen_DWordAdjust:!0,resultProjectScreen_DWordAdjust:[],refreshScreen_String:!0,resultProjectScreen_String:[],refreshScreen_TextFieldInput:!0,resultProjectScreen_TextFieldInput:[],refreshScreen_Line:!0,resultProjectScreen_Line:[],refreshSetupElement:!0,resultSetupElement:[],refreshDataSetupAlarm:!0,resultSetupAlarm:[],resultSetupAlarmTable:[],resultSetupAlarmTable_BitDisplay:[],resultSetupAlarmTable_BitAdjust:[],refreshDataBitImageLibrary:!0,haveChangeArrBit:r,haveChangeArrBitAdjust:a,haveChangeArrBitDisplay:n,haveChangeArrBitDisplay_SetupAlarm:i,haveChangeArrWordAdjust:o,haveChangeArrWordDisplay:s,haveChangeArrNumber:l,haveChangeArrGauge:c,haveChangeArrProgressBar:d,haveChangeArrSlider:u,haveChangeArrDWordAdjust:p,haveChangeArrDWordDisplay:y,haveChangeArrElement:t,haveChangeArrString:f,haveChangeArrTextField:m,haveChangeArrTextFieldInput:h,haveChangeArrRealDisplay:g,clientMB:void 0,clientMB_Writting:!1,ComPC:[],refreshMemonic:!0,haveChangeMemonic:!1,resultMemonic:[],resultIconImageLibrary:[],refreshDataIconImageLibrary:!0,resultImageBackgroundImageLibrary:[],refreshDataImageBackgroundImageLibrary:!0,result3D:[]}},456:e=>{e.exports={PositionMobileRobot:[{},{},{},{},{}],OldPositionMobileRobot:[],active:!1,IO:void 0,PathLocalDB:void 0,LocalDB:"null",PLC_Code_BitAdjust:[],PLC_Code_WordAdjust:[],PLC_Code_DWordAdjust:[],ProjectPalletizer:!1,COMMUNICATION_SERVER_TYPE:[],COMMUNICATION_OPCUA:[],COMMUNICATION_ACE_SOCKET:[],COMMUNICATION_SIEMENS:[],COMMUNICATION_PLC_OMRON:[],COMMUNICATION_MOBILE_ROBOT:[],COMMUNICATION_MOBILE_ROBOT_TIMER:[],COMMUNICATION_PLC_MODBUS:[],COMMUNICATION_PLC_SIEMENS:[],COMMUNICATION_VNC:[],COMMUNICATION_VNC_INITIAL_DATA:[],TimeDelayWriteWordBitAdjust:[],PLC_WordStartElement:[],PLC_LengthOfWordElement:[],PLC_WordStartBitDisplay:[],PLC_LengthOfWordBitDisplay:[],PLC_WordStartBitAdjust:[],PLC_LengthOfWordBitAdjust:[],PLC_BitStartBitDisplay:[],PLC_LengthOfBitBitDisplay:[],PLC_BitStartBitAdjust:[],PLC_LengthOfBitBitAdjust:[],PLC_WordStartWordDisplay:[],PLC_LengthOfWordWordDisplay:[],PLC_WordStartWordAdjust:[],PLC_LengthOfWordWordAdjust:[],PLC_WordStartDWordDisplay:[],PLC_LengthOfWordDWordDisplay:[],PLC_WordStartDWordAdjust:[],PLC_LengthOfWordDWordAdjust:[],PLC_Length_ReadWrite:[],PLC_WriteUnSafe:[],PLC_IntervalWriteData:[],PLC_WordStartRotate:[],PLC_LengthOfWordRotate:[],PLC_WordStartComPC:[],PLC_LengthOfWordComPC:[],PLC_Enable_String:[],PLC_WordStartString:[],PLC_LengthOfWordString:[],PLC_NumberWordInString:[],RefreshData:!1}},6509:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.AppController=void 0;const n=r(3563),o=r(7247),s=r(4774),l=r(3726),c=r(3292),d=r(2338),u=r(1134),p=r(9940),y=r(9742),g=r(6712),f=r(7888),m=r(8792),h=r(3336),v=r(9446),b=r(3044),S=r(5324),D=r(6052),_=r(6277),I=r(456),C=r(4780);let R=class{constructor(e,t,r,a,i,n,o,s,l,c,d,u,p,y,g,f){this.socketGateway=e,this.scadaWordDisplayRefreshService=t,this.scadaNumberRefreshService=r,this.scadaGaugeRefreshService=a,this.scadaProgressBarRefreshService=i,this.scadaSliderRefreshService=n,this.scadaWordAdjustRefreshService=o,this.scadaDWordDisplayRefreshService=s,this.scadaElementRefreshService=l,this.scadaBitAdjustRefreshService=c,this.scadaBitRefreshService=d,this.scadaBitDisplayRefreshService=u,this.scadaDWordAdjustRefreshService=p,this.scadaStringRefreshService=y,this.scadaTextFieldRefreshService=g,this.scadaSetupAlarmRefreshService=f,setInterval((()=>{if(_&&1==C.active){for(let e=0;e<_.Element.length;e++)JSON.stringify(_.Element[e])!==JSON.stringify(_.OldElement[e])&&(_.OldElement[e]=_.Element[e].slice(),_.haveChangeArrElement[e]=!0,this.scadaElementRefreshService.refreshData());for(let e=0;e<_.Bit.length;e++)JSON.stringify(_.Bit[e])!==JSON.stringify(_.OldBit[e])&&(_.OldBit[e]=_.Bit[e].slice(),_.haveChangeArrBit[e]=!0,this.scadaBitRefreshService.refreshData());for(let e=0;e<_.BitAdjust.length;e++)JSON.stringify(_.BitAdjust[e])!==JSON.stringify(_.OldBitAdjust[e])&&(_.OldBitAdjust[e]=_.BitAdjust[e].slice(),_.haveChangeArrBitAdjust[e]=!0,this.scadaBitAdjustRefreshService.refreshData());for(let e=0;e<_.BitDisplay.length;e++)JSON.stringify(_.BitDisplay[e])!==JSON.stringify(_.OldBitDisplay[e])&&(_.OldBitDisplay[e]=_.BitDisplay[e].slice(),_.haveChangeArrBitDisplay[e]=!0,this.scadaBitDisplayRefreshService.refreshData());for(let e=0;e<_.Word.length;e++)JSON.stringify(_.Word[e])!==JSON.stringify(_.OldWord[e])&&(_.OldWord[e]=_.Word[e].slice(),_.haveChangeArrNumber[e]=!0,this.scadaNumberRefreshService.refreshData(),_.haveChangeArrProgressBar[e]=!0,this.scadaProgressBarRefreshService.refreshData(),_.haveChangeArrSlider[e]=!0,this.scadaSliderRefreshService.refreshData());for(let e=0;e<_.WordDisplay.length;e++)JSON.stringify(_.WordDisplay[e])!==JSON.stringify(_.OldWordDisplay[e])&&(_.OldWordDisplay[e]=_.WordDisplay[e].slice(),_.haveChangeArrWordDisplay[e]=!0,this.scadaWordDisplayRefreshService.refreshData(),_.haveChangeArrNumber[e]=!0,this.scadaNumberRefreshService.refreshData());for(let e=0;e<_.Number.length;e++)JSON.stringify(_.Number[e])!==JSON.stringify(_.OldNumber[e])&&(_.OldNumber[e]=_.Number[e].slice(),_.haveChangeArrNumber[e]=!0,this.scadaNumberRefreshService.refreshData(),_.haveChangeArrGauge[e]=!0,this.scadaGaugeRefreshService.refreshData(),_.haveChangeArrProgressBar[e]=!0,this.scadaProgressBarRefreshService.refreshData(),_.haveChangeArrSlider[e]=!0,this.scadaSliderRefreshService.refreshData(),_.haveChangeArrString[e]=!0,this.scadaStringRefreshService.refreshData());for(let e=0;e<_.WordAdjust.length;e++)JSON.stringify(_.WordAdjust[e])!==JSON.stringify(_.OldWordAdjust[e])&&(_.OldWordAdjust[e]=_.WordAdjust[e].slice(),_.haveChangeArrWordAdjust[e]=!0,this.scadaWordAdjustRefreshService.refreshData(),_.haveChangeArrNumber[e]=!0,this.scadaNumberRefreshService.refreshData());for(let e=0;e<_.DWord.length;e++)JSON.stringify(_.DWord[e])!==JSON.stringify(_.OldDWord[e])&&(_.OldDWord[e]=_.DWord[e].slice(),_.haveChangeArrNumber[e]=!0,this.scadaNumberRefreshService.refreshData(),_.haveChangeArrProgressBar[e]=!0,this.scadaProgressBarRefreshService.refreshData(),_.haveChangeArrSlider[e]=!0,this.scadaSliderRefreshService.refreshData());for(let e=0;e<_.DWordDisplay.length;e++)JSON.stringify(_.DWordDisplay[e])!==JSON.stringify(_.OldDWordDisplay[e])&&(_.OldDWordDisplay[e]=_.DWordDisplay[e].slice(),_.haveChangeArrDWordDisplay[e]=!0,this.scadaDWordDisplayRefreshService.refreshData(),_.haveChangeArrNumber[e]=!0,this.scadaNumberRefreshService.refreshData());for(let e=0;e<_.DWordAdjust.length;e++)JSON.stringify(_.DWordAdjust[e])!==JSON.stringify(_.OldDWordAdjust[e])&&(_.OldDWordAdjust[e]=_.DWordAdjust[e].slice(),_.haveChangeArrDWordAdjust[e]=!0,this.scadaDWordAdjustRefreshService.refreshData(),_.haveChangeArrNumber[e]=!0,this.scadaNumberRefreshService.refreshData());for(let e=0;e<_.ListString.length;e++)JSON.stringify(_.ListString[e])!==JSON.stringify(_.OldListString[e])&&(_.OldListString[e]=_.ListString[e].slice(),_.haveChangeArrString[e]=!0,this.scadaStringRefreshService.refreshData());for(let e=0;e<_.RealDisplay.length;e++)JSON.stringify(_.RealDisplay[e])!==JSON.stringify(_.OldRealDisplay[e])&&(_.OldRealDisplay[e]=_.RealDisplay[e].slice(),_.haveChangeArrRealDisplay[e]=!0);for(let e=0;e<_.TextField.length;e++)JSON.stringify(_.TextField[e])!==JSON.stringify(_.OldTextField[e])&&(_.OldTextField[e]=_.TextField[e].slice(),_.haveChangeArrTextField[e]=!0,this.scadaTextFieldRefreshService.refreshData());JSON.stringify(I.PositionMobileRobot)!==JSON.stringify(I.OldPositionMobileRobot)&&(I.OldPositionMobileRobot=I.PositionMobileRobot.slice(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("PositionMobile",I.PositionMobileRobot))}}),100),setInterval((()=>{this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("PLC_Connect_Status",_.Plc_Connect_Status),1==_.turnOff&&process.exit(0)}),1e3)}};t.AppController=R,t.AppController=R=a([(0,n.Controller)(),i("design:paramtypes",[o.SocketGateway,s.ScadaWordDisplayRefreshService,l.ScadaNumberRefreshService,c.ScadaGaugeRefreshService,d.ScadaProgressBarRefreshService,u.ScadaSliderRefreshService,S.ScadaWordAdjustRefreshService,m.ScadaDWordDisplayRefreshService,p.ScadaElementRefreshService,y.ScadaBitAdjustRefreshService,g.ScadaBitRefreshService,f.ScadaBitDisplayRefreshService,h.ScadaDWordAdjustRefreshService,v.ScadaStringRefreshService,b.ScadaTextFieldRefreshService,D.ScadaSetupAlarmRefreshService])],R)},3205:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.AppModule=void 0;const i=r(3563),n=r(6509),o=r(2283),s=r(5851),l=r(2449),c=r(2523),d=r(9522),u=r(4789),p=r(1205),y=r(9369),g=r(4831),f=r(3397),m=r(7573),h=r(7941),v=r(2459),b=r(463),S=r(4765),D=r(5989),_=r(1451),I=r(759),C=r(8271),R=r(7239),j=r(3473),P=r(3585),O=r(7695),w=r(465),A=r(7861),B=r(5893),N=r(6881),M=r(7305),E=r(8933),L=r(855),k=r(8213),T=r(4933),W=r(5423),G=r(3415),U=r(1937),F=r(2181),x=r(9825),V=r(3115),q=r(2089),H=r(4115),z=r(4771),J=r(1845),Q=r(979),$=r(69),Y=r(1129),X=r(677),K=r(4879),Z=r(6285),ee=r(1717),te=r(2589),re=r(6173),ae=r(6461),ie=r(4774),ne=r(9940),oe=r(9742),se=r(7888),le=r(8792),ce=r(3336),de=r(9446),ue=r(3044),pe=r(8281),ye=r(6959),ge=r(1903),fe=r(5822),me=r(5324),he=r(6052),ve=r(3726),be=r(3292),Se=r(2338),De=r(1134),_e=r(6712),Ie=r(7328);let Ce=class{};t.AppModule=Ce,t.AppModule=Ce=a([(0,i.Module)({imports:[o.PostModule,s.NoteModule,l.SocketIoModule,c.SystemApiModule,ge.ConfigModule,d.TypeOrmModule.forRootAsync(fe.typeOrmConfigAsync),p.ScadaLabelModule,y.ScadaChartModule,g.ScadaUserModule,f.ScadaPanelModule,m.ScadaCameraStreamModule,h.ScadaViewImageModule,v.ScadaGridViewModule,b.ScadaDateTimePickerModule,S.ScadaSelectModule,D.ScadaGaugeModule,_.ScadaProgressBarModule,I.ScadaSliderModule,C.Scada3DModule,j.ScadaBitModule,P.ScadaConnectionModule,O.ScadaNavigateModule,w.ScadaPrintModule,A.ScadaReportModule,R.ScadaBitAdjustModule,B.ScadaWordAdjustModule,N.ScadaDWordAdjustModule,E.ScadaDesignModule,L.ScadaDesignTableModule,k.ScadaPopupModule,T.ScadaPopupImageLibraryModule,M.ScadaBitDisplayModule,W.ScadaWordDisplayModule,G.ScadaNumberModule,U.ScadaDWordDisplayModule,F.ScadaBitDisplayImageLibraryModule,V.ScadaBitAdjustImageLibraryModule,q.ScadaBitImageLibraryModule,H.ScadaNumberImageLibraryModule,z.ScadaNavigateImageLibraryModule,x.ScadaDesignImageLibraryModule,Q.ScadaIconImageLibraryModule,$.ScadaBackgroundImageLibraryModule,Y.ScadaMapImageLibraryModule,X.ScadaMapModule,K.ScadaStringModule,Z.ScadaTextFieldModule,ee.ScadaLineModule,J.ScadaElementImageLibraryModule,te.ScadaElementModule,re.ScadaMemonicModule,l.SocketIoModule,pe.MicroserviceClientModule,ye.MqttModule,ae.ScadaSetupAlarmModule,u.ScadaTotalModule,Ie.SharedModule],controllers:[n.AppController],providers:[ie.ScadaWordDisplayRefreshService,ve.ScadaNumberRefreshService,be.ScadaGaugeRefreshService,Se.ScadaProgressBarRefreshService,De.ScadaSliderRefreshService,me.ScadaWordAdjustRefreshService,ne.ScadaElementRefreshService,oe.ScadaBitAdjustRefreshService,_e.ScadaBitRefreshService,se.ScadaBitDisplayRefreshService,le.ScadaDWordDisplayRefreshService,ce.ScadaDWordAdjustRefreshService,de.ScadaStringRefreshService,ue.ScadaTextFieldRefreshService,he.ScadaSetupAlarmRefreshService]})],Ce)},1903:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigModule=void 0;const i=r(3563),n=r(2664);let o=class{};t.ConfigModule=o,t.ConfigModule=o=a([(0,i.Module)({providers:[n.ConfigService],exports:[n.ConfigService]})],o)},2664:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigService=void 0;const n=r(3563),o=r(818),s=r(9896);let l=class{constructor(){{const e=__dirname+"/../.env";s.existsSync(e)||(console.log(".env file does not exist"),process.exit(0)),this.envConfig=o.parse(s.readFileSync(e))}}get(e){return this.envConfig[e]}};t.ConfigService=l,t.ConfigService=l=a([(0,n.Injectable)(),i("design:paramtypes",[])],l)},5822:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.typeOrmConfigAsync=void 0;const a=r(1903),i=r(2664),n=r(6334),o=r(2428),s=r(7202),l=r(5140),c=r(436),d=r(3048),u=r(10),p=r(2586),y=r(9920),g=r(1866),f=r(6494),m=r(7822),h=r(9314),v=r(9082),b=r(7438),S=r(8248),D=r(3566),_=r(7006),I=r(602),C=r(938),R=r(8110),j=r(3350),P=r(6324),O=r(7470),w=r(882),A=r(1374),B=r(274),N=r(9310),M=r(8982),E=r(1902),L=r(6078),k=r(6574),T=r(7788),W=r(8016),G=r(7574),U=r(5646),F=r(5484),x=r(8075),V=r(4288),q=r(5392),H=r(9094),z=r(1520),J=r(5550),Q=r(2e3),$=r(808),Y=r(7222);r(818).config();const X=r(456);t.typeOrmConfigAsync={imports:[a.ConfigModule],inject:[i.ConfigService],useFactory:async e=>{const t=e.get("DB_Path")||"./db/default.db";return X.PathLocalDB=t,{type:"sqlite",database:t,entities:[n.BackgroundImageLibraryEntity,z.UserEntity,d.BitAdjustEntity,u.BitEntity,p.ConnectionEntity,y.NavigateEntity,g.PrintEntity,f.ReportEntity,s.BitImageLibraryEntity,l.NumberImageLibraryEntity,c.NavigateImageLibraryEntity,o.BitAdjustImageLibraryEntity,h.BitDisplayEntity,m.BitDisplayImageLibraryEntity,v.DesignImageLibraryEntity,b.DesignEntity,S.DesignTableEntity,_.PopupEntity,D.PopupImageLibraryEntity,I.DWordAdjustEntity,C.DWordDisplayEntity,j.ElementEntity,R.ElementImageLibraryEntity,P.IconImageLibraryEntity,O.LabelEntity,w.ChartEntity,A.LineEntity,N.MapEntity,B.MapImageLibraryEntity,M.MemonicEntity,E.PanelEntity,L.CameraStreamEntity,k.ViewImageEntity,T.GridViewEntity,W.DateTimePickerEntity,G.SelectEntity,U.GaugeEntity,F.ProgressBarEntity,x.SliderEntity,V._3DEntity,q.StringEntity,H.TextFieldEntity,J.WordAdjustEntity,Q.WordDisplayEntity,$.NumberEntity,Y.SetupAlarmEntity],synchronize:!0}}}},3721:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.MicroserviceClientController=void 0;const n=r(3563),o=r(6202);let s=class{constructor(e){this.microserviceClientService=e}async sendMessage(){return await this.microserviceClientService.sendMessage("Hello from client!")}};t.MicroserviceClientController=s,a([(0,n.Get)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],s.prototype,"sendMessage",null),t.MicroserviceClientController=s=a([(0,n.Controller)(),i("design:paramtypes",[o.MicroserviceClientService])],s)},8281:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.MicroserviceClientModule=void 0;const i=r(3563),n=r(6202),o=r(3721);let s=class{};t.MicroserviceClientModule=s,t.MicroserviceClientModule=s=a([(0,i.Module)({providers:[n.MicroserviceClientService],controllers:[o.MicroserviceClientController]})],s)},6202:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.MicroserviceClientService=void 0;const n=r(3563),o=r(2510);let s=class{constructor(){this.client=o.ClientProxyFactory.create({transport:o.Transport.MQTT,options:{host:"localhost",port:1883}})}async sendMessage(e){return this.client.send("message",e).toPromise()}};t.MicroserviceClientService=s,t.MicroserviceClientService=s=a([(0,n.Injectable)(),i("design:paramtypes",[])],s)},6959:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.MqttModule=void 0;const i=r(3563),n=r(824),o=r(2664);let s=class{};t.MqttModule=s,t.MqttModule=s=a([(0,i.Module)({providers:[n.MqttService,o.ConfigService],exports:[n.MqttService]})],s)},824:function(e,t,r){"use strict";var a,i=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.MqttService=void 0;const o=r(3563),s=r(2630),l=r(2664),c=r(6277),d=r(4780);r(818).config();let u=a=class{constructor(e){this.configService=e}onModuleInit(){a.mqttClient||this.initializeMqttClient()}initializeMqttClient(){const e=process.env.MQTT_HOST,t=process.env.MQTT_PORT,r=`mqtt_${Math.random().toString(16).slice(3)}`,i=`mqtt://${e}:${t}`;a.mqttClient=(0,s.connect)(i,{clientId:r,clean:!0,connectTimeout:4e3,reconnectPeriod:1e3}),a.mqttClient.on("connect",(()=>{console.log("Connected to CloudMQTT"),a.mqttClient.publish("MQTT_Raw_ResultBit",JSON.stringify(c.resultBit),{retain:!0}),a.mqttClient.publish("MQTT_Raw_ResultNumber",JSON.stringify(c.resultNumber),{retain:!0}),a.mqttClient.publish("MQTT_Raw_ResultString",JSON.stringify(c.resultString),{retain:!0}),a.mqttClient.publish("MQTT_Raw_ResultElement",JSON.stringify(c.resultElement),{retain:!0})})),a.mqttClient.on("error",(e=>{}))}publish(e,t){return 1==d.active&&a.mqttClient?(a.mqttClient.publish(e,t,{retain:!0}),`Publishing to ${e}`):`Failed to publish to ${e}`}};t.MqttService=u,u.mqttClient=null,t.MqttService=u=a=i([(0,o.Injectable)(),n("design:paramtypes",[l.ConfigService])],u)},5851:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.NoteModule=void 0;const i=r(3563);let n=class{};t.NoteModule=n,t.NoteModule=n=a([(0,i.Module)({})],n)},2283:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.PostModule=void 0;const i=r(3563);let n=class{};t.PostModule=n,t.PostModule=n=a([(0,i.Module)({})],n)},2347:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Scada3DController=void 0;const o=r(3563),s=r(1192);let l=class{constructor(e){this.scada3DService=e}getData(){return this.scada3DService.getData()}insert3D(e){return this.scada3DService.insert3D(e)}update3D(e){return this.scada3DService.update3D(e)}delete3D(e){return this.scada3DService.delete3D(e)}};t.Scada3DController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_3D"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insert3D",null),a([(0,o.Put)("/update_3D"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update3D",null),a([(0,o.Delete)("/delete_3D"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete3D",null),t.Scada3DController=l=a([(0,o.Controller)("3D"),i("design:paramtypes",[s.Scada3DService])],l)},4288:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t._3DEntity=void 0;const n=r(3132);let o=class{};t._3DEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttTopicJointChange",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"arrModelUrls",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"evalSetupJoint",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"evalUpdateRotation",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cameraConfig",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"arrTargetOrbitControls",void 0),t._3DEntity=o=a([(0,n.Entity)("3D")],o)},8271:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.Scada3DModule=void 0;const i=r(3563),n=r(1192),o=r(2347),s=r(2449),l=r(9522),c=r(4288);let d=class{};t.Scada3DModule=d,t.Scada3DModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c._3DEntity]),s.SocketIoModule],providers:[n.Scada3DService],controllers:[o.Scada3DController]})],d)},1192:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Scada3DService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(4288),d=r(7247),u=r(6277);let p=class{constructor(e,t){this._3DRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshData3D){u.refreshData3D=!1;try{u.result3D=await this._3DRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("Update3D",u.result3D)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.result3D}async insert3D(e){try{e._id="a"+Math.random().toString(36);const t=this._3DRepository.create(e);return await this._3DRepository.save(t),u.refreshData3D=!0,{result:"success",message:"Add 3D Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async update3D(e){try{return await this._3DRepository.update(e._id,e),u.refreshData3D=!0,{result:"success",message:"Update 3D Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async delete3D(e){try{return await this._3DRepository.delete(e),u.refreshData3D=!0,{result:"success",message:"Delete 3D Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.Scada3DService=p,t.Scada3DService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c._3DEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},6525:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBackgroundImageLibraryController=void 0;const o=r(3563),s=r(2790);let l=class{constructor(e){this.scadaBackgroundImageLibraryService=e}getData(){return this.scadaBackgroundImageLibraryService.getData()}getDataQuery(e){return this.scadaBackgroundImageLibraryService.getDataQuery(e)}upload(e){return console.log("requestBody",e),this.scadaBackgroundImageLibraryService.upload(e)}update(e){return this.scadaBackgroundImageLibraryService.update(e)}delete(e){return this.scadaBackgroundImageLibraryService.delete(e)}};t.ScadaBackgroundImageLibraryController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Get)("/getdata_query"),n(0,(0,o.Query)("screenName")),i("design:type",Function),i("design:paramtypes",[String]),i("design:returntype",void 0)],l.prototype,"getDataQuery",null),a([(0,o.Post)("/upload"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"upload",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaBackgroundImageLibraryController=l=a([(0,o.Controller)("uploadImageImageBackground"),i("design:paramtypes",[s.ScadaBackgroundImageLibraryService])],l)},6334:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundImageLibraryEntity=void 0;const n=r(3132);let o=class{};t.BackgroundImageLibraryEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"img",void 0),a([(0,n.Column)({nullable:!0,default:0}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,default:0}),i("design:type",Number)],o.prototype,"height",void 0),t.BackgroundImageLibraryEntity=o=a([(0,n.Entity)("ImageBackgroundImageLibrary")],o)},69:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBackgroundImageLibraryModule=void 0;const i=r(3563),n=r(2449),o=r(9522),s=r(6334),l=r(6525),c=r(2790);let d=class{};t.ScadaBackgroundImageLibraryModule=d,t.ScadaBackgroundImageLibraryModule=d=a([(0,i.Module)({imports:[o.TypeOrmModule.forFeature([s.BackgroundImageLibraryEntity]),n.SocketIoModule],controllers:[l.ScadaBackgroundImageLibraryController],providers:[c.ScadaBackgroundImageLibraryService]})],d)},2790:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBackgroundImageLibraryService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7247),d=r(6334),u=r(6277);let p=class{constructor(e,t){this.BackgroundImageLibraryRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataImageBackgroundImageLibrary){u.refreshDataImageBackgroundImageLibrary=!1;try{u.resultImageBackgroundImageLibrary=await this.BackgroundImageLibraryRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateImageBackgroundImageLibrary",u.resultImageBackgroundImageLibrary)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultImageBackgroundImageLibrary}async getDataQuery(e){return await this.BackgroundImageLibraryRepository.query('SELECT * FROM ImageBackgroundImageLibrary WHERE name="'+e+'"')}async upload(e){try{if(3!==e.data.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/).length)return{result:"error",data:{},message:"Invalid input string"};let t={_id:"a"+Math.random().toString(36),name:e.name,img:e.data,enable:e.enable,width:e.width,height:e.height};const r=this.BackgroundImageLibraryRepository.create(t);return await this.BackgroundImageLibraryRepository.save(r),u.refreshDataImageBackgroundImageLibrary=!0,{result:"success",message:"Add Background Image Library Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.BackgroundImageLibraryRepository.delete(e),u.refreshDataImageBackgroundImageLibrary=!0,{result:"success",message:"Delete Background Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async update(e){try{return await this.BackgroundImageLibraryRepository.update(e._id,e),u.refreshDataImageBackgroundImageLibrary=!0,{result:"success",message:"Update Background Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaBackgroundImageLibraryService=p,t.ScadaBackgroundImageLibraryService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.BackgroundImageLibraryEntity)),i("design:paramtypes",[l.Repository,c.SocketGateway])],p)},7503:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitAdjustImageLibraryController=void 0;const o=r(3563),s=r(7332);let l=class{constructor(e){this.scadaBitAdjustImageLibraryService=e}getData(){return this.scadaBitAdjustImageLibraryService.getData()}upload(e){return this.scadaBitAdjustImageLibraryService.upload(e)}delete(e){return this.scadaBitAdjustImageLibraryService.delete(e)}};t.ScadaBitAdjustImageLibraryController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/upload"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"upload",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaBitAdjustImageLibraryController=l=a([(0,o.Controller)("uploadImageBitAdjust"),i("design:paramtypes",[s.ScadaBitAdjustImageLibraryService])],l)},2428:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.BitAdjustImageLibraryEntity=void 0;const n=r(3132);let o=class{};t.BitAdjustImageLibraryEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"img",void 0),t.BitAdjustImageLibraryEntity=o=a([(0,n.Entity)("BitAdjustImageLibrary")],o)},3115:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitAdjustImageLibraryModule=void 0;const i=r(3563),n=r(2449),o=r(9522),s=r(2428),l=r(7503),c=r(7332);let d=class{};t.ScadaBitAdjustImageLibraryModule=d,t.ScadaBitAdjustImageLibraryModule=d=a([(0,i.Module)({imports:[o.TypeOrmModule.forFeature([s.BitAdjustImageLibraryEntity]),n.SocketIoModule],controllers:[l.ScadaBitAdjustImageLibraryController],providers:[c.ScadaBitAdjustImageLibraryService]})],d)},7332:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitAdjustImageLibraryService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7247),d=r(2428),u=r(6277);let p=class{constructor(e,t){this.bitDisplayImageLibraryRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataBitAdjustImageLibrary){u.refreshDataBitAdjustImageLibrary=!1;try{u.resultBitAdjustImageLibrary=await this.bitDisplayImageLibraryRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateBitAdjustImageLibrary",u.resultBitAdjustImageLibrary)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultBitAdjustImageLibrary}async upload(e){try{if(3!==e.data.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/).length)return{result:"error",data:{},message:"Invalid input string"};let t={_id:"a"+Math.random().toString(36),name:e.name,img:e.data};const r=this.bitDisplayImageLibraryRepository.create(t);return await this.bitDisplayImageLibraryRepository.save(r),u.refreshDataBitAdjustImageLibrary=!0,{result:"success",message:"Add BitAdjust Image Library Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.bitDisplayImageLibraryRepository.delete(e),u.refreshDataBitAdjustImageLibrary=!0,{result:"success",message:"Delete BitAdjust Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaBitAdjustImageLibraryService=p,t.ScadaBitAdjustImageLibraryService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.BitAdjustImageLibraryEntity)),i("design:paramtypes",[l.Repository,c.SocketGateway])],p)},9742:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitAdjustRefreshService=void 0;const n=r(3563),o=r(7247),s=r(6277);let l=class{constructor(e){this.socketGateway=e}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}refreshData(){let e=!1;try{if(Array.isArray(s.haveChangeArrBitAdjust))for(let t=0;t<s.haveChangeArrBitAdjust.length;t++)if(s.haveChangeArrBitAdjust[t]){if(e=!1,s.haveChangeArrBitAdjust[t]=!1,Array.isArray(s.resultBitAdjust))for(let t=0;t<s.resultBitAdjust.length;t++)if(this.checkVariableTypeNumber(s.resultBitAdjust[t].idDevice)&&s.BitAdjust[parseInt(s.resultBitAdjust[t].idDevice)])if(this.checkVariableTypeNumber(s.resultBitAdjust[t].tag))if(/^\d+\.\d+$/.test(s.resultBitAdjust[t].tag)){if(s.resultBitAdjust[t].tag.length>0&&s.BitAdjust[parseInt(s.resultBitAdjust[t].idDevice)])for(let r of s.BitAdjust[parseInt(s.resultBitAdjust[t].idDevice)])s.resultBitAdjust[t].tag in r&&(s.resultBitAdjust[t].status=r[s.resultBitAdjust[t].tag],e=!0)}else s.resultBitAdjust[t].tag<=s.BitAdjust[parseInt(s.resultBitAdjust[t].idDevice)].length&&(s.resultBitAdjust[t].status=s.BitAdjust[parseInt(s.resultBitAdjust[t].idDevice)][s.resultBitAdjust[t].tag],e=!0);else if(s.resultBitAdjust[t].tag.length>0&&s.BitAdjust[parseInt(s.resultBitAdjust[t].idDevice)])for(let r of s.BitAdjust[parseInt(s.resultBitAdjust[t].idDevice)])s.resultBitAdjust[t].tag in r&&(s.resultBitAdjust[t].status=r[s.resultBitAdjust[t].tag],e=!0);if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateBitAdjust",s.resultBitAdjust),e=!1,Array.isArray(s.resultProjectScreen_BitAdjust))for(let t=0;t<s.resultProjectScreen_BitAdjust.length;t++)parseInt(s.resultProjectScreen_BitAdjust[t].idDevice)&&s.BitAdjust[parseInt(s.resultProjectScreen_BitAdjust[t].idDevice)]&&(s.resultProjectScreen_BitAdjust[t].tag<=s.BitAdjust[parseInt(s.resultProjectScreen_BitAdjust[t].idDevice)].length&&(s.resultProjectScreen_BitAdjust[t].status=s.BitAdjust[parseInt(s.resultProjectScreen_BitAdjust[t].idDevice)][s.resultProjectScreen_BitAdjust[t].tag]),e=!0);if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_BitAdjust",s.resultProjectScreen_BitAdjust),e=!1,Array.isArray(s.resultProjectScreen_Element))for(let t=0;t<s.resultProjectScreen_Element.length;t++)isNaN(s.resultProjectScreen_Element[t].idDevice)||((s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]&&s.resultProjectScreen_Element[t].tagOn||!s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]&&s.resultProjectScreen_Element[t].tagOff)&&(s.resultProjectScreen_Element[t].status=2),s.resultProjectScreen_Element[t].tagOff&&s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)]&&(parseInt(s.resultProjectScreen_Element[t].notOff)?s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagOff]||(s.resultProjectScreen_Element[t].status=0,e=!0):s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagOff]&&(s.resultProjectScreen_Element[t].status=0,e=!0)),s.resultProjectScreen_Element[t].tagOn&&s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)]&&(parseInt(s.resultProjectScreen_Element[t].notOn)?s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagOn]||(s.resultProjectScreen_Element[t].status=1,e=!0):s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagOn]&&(s.resultProjectScreen_Element[t].status=1,e=!0)),s.resultProjectScreen_Element[t].tagFault&&s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)]&&s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagFault]&&(s.resultProjectScreen_Element[t].status=3,e=!0));if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_Element",s.resultProjectScreen_Element),e=!1,e=!1,Array.isArray(s.resultProjectScreen_Element))for(let t=0;t<s.resultProjectScreen_Element.length;t++)isNaN(s.resultProjectScreen_Element[t].idDevice)||((s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]&&!s.resultProjectScreen_Element[t].tagOn||!s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]&&!s.resultProjectScreen_Element[t].tagOff)&&(s.resultProjectScreen_Element[t].status=2,e=!0),s.resultProjectScreen_Element[t].tagOff||s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]||!s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)]||s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagBit]||(s.resultProjectScreen_Element[t].status=0,e=!0),!s.resultProjectScreen_Element[t].tagOn&&s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]&&s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)]&&s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagBit]&&(s.resultProjectScreen_Element[t].status=1,e=!0));if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_Element",s.resultProjectScreen_Element),e=!1,e=!1,Array.isArray(s.resultLine))for(let t=0;t<s.resultLine.length;t++)"BitAdjust"==s.resultLine[t].typeTag&&!isNaN(s.resultLine[t].idDevice)&&s.BitAdjust[parseInt(s.resultLine[t].idDevice)]&&(s.BitAdjust[parseInt(s.resultLine[t].idDevice)][s.resultLine[t].tag]?(s.resultLine[t].status=1,e=!0):(s.resultLine[t].status=0,e=!0));if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateLine",s.resultLine),e=!1,Array.isArray(s.resultProjectScreen_Line))for(let t=0;t<s.resultProjectScreen_Line.length;t++)"BitAdjust"==s.resultProjectScreen_Line[t].typeTag&&!isNaN(s.resultProjectScreen_Line[t].idDevice)&&s.BitAdjust[parseInt(s.resultProjectScreen_Line[t].idDevice)]&&(s.BitAdjust[parseInt(s.resultProjectScreen_Line[t].idDevice)][s.resultProjectScreen_Line[t].tag]?(s.resultProjectScreen_Line[t].status=1,e=!0):(s.resultProjectScreen_Line[t].status=0,e=!0));e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_Line",s.resultProjectScreen_Line)}}catch(e){console.log(e)}}};t.ScadaBitAdjustRefreshService=l,t.ScadaBitAdjustRefreshService=l=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway])],l)},5699:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitAdjustController=void 0;const o=r(3563),s=r(4672);let l=class{constructor(e){this.scadaBitAdjustService=e}getData(){return this.scadaBitAdjustService.getData()}insertBitAdjust(e){return this.scadaBitAdjustService.insertBitAdjust(e)}updateBitAdjust(e){return this.scadaBitAdjustService.updateBitAdjust(e)}deleteBitAdjust(e){return this.scadaBitAdjustService.deleteBitAdjust(e)}};t.ScadaBitAdjustController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_bitAdjust"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertBitAdjust",null),a([(0,o.Put)("/update_bitAdjust"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateBitAdjust",null),a([(0,o.Delete)("/delete_bitAdjust"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteBitAdjust",null),t.ScadaBitAdjustController=l=a([(0,o.Controller)("bitAdjust"),i("design:paramtypes",[s.ScadaBitAdjustService])],l)},3048:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.BitAdjustEntity=void 0;const n=r(3132);let o=class{};t.BitAdjustEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"status",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"borderRadius",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorOn",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorOff",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"myKeyPress",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"unit",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage0",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage1",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"borderWidthOn",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"borderWidthOff",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"blink0",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"blink1",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"enableLogData",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),t.BitAdjustEntity=o=a([(0,n.Entity)("BitAdjust")],o)},7239:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitAdjustModule=void 0;const i=r(3563),n=r(5699),o=r(4672),s=r(2449),l=r(9522),c=r(3048);let d=class{};t.ScadaBitAdjustModule=d,t.ScadaBitAdjustModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.BitAdjustEntity]),s.SocketIoModule],controllers:[n.ScadaBitAdjustController],providers:[o.ScadaBitAdjustService]})],d)},4672:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitAdjustService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(3048),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.bitAdjustRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(u.refreshDataBitAdjust){u.refreshDataBitAdjust=!1;try{if(u.resultBitAdjust=await this.bitAdjustRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateBitAdjust",u.resultBitAdjust),u.OldBitAdjust=[],Array.isArray(u.resultBitAdjust))for(let e=0;e<u.resultBitAdjust.length;e++)try{u.resultBitAdjust[e]&&this.checkVariableTypeNumber(u.resultBitAdjust[e].idDevice)&&(this.checkVariableTypeNumber(u.resultBitAdjust[e].tag)?(u.Modbus_Client_Coil[parseInt(u.resultBitAdjust[e].idDevice)]=u.Modbus_Client_Coil[parseInt(u.resultBitAdjust[e].idDevice)]||[],u.Modbus_Client_Coil[parseInt(u.resultBitAdjust[e].idDevice)][parseInt(u.resultBitAdjust[e].tag)]=parseInt(u.resultBitAdjust[e].tag)):u.resultBitAdjust[e].tag.length>0&&(u.Communication_OPC_Items[parseInt(u.resultBitAdjust[e].idDevice)]=u.Communication_OPC_Items[parseInt(u.resultBitAdjust[e].idDevice)]||[],u.Communication_OPC_Items[parseInt(u.resultBitAdjust[e].idDevice)].includes(u.resultBitAdjust[e].tag)||u.Communication_OPC_Items[parseInt(u.resultBitAdjust[e].idDevice)].push(u.resultBitAdjust[e].tag)),u.resultBitAdjust[e].tag.length>0)&&/^\d+\.\d+$/.test(u.resultBitAdjust[e].tag)&&(u.Communication_PLC_Bit_Address_String[parseInt(u.resultBitAdjust[e].idDevice)]=u.Communication_PLC_Bit_Address_String[parseInt(u.resultBitAdjust[e].idDevice)]||[],u.Communication_PLC_Bit_Address_String[parseInt(u.resultBitAdjust[e].idDevice)].push(u.resultBitAdjust[e].tag),u.Communication_PLC_Word_Address[parseInt(u.resultBitAdjust[e].idDevice)]=u.Communication_PLC_Word_Address[parseInt(u.resultBitAdjust[e].idDevice)]||[],u.Communication_PLC_Word_Address[parseInt(u.resultBitAdjust[e].idDevice)][u.resultBitAdjust[e].tag.split(".")[0]]=parseInt(u.resultBitAdjust[e].tag.split(".")[0]))}catch(e){console.log(e)}}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultBitAdjust}async insertBitAdjust(e){try{e._id="a"+Math.random().toString(36),e.status=0;const t=this.bitAdjustRepository.create(e);return await this.bitAdjustRepository.save(t),u.refreshDataBitAdjust=!0,{result:"success",message:"Add BitAdjust Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateBitAdjust(e){try{return await this.bitAdjustRepository.update(e._id,e),u.refreshDataBitAdjust=!0,{result:"success",message:"Update BitAdjust Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteBitAdjust(e){try{return await this.bitAdjustRepository.delete(e),u.refreshDataBitAdjust=!0,{result:"success",message:"Delete BitAdjust Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaBitAdjustService=p,t.ScadaBitAdjustService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.BitAdjustEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},1021:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitDisplayImageLibraryController=void 0;const o=r(3563),s=r(7702);let l=class{constructor(e){this.scadaBitDisplayImageLibraryService=e}getData(){return this.scadaBitDisplayImageLibraryService.getData()}upload(e){return this.scadaBitDisplayImageLibraryService.upload(e)}update(e){return this.scadaBitDisplayImageLibraryService.update(e)}delete(e){return this.scadaBitDisplayImageLibraryService.delete(e)}};t.ScadaBitDisplayImageLibraryController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/upload"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"upload",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaBitDisplayImageLibraryController=l=a([(0,o.Controller)("uploadImage"),i("design:paramtypes",[s.ScadaBitDisplayImageLibraryService])],l)},7822:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.BitDisplayImageLibraryEntity=void 0;const n=r(3132);let o=class{};t.BitDisplayImageLibraryEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"img",void 0),t.BitDisplayImageLibraryEntity=o=a([(0,n.Entity)("BitDisplayImageLibrary")],o)},2181:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitDisplayImageLibraryModule=void 0;const i=r(3563),n=r(2449),o=r(9522),s=r(7822),l=r(1021),c=r(7702);let d=class{};t.ScadaBitDisplayImageLibraryModule=d,t.ScadaBitDisplayImageLibraryModule=d=a([(0,i.Module)({imports:[o.TypeOrmModule.forFeature([s.BitDisplayImageLibraryEntity]),n.SocketIoModule],controllers:[l.ScadaBitDisplayImageLibraryController],providers:[c.ScadaBitDisplayImageLibraryService]})],d)},7702:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitDisplayImageLibraryService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7247),d=r(7822),u=r(6277);let p=class{constructor(e,t){this.bitDisplayImageLibraryRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataBitDisplayImageLibrary){u.refreshDataBitDisplayImageLibrary=!1;try{u.resultBitDisplayImageLibrary=await this.bitDisplayImageLibraryRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateBitDisplayImageLibrary",u.resultBitDisplayImageLibrary)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultBitDisplayImageLibrary}async upload(e){try{if(3!==e.data.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/).length)return{result:"error",data:{},message:"Invalid input string"};let t={_id:"a"+Math.random().toString(36),name:e.name,img:e.data};const r=this.bitDisplayImageLibraryRepository.create(t);return await this.bitDisplayImageLibraryRepository.save(r),u.refreshDataBitDisplayImageLibrary=!0,{result:"success",message:"Add BitDisplay Image Library Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async update(e){try{return await this.bitDisplayImageLibraryRepository.update(e._id,e),u.refreshDataBitDisplayImageLibrary=!0,{result:"success",message:"Update Element Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.bitDisplayImageLibraryRepository.delete(e),u.refreshDataBitDisplayImageLibrary=!0,{result:"success",message:"Delete BitDisplay Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaBitDisplayImageLibraryService=p,t.ScadaBitDisplayImageLibraryService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.BitDisplayImageLibraryEntity)),i("design:paramtypes",[l.Repository,c.SocketGateway])],p)},7888:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitDisplayRefreshService=void 0;const n=r(3563),o=r(7247),s=r(6277);let l=class{constructor(e){this.socketGateway=e}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}refreshData(){let e=!1;try{if(Array.isArray(s.haveChangeArrBitDisplay))for(let t=0;t<s.haveChangeArrBitDisplay.length;t++)if(s.haveChangeArrBitDisplay[t]){if(e=!1,s.haveChangeArrBitDisplay[t]=!1,Array.isArray(s.resultBitDisplay))for(let t=0;t<s.resultBitDisplay.length;t++)if(this.checkVariableTypeNumber(s.resultBitDisplay[t].idDevice)&&s.BitDisplay[parseInt(s.resultBitDisplay[t].idDevice)])if(this.checkVariableTypeNumber(s.resultBitDisplay[t].tag))if(/^\d+\.\d+$/.test(s.resultBitDisplay[t].tag))for(let r of s.BitDisplay[parseInt(s.resultBitDisplay[t].idDevice)])s.resultBitDisplay[t].tag in r&&(s.resultBitDisplay[t].status=r[s.resultBitDisplay[t].tag],e=!0);else s.resultBitDisplay[t].tag<=s.BitDisplay[parseInt(s.resultBitDisplay[t].idDevice)].length&&(s.resultBitDisplay[t].status=s.BitDisplay[parseInt(s.resultBitDisplay[t].idDevice)][s.resultBitDisplay[t].tag],e=!0);else if(s.resultBitDisplay[t].tag.length>0&&s.BitDisplay[parseInt(s.resultBitDisplay[t].idDevice)])for(let r of s.BitDisplay[parseInt(s.resultBitDisplay[t].idDevice)])s.resultBitDisplay[t].tag in r&&(s.resultBitDisplay[t].status=r[s.resultBitDisplay[t].tag],e=!0);if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateBitDisplay",s.resultBitDisplay),e=!1,Array.isArray(s.resultProjectScreen_BitDisplay))for(let t=0;t<s.resultProjectScreen_BitDisplay.length;t++)s.resultProjectScreen_BitDisplay[t].idDevice&&Array.isArray(s.BitDisplay[parseInt(s.resultProjectScreen_BitDisplay[t].idDevice)])&&s.BitDisplay[parseInt(s.resultProjectScreen_BitDisplay[t].idDevice)]&&(s.resultProjectScreen_BitDisplay[t].tag<=s.BitDisplay[parseInt(s.resultProjectScreen_BitDisplay[t].idDevice)].length&&(s.resultProjectScreen_BitDisplay[t].status=s.BitDisplay[parseInt(s.resultProjectScreen_BitDisplay[t].idDevice)][s.resultProjectScreen_BitDisplay[t].tag]),e=!0);if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_BitDisplay",s.resultProjectScreen_BitDisplay),e=!1,Array.isArray(s.resultProjectScreen_Element))for(let t=0;t<s.resultProjectScreen_Element.length;t++)isNaN(s.resultProjectScreen_Element[t].idDevice)||((s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]&&s.resultProjectScreen_Element[t].tagOn||!s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]&&s.resultProjectScreen_Element[t].tagOff)&&(s.resultProjectScreen_Element[t].status=2),s.resultProjectScreen_Element[t].tagOff&&s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)]&&parseInt(s.resultProjectScreen_Element[t].tagOff)<=s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)].length&&(parseInt(s.resultProjectScreen_Element[t].notOff)?s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagOff]||(s.resultProjectScreen_Element[t].status=0,e=!0):s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagOff]&&(s.resultProjectScreen_Element[t].status=0,e=!0)),s.resultProjectScreen_Element[t].tagOn&&s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)]&&parseInt(s.resultProjectScreen_Element[t].tagOn)<=s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)].length&&(parseInt(s.resultProjectScreen_Element[t].notOn)?s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagOn]||(s.resultProjectScreen_Element[t].status=1,e=!0):s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagOn]&&(s.resultProjectScreen_Element[t].status=1,e=!0)),s.resultProjectScreen_Element[t].tagFault&&s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)]&&parseInt(s.resultProjectScreen_Element[t].tagFault)<=s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)].length&&s.BitDisplay[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagFault]&&(s.resultProjectScreen_Element[t].status=3,e=!0));if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_Element",s.resultProjectScreen_Element),e=!1,Array.isArray(s.resultProjectScreen_Element))for(let t=0;t<s.resultProjectScreen_Element.length;t++)isNaN(s.resultProjectScreen_Element[t].idDevice)||((s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]&&!s.resultProjectScreen_Element[t].tagOn||!s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]&&!s.resultProjectScreen_Element[t].tagOff)&&(s.resultProjectScreen_Element[t].status=2,e=!0),s.resultProjectScreen_Element[t].tagOff||s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]||!s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)]||parseInt(s.resultProjectScreen_Element[t].tagBit)<=s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)].length&&(s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagBit]||(s.resultProjectScreen_Element[t].status=0,e=!0)),!s.resultProjectScreen_Element[t].tagOn&&s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][parseInt(s.resultProjectScreen_Element[t].tagBit)]&&s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)]&&parseInt(s.resultProjectScreen_Element[t].tagBit)<=s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)].length&&s.BitAdjust[parseInt(s.resultProjectScreen_Element[t].idDevice)][s.resultProjectScreen_Element[t].tagBit]&&(s.resultProjectScreen_Element[t].status=1,e=!0));if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_Element",s.resultProjectScreen_Element),e=!1,e=!1,Array.isArray(s.resultLine))for(let t=0;t<s.resultLine.length;t++)"BitDisplay"==s.resultLine[t].typeTag&&!isNaN(s.resultLine[t].idDevice)&&s.BitDisplay[parseInt(s.resultLine[t].idDevice)]&&parseInt(s.resultLine[t].tag)<=s.BitDisplay[parseInt(s.resultLine[t].idDevice)].length&&(s.BitDisplay[parseInt(s.resultLine[t].idDevice)][s.resultLine[t].tag]?(s.resultLine[t].status=1,e=!0):(s.resultLine[t].status=0,e=!0));if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateLine",s.resultLine),e=!1,Array.isArray(s.resultProjectScreen_Line))for(let t=0;t<s.resultProjectScreen_Line.length;t++)"BitDisplay"==s.resultProjectScreen_Line[t].typeTag&&!isNaN(s.resultProjectScreen_Line[t].idDevice)&&s.BitDisplay[parseInt(s.resultProjectScreen_Line[t].idDevice)]&&parseInt(s.resultProjectScreen_Line[t].tag)<=s.BitDisplay[parseInt(s.resultProjectScreen_Line[t].idDevice)].length&&(s.BitDisplay[parseInt(s.resultProjectScreen_Line[t].idDevice)][s.resultProjectScreen_Line[t].tag]?(s.resultProjectScreen_Line[t].status=1,e=!0):(s.resultProjectScreen_Line[t].status=0,e=!0));e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_Line",s.resultProjectScreen_Line)}}catch(e){console.log(e)}}};t.ScadaBitDisplayRefreshService=l,t.ScadaBitDisplayRefreshService=l=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway])],l)},4073:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitDisplayController=void 0;const o=r(3563),s=r(7834);let l=class{constructor(e){this.scadaBitDisplayService=e}getData(){return this.scadaBitDisplayService.getData()}insertBitDisplay(e){return this.scadaBitDisplayService.insertBitDisplay(e)}updateBitDisplay(e){return this.scadaBitDisplayService.updateBitDisplay(e)}deleteBitDisplay(e){return this.scadaBitDisplayService.deleteBitDisplay(e)}};t.ScadaBitDisplayController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_bitDisplay"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertBitDisplay",null),a([(0,o.Put)("/update_bitDisplay"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateBitDisplay",null),a([(0,o.Delete)("/delete_bitDisplay"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteBitDisplay",null),t.ScadaBitDisplayController=l=a([(0,o.Controller)("bitDisplay"),i("design:paramtypes",[s.ScadaBitDisplayService])],l)},9314:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.BitDisplayEntity=void 0;const n=r(3132);let o=class{};t.BitDisplayEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"status",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text0",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text1",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"color0",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"color1",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage0",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage1",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"blink0",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"blink1",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tagRotate",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"rotate",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),t.BitDisplayEntity=o=a([(0,n.Entity)("BitDisplay")],o)},7305:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitDisplayModule=void 0;const i=r(3563),n=r(4073),o=r(7834),s=r(2449),l=r(9522),c=r(9314);let d=class{};t.ScadaBitDisplayModule=d,t.ScadaBitDisplayModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.BitDisplayEntity]),s.SocketIoModule],controllers:[n.ScadaBitDisplayController],providers:[o.ScadaBitDisplayService]})],d)},7834:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitDisplayService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(9314),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.bitDisplayRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(u.refreshDataBitDisplay){u.refreshDataBitDisplay=!1;try{if(u.resultBitDisplay=await this.bitDisplayRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateBitDisplay",u.resultBitDisplay),u.OldBitDisplay=[],Array.isArray(u.resultBitDisplay))for(let e=0;e<u.resultBitDisplay.length;e++)try{u.resultBitDisplay[e]&&this.checkVariableTypeNumber(u.resultBitDisplay[e].idDevice)&&(this.checkVariableTypeNumber(u.resultBitDisplay[e].tag)?(u.Modbus_Client_Coil[parseInt(u.resultBitDisplay[e].idDevice)]=u.Modbus_Client_Coil[parseInt(u.resultBitDisplay[e].idDevice)]||[],u.Modbus_Client_Coil[parseInt(u.resultBitDisplay[e].idDevice)][parseInt(u.resultBitDisplay[e].tag)]=parseInt(u.resultBitDisplay[e].tag)):u.resultBitDisplay[e].tag.length>0&&(u.Communication_OPC_Items[parseInt(u.resultBitDisplay[e].idDevice)]=u.Communication_OPC_Items[parseInt(u.resultBitDisplay[e].idDevice)]||[],u.Communication_OPC_Items[parseInt(u.resultBitDisplay[e].idDevice)].includes(u.resultBitDisplay[e].tag)||u.Communication_OPC_Items[parseInt(u.resultBitDisplay[e].idDevice)].push(u.resultBitDisplay[e].tag)),this.checkVariableTypeNumber(u.resultBitDisplay[e].tagRotate)?(u.Communication_PLC_Word_Address[parseInt(u.resultBitDisplay[e].idDevice)]=u.Communication_PLC_Word_Address[parseInt(u.resultBitDisplay[e].idDevice)]||[],u.Communication_PLC_Word_Address[parseInt(u.resultBitDisplay[e].idDevice)][parseInt(u.resultBitDisplay[e].tagRotate)]=parseInt(u.resultBitDisplay[e].tagRotate)):u.resultBitDisplay[e].tagRotate.length>0&&(u.Communication_OPC_Items[parseInt(u.resultBitDisplay[e].idDevice)]=u.Communication_OPC_Items[parseInt(u.resultBitDisplay[e].idDevice)]||[],u.Communication_OPC_Items[parseInt(u.resultBitDisplay[e].idDevice)].includes(u.resultBitDisplay[e].tagRotate)||u.Communication_OPC_Items[parseInt(u.resultBitDisplay[e].idDevice)].push(u.resultBitDisplay[e].tagRotate)),u.resultBitDisplay[e].tag.length>0)&&/^\d+\.\d+$/.test(u.resultBitDisplay[e].tag)&&(u.Communication_PLC_Bit_Address_String[parseInt(u.resultBitDisplay[e].idDevice)]=u.Communication_PLC_Bit_Address_String[parseInt(u.resultBitDisplay[e].idDevice)]||[],u.Communication_PLC_Bit_Address_String[parseInt(u.resultBitDisplay[e].idDevice)].push(u.resultBitDisplay[e].tag))}catch(e){console.log(e)}}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultBitDisplay}async insertBitDisplay(e){try{e._id="a"+Math.random().toString(36),e.status=0;const t=this.bitDisplayRepository.create(e);return await this.bitDisplayRepository.save(t),u.refreshDataBitDisplay=!0,{result:"success",message:"Add BitDisplay Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateBitDisplay(e){try{return await this.bitDisplayRepository.update(e._id,e),u.refreshDataBitDisplay=!0,{result:"success",message:"Update BitDisplay Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteBitDisplay(e){try{return await this.bitDisplayRepository.delete(e),u.refreshDataBitDisplay=!0,{result:"success",message:"Delete BitDisplay Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaBitDisplayService=p,t.ScadaBitDisplayService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.BitDisplayEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},6345:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitImageLibraryController=void 0;const o=r(3563),s=r(6698);let l=class{constructor(e){this.scadaBitImageLibraryService=e}getData(){return this.scadaBitImageLibraryService.getData()}upload(e){return this.scadaBitImageLibraryService.upload(e)}delete(e){return this.scadaBitImageLibraryService.delete(e)}update(e){return this.scadaBitImageLibraryService.update(e)}};t.ScadaBitImageLibraryController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/upload"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"upload",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),t.ScadaBitImageLibraryController=l=a([(0,o.Controller)("uploadImageBit"),i("design:paramtypes",[s.ScadaBitImageLibraryService])],l)},7202:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.BitImageLibraryEntity=void 0;const n=r(3132);let o=class{};t.BitImageLibraryEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"img",void 0),t.BitImageLibraryEntity=o=a([(0,n.Entity)("BitImageLibrary")],o)},2089:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitImageLibraryModule=void 0;const i=r(3563),n=r(2449),o=r(9522),s=r(7202),l=r(6345),c=r(6698);let d=class{};t.ScadaBitImageLibraryModule=d,t.ScadaBitImageLibraryModule=d=a([(0,i.Module)({imports:[o.TypeOrmModule.forFeature([s.BitImageLibraryEntity]),n.SocketIoModule],controllers:[l.ScadaBitImageLibraryController],providers:[c.ScadaBitImageLibraryService]})],d)},6698:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitImageLibraryService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7247),d=r(7202),u=r(6277);let p=class{constructor(e,t){this.bitDisplayImageLibraryRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataBitImageLibrary){u.refreshDataBitImageLibrary=!1;try{u.resultBitImageLibrary=await this.bitDisplayImageLibraryRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateBitImageLibrary",u.resultBitImageLibrary)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultBitImageLibrary}async upload(e){try{if(3!==e.data.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/).length)return{result:"error",data:{},message:"Invalid input string"};let t={_id:"a"+Math.random().toString(36),name:e.name,img:e.data};const r=this.bitDisplayImageLibraryRepository.create(t);return await this.bitDisplayImageLibraryRepository.save(r),u.refreshDataBitImageLibrary=!0,{result:"success",message:"Add Bit Image Library Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.bitDisplayImageLibraryRepository.delete(e),u.refreshDataBitImageLibrary=!0,{result:"success",message:"Delete Bit Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async update(e){try{return await this.bitDisplayImageLibraryRepository.update(e._id,e),u.refreshDataBitImageLibrary=!0,{result:"success",message:"Update Design Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaBitImageLibraryService=p,t.ScadaBitImageLibraryService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.BitImageLibraryEntity)),i("design:paramtypes",[l.Repository,c.SocketGateway])],p)},6712:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitRefreshService=void 0;const n=r(3563),o=r(7247),s=r(824),l=r(9409),c=r(6277);let d=class{constructor(e,t,r){this.socketGateway=e,this.mqttService=t,this.sharedService=r}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}isObject(e){return"object"==typeof e&&null!==e}refreshData(){let e=!1;var t=!1;try{if(Array.isArray(c.haveChangeArrBit)){for(let r=0;r<c.haveChangeArrBit.length;r++)if(c.haveChangeArrBit[r]){if(e=!1,t=!0,c.haveChangeArrBit[r]=!1,Array.isArray(c.resultBit))for(let t=0;t<c.resultBit.length;t++)try{this.checkVariableTypeNumber(c.resultBit[t].idDevice)&&c.Bit[parseInt(c.resultBit[t].idDevice)]&&(c.resultBit[t].tag&&(c.resultBit[t].status=this.sharedService.Scada_Bit_Return(parseInt(c.resultBit[t].idDevice),c.resultBit[t].typeDevice,c.resultBit[t].dataType,c.resultBit[t].tag,c.resultBit[t]._id)),c.resultBit[t].tagEnableView&&(c.resultBit[t].view=this.sharedService.Scada_Bit_Return(parseInt(c.resultBit[t].idDevice),c.resultBit[t].typeDevice,c.resultBit[t].dataType,c.resultBit[t].tagEnableView,c.resultBit[t]._id))),e=!0;try{c.resultBit[t]&&c.resultBit[t].nameTag&&c.resultBit[t].nameTag.length>0&&(c.ListTagBit[parseInt(c.resultBit[t].idDevice)]=c.ListTagBit[parseInt(c.resultBit[t].idDevice)]||{},c.ListTagBit[parseInt(c.resultBit[t].idDevice)][c.resultBit[t].nameTag]=c.resultBit[t].status)}catch(e){console.log(e)}}catch(e){console.log(e)}if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateBit",c.resultBit),e=!1,Array.isArray(c.resultNumber))for(let t=0;t<c.resultNumber.length;t++)try{this.checkVariableTypeNumber(c.resultNumber[t].idDevice)&&c.Bit[parseInt(c.resultNumber[t].idDevice)]&&(this.checkVariableTypeNumber(c.resultNumber[t].tagEnableView)&&(c.resultNumber[t].view=this.sharedService.Scada_Number_Return(parseInt(c.resultNumber[t].idDevice),c.resultNumber[t].typeDevice,c.resultNumber[t].dataType,parseInt(c.resultNumber[t].negative),c.resultNumber[t].tagEnableView,c.resultNumber[t]._id,c.resultNumber[t].round,c.resultNumber[t].swapHighLow)),e=!0)}catch(e){console.log(e)}if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateNumber",c.resultNumber),e=!1,Array.isArray(c.resultElement))for(let t=0;t<c.resultElement.length;t++)if(this.checkVariableTypeNumber(c.resultElement[t].idDevice)&&c.Bit[parseInt(c.resultElement[t].idDevice)]){let r={tagBit:null,tagOn:null,tagOff:null,tagFault:null};try{if("Modbus-Client"==c.resultElement[t].typeDevice&&(this.checkVariableTypeNumber(c.resultElement[t].tagBit)&&c.Bit[parseInt(c.resultElement[t].idDevice)]&&c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagBit)]&&c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagBit)].hasOwnProperty("Coil")&&(r.tagBit=c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagBit)].Coil),this.checkVariableTypeNumber(c.resultElement[t].tagOn)&&c.Bit[parseInt(c.resultElement[t].idDevice)]&&c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagOn)]&&c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagOn)].hasOwnProperty("Coil")&&(r.tagOn=c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagOn)].Coil),this.checkVariableTypeNumber(c.resultElement[t].tagOff)&&c.Bit[parseInt(c.resultElement[t].idDevice)]&&c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagOff)]&&c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagOff)].hasOwnProperty("Coil")&&(r.tagOff=c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagOff)].Coil),this.checkVariableTypeNumber(c.resultElement[t].tagFault)&&c.Bit[parseInt(c.resultElement[t].idDevice)]&&c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagFault)]&&c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagFault)].hasOwnProperty("Coil")&&(r.tagFault=c.Bit[parseInt(c.resultElement[t].idDevice)][parseInt(c.resultElement[t].tagFault)].Coil)),"System"==c.resultElement[t].typeDevice&&c.Bit[parseInt(c.resultElement[t].idDevice)]&&(this.checkVariableTypeNumber(c.resultElement[t].tagBit)&&c.resultElement[t].tagBit.length>0&&(r.tagBit=c.Bit[parseInt(c.resultElement[t].idDevice)][c.resultElement[t].tagBit]),this.checkVariableTypeNumber(c.resultElement[t].tagOn)&&c.resultElement[t].tagOn.length>0&&(r.tagOn=c.Bit[parseInt(c.resultElement[t].idDevice)][c.resultElement[t].tagOn]),this.checkVariableTypeNumber(c.resultElement[t].tagOff)&&c.resultElement[t].tagOff.length>0&&(r.tagOff=c.Bit[parseInt(c.resultElement[t].idDevice)][c.resultElement[t].tagOff]),this.checkVariableTypeNumber(c.resultElement[t].tagFault)&&c.resultElement[t].tagFault.length>0&&(r.tagFault=c.Bit[parseInt(c.resultElement[t].idDevice)][c.resultElement[t].tagFault])),"Fins-Omron"==c.resultElement[t].typeDevice&&c.Bit[parseInt(c.resultElement[t].idDevice)]){if(this.checkVariableTypeNumber(c.resultElement[t].tagBit)&&/^\d+\.\d+$/.test(c.resultElement[t].tagBit)&&c.resultElement[t].tagBit.length>0)for(let e of c.Bit[parseInt(c.resultElement[t].idDevice)])e&&e.hasOwnProperty(c.resultElement[t].tagBit)&&(r.tagBit=e[c.resultElement[t].tagBit]);if(this.checkVariableTypeNumber(c.resultElement[t].tagOn)&&/^\d+\.\d+$/.test(c.resultElement[t].tagOn)&&c.resultElement[t].tagOn.length>0)for(let e of c.Bit[parseInt(c.resultElement[t].idDevice)])e&&e.hasOwnProperty(c.resultElement[t].tagOn)&&(r.tagOn=e[c.resultElement[t].tagOn]);if(this.checkVariableTypeNumber(c.resultElement[t].tagOff)&&/^\d+\.\d+$/.test(c.resultElement[t].tagOff)&&c.resultElement[t].tagOff.length>0)for(let e of c.Bit[parseInt(c.resultElement[t].idDevice)])e&&e.hasOwnProperty(c.resultElement[t].tagOff)&&(r.tagOff=e[c.resultElement[t].tagOff]);if(this.checkVariableTypeNumber(c.resultElement[t].tagFault)&&/^\d+\.\d+$/.test(c.resultElement[t].tagFault)&&c.resultElement[t].tagFault.length>0)for(let e of c.Bit[parseInt(c.resultElement[t].idDevice)])e&&e.hasOwnProperty(c.resultElement[t].tagFault)&&(r.tagFault=e[c.resultElement[t].tagFault])}if("OPC-UA"==c.resultElement[t].typeDevice&&c.Bit[parseInt(c.resultElement[t].idDevice)]){if(this.checkVariableTypeNumber(c.resultElement[t].tagBit)&&c.resultElement[t].tagBit.length>0)for(let e of c.Bit[parseInt(c.resultElement[t].idDevice)])e&&e.hasOwnProperty(c.resultElement[t].tagBit)&&(r.tagBit=e[c.resultElement[t].tagBit]);if(this.checkVariableTypeNumber(c.resultElement[t].tagOn)&&c.resultElement[t].tagOn.length>0)for(let e of c.Bit[parseInt(c.resultElement[t].idDevice)])e&&e.hasOwnProperty(c.resultElement[t].tagOn)&&(r.tagOn=e[c.resultElement[t].tagOn]);if(this.checkVariableTypeNumber(c.resultElement[t].tagOff)&&c.resultElement[t].tagOff.length>0)for(let e of c.Bit[parseInt(c.resultElement[t].idDevice)])e&&e.hasOwnProperty(c.resultElement[t].tagOff)&&(r.tagOff=e[c.resultElement[t].tagOff]);if(this.checkVariableTypeNumber(c.resultElement[t].tagFault)&&c.resultElement[t].tagFault.length>0)for(let e of c.Bit[parseInt(c.resultElement[t].idDevice)])e&&e.hasOwnProperty(c.resultElement[t].tagFault)&&(r.tagFault=e[c.resultElement[t].tagFault])}null!==r.tagBit&&(1!=c.resultElement[t].status&&r.tagBit&&(c.resultElement[t].status=1,e=!0),0==c.resultElement[t].status||r.tagBit||(c.resultElement[t].status=0,e=!0));let a=-1;null===r.tagOn&&null===r.tagOff||(a=2),null!=r.tagOff&&(parseInt(c.resultElement[t].notOff)?r.tagOff||(a=0):r.tagOff&&(a=0)),null!=r.tagOn&&(parseInt(c.resultElement[t].notOn)?r.tagOn||(a=1):r.tagOn&&(a=1)),-1!=a&&(c.resultElement[t].status=a,e=!0),null==r.tagOff&&null==r.tagOn&&(r.tagBit?(c.resultElement[t].status=1,e=!0):(c.resultElement[t].status=0,e=!0)),r.tagFault&&(c.resultElement[t].status=3,e=!0)}catch(e){console.log(e)}}if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateElement",c.resultElement),e=!1,e=!1,e=!1,Array.isArray(c.resultLine))for(let t=0;t<c.resultLine.length;t++)"Bit"==c.resultLine[t].typeTag&&!isNaN(c.resultLine[t].idDevice)&&c.Bit[parseInt(c.resultLine[t].idDevice)]&&(c.Bit[parseInt(c.resultLine[t].idDevice)][c.resultLine[t].tag]?(c.resultLine[t].status=1,e=!0):(c.resultLine[t].status=0,e=!0));if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateLine",c.resultLine),e=!1,Array.isArray(c.resultProjectScreen_Line))for(let t=0;t<c.resultProjectScreen_Line.length;t++)"Bit"==c.resultProjectScreen_Line[t].typeTag&&!isNaN(c.resultProjectScreen_Line[t].idDevice)&&c.Bit[parseInt(c.resultProjectScreen_Line[t].idDevice)]&&(c.Bit[parseInt(c.resultProjectScreen_Line[t].idDevice)][c.resultProjectScreen_Line[t].tag]?(c.resultProjectScreen_Line[t].status=1,e=!0):(c.resultProjectScreen_Line[t].status=0,e=!0));e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_Line",c.resultProjectScreen_Line)}t&&this.mqttService.publish("MQTT_Raw_Bit",JSON.stringify(c.Bit))}}catch(e){console.log(e)}}};t.ScadaBitRefreshService=d,t.ScadaBitRefreshService=d=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway,s.MqttService,l.SharedService])],d)},5537:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitController=void 0;const o=r(3563),s=r(2754);let l=class{constructor(e){this.scadaBitService=e}getData(){return this.scadaBitService.getData()}insertBit(e){return this.scadaBitService.insertBit(e)}updateBit(e){return this.scadaBitService.updateBit(e)}deleteBit(e){return this.scadaBitService.deleteBit(e)}};t.ScadaBitController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_bit"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertBit",null),a([(0,o.Put)("/update_bit"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateBit",null),a([(0,o.Delete)("/delete_bit"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteBit",null),t.ScadaBitController=l=a([(0,o.Controller)("bit"),i("design:paramtypes",[s.ScadaBitService])],l)},10:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.BitEntity=void 0;const n=r(3132);let o=class{};t.BitEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataType",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"editable",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttEditable",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"status",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableTextOnOff",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"textOn",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"textOff",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameTag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tagEnableView",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataTypeTagEnableView",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"borderRadius",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorOn",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorOff",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"myKeyPress",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"unit",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage0",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage1",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"borderWidthOn",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"borderWidthOff",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"blink0",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"blink1",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"enableLogData",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableMqtt",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttTopic",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableFlexScale",void 0),a([(0,n.Column)({nullable:!0,default:"Bit"}),i("design:type",String)],o.prototype,"objectType",void 0),a([(0,n.Column)({nullable:!0,default:!0}),i("design:type",Boolean)],o.prototype,"view",void 0),a([(0,n.Column)({nullable:!0,default:"Toggle"}),i("design:type",String)],o.prototype,"typeAction",void 0),t.BitEntity=o=a([(0,n.Entity)("Bit")],o)},3473:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitModule=void 0;const i=r(3563),n=r(5537),o=r(2754),s=r(2449),l=r(9522),c=r(10),d=r(824),u=r(2664),p=r(7328);let y=class{};t.ScadaBitModule=y,t.ScadaBitModule=y=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.BitEntity]),s.SocketIoModule,p.SharedModule],controllers:[n.ScadaBitController],providers:[o.ScadaBitService,d.MqttService,u.ConfigService]})],y)},2754:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaBitService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(10),d=r(7247),u=r(824),p=r(6277),y=r(9409);let g=class{constructor(e,t,r,a){this.bitRepository=e,this.socketGateway=t,this.mqttService=r,this.sharedService=a}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(p.refreshDataBit){p.refreshDataBit=!1;try{if(p.resultBit=await this.bitRepository.find(),this.mqttService.publish("MQTT_Raw_ResultBit",JSON.stringify(p.resultBit)),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateBit",p.resultBit),p.OldBit=[],Array.isArray(p.resultBit)){p.Temp_ProfiNet_Items_Bit=[];for(let t=0;t<p.resultBit.length;t++)try{p.resultBit[t]&&this.checkVariableTypeNumber(p.resultBit[t].idDevice)&&(this.sharedService.Scada_Bit_Add(parseInt(p.resultBit[t].idDevice),p.resultBit[t].typeDevice,p.resultBit[t].dataType,p.resultBit[t].tag,p.resultBit[t]._id),p.resultBit[t].tagEnableView&&this.sharedService.Scada_Bit_Add(parseInt(p.resultBit[t].idDevice),p.resultBit[t].typeDevice,p.resultBit[t].dataType,p.resultBit[t].tagEnableView,p.resultBit[t]._id))}catch(r){console.log(r)}function e(...e){let t=[];return e.forEach((e=>{e.forEach(((e,r)=>{e&&(t[r]||(t[r]={}),Object.assign(t[r],e))}))})),t}p.Communication_Profinet_Items_Bit=p.Communication_Profinet_Items_Bit.slice(),p.Communication_Profinet_Items=e(p.Communication_Profinet_Items_Bit,p.Communication_Profinet_Items_Number,p.Communication_Profinet_Items_String,p.Communication_Profinet_Items_Bit_Popup,p.Communication_Profinet_Items_Number_Popup,p.Communication_Profinet_Items_String_Popup)}}catch(a){console.log(a)}}}catch(i){console.log(i)}}async getData(){return p.resultBit}async insertBit(e){try{e._id="a"+Math.random().toString(36),e.status=0;const t=this.bitRepository.create(e);return await this.bitRepository.save(t),p.refreshDataBit=!0,{result:"success",message:"Add Bit Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateBit(e){try{return await this.bitRepository.update(e._id,e),p.refreshDataBit=!0,{result:"success",message:"Update Bit Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteBit(e){try{return await this.bitRepository.delete(e),p.refreshDataBit=!0,{result:"success",message:"Delete Bit Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaBitService=g,t.ScadaBitService=g=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.BitEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway,u.MqttService,y.SharedService])],g)},4093:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaCameraStreamController=void 0;const o=r(3563),s=r(3702);let l=class{constructor(e){this.scadaCameraStreamService=e}getData(){return this.scadaCameraStreamService.getData()}insertCameraStream(e){return this.scadaCameraStreamService.insertCameraStream(e)}updateCameraStream(e){return this.scadaCameraStreamService.updateCameraStream(e)}deleteCameraStream(e){return this.scadaCameraStreamService.deleteCameraStream(e)}};t.ScadaCameraStreamController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_cameraStream"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertCameraStream",null),a([(0,o.Put)("/update_cameraStream"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateCameraStream",null),a([(0,o.Delete)("/delete_cameraStream"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteCameraStream",null),t.ScadaCameraStreamController=l=a([(0,o.Controller)("cameraStream"),i("design:paramtypes",[s.ScadaCameraStreamService])],l)},6078:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CameraStreamEntity=void 0;const n=r(3132);let o=class{};t.CameraStreamEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"urlStream",void 0),a([(0,n.Column)({nullable:!0,default:"CameraStream"}),i("design:type",String)],o.prototype,"objectType",void 0),t.CameraStreamEntity=o=a([(0,n.Entity)("CameraStream")],o)},7573:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaCameraStreamModule=void 0;const i=r(3563),n=r(3702),o=r(4093),s=r(2449),l=r(9522),c=r(6078);let d=class{};t.ScadaCameraStreamModule=d,t.ScadaCameraStreamModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.CameraStreamEntity]),s.SocketIoModule],providers:[n.ScadaCameraStreamService],controllers:[o.ScadaCameraStreamController]})],d)},3702:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaCameraStreamService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(6078),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.cameraStreamRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataCameraStream){u.refreshDataCameraStream=!1;try{u.resultCameraStream=await this.cameraStreamRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateCameraStream",u.resultCameraStream)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultCameraStream}async insertCameraStream(e){try{e._id="a"+Math.random().toString(36);const t=this.cameraStreamRepository.create(e);return await this.cameraStreamRepository.save(t),u.refreshDataCameraStream=!0,{result:"success",message:"Add CameraStream Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateCameraStream(e){try{return await this.cameraStreamRepository.update(e._id,e),u.refreshDataCameraStream=!0,{result:"success",message:"Update CameraStream Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteCameraStream(e){try{return await this.cameraStreamRepository.delete(e),u.refreshDataCameraStream=!0,{result:"success",message:"Delete CameraStream Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaCameraStreamService=p,t.ScadaCameraStreamService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.CameraStreamEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},1705:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaChartController=void 0;const o=r(3563),s=r(4362);let l=class{constructor(e){this.scadaChartService=e}getData(){return this.scadaChartService.getData()}insertChart(e){return this.scadaChartService.insertChart(e)}updateChart(e){return this.scadaChartService.updateChart(e)}deleteChart(e){return this.scadaChartService.deleteChart(e)}};t.ScadaChartController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_chart"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertChart",null),a([(0,o.Put)("/update_chart"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateChart",null),a([(0,o.Delete)("/delete_chart"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteChart",null),t.ScadaChartController=l=a([(0,o.Controller)("chart"),i("design:paramtypes",[s.ScadaChartService])],l)},882:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ChartEntity=void 0;const n=r(3132);let o=class{};t.ChartEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"title",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttTopic",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataKeyX",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataKeyY",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"numberLines",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"maxY",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorLine",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorLabelX",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorLabelY",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorTitle",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSizeTitle",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSizeLabelX",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSizeLabelY",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"marginLeft",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"marginTop",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"marginRight",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"marginBottom",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"marginBottomLegend",void 0),a([(0,n.Column)({type:"float",nullable:!0}),i("design:type",Number)],o.prototype,"scale",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type1Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type2Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type3Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type4Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type5Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type6Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type7Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type8Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type9Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type10Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttCurrentValue",void 0),a([(0,n.Column)({nullable:!0,default:"Chart"}),i("design:type",String)],o.prototype,"objectType",void 0),t.ChartEntity=o=a([(0,n.Entity)("Chart")],o)},9369:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaChartModule=void 0;const i=r(3563),n=r(1705),o=r(4362),s=r(2449),l=r(9522),c=r(882);let d=class{};t.ScadaChartModule=d,t.ScadaChartModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.ChartEntity]),s.SocketIoModule],controllers:[n.ScadaChartController],providers:[o.ScadaChartService]})],d)},4362:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaChartService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(882),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.chartRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataChart){u.refreshDataChart=!1;try{u.resultchart=await this.chartRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateChart",u.resultchart)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultchart}async insertChart(e){try{e._id="a"+Math.random().toString(36);const t=this.chartRepository.create(e);return await this.chartRepository.save(t),u.refreshDataChart=!0,{result:"success",message:"Add Chart Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateChart(e){try{return await this.chartRepository.update(e._id,e),u.refreshDataChart=!0,{result:"success",message:"Update Chart Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteChart(e){try{return await this.chartRepository.delete(e),u.refreshDataChart=!0,{result:"success",message:"Delete Chart Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaChartService=p,t.ScadaChartService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.ChartEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},7009:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaConnectionController=void 0;const o=r(3563),s=r(3314);let l=class{constructor(e){this.scadaConnectionService=e}getData(){return this.scadaConnectionService.getData()}insert(e){return this.scadaConnectionService.insert(e)}update(e){return this.scadaConnectionService.update(e)}delete(e){return this.scadaConnectionService.delete(e)}};t.ScadaConnectionController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insert",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaConnectionController=l=a([(0,o.Controller)("connection"),i("design:paramtypes",[s.ScadaConnectionService])],l)},2586:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionEntity=void 0;const n=r(3132);let o=class{};t.ConnectionEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttTopic",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImgOnline",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImgOffline",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"status",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tooltip",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0,default:"Connection"}),i("design:type",String)],o.prototype,"objectType",void 0),t.ConnectionEntity=o=a([(0,n.Entity)("Connection")],o)},3585:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaConnectionModule=void 0;const i=r(3563),n=r(7009),o=r(3314),s=r(2449),l=r(9522),c=r(2586),d=r(824),u=r(2664);let p=class{};t.ScadaConnectionModule=p,t.ScadaConnectionModule=p=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.ConnectionEntity]),s.SocketIoModule],controllers:[n.ScadaConnectionController],providers:[o.ScadaConnectionService,d.MqttService,u.ConfigService]})],p)},3314:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaConnectionService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(2586),d=r(7247),u=r(824),p=r(6277);let y=class{constructor(e,t,r){this.connectionRepository=e,this.socketGateway=t,this.mqttService=r}onModuleInit(){p.refreshDataConnection=!0,this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(p.refreshDataConnection){p.refreshDataConnection=!1;try{p.resultConnection=await this.connectionRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateConnection",p.resultConnection)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return p.resultConnection}async insert(e){try{e._id="a"+Math.random().toString(36);const t=this.connectionRepository.create(e);return await this.connectionRepository.save(t),p.refreshDataConnection=!0,{result:"success",message:"Add Connection Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async update(e){try{return await this.connectionRepository.update(e._id,e),p.refreshDataConnection=!0,{result:"success",message:"Update Connection Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.connectionRepository.delete(e),p.refreshDataConnection=!0,{result:"success",message:"Delete Connection Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaConnectionService=y,t.ScadaConnectionService=y=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.ConnectionEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway,u.MqttService])],y)},3035:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDateTimePickerController=void 0;const o=r(3563),s=r(5224);let l=class{constructor(e){this.scadaDateTimePickerService=e}getData(){return this.scadaDateTimePickerService.getData()}insertDateTimePicker(e){return this.scadaDateTimePickerService.insertDateTimePicker(e)}updateDateTimePicker(e){return this.scadaDateTimePickerService.updateDateTimePicker(e)}deleteDateTimePicker(e){return this.scadaDateTimePickerService.deleteDateTimePicker(e)}};t.ScadaDateTimePickerController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_dateTimePicker"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertDateTimePicker",null),a([(0,o.Put)("/update_dateTimePicker"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateDateTimePicker",null),a([(0,o.Delete)("/delete_dateTimePicker"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteDateTimePicker",null),t.ScadaDateTimePickerController=l=a([(0,o.Controller)("dateTimePicker"),i("design:paramtypes",[s.ScadaDateTimePickerService])],l)},8016:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DateTimePickerEntity=void 0;const n=r(3132);let o=class{};t.DateTimePickerEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqtt",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttCurrentValue",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"size",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zoom",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"config",void 0),a([(0,n.Column)({nullable:!0,default:"DateTimePicker"}),i("design:type",String)],o.prototype,"objectType",void 0),t.DateTimePickerEntity=o=a([(0,n.Entity)("DateTimePicker")],o)},463:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDateTimePickerModule=void 0;const i=r(3563),n=r(5224),o=r(3035),s=r(2449),l=r(9522),c=r(8016);let d=class{};t.ScadaDateTimePickerModule=d,t.ScadaDateTimePickerModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.DateTimePickerEntity]),s.SocketIoModule],providers:[n.ScadaDateTimePickerService],controllers:[o.ScadaDateTimePickerController]})],d)},5224:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDateTimePickerService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(8016),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.dateTimePickerRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataDateTimePicker){u.refreshDataDateTimePicker=!1;try{u.resultDateTimePicker=await this.dateTimePickerRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateDateTimePicker",u.resultDateTimePicker)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultDateTimePicker}async insertDateTimePicker(e){try{e._id="a"+Math.random().toString(36);const t=this.dateTimePickerRepository.create(e);return await this.dateTimePickerRepository.save(t),u.refreshDataDateTimePicker=!0,{result:"success",message:"Add DateTimePicker Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateDateTimePicker(e){try{return await this.dateTimePickerRepository.update(e._id,e),u.refreshDataDateTimePicker=!0,{result:"success",message:"Update DateTimePicker Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteDateTimePicker(e){try{return await this.dateTimePickerRepository.delete(e),u.refreshDataDateTimePicker=!0,{result:"success",message:"Delete DateTimePicker Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaDateTimePickerService=p,t.ScadaDateTimePickerService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.DateTimePickerEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},7713:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDesignImageLibraryController=void 0;const o=r(3563),s=r(7874);let l=class{constructor(e){this.scadaDesignImageLibraryService=e}getData(){return this.scadaDesignImageLibraryService.getData()}upload(e){return this.scadaDesignImageLibraryService.upload(e)}update(e){return this.scadaDesignImageLibraryService.update(e)}delete(e){return this.scadaDesignImageLibraryService.delete(e)}};t.ScadaDesignImageLibraryController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/upload"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"upload",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaDesignImageLibraryController=l=a([(0,o.Controller)("DesignUploadImage"),i("design:paramtypes",[s.ScadaDesignImageLibraryService])],l)},9082:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DesignImageLibraryEntity=void 0;const n=r(3132);let o=class{};t.DesignImageLibraryEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"img",void 0),t.DesignImageLibraryEntity=o=a([(0,n.Entity)("DesignImageLibrary")],o)},9825:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDesignImageLibraryModule=void 0;const i=r(3563),n=r(2449),o=r(9522),s=r(9082),l=r(7713),c=r(7874);let d=class{};t.ScadaDesignImageLibraryModule=d,t.ScadaDesignImageLibraryModule=d=a([(0,i.Module)({imports:[o.TypeOrmModule.forFeature([s.DesignImageLibraryEntity]),n.SocketIoModule],controllers:[l.ScadaDesignImageLibraryController],providers:[c.ScadaDesignImageLibraryService]})],d)},7874:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDesignImageLibraryService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7247),d=r(9082),u=r(6277);let p=class{constructor(e,t){this.designImageLibraryRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataDesignImageLibrary){u.refreshDataDesignImageLibrary=!1;try{u.resultDesignImageLibrary=await this.designImageLibraryRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateDesignImageLibrary",u.resultDesignImageLibrary)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultDesignImageLibrary}async upload(e){try{if(3!==e.data.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/).length)return{result:"error",data:{},message:"Invalid input string"};let t={_id:"a"+Math.random().toString(36),name:e.name,img:e.data};const r=this.designImageLibraryRepository.create(t);return await this.designImageLibraryRepository.save(r),u.refreshDataDesignImageLibrary=!0,{result:"success",message:"Add Design Image Library Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async update(e){try{return await this.designImageLibraryRepository.update(e._id,e),u.refreshDataDesignImageLibrary=!0,{result:"success",message:"Update Design Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.designImageLibraryRepository.delete(e),u.refreshDataDesignImageLibrary=!0,{result:"success",message:"Delete Design Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaDesignImageLibraryService=p,t.ScadaDesignImageLibraryService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.DesignImageLibraryEntity)),i("design:paramtypes",[l.Repository,c.SocketGateway])],p)},2653:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDesignController=void 0;const o=r(3563),s=r(9078);let l=class{constructor(e){this.scadaDesignService=e}getData(){return this.scadaDesignService.getData()}insertDesign(e){return this.scadaDesignService.insertDesign(e)}updateDesign(e){return this.scadaDesignService.updateDesign(e)}deleteDesign(e){return this.scadaDesignService.deleteDesign(e)}};t.ScadaDesignController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_design"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertDesign",null),a([(0,o.Put)("/update_design"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateDesign",null),a([(0,o.Delete)("/delete_design"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteDesign",null),t.ScadaDesignController=l=a([(0,o.Controller)("design"),i("design:paramtypes",[s.ScadaDesignService])],l)},7438:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DesignEntity=void 0;const n=r(3132);let o=class{};t.DesignEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"rotate",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableFlexScale",void 0),a([(0,n.Column)({nullable:!0,default:"Design"}),i("design:type",String)],o.prototype,"objectType",void 0),t.DesignEntity=o=a([(0,n.Entity)("Design")],o)},8933:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDesignModule=void 0;const i=r(3563),n=r(2653),o=r(9078),s=r(2449),l=r(9522),c=r(7438);let d=class{};t.ScadaDesignModule=d,t.ScadaDesignModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.DesignEntity]),s.SocketIoModule],controllers:[n.ScadaDesignController],providers:[o.ScadaDesignService]})],d)},9078:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDesignService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7438),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.designRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataDesign){u.refreshDataDesign=!1;try{u.resultDesign=await this.designRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateDesign",u.resultDesign)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultDesign}async insertDesign(e){try{e._id="a"+Math.random().toString(36);const t=this.designRepository.create(e);return await this.designRepository.save(t),u.refreshDataDesign=!0,{result:"success",message:"Add Design Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateDesign(e){try{return await this.designRepository.update(e._id,e),u.refreshDataDesign=!0,{result:"success",message:"Update Design Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteDesign(e){try{return await this.designRepository.delete(e),u.refreshDataDesign=!0,{result:"success",message:"Delete Design Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaDesignService=p,t.ScadaDesignService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.DesignEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},6227:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDesignTableController=void 0;const o=r(3563),s=r(7376);let l=class{constructor(e){this.scadaDesign_tableService=e}getData(){return this.scadaDesign_tableService.getData()}insertDesign_table(e){return this.scadaDesign_tableService.insertDesign_table(e)}updateDesign_table(e){return this.scadaDesign_tableService.updateDesign_table(e)}deleteDesign_table(e){return this.scadaDesign_tableService.deleteDesign_table(e)}};t.ScadaDesignTableController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertDesign_table",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateDesign_table",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteDesign_table",null),t.ScadaDesignTableController=l=a([(0,o.Controller)("designTable"),i("design:paramtypes",[s.ScadaDesignTableService])],l)},8248:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DesignTableEntity=void 0;const n=r(3132);let o=class{};t.DesignTableEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"rows",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"columns",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"borderWidth",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"columnWidths",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"rowHeights",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0,default:"DesignTable"}),i("design:type",String)],o.prototype,"objectType",void 0),t.DesignTableEntity=o=a([(0,n.Entity)("DesignTable")],o)},855:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDesignTableModule=void 0;const i=r(3563),n=r(6227),o=r(7376),s=r(2449),l=r(9522),c=r(8248);let d=class{};t.ScadaDesignTableModule=d,t.ScadaDesignTableModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.DesignTableEntity]),s.SocketIoModule],controllers:[n.ScadaDesignTableController],providers:[o.ScadaDesignTableService]})],d)},7376:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDesignTableService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(8248),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.design_tableRepository=e,this.socketGateway=t}onModuleInit(){u.refreshDataDesignTable=!0,this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataDesignTable){u.refreshDataDesignTable=!1;try{u.resultDesignTable=await this.design_tableRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateDesignTable",u.resultDesignTable)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultDesignTable}async insertDesign_table(e){try{e._id="a"+Math.random().toString(36);const t=this.design_tableRepository.create(e);return await this.design_tableRepository.save(t),u.refreshDataDesignTable=!0,{result:"success",message:"Add Design_table Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateDesign_table(e){try{return await this.design_tableRepository.update(e._id,e),u.refreshDataDesignTable=!0,{result:"success",message:"Update Design_table Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteDesign_table(e){try{return await this.design_tableRepository.delete(e),u.refreshDataDesignTable=!0,{result:"success",message:"Delete Design_table Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaDesignTableService=p,t.ScadaDesignTableService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.DesignTableEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},3336:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDWordAdjustRefreshService=void 0;const n=r(3563),o=r(7247),s=r(6277);let l=class{constructor(e){this.socketGateway=e}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}refreshData(){let e=!1;if(Array.isArray(s.haveChangeArrDWordAdjust))for(let t=0;t<s.haveChangeArrDWordAdjust.length;t++)if(s.haveChangeArrDWordAdjust[t]){if(e=!1,s.haveChangeArrDWordAdjust[t]=!1,Array.isArray(s.resultDWordAdjust))for(let t=0;t<s.resultDWordAdjust.length;t++)if(this.checkVariableTypeNumber(s.resultDWordAdjust[t].idDevice)&&s.DWordAdjust[parseInt(s.resultDWordAdjust[t].idDevice)])if(this.checkVariableTypeNumber(s.resultDWordAdjust[t].tag))s.resultDWordAdjust[t].tag<=s.DWordAdjust[parseInt(s.resultDWordAdjust[t].idDevice)].length&&(parseInt(s.resultDWordAdjust[t].negative)?parseInt(s.DWordAdjust[parseInt(s.resultDWordAdjust[t].idDevice)][s.resultDWordAdjust[t].tag])>2147483647?s.resultDWordAdjust[t].text=parseInt(s.DWordAdjust[parseInt(s.resultDWordAdjust[t].idDevice)][s.resultDWordAdjust[t].tag])-4294967296:s.resultDWordAdjust[t].text=s.DWordAdjust[parseInt(s.resultDWordAdjust[t].idDevice)][s.resultDWordAdjust[t].tag]:s.DWordAdjust[parseInt(s.resultDWordAdjust[t].idDevice)][s.resultDWordAdjust[t].tag]<0?s.resultDWordAdjust[t].text=s.DWordAdjust[parseInt(s.resultDWordAdjust[t].idDevice)][s.resultDWordAdjust[t].tag]+4294967296:s.resultDWordAdjust[t].text=s.DWordAdjust[parseInt(s.resultDWordAdjust[t].idDevice)][s.resultDWordAdjust[t].tag],e=!0);else if(s.resultDWordAdjust[t].tag.length>0&&s.DWordAdjust[parseInt(s.resultDWordAdjust[t].idDevice)])for(let r of s.DWordAdjust[parseInt(s.resultDWordAdjust[t].idDevice)])s.resultDWordAdjust[t].tag in r&&(s.resultDWordAdjust[t].text=r[s.resultDWordAdjust[t].tag],e=!0);if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateDWordAdjust",s.resultDWordAdjust),e=!1,Array.isArray(s.resultProjectScreen_DWordAdjust))for(let t=0;t<s.resultProjectScreen_DWordAdjust.length;t++)s.resultProjectScreen_DWordAdjust[t].idDevice&&s.DWordAdjust[parseInt(s.resultProjectScreen_DWordAdjust[t].idDevice)]&&s.resultProjectScreen_DWordAdjust[t].tag<=s.DWordAdjust[parseInt(s.resultProjectScreen_DWordAdjust[t].idDevice)].length&&(parseInt(s.resultProjectScreen_DWordAdjust[t].negative)&&parseInt(s.DWordAdjust[parseInt(s.resultProjectScreen_DWordAdjust[t].idDevice)][s.resultProjectScreen_DWordAdjust[t].tag])>2147483647?s.resultProjectScreen_DWordAdjust[t].text=parseInt(s.DWordAdjust[parseInt(s.resultProjectScreen_DWordAdjust[t].idDevice)][s.resultProjectScreen_DWordAdjust[t].tag])-4294967296:s.resultProjectScreen_DWordAdjust[t].text=s.DWordAdjust[parseInt(s.resultProjectScreen_DWordAdjust[t].idDevice)][s.resultProjectScreen_DWordAdjust[t].tag],e=!0);e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_DWordAdjust",s.resultProjectScreen_DWordAdjust)}}};t.ScadaDWordAdjustRefreshService=l,t.ScadaDWordAdjustRefreshService=l=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway])],l)},4529:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDWordAdjustController=void 0;const o=r(3563),s=r(4354);let l=class{constructor(e){this.scadaDWordAdjustService=e}getData(){return this.scadaDWordAdjustService.getData()}insertDWordAdjust(e){return this.scadaDWordAdjustService.insertDWordAdjust(e)}updateDWordAdjust(e){return this.scadaDWordAdjustService.updateDWordAdjust(e)}deleteDWordAdjust(e){return this.scadaDWordAdjustService.deleteDWordAdjust(e)}};t.ScadaDWordAdjustController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_dwordAdjust"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertDWordAdjust",null),a([(0,o.Put)("/update_dwordAdjust"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateDWordAdjust",null),a([(0,o.Delete)("/delete_dwordAdjust"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteDWordAdjust",null),t.ScadaDWordAdjustController=l=a([(0,o.Controller)("dwordAdjust"),i("design:paramtypes",[s.ScadaDWordAdjustService])],l)},602:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DWordAdjustEntity=void 0;const n=r(3132);let o=class{};t.DWordAdjustEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"divide",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"unit",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorBackground",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"negative",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"enableLogData",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"borderRadius",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),t.DWordAdjustEntity=o=a([(0,n.Entity)("DWordAdjust")],o)},6881:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDWordAdjustModule=void 0;const i=r(3563),n=r(4529),o=r(4354),s=r(2449),l=r(9522),c=r(602);let d=class{};t.ScadaDWordAdjustModule=d,t.ScadaDWordAdjustModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.DWordAdjustEntity]),s.SocketIoModule],controllers:[n.ScadaDWordAdjustController],providers:[o.ScadaDWordAdjustService]})],d)},4354:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDWordAdjustService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(602),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.dwordAdjustRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(u.refreshDataDWordAdjust){u.refreshDataDWordAdjust=!1;try{if(u.resultDWordAdjust=await this.dwordAdjustRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateDWordAdjust",u.resultDWordAdjust),u.OldDWordAdjust=[],Array.isArray(u.resultDWordAdjust))for(let e=0;e<u.resultDWordAdjust.length;e++)try{u.resultDWordAdjust[e]&&this.checkVariableTypeNumber(u.resultDWordAdjust[e].idDevice)&&(this.checkVariableTypeNumber(u.resultDWordAdjust[e].tag)?(u.Modbus_Client_HoldingRegister[parseInt(u.resultDWordAdjust[e].idDevice)]=u.Modbus_Client_HoldingRegister[parseInt(u.resultDWordAdjust[e].idDevice)]||[],u.Modbus_Client_HoldingRegister[parseInt(u.resultDWordAdjust[e].idDevice)][parseInt(u.resultDWordAdjust[e].tag)]=parseInt(u.resultDWordAdjust[e].tag),u.Modbus_Client_HoldingRegister[parseInt(u.resultDWordAdjust[e].idDevice)][parseInt(u.resultDWordAdjust[e].tag)+1]=parseInt(u.resultDWordAdjust[e].tag)+1,u.DWordTag[parseInt(u.resultDWordAdjust[e].idDevice)]=u.DWordTag[parseInt(u.resultDWordAdjust[e].idDevice)]||[],u.DWordTag[parseInt(u.resultDWordAdjust[e].idDevice)][parseInt(u.resultDWordAdjust[e].tag)]=parseInt(u.resultDWordAdjust[e].tag)):u.resultDWordAdjust[e].tag.length>0&&(u.Communication_OPC_Items[parseInt(u.resultDWordAdjust[e].idDevice)]=u.Communication_OPC_Items[parseInt(u.resultDWordAdjust[e].idDevice)]||[],u.Communication_OPC_Items[parseInt(u.resultDWordAdjust[e].idDevice)].includes(u.resultDWordAdjust[e].tag)||u.Communication_OPC_Items[parseInt(u.resultDWordAdjust[e].idDevice)].push(u.resultDWordAdjust[e].tag)))}catch(e){console.log(e)}}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultDWordAdjust}async insertDWordAdjust(e){try{e._id="a"+Math.random().toString(36),e.text=0;const t=this.dwordAdjustRepository.create(e);return await this.dwordAdjustRepository.save(t),u.refreshDataDWordAdjust=!0,{result:"success",message:"Add DWordAdjust Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateDWordAdjust(e){try{return await this.dwordAdjustRepository.update(e._id,e),u.refreshDataDWordAdjust=!0,{result:"success",message:"Update DWordAdjust Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteDWordAdjust(e){try{return await this.dwordAdjustRepository.delete(e),u.refreshDataDWordAdjust=!0,{result:"success",message:"Delete DWordAdjust Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaDWordAdjustService=p,t.ScadaDWordAdjustService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.DWordAdjustEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},8792:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDWordDisplayRefreshService=void 0;const n=r(3563),o=r(7247),s=r(6277);let l=class{constructor(e){this.socketGateway=e}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}refreshData(){let e=!1;if(Array.isArray(s.haveChangeArrDWordDisplay))for(let t=0;t<s.haveChangeArrDWordDisplay.length;t++)if(s.haveChangeArrDWordDisplay[t]){if(e=!1,s.haveChangeArrDWordDisplay[t]=!1,Array.isArray(s.resultDWordDisplay))for(let t=0;t<s.resultDWordDisplay.length;t++)if(this.checkVariableTypeNumber(s.resultDWordDisplay[t].idDevice)&&s.DWordDisplay[parseInt(s.resultDWordDisplay[t].idDevice)])if(this.checkVariableTypeNumber(s.resultDWordDisplay[t].tag))s.resultDWordDisplay[t].tag<=s.DWordDisplay[parseInt(s.resultDWordDisplay[t].idDevice)].length&&(parseInt(s.resultDWordDisplay[t].negative)?parseInt(s.DWordDisplay[parseInt(s.resultDWordDisplay[t].idDevice)][s.resultDWordDisplay[t].tag])>2147483647?s.resultDWordDisplay[t].text=parseInt(s.DWordDisplay[parseInt(s.resultDWordDisplay[t].idDevice)][s.resultDWordDisplay[t].tag])-4294967296:s.resultDWordDisplay[t].text=s.DWordDisplay[parseInt(s.resultDWordDisplay[t].idDevice)][s.resultDWordDisplay[t].tag]:s.DWordDisplay[parseInt(s.resultDWordDisplay[t].idDevice)][s.resultDWordDisplay[t].tag]<0?s.resultDWordDisplay[t].text=s.DWordDisplay[parseInt(s.resultDWordDisplay[t].idDevice)][s.resultDWordDisplay[t].tag]+4294967296:s.resultDWordDisplay[t].text=s.DWordDisplay[parseInt(s.resultDWordDisplay[t].idDevice)][s.resultDWordDisplay[t].tag],e=!0);else if(s.resultDWordDisplay[t].tag.length>0&&s.DWordDisplay[parseInt(s.resultDWordDisplay[t].idDevice)])for(let r of s.DWordDisplay[parseInt(s.resultDWordDisplay[t].idDevice)])s.resultDWordDisplay[t].tag in r&&(s.resultDWordDisplay[t].text=r[s.resultDWordDisplay[t].tag],e=!0);if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateDWordDisplay",s.resultDWordDisplay),e=!1,Array.isArray(s.resultProjectScreen_DWordDisplay))for(let t=0;t<s.resultProjectScreen_DWordDisplay.length;t++)s.resultProjectScreen_DWordDisplay[t].idDevice&&s.DWordDisplay[parseInt(s.resultProjectScreen_DWordDisplay[t].idDevice)]&&s.resultProjectScreen_DWordDisplay[t].tag<=s.DWordDisplay[parseInt(s.resultProjectScreen_DWordDisplay[t].idDevice)].length&&(parseInt(s.resultProjectScreen_DWordDisplay[t].negative)&&parseInt(s.DWordDisplay[parseInt(s.resultProjectScreen_DWordDisplay[t].idDevice)][s.resultProjectScreen_DWordDisplay[t].tag])>2147483647?s.resultProjectScreen_DWordDisplay[t].text=parseInt(s.DWordDisplay[parseInt(s.resultProjectScreen_DWordDisplay[t].idDevice)][s.resultProjectScreen_DWordDisplay[t].tag])-4294967296:s.resultProjectScreen_DWordDisplay[t].text=s.DWordDisplay[parseInt(s.resultProjectScreen_DWordDisplay[t].idDevice)][s.resultProjectScreen_DWordDisplay[t].tag],e=!0);e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_DWordDisplay",s.resultProjectScreen_DWordDisplay)}}};t.ScadaDWordDisplayRefreshService=l,t.ScadaDWordDisplayRefreshService=l=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway])],l)},4785:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDWordDisplayController=void 0;const o=r(3563),s=r(3202);let l=class{constructor(e){this.scadaDWordDisplayService=e}getData(){return this.scadaDWordDisplayService.getData()}insertDWordDisplay(e){return this.scadaDWordDisplayService.insertDWordDisplay(e)}updateDWordDisplay(e){return this.scadaDWordDisplayService.updateDWordDisplay(e)}deleteDWordDisplay(e){return this.scadaDWordDisplayService.deleteDWordDisplay(e)}};t.ScadaDWordDisplayController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_dwordDisplay"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertDWordDisplay",null),a([(0,o.Put)("/update_dwordDisplay"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateDWordDisplay",null),a([(0,o.Delete)("/delete_dwordDisplay"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteDWordDisplay",null),t.ScadaDWordDisplayController=l=a([(0,o.Controller)("dwordDisplay"),i("design:paramtypes",[s.ScadaDWordDisplayService])],l)},938:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DWordDisplayEntity=void 0;const n=r(3132);let o=class{};t.DWordDisplayEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"divide",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"unit",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorBackground",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"negative",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"borderRadius",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),t.DWordDisplayEntity=o=a([(0,n.Entity)("DWordDisplay")],o)},1937:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDWordDisplayModule=void 0;const i=r(3563),n=r(4785),o=r(3202),s=r(2449),l=r(9522),c=r(938);let d=class{};t.ScadaDWordDisplayModule=d,t.ScadaDWordDisplayModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.DWordDisplayEntity]),s.SocketIoModule],controllers:[n.ScadaDWordDisplayController],providers:[o.ScadaDWordDisplayService]})],d)},3202:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaDWordDisplayService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(938),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.dwordDisplayRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(u.refreshDataDWordDisplay){u.refreshDataDWordDisplay=!1;try{if(u.resultDWordDisplay=await this.dwordDisplayRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateDWordDisplay",u.resultDWordDisplay),u.OldDWordDisplay=[],Array.isArray(u.resultDWordDisplay))for(let e=0;e<u.resultDWordDisplay.length;e++)try{u.resultDWordDisplay[e]&&(this.checkVariableTypeNumber(u.resultDWordDisplay[e].idDevice)?this.checkVariableTypeNumber(u.resultDWordDisplay[e].tag)&&(u.Modbus_Client_HoldingRegister[parseInt(u.resultDWordDisplay[e].idDevice)]=u.Modbus_Client_HoldingRegister[parseInt(u.resultDWordDisplay[e].idDevice)]||[],u.Modbus_Client_HoldingRegister[parseInt(u.resultDWordDisplay[e].idDevice)][parseInt(u.resultDWordDisplay[e].tag)]=parseInt(u.resultDWordDisplay[e].tag),u.Modbus_Client_HoldingRegister[parseInt(u.resultDWordDisplay[e].idDevice)][parseInt(u.resultDWordDisplay[e].tag)+1]=parseInt(u.resultDWordDisplay[e].tag)+1,u.DWordTag[parseInt(u.resultDWordDisplay[e].idDevice)]=u.DWordTag[parseInt(u.resultDWordDisplay[e].idDevice)]||[],u.DWordTag[parseInt(u.resultDWordDisplay[e].idDevice)][parseInt(u.resultDWordDisplay[e].tag)]=parseInt(u.resultDWordDisplay[e].tag)):u.resultDWordDisplay[e].tag.length>0&&(u.Communication_OPC_Items[parseInt(u.resultDWordDisplay[e].idDevice)]=u.Communication_OPC_Items[parseInt(u.resultDWordDisplay[e].idDevice)]||[],u.Communication_OPC_Items[parseInt(u.resultDWordDisplay[e].idDevice)].includes(u.resultDWordDisplay[e].tag)||u.Communication_OPC_Items[parseInt(u.resultDWordDisplay[e].idDevice)].push(u.resultDWordDisplay[e].tag)))}catch(e){console.log(e)}}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultDWordDisplay}async insertDWordDisplay(e){try{e._id="a"+Math.random().toString(36),e.text=0;const t=this.dwordDisplayRepository.create(e);return await this.dwordDisplayRepository.save(t),u.refreshDataDWordDisplay=!0,{result:"success",message:"Add DWordDisplay Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateDWordDisplay(e){try{return await this.dwordDisplayRepository.update(e._id,e),u.refreshDataDWordDisplay=!0,{result:"success",message:"Update DWordDisplay Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteDWordDisplay(e){try{return await this.dwordDisplayRepository.delete(e),u.refreshDataDWordDisplay=!0,{result:"success",message:"Delete DWordDisplay Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaDWordDisplayService=p,t.ScadaDWordDisplayService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.DWordDisplayEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},7725:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaElementImageLibraryController=void 0;const o=r(3563),s=r(1702);let l=class{constructor(e){this.scadaElementImageLibraryService=e}getData(){return this.scadaElementImageLibraryService.getData()}upload(e){return this.scadaElementImageLibraryService.upload(e)}update(e){return this.scadaElementImageLibraryService.update(e)}delete(e){return this.scadaElementImageLibraryService.delete(e)}};t.ScadaElementImageLibraryController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/upload"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"upload",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaElementImageLibraryController=l=a([(0,o.Controller)("uploadImageElement"),i("design:paramtypes",[s.ScadaElementImageLibraryService])],l)},8110:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ElementImageLibraryEntity=void 0;const n=r(3132);let o=class{};t.ElementImageLibraryEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"img",void 0),t.ElementImageLibraryEntity=o=a([(0,n.Entity)("ElementImageLibrary")],o)},1845:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaElementImageLibraryModule=void 0;const i=r(3563),n=r(2449),o=r(9522),s=r(8110),l=r(7725),c=r(1702);let d=class{};t.ScadaElementImageLibraryModule=d,t.ScadaElementImageLibraryModule=d=a([(0,i.Module)({imports:[o.TypeOrmModule.forFeature([s.ElementImageLibraryEntity]),n.SocketIoModule],controllers:[l.ScadaElementImageLibraryController],providers:[c.ScadaElementImageLibraryService]})],d)},1702:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaElementImageLibraryService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7247),d=r(8110),u=r(6277);let p=class{constructor(e,t){this.elementImageLibraryRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataElementImageLibrary){u.refreshDataElementImageLibrary=!1;try{u.resultElementImageLibrary=await this.elementImageLibraryRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateElementImageLibrary",u.resultElementImageLibrary)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultElementImageLibrary}async upload(e){try{if(3!==e.data.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/).length)return{result:"error",data:{},message:"Invalid input string"};let t={_id:"a"+Math.random().toString(36),name:e.name,img:e.data};const r=this.elementImageLibraryRepository.create(t);return await this.elementImageLibraryRepository.save(r),u.refreshDataElementImageLibrary=!0,{result:"success",message:"Add Element Image Library Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.elementImageLibraryRepository.delete(e),u.refreshDataElementImageLibrary=!0,{result:"success",message:"Delete Element Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async update(e){try{return await this.elementImageLibraryRepository.update(e._id,e),u.refreshDataElementImageLibrary=!0,{result:"success",message:"Update Element Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaElementImageLibraryService=p,t.ScadaElementImageLibraryService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.ElementImageLibraryEntity)),i("design:paramtypes",[l.Repository,c.SocketGateway])],p)},9940:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaElementRefreshService=void 0;const n=r(3563),o=r(7247),s=r(6277);let l=class{constructor(e){this.socketGateway=e}refreshData(){let e=!1;try{if(Array.isArray(s.haveChangeArrElement))for(let t=0;t<s.haveChangeArrElement.length;t++)if(s.haveChangeArrElement[t]){e=!1,s.haveChangeArrElement[t]=!1;for(let t=0;t<s.resultElementWord.length;t++)try{s.resultElementWord[t].idDevice&&s.Element[parseInt(s.resultElementWord[t].idDevice)]&&s.resultElementWord[t].indexElement<=s.Element[parseInt(s.resultElementWord[t].idDevice)].length&&(s.resultElementWord[t].status=s.Element[parseInt(s.resultElementWord[t].idDevice)][s.resultElementWord[t].indexElement],e=!0)}catch(e){console.log(e)}if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateElementWord",s.resultElementWord),e=!1,Array.isArray(s.resultLine))for(let t=0;t<s.resultLine.length;t++)try{"Element"==s.resultLine[t].typeTag&&!isNaN(s.resultLine[t].idDevice)&&s.Element[parseInt(s.resultLine[t].idDevice)]&&parseInt(s.resultLine[t].tag)<=s.Element[parseInt(s.resultLine[t].idDevice)].length&&(0|parseInt(s.Element[parseInt(s.resultLine[t].idDevice)][s.resultLine[t].tag])?(s.resultLine[t].status=1,e=!0):(s.resultLine[t].status=0,e=!0))}catch(e){console.log(e)}e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateLine",s.resultLine)}}catch(e){console.log(e)}}};t.ScadaElementRefreshService=l,t.ScadaElementRefreshService=l=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway])],l)},2421:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaElementController=void 0;const o=r(3563),s=r(7598);let l=class{constructor(e){this.scadaElementService=e}getData(){return this.scadaElementService.getData()}insertElement(e){return this.scadaElementService.insertElement(e)}updateElement(e){return this.scadaElementService.updateElement(e)}deleteElement(e){return this.scadaElementService.deleteElement(e)}};t.ScadaElementController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_Element"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertElement",null),a([(0,o.Put)("/update_Element"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateElement",null),a([(0,o.Delete)("/delete_Element"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteElement",null),t.ScadaElementController=l=a([(0,o.Controller)("Element"),i("design:paramtypes",[s.ScadaElementService])],l)},3350:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ElementEntity=void 0;const n=r(3132);let o=class{};t.ElementEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tagEnableView",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataTypeTagEnableView",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tagBit",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tagOn",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tagOff",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tagFault",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"notOn",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"notOff",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameElement",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"status",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"src_R",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"src_S",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"src_N",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"src_F",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"rotate",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataType",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"enableLogData",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enablePopup",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"childObject",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"childObjectTitle",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"childObjectLeft",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"childObjectTop",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"childObjectWidth",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"childObjectHeight",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"childObjectCssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"childObjectBackgroundColor",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableFlexScale",void 0),a([(0,n.Column)({nullable:!0,default:"Element"}),i("design:type",String)],o.prototype,"objectType",void 0),a([(0,n.Column)({nullable:!0,default:!0}),i("design:type",Boolean)],o.prototype,"view",void 0),t.ElementEntity=o=a([(0,n.Entity)("Element")],o)},2589:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaElementModule=void 0;const i=r(3563),n=r(2421),o=r(7598),s=r(2449),l=r(9522),c=r(3350),d=r(824),u=r(2664);let p=class{};t.ScadaElementModule=p,t.ScadaElementModule=p=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.ElementEntity]),s.SocketIoModule],controllers:[n.ScadaElementController],providers:[o.ScadaElementService,d.MqttService,u.ConfigService]})],p)},7598:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaElementService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(3350),d=r(7247),u=r(824),p=r(6277);let y=class{constructor(e,t,r){this.ElementRepository=e,this.socketGateway=t,this.mqttService=r}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(p.refreshDataElement){p.refreshDataElement=!1;try{p.resultElement=await this.ElementRepository.find(),this.mqttService.publish("MQTT_Raw_ResultElement",JSON.stringify(p.resultElement)),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateElement",p.resultElement);for(let e=0;e<p.resultElement.length;e++)try{p.resultElement[e]&&this.checkVariableTypeNumber(p.resultElement[e].idDevice)&&("Modbus-Client"==p.resultElement[e].typeDevice&&(p.Modbus_Client_Coil[parseInt(p.resultElement[e].idDevice)]=p.Modbus_Client_Coil[parseInt(p.resultElement[e].idDevice)]||[],p.Modbus_Client_DiscreteInput[parseInt(p.resultElement[e].idDevice)]=p.Modbus_Client_DiscreteInput[parseInt(p.resultElement[e].idDevice)]||[],this.checkVariableTypeNumber(p.resultElement[e].tagBit)&&("Coil"==p.resultElement[e].dataType&&(p.Modbus_Client_Coil[parseInt(p.resultElement[e].idDevice)][parseInt(p.resultElement[e].tagBit)]=parseInt(p.resultElement[e].tagBit)),"DiscreteInput"==p.resultElement[e].dataType&&(p.Modbus_Client_DiscreteInput[parseInt(p.resultElement[e].idDevice)][parseInt(p.resultElement[e].tagBit)]=parseInt(p.resultElement[e].tagBit))),this.checkVariableTypeNumber(p.resultElement[e].tagOn)&&("Coil"==p.resultElement[e].dataType&&(p.Modbus_Client_Coil[parseInt(p.resultElement[e].idDevice)][parseInt(p.resultElement[e].tagOn)]=parseInt(p.resultElement[e].tagOn)),"DiscreteInput"==p.resultElement[e].dataType&&(p.Modbus_Client_DiscreteInput[parseInt(p.resultElement[e].idDevice)][parseInt(p.resultElement[e].tagOn)]=parseInt(p.resultElement[e].tagOn))),this.checkVariableTypeNumber(p.resultElement[e].tagOff)&&("Coil"==p.resultElement[e].dataType&&(p.Modbus_Client_Coil[parseInt(p.resultElement[e].idDevice)][parseInt(p.resultElement[e].tagOff)]=parseInt(p.resultElement[e].tagOff)),"DiscreteInput"==p.resultElement[e].dataType&&(p.Modbus_Client_DiscreteInput[parseInt(p.resultElement[e].idDevice)][parseInt(p.resultElement[e].tagOff)]=parseInt(p.resultElement[e].tagOff))),this.checkVariableTypeNumber(p.resultElement[e].tagFault)&&("Coil"==p.resultElement[e].dataType&&(p.Modbus_Client_Coil[parseInt(p.resultElement[e].idDevice)][parseInt(p.resultElement[e].tagFault)]=parseInt(p.resultElement[e].tagFault)),"DiscreteInput"==p.resultElement[e].dataType&&(p.Modbus_Client_DiscreteInput[parseInt(p.resultElement[e].idDevice)][parseInt(p.resultElement[e].tagFault)]=parseInt(p.resultElement[e].tagFault))),this.checkVariableTypeNumber(p.resultElement[e].tagEnableView)&&("Coil"==p.resultElement[e].dataType&&(p.Modbus_Client_Coil[parseInt(p.resultElement[e].idDevice)][parseInt(p.resultElement[e].tagEnableView)]=parseInt(p.resultElement[e].tagEnableView)),"DiscreteInput"==p.resultElement[e].dataType&&(p.Modbus_Client_DiscreteInput[parseInt(p.resultElement[e].idDevice)][parseInt(p.resultElement[e].tagEnableView)]=parseInt(p.resultElement[e].tagEnableView)))),"Fins-Omron"==p.resultElement[e].typeDevice&&(p.Communication_PLC_Bit_Address_String[parseInt(p.resultElement[e].idDevice)]=p.Communication_PLC_Bit_Address_String[parseInt(p.resultElement[e].idDevice)]||[],p.Communication_PLC_Word_Address[parseInt(p.resultElement[e].idDevice)]=p.Communication_PLC_Word_Address[parseInt(p.resultElement[e].idDevice)]||[],this.checkVariableTypeNumber(p.resultElement[e].tagBit)&&/^\d+\.\d+$/.test(p.resultElement[e].tagBit)&&(p.Communication_PLC_Bit_Address_String[parseInt(p.resultElement[e].idDevice)].push(p.resultElement[e].tagBit),p.Communication_PLC_Word_Address[parseInt(p.resultElement[e].idDevice)][p.resultElement[e].tagBit.split(".")[0]]=parseInt(p.resultElement[e].tagBit.split(".")[0])),this.checkVariableTypeNumber(p.resultElement[e].tagOn)&&/^\d+\.\d+$/.test(p.resultElement[e].tagOn)&&(p.Communication_PLC_Bit_Address_String[parseInt(p.resultElement[e].idDevice)].push(p.resultElement[e].tagOn),p.Communication_PLC_Word_Address[parseInt(p.resultElement[e].idDevice)][p.resultElement[e].tagOn.split(".")[0]]=parseInt(p.resultElement[e].tagOn.split(".")[0])),this.checkVariableTypeNumber(p.resultElement[e].tagOff)&&/^\d+\.\d+$/.test(p.resultElement[e].tagOff)&&(p.Communication_PLC_Bit_Address_String[parseInt(p.resultElement[e].idDevice)].push(p.resultElement[e].tagOff),p.Communication_PLC_Word_Address[parseInt(p.resultElement[e].idDevice)][p.resultElement[e].tagOff.split(".")[0]]=parseInt(p.resultElement[e].tagOff.split(".")[0])),this.checkVariableTypeNumber(p.resultElement[e].tagFault)&&/^\d+\.\d+$/.test(p.resultElement[e].tagFault)&&(p.Communication_PLC_Bit_Address_String[parseInt(p.resultElement[e].idDevice)].push(p.resultElement[e].tagFault),p.Communication_PLC_Word_Address[parseInt(p.resultElement[e].idDevice)][p.resultElement[e].tagFault.split(".")[0]]=parseInt(p.resultElement[e].tagFault.split(".")[0])),this.checkVariableTypeNumber(p.resultElement[e].tagEnableView)&&/^\d+\.\d+$/.test(p.resultElement[e].tagEnableView)&&(p.Communication_PLC_Bit_Address_String[parseInt(p.resultElement[e].idDevice)].push(p.resultElement[e].tagEnableView),p.Communication_PLC_Word_Address[parseInt(p.resultElement[e].idDevice)][p.resultElement[e].tagEnableView.split(".")[0]]=parseInt(p.resultElement[e].tagEnableView.split(".")[0]))),"OPC-UA"==p.resultElement[e].typeDevice&&(p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)]=p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)]||[],this.checkVariableTypeNumber(p.resultElement[e].tagBit)&&(p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)].includes(p.resultElement[e].tagBit)||p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)].push(p.resultElement[e].tagBit)),this.checkVariableTypeNumber(p.resultElement[e].tagOn)&&(p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)].includes(p.resultElement[e].tagOn)||p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)].push(p.resultElement[e].tagOn)),this.checkVariableTypeNumber(p.resultElement[e].tagOff)&&(p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)].includes(p.resultElement[e].tagOff)||p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)].push(p.resultElement[e].tagOff)),this.checkVariableTypeNumber(p.resultElement[e].tagFault)&&(p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)].includes(p.resultElement[e].tagFault)||p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)].push(p.resultElement[e].tagFault)),this.checkVariableTypeNumber(p.resultElement[e].tagEnableView)&&(p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)].includes(p.resultElement[e].tagEnableView)||p.Communication_OPC_Items[parseInt(p.resultElement[e].idDevice)].push(p.resultElement[e].tagEnableView))))}catch(e){console.log(e)}if(p.OldBitAdjust=[],p.OldBitDisplay=[],Array.isArray(p.resultElement))for(let e=0;e<p.resultElement.length;e++)try{if(p.resultElement[e]&&p.resultElement[e].childObject&&p.resultElement[e].childObject.length>0){let t=JSON.parse(p.resultElement[e].childObject.toString()),r=t.filter((e=>"Number"===JSON.parse(e).scadaType)).map((e=>JSON.parse(e)));for(let e=0;e<r.length;e++)try{r[e]&&this.checkVariableTypeNumber(r[e].idDevice)&&("Modbus-Client"==r[e].typeDevice&&this.checkVariableTypeNumber(r[e].tag)&&("HoldingRegister-Int16"==r[e].dataType&&(p.Modbus_Client_HoldingRegister[parseInt(r[e].idDevice)]=p.Modbus_Client_HoldingRegister[parseInt(r[e].idDevice)]||[],p.Modbus_Client_HoldingRegister[parseInt(r[e].idDevice)][parseInt(r[e].tag)]=parseInt(r[e].tag)),"HoldingRegister-Int32"==r[e].dataType&&(p.Modbus_Client_HoldingRegister[parseInt(r[e].idDevice)]=p.Modbus_Client_HoldingRegister[parseInt(r[e].idDevice)]||[],p.Modbus_Client_HoldingRegister[parseInt(r[e].idDevice)][parseInt(r[e].tag)]=parseInt(r[e].tag),p.Modbus_Client_HoldingRegister[parseInt(r[e].idDevice)][parseInt(r[e].tag)+1]=parseInt(r[e].tag)+1),"InputRegister-Int16"==r[e].dataType&&(p.Modbus_Client_InputRegister[parseInt(r[e].idDevice)]=p.Modbus_Client_InputRegister[parseInt(r[e].idDevice)]||[],p.Modbus_Client_InputRegister[parseInt(r[e].idDevice)][parseInt(r[e].tag)]=parseInt(r[e].tag)),"InputRegister-Int32"==r[e].dataType&&(p.Modbus_Client_InputRegister[parseInt(r[e].idDevice)]=p.Modbus_Client_InputRegister[parseInt(r[e].idDevice)]||[],p.Modbus_Client_InputRegister[parseInt(r[e].idDevice)][parseInt(r[e].tag)]=parseInt(r[e].tag),p.Modbus_Client_InputRegister[parseInt(r[e].idDevice)][parseInt(r[e].tag)+1]=parseInt(r[e].tag)+1)),"Fins-Omron"==r[e].typeDevice&&this.checkVariableTypeNumber(r[e].tag)&&(p.Communication_PLC_Word_Address[parseInt(r[e].idDevice)]=p.Communication_PLC_Word_Address[parseInt(r[e].idDevice)]||[],p.Communication_PLC_Word_Address[parseInt(r[e].idDevice)][parseInt(r[e].tag)]=parseInt(r[e].tag)),"OPC-UA"!=r[e].typeDevice&&"OPC-DA"!=r[e].typeDevice||r[e].tag.length>0&&(p.Communication_OPC_Items[parseInt(r[e].idDevice)]=p.Communication_OPC_Items[parseInt(r[e].idDevice)]||[],p.Communication_OPC_Items[parseInt(r[e].idDevice)].includes(r[e].tag)||p.Communication_OPC_Items[parseInt(r[e].idDevice)].push(r[e].tag)),"ACE"==r[e].typeDevice&&r[e].tag.length>0&&(p.Communication_ACE_Items[parseInt(r[e].idDevice)]=p.Communication_ACE_Items[parseInt(r[e].idDevice)]||[],p.Communication_ACE_Items[parseInt(r[e].idDevice)].includes(r[e].tag)||p.Communication_ACE_Items[parseInt(r[e].idDevice)].push(r[e].tag)))}catch(e){console.log(e)}let a=t.filter((e=>"Bit"===JSON.parse(e).scadaType)).map((e=>JSON.parse(e)));for(let e=0;e<a.length;e++)try{a[e]&&this.checkVariableTypeNumber(a[e].idDevice)&&("Modbus-Client"==a[e].typeDevice&&(this.checkVariableTypeNumber(a[e].tag)&&("Coil"==a[e].dataType&&(p.Modbus_Client_Coil[parseInt(a[e].idDevice)]=p.Modbus_Client_Coil[parseInt(a[e].idDevice)]||[],p.Modbus_Client_Coil[parseInt(a[e].idDevice)][parseInt(a[e].tag)]=parseInt(a[e].tag)),"DiscreteInput"==a[e].dataType&&(p.Modbus_Client_DiscreteInput[parseInt(a[e].idDevice)]=p.Modbus_Client_DiscreteInput[parseInt(a[e].idDevice)]||[],p.Modbus_Client_DiscreteInput[parseInt(a[e].idDevice)][parseInt(a[e].tag)]=parseInt(a[e].tag))),this.checkVariableTypeNumber(a[e].tagEnableView)&&("Coil"==a[e].dataType&&(p.Modbus_Client_Coil[parseInt(a[e].idDevice)]=p.Modbus_Client_Coil[parseInt(a[e].idDevice)]||[],p.Modbus_Client_Coil[parseInt(a[e].idDevice)][parseInt(a[e].tagEnableView)]=parseInt(a[e].tagEnableView)),"DiscreteInput"==a[e].dataType&&(p.Modbus_Client_DiscreteInput[parseInt(a[e].idDevice)]=p.Modbus_Client_DiscreteInput[parseInt(a[e].idDevice)]||[],p.Modbus_Client_DiscreteInput[parseInt(a[e].idDevice)][parseInt(a[e].tagEnableView)]=parseInt(a[e].tagEnableView)))),"Fins-Omron"==a[e].typeDevice&&(this.checkVariableTypeNumber(a[e].tag)&&/^\d+\.\d+$/.test(a[e].tag)&&(p.Communication_PLC_Bit_Address_String[parseInt(a[e].idDevice)]=p.Communication_PLC_Bit_Address_String[parseInt(a[e].idDevice)]||[],p.Communication_PLC_Bit_Address_String[parseInt(a[e].idDevice)].push(a[e].tag),p.Communication_PLC_Word_Address[parseInt(a[e].idDevice)]=p.Communication_PLC_Word_Address[parseInt(a[e].idDevice)]||[],p.Communication_PLC_Word_Address[parseInt(a[e].idDevice)][a[e].tag.split(".")[0]]=parseInt(a[e].tag.split(".")[0])),this.checkVariableTypeNumber(a[e].tagEnableView)&&/^\d+\.\d+$/.test(a[e].tagEnableView)&&(p.Communication_PLC_Bit_Address_String[parseInt(a[e].idDevice)]=p.Communication_PLC_Bit_Address_String[parseInt(a[e].idDevice)]||[],p.Communication_PLC_Bit_Address_String[parseInt(a[e].idDevice)].push(a[e].tagEnableView),p.Communication_PLC_Word_Address[parseInt(a[e].idDevice)]=p.Communication_PLC_Word_Address[parseInt(a[e].idDevice)]||[],p.Communication_PLC_Word_Address[parseInt(a[e].idDevice)][a[e].tagEnableView.split(".")[0]]=parseInt(a[e].tagEnableView.split(".")[0]))),"OPC-UA"==a[e].typeDevice&&(this.checkVariableTypeNumber(a[e].tag)&&(p.Communication_OPC_Items[parseInt(a[e].idDevice)]=p.Communication_OPC_Items[parseInt(a[e].idDevice)]||[],p.Communication_OPC_Items[parseInt(a[e].idDevice)].includes(a[e].tag)||p.Communication_OPC_Items[parseInt(a[e].idDevice)].push(a[e].tag)),this.checkVariableTypeNumber(a[e].tagEnableView)&&(p.Communication_OPC_Items[parseInt(a[e].idDevice)]=p.Communication_OPC_Items[parseInt(a[e].idDevice)]||[],p.Communication_OPC_Items[parseInt(a[e].idDevice)].includes(a[e].tagEnableView)||p.Communication_OPC_Items[parseInt(a[e].idDevice)].push(a[e].tagEnableView))),"ACE"==a[e].typeDevice&&(this.checkVariableTypeNumber(a[e].tag)&&(p.Communication_ACE_Items[parseInt(a[e].idDevice)]=p.Communication_ACE_Items[parseInt(a[e].idDevice)]||[],p.Communication_ACE_Items[parseInt(a[e].idDevice)].includes(a[e].tag)||p.Communication_ACE_Items[parseInt(a[e].idDevice)].push(a[e].tag)),this.checkVariableTypeNumber(a[e].tagEnableView)&&(p.Communication_ACE_Items[parseInt(a[e].idDevice)]=p.Communication_ACE_Items[parseInt(a[e].idDevice)]||[],p.Communication_ACE_Items[parseInt(a[e].idDevice)].includes(a[e].tagEnableView)||p.Communication_ACE_Items[parseInt(a[e].idDevice)].push(a[e].tagEnableView))))}catch(e){console.log(e)}}}catch(e){console.log(e)}}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return p.resultElement}async insertElement(e){try{e._id="a"+Math.random().toString(36),e.status=0;const t=this.ElementRepository.create(e);return await this.ElementRepository.save(t),p.refreshDataElement=!0,{result:"success",message:"Add Element Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateElement(e){try{return await this.ElementRepository.update(e._id,e),p.refreshDataElement=!0,{result:"success",message:"Update Element Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteElement(e){try{return await this.ElementRepository.delete(e),p.refreshDataElement=!0,{result:"success",message:"Delete Element Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaElementService=y,t.ScadaElementService=y=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.ElementEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway,u.MqttService])],y)},3292:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaGaugeRefreshService=void 0;const n=r(3563),o=r(7247),s=r(9409),l=r(6277);let c=class{constructor(e,t){this.socketGateway=e,this.sharedService=t}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}refreshData(){let e=!1;if(Array.isArray(l.haveChangeArrGauge))for(let t=0;t<l.haveChangeArrGauge.length;t++)if(l.haveChangeArrGauge[t]){if(e=!1,l.haveChangeArrGauge[t]=!1,Array.isArray(l.resultGauge))for(let t=0;t<l.resultGauge.length;t++)try{this.checkVariableTypeNumber(l.resultGauge[t].idDevice)&&"Device"==l.resultGauge[t].mode&&(l.resultGauge[t].value=this.sharedService.Scada_Number_Return(parseInt(l.resultGauge[t].idDevice),l.resultGauge[t].typeDevice,l.resultGauge[t].dataType,parseInt(l.resultGauge[t].negative),l.resultGauge[t].tag,l.resultGauge[t]._id,l.resultGauge[t].round,l.resultGauge[t].swapHighLow),e=!0)}catch(e){console.log(e)}e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateGauge",l.resultGauge)}}};t.ScadaGaugeRefreshService=c,t.ScadaGaugeRefreshService=c=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway,s.SharedService])],c)},6365:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaGaugeController=void 0;const o=r(3563),s=r(182);let l=class{constructor(e){this.scadaGaugeService=e}getData(){return this.scadaGaugeService.getData()}insert(e){return this.scadaGaugeService.insert(e)}update(e){return this.scadaGaugeService.update(e)}delete(e){return this.scadaGaugeService.delete(e)}};t.ScadaGaugeController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insert",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaGaugeController=l=a([(0,o.Controller)("gauge"),i("design:paramtypes",[s.ScadaGaugeService])],l)},5646:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.GaugeEntity=void 0;const n=r(3132);let o=class{};t.GaugeEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"value",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameTag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataType",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"negative",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"divide",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type1Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type2Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type3Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type4Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type5Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type6Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type7Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type8Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type9Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type10Object",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttCurrentValue",void 0),a([(0,n.Column)({nullable:!0,default:"Gauge"}),i("design:type",String)],o.prototype,"objectType",void 0),a([(0,n.Column)({nullable:!0,default:1}),i("design:type",Number)],o.prototype,"round",void 0),a([(0,n.Column)({nullable:!0,default:!1}),i("design:type",Boolean)],o.prototype,"swapHighLow",void 0),t.GaugeEntity=o=a([(0,n.Entity)("Gauge")],o)},5989:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaGaugeModule=void 0;const i=r(3563),n=r(182),o=r(6365),s=r(2449),l=r(9522),c=r(5646),d=r(2664),u=r(824),p=r(7328);let y=class{};t.ScadaGaugeModule=y,t.ScadaGaugeModule=y=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.GaugeEntity]),s.SocketIoModule,p.SharedModule],controllers:[o.ScadaGaugeController],providers:[n.ScadaGaugeService,u.MqttService,d.ConfigService]})],y)},182:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaGaugeService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(5646),d=r(7247),u=r(824),p=r(9409),y=r(6277);let g=class{constructor(e,t,r,a){this.gaugeRepository=e,this.socketGateway=t,this.mqttService=r,this.sharedService=a}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500)),y.refreshDataGauge=!0}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(y.refreshDataGauge){y.refreshDataGauge=!1;try{if(y.resultGauge=await this.gaugeRepository.find(),this.mqttService.publish("MQTT_Raw_ResultGauge",JSON.stringify(y.resultGauge)),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateGauge",y.resultGauge),y.OldGauge=[],Array.isArray(y.resultGauge)){for(let t=0;t<y.resultGauge.length;t++)try{y.resultGauge[t]&&this.checkVariableTypeNumber(y.resultGauge[t].idDevice)&&"Device"==y.resultGauge[t].mode&&this.sharedService.Scada_Number_Add(parseInt(y.resultGauge[t].idDevice),y.resultGauge[t].typeDevice,y.resultGauge[t].dataType,y.resultGauge[t].negative,y.resultGauge[t].tag,y.resultGauge[t]._id)}catch(r){console.log(r)}function e(...e){let t=[];return e.forEach((e=>{e.forEach(((e,r)=>{e&&(t[r]||(t[r]={}),Object.assign(t[r],e))}))})),t}y.Communication_Profinet_Items=e(y.Communication_Profinet_Items_Bit,y.Communication_Profinet_Items_Number,y.Communication_Profinet_Items_String,y.Communication_Profinet_Items_Bit_Popup,y.Communication_Profinet_Items_Number_Popup,y.Communication_Profinet_Items_String_Popup)}}catch(a){console.log(a)}}}catch(i){console.log(i)}}async getData(){return y.resultGauge}async insert(e){try{e._id="a"+Math.random().toString(36);const t=this.gaugeRepository.create(e);return await this.gaugeRepository.save(t),y.refreshDataGauge=!0,{result:"success",message:"Add Gauge Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async update(e){try{return await this.gaugeRepository.update(e._id,e),y.refreshDataGauge=!0,{result:"success",message:"Update Gauge Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.gaugeRepository.delete(e),y.refreshDataGauge=!0,{result:"success",message:"Delete Gauge Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaGaugeService=g,t.ScadaGaugeService=g=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.GaugeEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway,u.MqttService,p.SharedService])],g)},4639:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaGridViewController=void 0;const o=r(3563),s=r(1044);let l=class{constructor(e){this.scadaGridViewService=e}getData(){return this.scadaGridViewService.getData()}insertGridView(e){return this.scadaGridViewService.insertGridView(e)}updateGridView(e){return this.scadaGridViewService.updateGridView(e)}deleteGridView(e){return this.scadaGridViewService.deleteGridView(e)}};t.ScadaGridViewController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_gridView"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertGridView",null),a([(0,o.Put)("/update_gridView"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateGridView",null),a([(0,o.Delete)("/delete_gridView"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteGridView",null),t.ScadaGridViewController=l=a([(0,o.Controller)("gridView"),i("design:paramtypes",[s.ScadaGridViewService])],l)},7788:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.GridViewEntity=void 0;const n=r(3132);let o=class{};t.GridViewEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,default:0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqtt",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttResponse",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableDragDrop",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttDragDropResponse",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttSearch",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttResponseChangeData",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"arrColumnSearch",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"size",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"config",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"configExcel",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"code",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"codeSummaryExcel",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"createClassName",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"createRuleChangeStyle",void 0),a([(0,n.Column)({nullable:!0,default:"GridView"}),i("design:type",String)],o.prototype,"objectType",void 0),t.GridViewEntity=o=a([(0,n.Entity)("GridView")],o)},2459:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaGridViewModule=void 0;const i=r(3563),n=r(1044),o=r(4639),s=r(2449),l=r(9522),c=r(7788);let d=class{};t.ScadaGridViewModule=d,t.ScadaGridViewModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.GridViewEntity]),s.SocketIoModule],providers:[n.ScadaGridViewService],controllers:[o.ScadaGridViewController]})],d)},1044:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaGridViewService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7788),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.gridViewRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataGridView){u.refreshDataGridView=!1;try{u.resultGridView=await this.gridViewRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateGridView",u.resultGridView)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultGridView}async insertGridView(e){try{e._id="a"+Math.random().toString(36);const t=this.gridViewRepository.create(e);return await this.gridViewRepository.save(t),u.refreshDataGridView=!0,{result:"success",message:"Add GridView Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateGridView(e){try{return await this.gridViewRepository.update(e._id,e),u.refreshDataGridView=!0,{result:"success",message:"Update GridView Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteGridView(e){try{return await this.gridViewRepository.delete(e),u.refreshDataGridView=!0,{result:"success",message:"Delete GridView Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaGridViewService=p,t.ScadaGridViewService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.GridViewEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},2119:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaIconImageLibraryController=void 0;const o=r(3563),s=r(3500);let l=class{constructor(e){this.scadaIconImageLibraryService=e}getData(){return this.scadaIconImageLibraryService.getData()}upload(e){return this.scadaIconImageLibraryService.upload(e)}update(e){return this.scadaIconImageLibraryService.update(e)}delete(e){return this.scadaIconImageLibraryService.delete(e)}};t.ScadaIconImageLibraryController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/upload"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"upload",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaIconImageLibraryController=l=a([(0,o.Controller)("uploadImageIcon"),i("design:paramtypes",[s.ScadaIconImageLibraryService])],l)},6324:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.IconImageLibraryEntity=void 0;const n=r(3132);let o=class{};t.IconImageLibraryEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"img",void 0),a([(0,n.Column)({nullable:!0,default:0}),i("design:type",Boolean)],o.prototype,"enable",void 0),a([(0,n.Column)({nullable:!0,default:0}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,default:0}),i("design:type",Number)],o.prototype,"height",void 0),t.IconImageLibraryEntity=o=a([(0,n.Entity)("IconImageLibrary")],o)},979:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaIconImageLibraryModule=void 0;const i=r(3563),n=r(2449),o=r(9522),s=r(6324),l=r(2119),c=r(3500);let d=class{};t.ScadaIconImageLibraryModule=d,t.ScadaIconImageLibraryModule=d=a([(0,i.Module)({imports:[o.TypeOrmModule.forFeature([s.IconImageLibraryEntity]),n.SocketIoModule],controllers:[l.ScadaIconImageLibraryController],providers:[c.ScadaIconImageLibraryService]})],d)},3500:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaIconImageLibraryService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7247),d=r(6324),u=r(6277);let p=class{constructor(e,t){this.bitDisplayImageLibraryRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataIconImageLibrary){u.refreshDataIconImageLibrary=!1;try{u.resultIconImageLibrary=await this.bitDisplayImageLibraryRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateIconImageLibrary",u.resultIconImageLibrary)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultIconImageLibrary}async upload(e){try{if(3!==e.data.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/).length)return{result:"error",data:{},message:"Invalid input string"};let t={_id:"a"+Math.random().toString(36),name:e.name,img:e.data,enable:e.enable,width:e.width,height:e.height};const r=this.bitDisplayImageLibraryRepository.create(t);return await this.bitDisplayImageLibraryRepository.save(r),u.refreshDataIconImageLibrary=!0,{result:"success",message:"Add Icon Image Library Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.bitDisplayImageLibraryRepository.delete(e),u.refreshDataIconImageLibrary=!0,{result:"success",message:"Delete Icon Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async update(e){try{return await this.bitDisplayImageLibraryRepository.update(e._id,e),u.refreshDataIconImageLibrary=!0,{result:"success",message:"Update Icon Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaIconImageLibraryService=p,t.ScadaIconImageLibraryService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.IconImageLibraryEntity)),i("design:paramtypes",[l.Repository,c.SocketGateway])],p)},8157:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaLabelController=void 0;const o=r(3563),s=r(262);let l=class{constructor(e){this.scadaLabelService=e}getData(){return this.scadaLabelService.getData()}insertLabel(e){return this.scadaLabelService.insertLabel(e)}updateLabel(e){return this.scadaLabelService.updateLabel(e)}deleteLabel(e){return this.scadaLabelService.deleteLabel(e)}};t.ScadaLabelController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_label"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertLabel",null),a([(0,o.Put)("/update_label"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateLabel",null),a([(0,o.Delete)("/delete_label"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteLabel",null),t.ScadaLabelController=l=a([(0,o.Controller)("label"),i("design:paramtypes",[s.ScadaLabelService])],l)},7470:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.LabelEntity=void 0;const n=r(3132);let o=class{};t.LabelEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float",default:40}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"listText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"color",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idScreen",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0,default:"1"}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type1Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type2Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type3Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type4Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type5Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type6Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type7Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type8Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type9Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type10Object",void 0),a([(0,n.Column)({nullable:!0,default:"Label"}),i("design:type",String)],o.prototype,"objectType",void 0),t.LabelEntity=o=a([(0,n.Entity)("Label")],o)},1205:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaLabelModule=void 0;const i=r(3563),n=r(8157),o=r(262),s=r(2449),l=r(9522),c=r(7470);let d=class{};t.ScadaLabelModule=d,t.ScadaLabelModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.LabelEntity]),s.SocketIoModule],controllers:[n.ScadaLabelController],providers:[o.ScadaLabelService]})],d)},262:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaLabelService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7470),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.labelRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataLabel){u.refreshDataLabel=!1;try{u.resultlabel=await this.labelRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateLabel",u.resultlabel)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultlabel}async insertLabel(e){try{e._id="a"+Math.random().toString(36);const t=this.labelRepository.create(e);return await this.labelRepository.save(t),u.refreshDataLabel=!0,{result:"success",message:"Add Label Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateLabel(e){try{return await this.labelRepository.update(e._id,e),u.refreshDataLabel=!0,{result:"success",message:"Update Label Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteLabel(e){try{return await this.labelRepository.delete(e),u.refreshDataLabel=!0,{result:"success",message:"Delete Label Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaLabelService=p,t.ScadaLabelService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.LabelEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},9485:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaLineController=void 0;const o=r(3563),s=r(1974);let l=class{constructor(e){this.scadaLineService=e}getData(){return this.scadaLineService.getData()}insertLine(e){return this.scadaLineService.insertLine(e)}updateLine(e){return this.scadaLineService.updateLine(e)}deleteLine(e){return this.scadaLineService.deleteLine(e)}};t.ScadaLineController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_line"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertLine",null),a([(0,o.Put)("/update_line"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateLine",null),a([(0,o.Delete)("/delete_line"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteLine",null),t.ScadaLineController=l=a([(0,o.Controller)("line"),i("design:paramtypes",[s.ScadaLineService])],l)},1374:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.LineEntity=void 0;const n=r(3132);let o=class{};t.LineEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"length",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorOff",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorOn",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"orientation",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"rotate",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeTag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"status",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode_On",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode_Off",void 0),a([(0,n.Column)({nullable:!0,default:"Line"}),i("design:type",String)],o.prototype,"objectType",void 0),t.LineEntity=o=a([(0,n.Entity)("Line")],o)},1717:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaLineModule=void 0;const i=r(3563),n=r(9485),o=r(1974),s=r(2449),l=r(9522),c=r(1374);let d=class{};t.ScadaLineModule=d,t.ScadaLineModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.LineEntity]),s.SocketIoModule],controllers:[n.ScadaLineController],providers:[o.ScadaLineService]})],d)},1974:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaLineService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(1374),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.lineRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataLine){u.refreshDataLine=!1;try{u.resultLine=await this.lineRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateLine",u.resultLine),u.OldBitAdjust=[],u.OldBitDisplay=[],u.OldElement=[]}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultLine}async insertLine(e){try{e._id="a"+Math.random().toString(36),e.status=0;const t=this.lineRepository.create(e);return await this.lineRepository.save(t),u.refreshDataLine=!0,{result:"success",message:"Add Line Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateLine(e){try{return await this.lineRepository.update(e._id,e),u.refreshDataLine=!0,{result:"success",message:"Update Line Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteLine(e){try{return await this.lineRepository.delete(e),u.refreshDataLine=!0,{result:"success",message:"Delete Line Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaLineService=p,t.ScadaLineService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.LineEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},2761:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaMapImageLibraryController=void 0;const o=r(3563),s=r(5546);let l=class{constructor(e){this.scadaMapImageLibraryService=e}getData(){return this.scadaMapImageLibraryService.getData()}upload(e){return this.scadaMapImageLibraryService.upload(e)}delete(e){return this.scadaMapImageLibraryService.delete(e)}};t.ScadaMapImageLibraryController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/upload"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"upload",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaMapImageLibraryController=l=a([(0,o.Controller)("uploadMap"),i("design:paramtypes",[s.ScadaMapImageLibraryService])],l)},274:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.MapImageLibraryEntity=void 0;const n=r(3132);let o=class{};t.MapImageLibraryEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"img",void 0),t.MapImageLibraryEntity=o=a([(0,n.Entity)("MapImageLibrary")],o)},1129:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaMapImageLibraryModule=void 0;const i=r(3563),n=r(2449),o=r(9522),s=r(274),l=r(2761),c=r(5546);let d=class{};t.ScadaMapImageLibraryModule=d,t.ScadaMapImageLibraryModule=d=a([(0,i.Module)({imports:[o.TypeOrmModule.forFeature([s.MapImageLibraryEntity]),n.SocketIoModule],controllers:[l.ScadaMapImageLibraryController],providers:[c.ScadaMapImageLibraryService]})],d)},5546:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaMapImageLibraryService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7247),d=r(274),u=r(6277);let p=class{constructor(e,t){this.bitDisplayImageLibraryRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataMapImageLibrary){u.refreshDataMapImageLibrary=!1;try{u.resultMapImageLibrary=await this.bitDisplayImageLibraryRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateMapImageLibrary",u.resultMapImageLibrary)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultMapImageLibrary}async upload(e){try{if(3!==e.data.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/).length)return{result:"error",data:{},message:"Invalid input string"};let t={_id:"a"+Math.random().toString(36),name:e.name,img:e.data};const r=this.bitDisplayImageLibraryRepository.create(t);return await this.bitDisplayImageLibraryRepository.save(r),u.refreshDataMapImageLibrary=!0,{result:"success",message:"Add Map Image Library Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.bitDisplayImageLibraryRepository.delete(e),u.refreshDataMapImageLibrary=!0,{result:"success",message:"Delete Map Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaMapImageLibraryService=p,t.ScadaMapImageLibraryService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.MapImageLibraryEntity)),i("design:paramtypes",[l.Repository,c.SocketGateway])],p)},13:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaMapController=void 0;const o=r(3563),s=r(9110),l=r(456);let c=class{constructor(e){this.scadaMapService=e}getData(){return this.scadaMapService.getData()}getPosition(){return l.PositionMobileRobot}insertMap(e){return this.scadaMapService.insertMap(e)}updateMap(e){return this.scadaMapService.updateMap(e)}deleteMap(e){return this.scadaMapService.deleteMap(e)}};t.ScadaMapController=c,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],c.prototype,"getData",null),a([(0,o.Get)("/getposition"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],c.prototype,"getPosition",null),a([(0,o.Post)("/insert_map"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],c.prototype,"insertMap",null),a([(0,o.Put)("/update_map"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],c.prototype,"updateMap",null),a([(0,o.Delete)("/delete_map"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],c.prototype,"deleteMap",null),t.ScadaMapController=c=a([(0,o.Controller)("map"),i("design:paramtypes",[s.ScadaMapService])],c)},9310:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.MapEntity=void 0;const n=r(3132);let o=class{};t.MapEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"selectPoint",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"image1X",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"image1Y",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"image2X",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"image2Y",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"map1X",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"map1Y",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"map2X",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"map2Y",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"indexMobileRobot",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0,default:"Map"}),i("design:type",String)],o.prototype,"objectType",void 0),t.MapEntity=o=a([(0,n.Entity)("Map")],o)},677:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaMapModule=void 0;const i=r(3563),n=r(13),o=r(9110),s=r(2449),l=r(9522),c=r(9310);let d=class{};t.ScadaMapModule=d,t.ScadaMapModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.MapEntity]),s.SocketIoModule],controllers:[n.ScadaMapController],providers:[o.ScadaMapService]})],d)},9110:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaMapService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(9310),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.mapRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataMap){u.refreshDataMap=!1;try{u.resultMap=await this.mapRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateMap",u.resultMap)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultMap}async insertMap(e){try{e._id="a"+Math.random().toString(36);const t=this.mapRepository.create(e);return await this.mapRepository.save(t),u.refreshDataMap=!0,{result:"success",message:"Add Map Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateMap(e){try{return await this.mapRepository.update(e._id,e),u.refreshDataMap=!0,{result:"success",message:"Update Map Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteMap(e){try{return await this.mapRepository.delete(e),u.refreshDataMap=!0,{result:"success",message:"Delete Map Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaMapService=p,t.ScadaMapService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.MapEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},9893:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaMemonicController=void 0;const o=r(3563),s=r(1918);let l=class{constructor(e){this.scadaMemonicService=e}getData(){return this.scadaMemonicService.getData()}insertMemonic(e){return this.scadaMemonicService.insertMemonic(e)}updateMemonic(e){return this.scadaMemonicService.updateMemonic(e)}deleteMemonic(e){return this.scadaMemonicService.deleteMemonic(e)}};t.ScadaMemonicController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertMemonic",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateMemonic",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteMemonic",null),t.ScadaMemonicController=l=a([(0,o.Controller)("memonic"),i("design:paramtypes",[s.ScadaMemonicService])],l)},8982:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.MemonicEntity=void 0;const n=r(3132);let o=class{};t.MemonicEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"indexPLC",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeMemonic",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameVariable",void 0),t.MemonicEntity=o=a([(0,n.Entity)("Memonic")],o)},6173:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaMemonicModule=void 0;const i=r(3563),n=r(9893),o=r(1918),s=r(2449),l=r(9522),c=r(8982);let d=class{};t.ScadaMemonicModule=d,t.ScadaMemonicModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.MemonicEntity]),s.SocketIoModule],controllers:[n.ScadaMemonicController],providers:[o.ScadaMemonicService]})],d)},1918:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaMemonicService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(8982),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.memonicRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataMemonic){u.refreshDataMemonic=!1;try{u.resultmemonic=await this.memonicRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateMemonic",u.resultmemonic)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultmemonic}async insertMemonic(e){try{e._id="a"+Math.random().toString(36);const t=this.memonicRepository.create(e);return await this.memonicRepository.save(t),u.refreshDataMemonic=!0,{result:"success",message:"Add Memonic Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateMemonic(e){try{return await this.memonicRepository.update(e._id,e),u.refreshDataMemonic=!0,{result:"success",message:"Update Memonic Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteMemonic(e){try{return await this.memonicRepository.delete(e),u.refreshDataMemonic=!0,{result:"success",message:"Delete Memonic Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaMemonicService=p,t.ScadaMemonicService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.MemonicEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},6743:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNavigateImageLibraryController=void 0;const o=r(3563),s=r(9836);let l=class{constructor(e){this.scadaNavigateImageLibraryService=e}getData(){return this.scadaNavigateImageLibraryService.getData()}upload(e){return this.scadaNavigateImageLibraryService.upload(e)}delete(e){return this.scadaNavigateImageLibraryService.delete(e)}update(e){return this.scadaNavigateImageLibraryService.update(e)}};t.ScadaNavigateImageLibraryController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/upload"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"upload",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),t.ScadaNavigateImageLibraryController=l=a([(0,o.Controller)("uploadImageNavigate"),i("design:paramtypes",[s.ScadaNavigateImageLibraryService])],l)},436:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.NavigateImageLibraryEntity=void 0;const n=r(3132);let o=class{};t.NavigateImageLibraryEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"img",void 0),t.NavigateImageLibraryEntity=o=a([(0,n.Entity)("NavigateImageLibrary")],o)},4771:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNavigateImageLibraryModule=void 0;const i=r(3563),n=r(2449),o=r(9522),s=r(436),l=r(6743),c=r(9836);let d=class{};t.ScadaNavigateImageLibraryModule=d,t.ScadaNavigateImageLibraryModule=d=a([(0,i.Module)({imports:[o.TypeOrmModule.forFeature([s.NavigateImageLibraryEntity]),n.SocketIoModule],controllers:[l.ScadaNavigateImageLibraryController],providers:[c.ScadaNavigateImageLibraryService]})],d)},9836:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNavigateImageLibraryService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7247),d=r(436),u=r(6277);let p=class{constructor(e,t){this.navigateDisplayImageLibraryRepository=e,this.socketGateway=t}onModuleInit(){u.refreshDataNavigateImageLibrary=!0,this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataNavigateImageLibrary){u.refreshDataNavigateImageLibrary=!1;try{u.resultNavigateImageLibrary=await this.navigateDisplayImageLibraryRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateNavigateImageLibrary",u.resultNavigateImageLibrary)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultNavigateImageLibrary}async upload(e){try{if(3!==e.data.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/).length)return{result:"error",data:{},message:"Invalid input string"};let t={_id:"a"+Math.random().toString(36),name:e.name,img:e.data};const r=this.navigateDisplayImageLibraryRepository.create(t);return await this.navigateDisplayImageLibraryRepository.save(r),u.refreshDataNavigateImageLibrary=!0,{result:"success",message:"Add Navigate Image Library Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.navigateDisplayImageLibraryRepository.delete(e),u.refreshDataNavigateImageLibrary=!0,{result:"success",message:"Delete Navigate Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async update(e){try{return await this.navigateDisplayImageLibraryRepository.update(e._id,e),u.refreshDataNavigateImageLibrary=!0,{result:"success",message:"Update Design Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaNavigateImageLibraryService=p,t.ScadaNavigateImageLibraryService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.NavigateImageLibraryEntity)),i("design:paramtypes",[l.Repository,c.SocketGateway])],p)},5787:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNavigateController=void 0;const o=r(3563),s=r(5368);let l=class{constructor(e){this.scadaNavigateService=e}getData(){return this.scadaNavigateService.getData()}insertNavigate(e){return this.scadaNavigateService.insertNavigate(e)}updateNavigate(e){return this.scadaNavigateService.updateNavigate(e)}deleteNavigate(e){return this.scadaNavigateService.deleteNavigate(e)}};t.ScadaNavigateController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_navigate"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertNavigate",null),a([(0,o.Put)("/update_navigate"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateNavigate",null),a([(0,o.Delete)("/delete_navigate"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteNavigate",null),t.ScadaNavigateController=l=a([(0,o.Controller)("navigate"),i("design:paramtypes",[s.ScadaNavigateService])],l)},9920:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.NavigateEntity=void 0;const n=r(3132);let o=class{};t.NavigateEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"status",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"url",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"borderRadius",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorOn",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorOff",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage0",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage1",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"borderWidthOn",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"borderWidthOff",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"blink0",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"blink1",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableFlexScale",void 0),a([(0,n.Column)({nullable:!0,default:"Navigate"}),i("design:type",String)],o.prototype,"objectType",void 0),t.NavigateEntity=o=a([(0,n.Entity)("Navigate")],o)},7695:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNavigateModule=void 0;const i=r(3563),n=r(5787),o=r(5368),s=r(2449),l=r(9522),c=r(9920),d=r(824),u=r(2664);let p=class{};t.ScadaNavigateModule=p,t.ScadaNavigateModule=p=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.NavigateEntity]),s.SocketIoModule],controllers:[n.ScadaNavigateController],providers:[o.ScadaNavigateService,d.MqttService,u.ConfigService]})],p)},5368:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNavigateService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(9920),d=r(7247),u=r(824),p=r(6277);let y=class{constructor(e,t,r){this.navigateRepository=e,this.socketGateway=t,this.mqttService=r}onModuleInit(){p.refreshDataNavigate=!0,this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(p.refreshDataNavigate){p.refreshDataNavigate=!1;try{p.resultNavigate=await this.navigateRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateNavigate",p.resultNavigate)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return p.resultNavigate}async insertNavigate(e){try{e._id="a"+Math.random().toString(36),e.status=0;const t=this.navigateRepository.create(e);return await this.navigateRepository.save(t),p.refreshDataNavigate=!0,{result:"success",message:"Add Navigate Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateNavigate(e){try{return await this.navigateRepository.update(e._id,e),p.refreshDataNavigate=!0,{result:"success",message:"Update Navigate Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async deleteNavigate(e){try{return await this.navigateRepository.delete(e),p.refreshDataNavigate=!0,{result:"success",message:"Delete Navigate Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaNavigateService=y,t.ScadaNavigateService=y=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.NavigateEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway,u.MqttService])],y)},4551:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNumberImageLibraryController=void 0;const o=r(3563),s=r(1996);let l=class{constructor(e){this.scadaNumberImageLibraryService=e}getData(){return this.scadaNumberImageLibraryService.getData()}upload(e){return this.scadaNumberImageLibraryService.upload(e)}delete(e){return this.scadaNumberImageLibraryService.delete(e)}update(e){return this.scadaNumberImageLibraryService.update(e)}};t.ScadaNumberImageLibraryController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/upload"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"upload",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),t.ScadaNumberImageLibraryController=l=a([(0,o.Controller)("uploadImageNumber"),i("design:paramtypes",[s.ScadaNumberImageLibraryService])],l)},5140:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.NumberImageLibraryEntity=void 0;const n=r(3132);let o=class{};t.NumberImageLibraryEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"img",void 0),t.NumberImageLibraryEntity=o=a([(0,n.Entity)("NumberImageLibrary")],o)},4115:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNumberImageLibraryModule=void 0;const i=r(3563),n=r(2449),o=r(9522),s=r(5140),l=r(4551),c=r(1996);let d=class{};t.ScadaNumberImageLibraryModule=d,t.ScadaNumberImageLibraryModule=d=a([(0,i.Module)({imports:[o.TypeOrmModule.forFeature([s.NumberImageLibraryEntity]),n.SocketIoModule],controllers:[l.ScadaNumberImageLibraryController],providers:[c.ScadaNumberImageLibraryService]})],d)},1996:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNumberImageLibraryService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7247),d=r(5140),u=r(6277);let p=class{constructor(e,t){this.numberDisplayImageLibraryRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval(),u.refreshDataNumberImageLibrary=!0}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataNumberImageLibrary){u.refreshDataNumberImageLibrary=!1;try{u.resultNumberImageLibrary=await this.numberDisplayImageLibraryRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateNumberImageLibrary",u.resultNumberImageLibrary)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultNumberImageLibrary}async upload(e){try{if(3!==e.data.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/).length)return{result:"error",data:{},message:"Invalid input string"};let t={_id:"a"+Math.random().toString(36),name:e.name,img:e.data};const r=this.numberDisplayImageLibraryRepository.create(t);return await this.numberDisplayImageLibraryRepository.save(r),u.refreshDataNumberImageLibrary=!0,{result:"success",message:"Add Number Image Library Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.numberDisplayImageLibraryRepository.delete(e),u.refreshDataNumberImageLibrary=!0,{result:"success",message:"Delete Number Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async update(e){try{return await this.numberDisplayImageLibraryRepository.update(e._id,e),u.refreshDataNumberImageLibrary=!0,{result:"success",message:"Update Design Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaNumberImageLibraryService=p,t.ScadaNumberImageLibraryService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.NumberImageLibraryEntity)),i("design:paramtypes",[l.Repository,c.SocketGateway])],p)},3726:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNumberRefreshService=void 0;const n=r(3563),o=r(7247),s=r(824),l=r(9409),c=r(6277);let d=class{constructor(e,t,r){this.socketGateway=e,this.mqttService=t,this.sharedService=r}refreshData(){let e=!1;var t=!1;if(Array.isArray(c.haveChangeArrNumber)){for(let r=0;r<c.haveChangeArrNumber.length;r++)if(c.haveChangeArrNumber[r]){if(t=!0,e=!1,c.haveChangeArrNumber[r]=!1,Array.isArray(c.resultNumber))for(let t=0;t<c.resultNumber.length;t++)try{c.resultNumber[t].text=this.sharedService.Scada_Number_Return(parseInt(c.resultNumber[t].idDevice),c.resultNumber[t].typeDevice,c.resultNumber[t].dataType,parseInt(c.resultNumber[t].negative),c.resultNumber[t].tag,c.resultNumber[t]._id,c.resultNumber[t].round,c.resultNumber[t].swapHighLow),e=!0;try{c.resultNumber[t]&&c.resultNumber[t].nameTag&&c.resultNumber[t].nameTag.length>0&&(c.ListTagNumber[parseInt(c.resultNumber[t].idDevice)]=c.ListTagNumber[parseInt(c.resultNumber[t].idDevice)]||{},c.ListTagNumber[parseInt(c.resultNumber[t].idDevice)][c.resultNumber[t].nameTag]=c.resultNumber[t].text)}catch(e){console.log(e)}}catch(e){console.log(e)}e&&this.socketGateway&&this.socketGateway.server&&(this.socketGateway.server.emit("UpdateNumber",c.resultNumber),this.socketGateway.server.emit("UpdateRawNumber",c.Number))}t&&this.mqttService.publish("MQTT_Raw_Number",JSON.stringify(c.Number))}}};t.ScadaNumberRefreshService=d,t.ScadaNumberRefreshService=d=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway,s.MqttService,l.SharedService])],d)},1523:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNumberController=void 0;const o=r(3563),s=r(4464);let l=class{constructor(e){this.scadaNumberService=e}getData(){return this.scadaNumberService.getData()}getDataRaw(){return this.scadaNumberService.getDataRaw()}insertNumber(e){return this.scadaNumberService.insertNumber(e)}updateNumber(e){return this.scadaNumberService.updateNumber(e)}deleteNumber(e){return this.scadaNumberService.deleteNumber(e)}};t.ScadaNumberController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Get)("/getdataraw"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getDataRaw",null),a([(0,o.Post)("/insert_number"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertNumber",null),a([(0,o.Put)("/update_number"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateNumber",null),a([(0,o.Delete)("/delete_number"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteNumber",null),t.ScadaNumberController=l=a([(0,o.Controller)("number"),i("design:paramtypes",[s.ScadaNumberService])],l)},808:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.NumberEntity=void 0;const n=r(3132);let o=class{};t.NumberEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tagEnableView",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataTypeTagEnableView",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameTag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataType",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"editable",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttEditable",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableMqtt",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttInputEvent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"noBorder",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"unit",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"divide",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorBackground",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"negative",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idScreen",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"borderRadius",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"split3",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"decimalPoint",void 0),a([(0,n.Column)({nullable:!0,default:"Number"}),i("design:type",String)],o.prototype,"objectType",void 0),a([(0,n.Column)({nullable:!0,default:!0}),i("design:type",Boolean)],o.prototype,"view",void 0),a([(0,n.Column)({nullable:!0,default:1}),i("design:type",Number)],o.prototype,"round",void 0),a([(0,n.Column)({nullable:!0,default:!1}),i("design:type",Boolean)],o.prototype,"swapHighLow",void 0),t.NumberEntity=o=a([(0,n.Entity)("Number")],o)},3415:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNumberModule=void 0;const i=r(3563),n=r(1523),o=r(4464),s=r(2449),l=r(9522),c=r(808),d=r(824),u=r(2664),p=r(7328);let y=class{};t.ScadaNumberModule=y,t.ScadaNumberModule=y=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.NumberEntity]),s.SocketIoModule,p.SharedModule],controllers:[n.ScadaNumberController],providers:[o.ScadaNumberService,d.MqttService,u.ConfigService]})],y)},4464:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaNumberService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(808),d=r(7247),u=r(824),p=r(9409),y=r(6277);let g=class{constructor(e,t,r,a){this.numberRepository=e,this.socketGateway=t,this.mqttService=r,this.sharedService=a}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(y.refreshDataNumber){y.refreshDataNumber=!1;try{if(y.resultNumber=await this.numberRepository.find(),this.mqttService.publish("MQTT_Raw_ResultNumber",JSON.stringify(y.resultNumber)),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateNumber",y.resultNumber),y.OldNumber=[],Array.isArray(y.resultNumber)){y.Temp_ProfiNet_Items_Number=[];for(let t=0;t<y.resultNumber.length;t++)try{y.resultNumber[t]&&this.checkVariableTypeNumber(y.resultNumber[t].idDevice)&&(this.sharedService.Scada_Number_Add(parseInt(y.resultNumber[t].idDevice),y.resultNumber[t].typeDevice,y.resultNumber[t].dataType,y.resultNumber[t].negative,y.resultNumber[t].tag,y.resultNumber[t]._id),this.sharedService.Scada_Bit_Add(parseInt(y.resultNumber[t].idDevice),y.resultNumber[t].typeDevice,y.resultNumber[t].dataType,y.resultNumber[t].tagEnableView,y.resultNumber[t]._id))}catch(r){console.log(r)}function e(...e){let t=[];return e.forEach((e=>{e.forEach(((e,r)=>{e&&(t[r]||(t[r]={}),Object.assign(t[r],e))}))})),t}y.Communication_Profinet_Items_Number=y.Temp_ProfiNet_Items_Number.slice(),y.Communication_Profinet_Items=e(y.Communication_Profinet_Items_Bit,y.Communication_Profinet_Items_Number,y.Communication_Profinet_Items_String,y.Communication_Profinet_Items_Gauge,y.Communication_Profinet_Items_ProgressBar,y.Communication_Profinet_Items_Slider,y.Communication_Profinet_Items_Bit_Popup,y.Communication_Profinet_Items_Number_Popup,y.Communication_Profinet_Items_String_Popup)}}catch(a){console.log(a)}}}catch(i){console.log(i)}}async getData(){return y.resultNumber}getDataRaw(){return y.Number}async insertNumber(e){try{e._id="a"+Math.random().toString(36),e.text=0;const t=this.numberRepository.create(e);return await this.numberRepository.save(t),y.refreshDataNumber=!0,{result:"success",message:"Add Number Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateNumber(e){try{return await this.numberRepository.update(e._id,e),y.refreshDataNumber=!0,{result:"success",message:"Update Number Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteNumber(e){try{return await this.numberRepository.delete(e),y.refreshDataNumber=!0,{result:"success",message:"Delete Number Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaNumberService=g,t.ScadaNumberService=g=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.NumberEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway,u.MqttService,p.SharedService])],g)},4893:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPanelController=void 0;const o=r(3563),s=r(6182);let l=class{constructor(e){this.scadaPanelService=e}getData(){return this.scadaPanelService.getData()}insertPanel(e){return this.scadaPanelService.insertPanel(e)}updatePanel(e){return this.scadaPanelService.updatePanel(e)}deletePanel(e){return this.scadaPanelService.deletePanel(e)}};t.ScadaPanelController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_panel"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertPanel",null),a([(0,o.Put)("/update_panel"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updatePanel",null),a([(0,o.Delete)("/delete_panel"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deletePanel",null),t.ScadaPanelController=l=a([(0,o.Controller)("panel"),i("design:paramtypes",[s.ScadaPanelService])],l)},1902:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.PanelEntity=void 0;const n=r(3132);let o=class{};t.PanelEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({name:"backgroundColor",nullable:!0}),i("design:type",String)],o.prototype,"backgroundColor",void 0),a([(0,n.Column)({name:"borderRadius",nullable:!0}),i("design:type",String)],o.prototype,"borderRadius",void 0),a([(0,n.Column)({name:"boxShadow1",nullable:!0}),i("design:type",String)],o.prototype,"boxShadow1",void 0),a([(0,n.Column)({name:"boxShadow2",nullable:!0}),i("design:type",String)],o.prototype,"boxShadow2",void 0),a([(0,n.Column)({name:"boxShadow3",nullable:!0}),i("design:type",String)],o.prototype,"boxShadow3",void 0),a([(0,n.Column)({name:"boxShadowColor",nullable:!0}),i("design:type",String)],o.prototype,"boxShadowColor",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"margin",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"padding",void 0),a([(0,n.Column)({name:"idGroupControl",nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0,default:"Panel"}),i("design:type",String)],o.prototype,"objectType",void 0),t.PanelEntity=o=a([(0,n.Entity)("Panel")],o)},3397:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPanelModule=void 0;const i=r(3563),n=r(6182),o=r(4893),s=r(2449),l=r(9522),c=r(1902);let d=class{};t.ScadaPanelModule=d,t.ScadaPanelModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.PanelEntity]),s.SocketIoModule],providers:[n.ScadaPanelService],controllers:[o.ScadaPanelController]})],d)},6182:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPanelService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(1902),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.panelRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataPanel){u.refreshDataPanel=!1;try{u.resultPanel=await this.panelRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdatePanel",u.resultPanel)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultPanel}async insertPanel(e){try{e._id="a"+Math.random().toString(36);const t=this.panelRepository.create(e);return await this.panelRepository.save(t),u.refreshDataPanel=!0,{result:"success",message:"Add Panel Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updatePanel(e){try{return await this.panelRepository.update(e._id,e),u.refreshDataPanel=!0,{result:"success",message:"Update Panel Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deletePanel(e){try{return await this.panelRepository.delete(e),u.refreshDataPanel=!0,{result:"success",message:"Delete Panel Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaPanelService=p,t.ScadaPanelService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.PanelEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},7581:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPopupImageLibraryController=void 0;const o=r(3563),s=r(3478);let l=class{constructor(e){this.scadaPopupImageLibraryService=e}getData(){return this.scadaPopupImageLibraryService.getData()}upload(e){return this.scadaPopupImageLibraryService.upload(e)}update(e){return this.scadaPopupImageLibraryService.update(e)}delete(e){return this.scadaPopupImageLibraryService.delete(e)}};t.ScadaPopupImageLibraryController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/upload"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"upload",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaPopupImageLibraryController=l=a([(0,o.Controller)("PopupUploadImage"),i("design:paramtypes",[s.ScadaPopupImageLibraryService])],l)},3566:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.PopupImageLibraryEntity=void 0;const n=r(3132);let o=class{};t.PopupImageLibraryEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"img",void 0),t.PopupImageLibraryEntity=o=a([(0,n.Entity)("PopupImageLibrary")],o)},4933:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPopupImageLibraryModule=void 0;const i=r(3563),n=r(2449),o=r(9522),s=r(3566),l=r(7581),c=r(3478);let d=class{};t.ScadaPopupImageLibraryModule=d,t.ScadaPopupImageLibraryModule=d=a([(0,i.Module)({imports:[o.TypeOrmModule.forFeature([s.PopupImageLibraryEntity]),n.SocketIoModule],controllers:[l.ScadaPopupImageLibraryController],providers:[c.ScadaPopupImageLibraryService]})],d)},3478:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPopupImageLibraryService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7247),d=r(3566),u=r(6277);let p=class{constructor(e,t){this.popupImageLibraryRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataPopupImageLibrary){u.refreshDataPopupImageLibrary=!1;try{u.resultPopupImageLibrary=await this.popupImageLibraryRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdatePopupImageLibrary",u.resultPopupImageLibrary)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultPopupImageLibrary}async upload(e){try{if(3!==e.data.match(/^data:([A-Za-z-+\/]+);base64,(.+)$/).length)return{result:"error",data:{},message:"Invalid input string"};let t={_id:"a"+Math.random().toString(36),name:e.name,img:e.data};const r=this.popupImageLibraryRepository.create(t);return await this.popupImageLibraryRepository.save(r),u.refreshDataPopupImageLibrary=!0,{result:"success",message:"Add Popup Image Library Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async update(e){try{return await this.popupImageLibraryRepository.update(e._id,e),u.refreshDataPopupImageLibrary=!0,{result:"success",message:"Update Popup Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.popupImageLibraryRepository.delete(e),u.refreshDataPopupImageLibrary=!0,{result:"success",message:"Delete Popup Image Library Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaPopupImageLibraryService=p,t.ScadaPopupImageLibraryService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.PopupImageLibraryEntity)),i("design:paramtypes",[l.Repository,c.SocketGateway])],p)},2445:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPopupController=void 0;const o=r(3563),s=r(4166);let l=class{constructor(e){this.scadaPopupService=e}getData(){return this.scadaPopupService.getData()}insertPopup(e){return this.scadaPopupService.insertPopup(e)}updatePopup(e){return this.scadaPopupService.updatePopup(e)}deletePopup(e){return this.scadaPopupService.deletePopup(e)}};t.ScadaPopupController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_popup"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertPopup",null),a([(0,o.Put)("/update_popup"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updatePopup",null),a([(0,o.Delete)("/delete_popup"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deletePopup",null),t.ScadaPopupController=l=a([(0,o.Controller)("popup"),i("design:paramtypes",[s.ScadaPopupService])],l)},7006:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.PopupEntity=void 0;const n=r(3132);let o=class{};t.PopupEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"rotate",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"childObject",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"childObjectTitle",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"childObjectLeft",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"childObjectTop",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"childObjectWidth",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"childObjectHeight",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"childObjectCssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"childObjectBackgroundColor",void 0),a([(0,n.Column)({nullable:!0,default:"Popup"}),i("design:type",String)],o.prototype,"objectType",void 0),t.PopupEntity=o=a([(0,n.Entity)("Popup")],o)},8213:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPopupModule=void 0;const i=r(3563),n=r(2445),o=r(4166),s=r(2449),l=r(9522),c=r(7006),d=r(7328);let u=class{};t.ScadaPopupModule=u,t.ScadaPopupModule=u=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.PopupEntity]),s.SocketIoModule,d.SharedModule],controllers:[n.ScadaPopupController],providers:[o.ScadaPopupService]})],u)},4166:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPopupService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7006),d=r(7247),u=r(6277),p=r(9409);let y=class{constructor(e,t,r){this.popupRepository=e,this.socketGateway=t,this.sharedService=r}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(u.refreshDataPopup){u.refreshDataPopup=!1;try{if(u.resultPopup=await this.popupRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdatePopup",u.resultPopup),Array.isArray(u.resultPopup))for(let e=0;e<u.resultPopup.length;e++)try{if(u.resultPopup[e]&&u.resultPopup[e].childObject&&u.resultPopup[e].childObject.length>0){let t=JSON.parse(u.resultPopup[e].childObject.toString()),r=t.filter((e=>"Number"===JSON.parse(e).scadaType)).map((e=>JSON.parse(e))),a=[];for(let l=0;l<r.length;l++)try{r[l]&&this.checkVariableTypeNumber(r[l].idDevice)&&(this.checkVariableTypeNumber(r[l].tag)&&this.sharedService.Scada_Number_Add(parseInt(r[l].idDevice),r[l].typeDevice,r[l].dataType,r[l].negative,r[l].tag,r[l]._id),this.checkVariableTypeNumber(r[l].tagEnableView)&&this.sharedService.Scada_Bit_Add(parseInt(r[l].idDevice),r[l].typeDevice,r[l].dataType,r[l].tagEnableView,r[l]._id))}catch(c){console.log(c)}function i(...e){let t=[];return e.forEach((e=>{e.forEach(((e,r)=>{e&&(t[r]||(t[r]={}),Object.assign(t[r],e))}))})),t}u.Communication_Profinet_Items_Number_Popup=a.slice(),u.Communication_Profinet_Items=i(u.Communication_Profinet_Items_Bit,u.Communication_Profinet_Items_Number,u.Communication_Profinet_Items_String,u.Communication_Profinet_Items_Gauge,u.Communication_Profinet_Items_ProgressBar,u.Communication_Profinet_Items_Slider,u.Communication_Profinet_Items_Bit_Popup,u.Communication_Profinet_Items_Number_Popup,u.Communication_Profinet_Items_String_Popup);let n=t.filter((e=>"Bit"===JSON.parse(e).scadaType)).map((e=>JSON.parse(e)));for(let d=0;d<n.length;d++)try{n[d]&&this.checkVariableTypeNumber(n[d].idDevice)&&(this.checkVariableTypeNumber(n[d].tag)&&this.sharedService.Scada_Bit_Add(parseInt(n[d].idDevice),n[d].typeDevice,n[d].dataType,n[d].tag,n[d]._id),this.checkVariableTypeNumber(n[d].tagEnableView)&&this.sharedService.Scada_Bit_Add(parseInt(n[d].idDevice),n[d].typeDevice,n[d].dataType,n[d].tagEnableView,n[d]._id))}catch(p){console.log(p)}let o=t.filter((e=>"String"===JSON.parse(e).scadaType)).map((e=>JSON.parse(e))),s=[];for(let y=0;y<o.length;y++)try{if(o[y]&&this.checkVariableTypeNumber(o[y].idDevice)&&"ProfiNet"==o[y].typeDevice){function g(e){let t=e.replace(/[^a-zA-Z0-9_$]/g,"");return/^[0-9]/.test(t)&&(t="_"+t),t}o[y].tag.length>0&&(s[parseInt(o[y].idDevice)]=s[parseInt(o[y].idDevice)]||{},s[parseInt(o[y].idDevice)][g(o[y]._id)]=o[y].tag)}}catch(f){console.log(f)}u.Communication_Profinet_Items_String_Popup=s.slice(),u.Communication_Profinet_Items=i(u.Communication_Profinet_Items_Bit,u.Communication_Profinet_Items_Number,u.Communication_Profinet_Items_String,u.Communication_Profinet_Items_Gauge,u.Communication_Profinet_Items_ProgressBar,u.Communication_Profinet_Items_Slider,u.Communication_Profinet_Items_Bit_Popup,u.Communication_Profinet_Items_Number_Popup,u.Communication_Profinet_Items_String_Popup)}}catch(m){console.log(m)}}catch(h){console.log(h)}}}catch(v){console.log(v)}}async getData(){return u.resultPopup}async insertPopup(e){try{e._id="a"+Math.random().toString(36);const t=this.popupRepository.create(e);return await this.popupRepository.save(t),u.refreshDataPopup=!0,{result:"success",message:"Add Popup Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updatePopup(e){try{return await this.popupRepository.update(e._id,e),u.refreshDataPopup=!0,{result:"success",message:"Update Popup Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deletePopup(e){try{return await this.popupRepository.delete(e),u.refreshDataPopup=!0,{result:"success",message:"Delete Popup Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaPopupService=y,t.ScadaPopupService=y=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.PopupEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway,p.SharedService])],y)},8641:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPrintController=void 0;const o=r(3563),s=r(1730);let l=class{constructor(e){this.scadaPrintService=e}getData(){return this.scadaPrintService.getData()}insert(e){return this.scadaPrintService.insert(e)}update(e){return this.scadaPrintService.update(e)}delete(e){return this.scadaPrintService.delete(e)}};t.ScadaPrintController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insert",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaPrintController=l=a([(0,o.Controller)("print"),i("design:paramtypes",[s.ScadaPrintService])],l)},1866:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.PrintEntity=void 0;const n=r(3132);let o=class{};t.PrintEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"myKeyPress",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssPrint",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableMqtt",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttTopic",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableFlexScale",void 0),a([(0,n.Column)({nullable:!0,default:"Print"}),i("design:type",String)],o.prototype,"objectType",void 0),t.PrintEntity=o=a([(0,n.Entity)("Print")],o)},465:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPrintModule=void 0;const i=r(3563),n=r(8641),o=r(1730),s=r(2449),l=r(9522),c=r(1866);let d=class{};t.ScadaPrintModule=d,t.ScadaPrintModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.PrintEntity]),s.SocketIoModule],controllers:[n.ScadaPrintController],providers:[o.ScadaPrintService]})],d)},1730:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaPrintService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(1866),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.printRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500)),u.refreshDataPrint=!0}async fetchDataAndUpdate(){try{if(u.refreshDataPrint){u.refreshDataPrint=!1;try{u.resultPrint=await this.printRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdatePrint",u.resultPrint)}catch(e){console.log(e)}}}catch(e){console.log(e)}}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async getData(){return u.resultPrint}async insert(e){try{e._id="a"+Math.random().toString(36),e.status=0;const t=this.printRepository.create(e);return await this.printRepository.save(t),u.refreshDataPrint=!0,{result:"success",message:"Add Print Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async update(e){try{return await this.printRepository.update(e._id,e),u.refreshDataPrint=!0,{result:"success",message:"Update Print Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.printRepository.delete(e),u.refreshDataPrint=!0,{result:"success",message:"Delete Print Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaPrintService=p,t.ScadaPrintService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.PrintEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},2338:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaProgressBarRefreshService=void 0;const n=r(3563),o=r(7247),s=r(6277),l=r(9409);let c=class{constructor(e,t){this.socketGateway=e,this.sharedService=t}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}refreshData(){let e=!1;if(Array.isArray(s.haveChangeArrProgressBar))for(let t=0;t<s.haveChangeArrProgressBar.length;t++)if(s.haveChangeArrProgressBar[t]){if(e=!1,s.haveChangeArrProgressBar[t]=!1,Array.isArray(s.resultProgressBar))for(let t=0;t<s.resultProgressBar.length;t++)try{if(this.checkVariableTypeNumber(s.resultProgressBar[t].idDevice)&&"Device"==s.resultProgressBar[t].mode){s.resultProgressBar[t].value=this.sharedService.Scada_Number_Return(parseInt(s.resultProgressBar[t].idDevice),s.resultProgressBar[t].typeDevice,s.resultProgressBar[t].dataType,parseInt(s.resultProgressBar[t].negative),s.resultProgressBar[t].tag,s.resultProgressBar[t]._id,s.resultProgressBar[t].round,s.resultProgressBar[t].swapHighLow),e=!0;try{s.resultProgressBar[t].nameTag&&s.resultProgressBar[t].nameTag.length>0&&(s.ListTagProgressBar[parseInt(s.resultProgressBar[t].idDevice)]=s.ListTagProgressBar[parseInt(s.resultProgressBar[t].idDevice)]||{},s.ListTagProgressBar[parseInt(s.resultProgressBar[t].idDevice)][s.resultProgressBar[t].nameTag]=s.resultProgressBar[t].value)}catch(e){console.log(e)}}}catch(e){console.log(e)}e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateProgressBar",s.resultProgressBar)}}};t.ScadaProgressBarRefreshService=c,t.ScadaProgressBarRefreshService=c=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway,l.SharedService])],c)},2047:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaProgressBarController=void 0;const o=r(3563),s=r(6852);let l=class{constructor(e){this.scadaProgressBarService=e}getData(){return this.scadaProgressBarService.getData()}insert(e){return this.scadaProgressBarService.insert(e)}update(e){return this.scadaProgressBarService.update(e)}delete(e){return this.scadaProgressBarService.delete(e)}};t.ScadaProgressBarController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insert",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaProgressBarController=l=a([(0,o.Controller)("progressBar"),i("design:paramtypes",[s.ScadaProgressBarService])],l)},5484:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressBarEntity=void 0;const n=r(3132);let o=class{};t.ProgressBarEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"value",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameTag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataType",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"negative",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"divide",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type1Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type2Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type3Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type4Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type5Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type6Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type7Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type8Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type9Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type10Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttCurrentValue",void 0),a([(0,n.Column)({nullable:!0,default:"ProgressBar"}),i("design:type",String)],o.prototype,"objectType",void 0),a([(0,n.Column)({nullable:!0,default:1}),i("design:type",Number)],o.prototype,"round",void 0),a([(0,n.Column)({nullable:!0,default:!1}),i("design:type",Boolean)],o.prototype,"swapHighLow",void 0),t.ProgressBarEntity=o=a([(0,n.Entity)("ProgressBar")],o)},1451:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaProgressBarModule=void 0;const i=r(3563),n=r(6852),o=r(2047),s=r(2449),l=r(9522),c=r(5484),d=r(2664),u=r(824),p=r(7328);let y=class{};t.ScadaProgressBarModule=y,t.ScadaProgressBarModule=y=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.ProgressBarEntity]),s.SocketIoModule,p.SharedModule],controllers:[o.ScadaProgressBarController],providers:[n.ScadaProgressBarService,u.MqttService,d.ConfigService]})],y)},6852:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaProgressBarService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(5484),d=r(7247),u=r(824),p=r(6277),y=r(9409);let g=class{constructor(e,t,r,a){this.progressBarRepository=e,this.socketGateway=t,this.mqttService=r,this.sharedService=a}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500)),p.refreshDataProgressBar=!0}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(p.refreshDataProgressBar){p.refreshDataProgressBar=!1;try{if(p.resultProgressBar=await this.progressBarRepository.find(),this.mqttService.publish("MQTT_Raw_ResultProgressBar",JSON.stringify(p.resultProgressBar)),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateProgressBar",p.resultProgressBar),p.OldNumber=[],Array.isArray(p.resultProgressBar)){for(let t=0;t<p.resultProgressBar.length;t++)try{p.resultProgressBar[t]&&this.checkVariableTypeNumber(p.resultProgressBar[t].idDevice)&&(this.sharedService.Scada_Number_Add(parseInt(p.resultProgressBar[t].idDevice),p.resultProgressBar[t].typeDevice,p.resultProgressBar[t].dataType,p.resultProgressBar[t].negative,p.resultProgressBar[t].tag,p.resultProgressBar[t]._id),this.sharedService.Scada_Bit_Add(parseInt(p.resultProgressBar[t].idDevice),p.resultProgressBar[t].typeDevice,p.resultProgressBar[t].dataType,p.resultProgressBar[t].tagEnableView,p.resultProgressBar[t]._id))}catch(r){console.log(r)}function e(...e){let t=[];return e.forEach((e=>{e.forEach(((e,r)=>{e&&(t[r]||(t[r]={}),Object.assign(t[r],e))}))})),t}p.Communication_Profinet_Items=e(p.Communication_Profinet_Items_Bit,p.Communication_Profinet_Items_Number,p.Communication_Profinet_Items_String,p.Communication_Profinet_Items_Bit_Popup,p.Communication_Profinet_Items_Number_Popup,p.Communication_Profinet_Items_String_Popup)}}catch(a){console.log(a)}}}catch(i){console.log(i)}}async getData(){return p.resultProgressBar}async insert(e){try{e._id="a"+Math.random().toString(36);const t=this.progressBarRepository.create(e);return await this.progressBarRepository.save(t),p.refreshDataProgressBar=!0,{result:"success",message:"Add ProgressBar Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async update(e){try{return await this.progressBarRepository.update(e._id,e),p.refreshDataProgressBar=!0,{result:"success",message:"Update ProgressBar Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.progressBarRepository.delete(e),p.refreshDataProgressBar=!0,{result:"success",message:"Delete ProgressBar Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaProgressBarService=g,t.ScadaProgressBarService=g=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.ProgressBarEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway,u.MqttService,y.SharedService])],g)},7325:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaReportController=void 0;const o=r(3563),s=r(2214);let l=class{constructor(e){this.scadaReportService=e}getData(){return this.scadaReportService.getData()}insert(e){return this.scadaReportService.insert(e)}update(e){return this.scadaReportService.update(e)}delete(e){return this.scadaReportService.delete(e)}};t.ScadaReportController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insert",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaReportController=l=a([(0,o.Controller)("report"),i("design:paramtypes",[s.ScadaReportService])],l)},6494:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ReportEntity=void 0;const n=r(3132);let o=class{};t.ReportEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"myKeyPress",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameImage",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"css",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableMqtt",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttTopic",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"enableFlexScale",void 0),a([(0,n.Column)({nullable:!0,default:"Report"}),i("design:type",String)],o.prototype,"objectType",void 0),t.ReportEntity=o=a([(0,n.Entity)("Report")],o)},7861:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaReportModule=void 0;const i=r(3563),n=r(7325),o=r(2214),s=r(2449),l=r(9522),c=r(6494);let d=class{};t.ScadaReportModule=d,t.ScadaReportModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.ReportEntity]),s.SocketIoModule],controllers:[n.ScadaReportController],providers:[o.ScadaReportService]})],d)},2214:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaReportService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(6494),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.reportRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500)),u.refreshDataReport=!0}async fetchDataAndUpdate(){try{if(u.refreshDataReport){u.refreshDataReport=!1;try{u.resultReport=await this.reportRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateReport",u.resultReport)}catch(e){console.log(e)}}}catch(e){console.log(e)}}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async getData(){return u.resultReport}async insert(e){try{e._id="a"+Math.random().toString(36),e.status=0;const t=this.reportRepository.create(e);return await this.reportRepository.save(t),u.refreshDataReport=!0,{result:"success",message:"Add Report Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async update(e){try{return await this.reportRepository.update(e._id,e),u.refreshDataReport=!0,{result:"success",message:"Update Report Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.reportRepository.delete(e),u.refreshDataReport=!0,{result:"success",message:"Delete Report Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaReportService=p,t.ScadaReportService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.ReportEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},1573:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaSelectController=void 0;const o=r(3563),s=r(9726);let l=class{constructor(e){this.scadaSelectService=e}getData(){return this.scadaSelectService.getData()}insert(e){return this.scadaSelectService.insert(e)}update(e){return this.scadaSelectService.update(e)}delete(e){return this.scadaSelectService.delete(e)}};t.ScadaSelectController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insert",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaSelectController=l=a([(0,o.Controller)("select"),i("design:paramtypes",[s.ScadaSelectService])],l)},7574:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectEntity=void 0;const n=r(3132);let o=class{};t.SelectEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttTopic",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttCurrentValue",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttSearchValue",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttResponse",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttEditable",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"size",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type1Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type2Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type3Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type4Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type5Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zoom",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"config",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"createClassName",void 0),a([(0,n.Column)({nullable:!0,default:"Single"}),i("design:type",String)],o.prototype,"mode",void 0),a([(0,n.Column)({nullable:!0,default:"bottomLeft"}),i("design:type",String)],o.prototype,"placement",void 0),a([(0,n.Column)({nullable:!0,default:"Select"}),i("design:type",String)],o.prototype,"objectType",void 0),t.SelectEntity=o=a([(0,n.Entity)("Select")],o)},4765:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaSelectModule=void 0;const i=r(3563),n=r(9726),o=r(1573),s=r(2449),l=r(9522),c=r(7574);let d=class{};t.ScadaSelectModule=d,t.ScadaSelectModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.SelectEntity]),s.SocketIoModule],providers:[n.ScadaSelectService],controllers:[o.ScadaSelectController]})],d)},9726:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaSelectService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7574),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.selectRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500)),u.refreshDataSelect=!0}async fetchDataAndUpdate(){try{if(u.refreshDataSelect){u.refreshDataSelect=!1;try{u.resultSelect=await this.selectRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateSelect",u.resultSelect)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultSelect}async insert(e){try{e._id="a"+Math.random().toString(36);const t=this.selectRepository.create(e);return await this.selectRepository.save(t),u.refreshDataSelect=!0,{result:"success",message:"Add Select Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async update(e){try{return await this.selectRepository.update(e._id,e),u.refreshDataSelect=!0,{result:"success",message:"Update Select Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.selectRepository.delete(e),u.refreshDataSelect=!0,{result:"success",message:"Delete Select Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaSelectService=p,t.ScadaSelectService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.SelectEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},6052:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScadaSetupAlarmRefreshService=void 0;const common_1=__webpack_require__(3563),socket_io_gateway_1=__webpack_require__(7247),Variable=__webpack_require__(6277);let ScadaSetupAlarmRefreshService=class ScadaSetupAlarmRefreshService{constructor(e){this.socketGateway=e,this.oldArrActiveAlarm=[]}onModuleInit(){this.intervalId||(this.intervalId=setInterval((async()=>{this.refreshData()}),1e3))}refreshData(){let ArrActiveAlarm=[];try{if(Array.isArray(Variable.resultSetupAlarm)){for(let i=0;i<Variable.resultSetupAlarm.length;i++)try{Variable.resultSetupAlarm[i].logic&&Variable.resultSetupAlarm[i].logic.length>0&&(eval(Variable.resultSetupAlarm[i].logic)?Variable.resultSetupAlarm[i].enableAlarm&&(ArrActiveAlarm.push({_id:Variable.resultSetupAlarm[i]._id,logic:Variable.resultSetupAlarm[i].logic,alarmText:Variable.resultSetupAlarm[i].alarmText,typeAlarm:Variable.resultSetupAlarm[i].typeAlarm}),0==Variable.resultSetupAlarm[i].oldValue&&this.socketGateway&&this.socketGateway.server&&(Variable.resultSetupAlarm[i].oldValue=!0,this.socketGateway.server.emit("Server-Send-Snackbar",{status:Variable.resultSetupAlarm[i].typeAlarm,message:Variable.resultSetupAlarm[i].alarmText}))):Variable.resultSetupAlarm[i].oldValue=!1)}catch(e){ArrActiveAlarm.push({_id:Variable.resultSetupAlarm[i]._id,logic:Variable.resultSetupAlarm[i].logic,alarmText:"Wrong Logic - "+Variable.resultSetupAlarm[i].alarmText,typeAlarm:Variable.resultSetupAlarm[i].typeAlarm})}Variable.resultSetupAlarmTable=ArrActiveAlarm.slice()}JSON.stringify(this.oldArrActiveAlarm)!==JSON.stringify(ArrActiveAlarm)&&(this.oldArrActiveAlarm=ArrActiveAlarm.slice(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateSetupAlarmTable",ArrActiveAlarm))}catch(e){console.log(e)}}};exports.ScadaSetupAlarmRefreshService=ScadaSetupAlarmRefreshService,exports.ScadaSetupAlarmRefreshService=ScadaSetupAlarmRefreshService=__decorate([(0,common_1.Injectable)(),__metadata("design:paramtypes",[socket_io_gateway_1.SocketGateway])],ScadaSetupAlarmRefreshService)},8773:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaSetupAlarmController=void 0;const o=r(3563),s=r(5662);let l=class{constructor(e){this.scadaSetupAlarmService=e}getData(){return this.scadaSetupAlarmService.getData()}getDataSetupAlarmTable(){return this.scadaSetupAlarmService.getDataSetupAlarmTable()}insertSetupAlarm(e){return console.log(e),this.scadaSetupAlarmService.insertSetupAlarm(e)}updateSetupAlarm(e){return this.scadaSetupAlarmService.updateSetupAlarm(e)}deleteSetupAlarm(e){return this.scadaSetupAlarmService.deleteSetupAlarm(e)}};t.ScadaSetupAlarmController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Get)("/getdata_setupAlarmTable"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getDataSetupAlarmTable",null),a([(0,o.Post)("/insert_setupAlarm"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertSetupAlarm",null),a([(0,o.Put)("/update_setupAlarm"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateSetupAlarm",null),a([(0,o.Delete)("/delete_setupAlarm"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteSetupAlarm",null),t.ScadaSetupAlarmController=l=a([(0,o.Controller)("setupAlarm"),i("design:paramtypes",[s.ScadaSetupAlarmService])],l)},7222:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SetupAlarmEntity=void 0;const n=r(3132);let o=class{};t.SetupAlarmEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeAlarm",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"logic",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"oldValue",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"alarmText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"saveAlarm",void 0),a([(0,n.Column)({nullable:!0,default:!0}),i("design:type",Boolean)],o.prototype,"enableAlarm",void 0),t.SetupAlarmEntity=o=a([(0,n.Entity)("SetupAlarm")],o)},6461:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaSetupAlarmModule=void 0;const i=r(3563),n=r(8773),o=r(5662),s=r(2449),l=r(9522),c=r(7222);let d=class{};t.ScadaSetupAlarmModule=d,t.ScadaSetupAlarmModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.SetupAlarmEntity]),s.SocketIoModule],controllers:[n.ScadaSetupAlarmController],providers:[o.ScadaSetupAlarmService]})],d)},5662:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaSetupAlarmService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(7222),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.setupAlarmRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataSetupAlarm){u.refreshDataSetupAlarm=!1;try{u.resultSetupAlarm=await this.setupAlarmRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateSetupAlarm",u.resultSetupAlarm)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultSetupAlarm}async getDataSetupAlarmTable(){return u.resultSetupAlarmTable}async insertSetupAlarm(e){try{e._id="a"+Math.random().toString(36),e.oldValue=!1;const t=this.setupAlarmRepository.create(e);return await this.setupAlarmRepository.save(t),u.refreshDataSetupAlarm=!0,{result:"success",message:"Add SetupAlarm Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateSetupAlarm(e){try{return await this.setupAlarmRepository.update(e._id,e),u.refreshDataSetupAlarm=!0,{result:"success",message:"Update SetupAlarm Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteSetupAlarm(e){try{return await this.setupAlarmRepository.delete(e),u.refreshDataSetupAlarm=!0,{result:"success",message:"Delete SetupAlarm Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaSetupAlarmService=p,t.ScadaSetupAlarmService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.SetupAlarmEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},1134:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaSliderRefreshService=void 0;const n=r(3563),o=r(7247),s=r(6277);let l=class{constructor(e){this.socketGateway=e}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}isObject(e){return"object"==typeof e&&null!==e}refreshData(){let e=!1;if(Array.isArray(s.haveChangeArrSlider))for(let t=0;t<s.haveChangeArrSlider.length;t++)if(s.haveChangeArrSlider[t]){if(e=!1,s.haveChangeArrSlider[t]=!1,Array.isArray(s.resultSlider))for(let r=0;r<s.resultSlider.length;r++)try{if(this.checkVariableTypeNumber(s.resultSlider[r].idDevice)&&"Device"==s.resultSlider[r].mode){if("System"==s.resultSlider[r].typeDevice&&s.resultSlider[r].tag.length>0&&s.Number[parseInt(s.resultSlider[r].idDevice)]&&(s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag],e=!0),"Modbus-Client"==s.resultSlider[r].typeDevice&&this.checkVariableTypeNumber(s.resultSlider[r].tag)&&("HoldingRegister-Int16"==s.resultSlider[r].dataType&&s.Number[parseInt(s.resultSlider[r].idDevice)]&&parseInt(s.resultSlider[r].tag)<=s.Number[parseInt(s.resultSlider[r].idDevice)].length&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)]&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)].hasOwnProperty("HoldingRegister")&&(parseInt(s.resultSlider[r].negative)?parseInt(s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister)>32767?s.resultSlider[r].value=parseInt(s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister)-65536:s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister:s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister<0?s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister+65536:s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister,e=!0),"InputRegister-Int16"==s.resultSlider[r].dataType&&s.Number[parseInt(s.resultSlider[r].idDevice)]&&parseInt(s.resultSlider[r].tag)<=s.Number[parseInt(s.resultSlider[r].idDevice)].length&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)]&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)].hasOwnProperty("InputRegister")&&(parseInt(s.resultSlider[r].negative)?parseInt(s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister)>32767?s.resultSlider[r].value=parseInt(s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister)-65536:s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister:s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister<0?s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister+65536:s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister,e=!0),"HoldingRegister-Int32"==s.resultSlider[r].dataType&&s.Number[parseInt(s.resultSlider[r].idDevice)]&&parseInt(s.resultSlider[r].tag)+1<=s.Number[parseInt(s.resultSlider[r].idDevice)].length&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)]&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)+1]&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)].hasOwnProperty("HoldingRegister")&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)+1].hasOwnProperty("HoldingRegister")&&(parseInt(s.resultSlider[r].negative)?parseInt(s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister)>2147483647?s.resultSlider[r].value=parseInt(s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister)-4294967296:s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister:s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister<0?s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister+4294967296:s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].HoldingRegister,e=!0),"InputRegister-Int32"==s.resultSlider[r].dataType&&s.Number[parseInt(s.resultSlider[r].idDevice)]&&parseInt(s.resultSlider[r].tag)+1<=s.Number[parseInt(s.resultSlider[r].idDevice)].length&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)]&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)+1]&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)].hasOwnProperty("InputRegister")&&s.Number[parseInt(s.resultSlider[r].idDevice)][parseInt(s.resultSlider[r].tag)+1].hasOwnProperty("InputRegister")&&(parseInt(s.resultSlider[r].negative)?parseInt(s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister)>2147483647?s.resultSlider[r].value=parseInt(s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister)-4294967296:s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister:s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister<0?s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister+4294967296:s.resultSlider[r].value=s.Number[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag].InputRegister,e=!0)),"Fins-Omron"==s.resultSlider[r].typeDevice&&this.checkVariableTypeNumber(s.resultSlider[r].tag)&&("Word"==s.resultSlider[r].dataType&&s.WordDisplay[parseInt(s.resultSlider[r].idDevice)]&&parseInt(s.resultSlider[r].tag)<=s.WordDisplay[parseInt(s.resultSlider[r].idDevice)].length&&(parseInt(s.resultSlider[r].negative)?parseInt(s.WordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag])>32767?s.resultSlider[r].value=parseInt(s.WordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag])-65536:s.resultSlider[r].value=s.WordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag]:s.WordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag]<0?s.resultSlider[r].value=s.WordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag]+65536:s.resultSlider[r].value=s.WordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag],e=!0),"DWord"==s.resultSlider[r].dataType&&s.DWordDisplay[parseInt(s.resultSlider[r].idDevice)]&&parseInt(s.resultSlider[r].tag)<=s.DWordDisplay[parseInt(s.resultSlider[r].idDevice)].length&&(parseInt(s.resultSlider[r].negative)?parseInt(s.DWordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag])>2147483647?s.resultSlider[r].value=parseInt(s.DWordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag])-4294967296:s.resultSlider[r].value=s.DWordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag]:s.DWordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag]<0?s.resultSlider[r].value=s.DWordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag]+4294967296:s.resultSlider[r].value=s.DWordDisplay[parseInt(s.resultSlider[r].idDevice)][s.resultSlider[r].tag],e=!0)),"OPC-UA"==s.resultSlider[r].typeDevice&&s.resultSlider[r].tag.length>0&&s.Number[parseInt(s.resultSlider[r].idDevice)])for(let a of s.Number[parseInt(s.resultSlider[r].idDevice)])a&&a.hasOwnProperty(s.resultSlider[r].tag)&&(s.resultSlider[r].value=a[s.resultSlider[r].tag],e=!0);if("ACE"==s.resultSlider[r].typeDevice&&s.resultSlider[r].tag.length>0&&s.Number[parseInt(s.resultSlider[r].idDevice)])for(let i of s.Number[parseInt(s.resultSlider[r].idDevice)])i&&i.hasOwnProperty(s.resultSlider[r].tag)&&(s.resultSlider[r].value=i[s.resultSlider[r].tag],e=!0);if("ProfiNet"==s.resultSlider[r].typeDevice&&this.isObject(s.Communication_Profinet_Raw_Result[parseInt(s.resultSlider[r].idDevice)])){function n(e){let t=e.replace(/[^a-zA-Z0-9_$]/g,"");return/^[0-9]/.test(t)&&(t="_"+t),t}s.resultSlider[r].tag.length>0&&Object.keys(s.Communication_Profinet_Raw_Result[parseInt(s.resultSlider[r].idDevice)]).length>0&&s.Communication_Profinet_Raw_Result[parseInt(s.resultSlider[r].idDevice)].hasOwnProperty(n(s.resultSlider[r]._id))&&(s.resultSlider[r].value=s.Communication_Profinet_Raw_Result[parseInt(s.resultSlider[r].idDevice)][n(s.resultSlider[r]._id)],e=!0)}}}catch(o){console.log(o)}e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateSlider",s.resultSlider)}}};t.ScadaSliderRefreshService=l,t.ScadaSliderRefreshService=l=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway])],l)},5283:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaSliderController=void 0;const o=r(3563),s=r(2960);let l=class{constructor(e){this.scadaSliderService=e}getData(){return this.scadaSliderService.getData()}insert(e){return this.scadaSliderService.insert(e)}update(e){return this.scadaSliderService.update(e)}delete(e){return this.scadaSliderService.delete(e)}};t.ScadaSliderController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insert",null),a([(0,o.Put)("/update"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"update",null),a([(0,o.Delete)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaSliderController=l=a([(0,o.Controller)("slider"),i("design:paramtypes",[s.ScadaSliderService])],l)},8075:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SliderEntity=void 0;const n=r(3132);let o=class{};t.SliderEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"value",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameTag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataType",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"negative",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"divide",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type1Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type2Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type3Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type4Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type5Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type6Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type7Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type8Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type9Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"type10Object",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttCurrentValue",void 0),a([(0,n.Column)({nullable:!0,default:"Slider"}),i("design:type",String)],o.prototype,"objectType",void 0),t.SliderEntity=o=a([(0,n.Entity)("Slider")],o)},759:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaSliderModule=void 0;const i=r(3563),n=r(2960),o=r(5283),s=r(2449),l=r(9522),c=r(8075),d=r(2664),u=r(824),p=r(7328);let y=class{};t.ScadaSliderModule=y,t.ScadaSliderModule=y=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.SliderEntity]),s.SocketIoModule,p.SharedModule],controllers:[o.ScadaSliderController],providers:[n.ScadaSliderService,u.MqttService,d.ConfigService]})],y)},2960:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaSliderService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(8075),d=r(7247),u=r(824),p=r(9409),y=r(6277);let g=class{constructor(e,t,r,a){this.sliderRepository=e,this.socketGateway=t,this.mqttService=r,this.sharedService=a}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500)),y.refreshDataSlider=!0}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(y.refreshDataSlider){y.refreshDataSlider=!1;try{if(y.resultSlider=await this.sliderRepository.find(),this.mqttService.publish("MQTT_Raw_ResultSlider",JSON.stringify(y.resultSlider)),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateSlider",y.resultSlider),y.OldNumber=[],Array.isArray(y.resultSlider)){for(let t=0;t<y.resultSlider.length;t++)try{y.resultSlider[t]&&this.checkVariableTypeNumber(y.resultSlider[t].idDevice)&&"Device"==y.resultSlider[t].mode&&this.sharedService.Scada_Number_Add(parseInt(y.resultSlider[t].idDevice),y.resultSlider[t].typeDevice,y.resultSlider[t].dataType,y.resultSlider[t].negative,y.resultSlider[t].tag,y.resultSlider[t]._id)}catch(r){console.log(r)}function e(...e){let t=[];return e.forEach((e=>{e.forEach(((e,r)=>{e&&(t[r]||(t[r]={}),Object.assign(t[r],e))}))})),t}y.Communication_Profinet_Items=e(y.Communication_Profinet_Items_Bit,y.Communication_Profinet_Items_Number,y.Communication_Profinet_Items_String,y.Communication_Profinet_Items_Bit_Popup,y.Communication_Profinet_Items_Number_Popup,y.Communication_Profinet_Items_String_Popup)}}catch(a){console.log(a)}}}catch(i){console.log(i)}}async getData(){return y.resultSlider}async insert(e){try{e._id="a"+Math.random().toString(36);const t=this.sliderRepository.create(e);return await this.sliderRepository.save(t),y.refreshDataSlider=!0,{result:"success",message:"Add Slider Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async update(e){try{return await this.sliderRepository.update(e._id,e),y.refreshDataSlider=!0,{result:"success",message:"Update Slider Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async delete(e){try{return await this.sliderRepository.delete(e),y.refreshDataSlider=!0,{result:"success",message:"Delete Slider Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaSliderService=g,t.ScadaSliderService=g=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.SliderEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway,u.MqttService,p.SharedService])],g)},9446:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaStringRefreshService=void 0;const n=r(3563),o=r(7247),s=r(824),l=r(6277);let c=class{constructor(e,t){this.socketGateway=e,this.mqttService=t}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}isObject(e){return"object"==typeof e&&null!==e}refreshData(){let e=!1;var t=!1;if(Array.isArray(l.haveChangeArrString))for(let r=0;r<l.haveChangeArrString.length;r++)if(l.haveChangeArrString[r]){if(l.haveChangeArrString[r]=!1,t=!0,Array.isArray(l.resultString))for(let a=0;a<l.resultString.length;a++)try{if(!isNaN(l.resultString[a].idDevice)&&l.ListString[parseInt(l.resultString[a].idDevice)]){if("ProfiNet"==l.resultString[a].typeDevice){if("ProfiNet"==l.resultString[a].typeDevice&&this.isObject(l.Communication_Profinet_Raw_Result[parseInt(l.resultString[a].idDevice)])){function i(e){let t=e.replace(/[^a-zA-Z0-9_$]/g,"");return/^[0-9]/.test(t)&&(t="_"+t),t}l.resultString[a].tag.length>0&&Object.keys(l.Communication_Profinet_Raw_Result[parseInt(l.resultString[a].idDevice)]).length>0&&l.Communication_Profinet_Raw_Result[parseInt(l.resultString[a].idDevice)].hasOwnProperty(i(l.resultString[a]._id))&&(l.resultString[a].text=l.Communication_Profinet_Raw_Result[parseInt(l.resultString[a].idDevice)][i(l.resultString[a]._id)],e=!0,l.ListString[parseInt(l.resultString[a].idDevice)][i(l.resultString[a]._id)]=l.resultString[a].text)}}else l.resultString[a].tag<=l.ListString[parseInt(l.resultString[a].idDevice)].length&&(l.resultString[a].text=l.ListString[parseInt(l.resultString[a].idDevice)][l.resultString[a].tag]);if("ACE"==l.resultString[a].typeDevice){let n=parseInt(l.resultString[a].idDevice),o=l.resultString[a].tag;if(o.length>0&&l.Number[n])for(let s of l.Number[n])s&&s.hasOwnProperty(o)&&(l.resultString[a].text=s[o],e=!0)}}try{l.resultString[a]&&l.resultString[a].nameTag&&l.resultString[a].nameTag.length>0&&(l.ListTagString[parseInt(l.resultString[a].idDevice)]=l.ListTagString[parseInt(l.resultString[a].idDevice)]||{},l.ListTagString[parseInt(l.resultString[a].idDevice)][l.resultString[a].nameTag]=l.resultString[a].text)}catch(c){console.log(c)}e=!0}catch(d){console.log(d)}if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateString",l.resultString),e=!1,Array.isArray(l.resultProjectScreen_String))for(let u=0;u<l.resultProjectScreen_String.length;u++)!isNaN(l.resultProjectScreen_String[u].idDevice)&&l.ListString[parseInt(l.resultProjectScreen_String[u].idDevice)]&&l.resultProjectScreen_String[u].tag<=l.ListString[parseInt(l.resultProjectScreen_String[u].idDevice)].length&&(l.resultProjectScreen_String[u].text=l.ListString[parseInt(l.resultProjectScreen_String[u].idDevice)][l.resultProjectScreen_String[u].tag],e=!0);e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_String",l.resultProjectScreen_String)}t&&this.mqttService.publish("MQTT_Raw_String",JSON.stringify(l.ListString))}};t.ScadaStringRefreshService=c,t.ScadaStringRefreshService=c=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway,s.MqttService])],c)},491:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaStringController=void 0;const o=r(3563),s=r(5384);let l=class{constructor(e){this.scadaStringService=e}getData(){return this.scadaStringService.getData()}insertString(e){return this.scadaStringService.insertString(e)}updateString(e){return this.scadaStringService.updateString(e)}deleteString(e){return this.scadaStringService.deleteString(e)}};t.ScadaStringController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_string"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertString",null),a([(0,o.Put)("/update_string"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateString",null),a([(0,o.Delete)("/delete_string"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteString",null),t.ScadaStringController=l=a([(0,o.Controller)("string"),i("design:paramtypes",[s.ScadaStringService])],l)},5392:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.StringEntity=void 0;const n=r(3132);let o=class{};t.StringEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tagEnableView",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"dataTypeTagEnableView",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"nameTag",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"color",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"speedScroll",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"lengthScroll",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorBackground",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"borderRadius",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"numberCharacter",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Boolean)],o.prototype,"editable",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttEditable",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqttResponse",void 0),a([(0,n.Column)({nullable:!0,default:"String"}),i("design:type",String)],o.prototype,"objectType",void 0),a([(0,n.Column)({nullable:!0,default:!0}),i("design:type",Boolean)],o.prototype,"view",void 0),t.StringEntity=o=a([(0,n.Entity)("String")],o)},4879:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaStringModule=void 0;const i=r(3563),n=r(491),o=r(5384),s=r(2449),l=r(9522),c=r(5392),d=r(824),u=r(2664),p=r(7328);let y=class{};t.ScadaStringModule=y,t.ScadaStringModule=y=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.StringEntity]),s.SocketIoModule,p.SharedModule],controllers:[n.ScadaStringController],providers:[o.ScadaStringService,d.MqttService,u.ConfigService]})],y)},5384:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaStringService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(5392),d=r(7247),u=r(824),p=r(6277),y=r(9409);let g=class{constructor(e,t,r,a){this.stringRepository=e,this.socketGateway=t,this.mqttService=r,this.sharedService=a}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(p.refreshDataString){p.refreshDataString=!1;try{if(p.resultString=await this.stringRepository.find(),this.mqttService.publish("MQTT_Raw_ResultString",JSON.stringify(p.resultString)),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateString",p.resultString),p.OldListString=[],Array.isArray(p.resultString)){let e=[];for(let r=0;r<p.resultString.length;r++)try{p.resultString[r]&&this.checkVariableTypeNumber(p.resultString[r].idDevice)&&this.sharedService.Scada_String_Add(parseInt(p.resultString[r].idDevice),p.resultString[r].typeDevice,p.resultString[r].dataType,p.resultString[r].numberCharacter,p.resultString[r].tag,p.resultString[r]._id)}catch(a){console.log(a)}function t(...e){let t=[];return e.forEach((e=>{e.forEach(((e,r)=>{e&&(t[r]||(t[r]={}),Object.assign(t[r],e))}))})),t}p.Communication_Profinet_Items_String=e.slice(),p.Communication_Profinet_Items=t(p.Communication_Profinet_Items_Bit,p.Communication_Profinet_Items_Number,p.Communication_Profinet_Items_String,p.Communication_Profinet_Items_Gauge,p.Communication_Profinet_Items_ProgressBar,p.Communication_Profinet_Items_Slider,p.Communication_Profinet_Items_Bit_Popup,p.Communication_Profinet_Items_Number_Popup,p.Communication_Profinet_Items_String_Popup)}}catch(i){console.log(i)}}}catch(n){console.log(n)}}async getData(){return p.resultString}async insertString(e){try{e._id="a"+Math.random().toString(36),e.text="";const t=this.stringRepository.create(e);return await this.stringRepository.save(t),p.refreshDataString=!0,{result:"success",message:"Add String Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateString(e){try{return await this.stringRepository.update(e._id,e),p.refreshDataString=!0,{result:"success",message:"Update String Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteString(e){try{return await this.stringRepository.delete(e),p.refreshDataString=!0,{result:"success",message:"Delete String Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaStringService=g,t.ScadaStringService=g=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.StringEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway,u.MqttService,y.SharedService])],g)},3044:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaTextFieldRefreshService=void 0;const n=r(3563),o=r(7247),s=r(6277);let l=class{constructor(e){this.socketGateway=e}refreshData(){let e=!1;if(Array.isArray(s.haveChangeArrTextField))for(let t=0;t<s.haveChangeArrTextField.length;t++)if(s.haveChangeArrTextField[t]){if(s.haveChangeArrTextField[t]=!1,Array.isArray(s.resultTextField))for(let t=0;t<s.resultTextField.length;t++)try{!isNaN(s.resultTextField[t].idDevice)&&s.TextField[parseInt(s.resultTextField[t].idDevice)]&&s.resultTextField[t].tag<=s.TextField[parseInt(s.resultTextField[t].idDevice)].length&&(s.resultTextField[t].text=s.TextField[parseInt(s.resultTextField[t].idDevice)][s.resultTextField[t].tag],e=!0)}catch(e){console.log(e)}e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateTextField",s.resultTextField)}}};t.ScadaTextFieldRefreshService=l,t.ScadaTextFieldRefreshService=l=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway])],l)},7893:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaTextFieldController=void 0;const o=r(3563),s=r(6974);let l=class{constructor(e){this.scadaTextFieldService=e}getData(){return this.scadaTextFieldService.getData()}insertTextField(e){return this.scadaTextFieldService.insertTextField(e)}updateTextField(e){return this.scadaTextFieldService.updateTextField(e)}deleteTextField(e){return this.scadaTextFieldService.deleteTextField(e)}};t.ScadaTextFieldController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_textField"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertTextField",null),a([(0,o.Put)("/update_textField"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateTextField",null),a([(0,o.Delete)("/delete_textField"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteTextField",null),t.ScadaTextFieldController=l=a([(0,o.Controller)("textField"),i("design:paramtypes",[s.ScadaTextFieldService])],l)},9094:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.TextFieldEntity=void 0;const n=r(3132);let o=class{};t.TextFieldEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"color",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"rows",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorBackground",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"borderRadius",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0,default:"TextField"}),i("design:type",String)],o.prototype,"objectType",void 0),t.TextFieldEntity=o=a([(0,n.Entity)("TextField")],o)},6285:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaTextFieldModule=void 0;const i=r(3563),n=r(7893),o=r(6974),s=r(2449),l=r(9522),c=r(9094);let d=class{};t.ScadaTextFieldModule=d,t.ScadaTextFieldModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.TextFieldEntity]),s.SocketIoModule],controllers:[n.ScadaTextFieldController],providers:[o.ScadaTextFieldService]})],d)},6974:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaTextFieldService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(9094),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.textFieldRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataTextField){u.refreshDataTextField=!1;try{u.resultTextField=await this.textFieldRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateTextField",u.resultTextField),u.OldTextField=[]}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultTextField}async insertTextField(e){try{e._id="a"+Math.random().toString(36),e.text="";const t=this.textFieldRepository.create(e);return await this.textFieldRepository.save(t),u.refreshDataTextField=!0,{result:"success",message:"Add TextField Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateTextField(e){try{return await this.textFieldRepository.update(e._id,e),u.refreshDataTextField=!0,{result:"success",message:"Update TextField Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteTextField(e){try{return await this.textFieldRepository.delete(e),u.refreshDataTextField=!0,{result:"success",message:"Delete TextField Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaTextFieldService=p,t.ScadaTextFieldService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.TextFieldEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},6237:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaTotalController=void 0;const o=r(3563),s=r(6694);let l=class{constructor(e){this.scadaTotalService=e}insert(e){return this.scadaTotalService.insert(e)}delete(e){return this.scadaTotalService.delete(e)}};t.ScadaTotalController=l,a([(0,o.Post)("/insert"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insert",null),a([(0,o.Post)("/delete"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"delete",null),t.ScadaTotalController=l=a([(0,o.Controller)("total"),i("design:paramtypes",[s.ScadaTotalService])],l)},4789:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaTotalModule=void 0;const i=r(3563),n=r(6237),o=r(6694),s=r(2449),l=r(9522),c=r(2664),d=r(10),u=r(6078),p=r(882),y=r(8016),g=r(7438),f=r(8248),m=r(3350),h=r(5646),v=r(5484),b=r(8075),S=r(7788),D=r(7470),_=r(1374),I=r(9310),C=r(9920),R=r(808),j=r(1902),P=r(7006),O=r(1866),w=r(7574),A=r(7222),B=r(5392),N=r(9094),M=r(6574),E=r(6494),L=r(4288);let k=class{};t.ScadaTotalModule=k,t.ScadaTotalModule=k=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([d.BitEntity,u.CameraStreamEntity,p.ChartEntity,y.DateTimePickerEntity,g.DesignEntity,f.DesignTableEntity,m.ElementEntity,h.GaugeEntity,v.ProgressBarEntity,b.SliderEntity,S.GridViewEntity,D.LabelEntity,_.LineEntity,I.MapEntity,C.NavigateEntity,R.NumberEntity,j.PanelEntity,P.PopupEntity,O.PrintEntity,w.SelectEntity,A.SetupAlarmEntity,B.StringEntity,N.TextFieldEntity,M.ViewImageEntity,E.ReportEntity,L._3DEntity]),s.SocketIoModule],controllers:[n.ScadaTotalController],providers:[o.ScadaTotalService,c.ConfigService]})],k)},6694:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaTotalService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(6277),d=r(10),u=r(6078),p=r(882),y=r(8016),g=r(7438),f=r(8248),m=r(3350),h=r(5646),v=r(5484),b=r(8075),S=r(7788),D=r(7470),_=r(1374),I=r(9310),C=r(9920),R=r(808),j=r(1902),P=r(7006),O=r(1866),w=r(7574),A=r(7222),B=r(5392),N=r(9094),M=r(6574),E=r(6494),L=r(4288);let k=class{constructor(e,t,r,a,i,n,o,s,l,c,d,u,p,y,g,f,m,h,v,b,S,D,_,I,C,R,j){this.bitRepository=e,this.cameraStreamRepository=t,this.chartRepository=r,this.dateTimePickerRepository=a,this.designRepository=i,this.designTableRepository=n,this.elementRepository=o,this.gaugeRepository=s,this.progressBarRepository=l,this.sliderRepository=c,this.gridViewRepository=d,this.labelRepository=u,this.lineRepository=p,this.mapRepository=y,this.navigateRepository=g,this.numberRepository=f,this.panelRepository=m,this.popupRepository=h,this.printRepository=v,this.selectRepository=b,this.setupAlarmRepository=S,this.stringRepository=D,this.textFieldRepository=_,this.viewImageRepository=I,this._3DRepository=C,this.reportRepository=R,this.entityManager=j}onModuleInit(){}async insert(e){if(!Array.isArray(e))return{result:"error",message:"Invalid data format"};try{return await this.entityManager.transaction((async t=>{const r={Bit:[],CameraStream:[],Chart:[],DateTimePicker:[],Design:[],DesignTable:[],Element:[],Gauge:[],ProgressBar:[],Slider:[],GridView:[],Label:[],Line:[],Map:[],Navigate:[],Number:[],Panel:[],Popup:[],Print:[],Select:[],SetupAlarm:[],String:[],TextField:[],ViewImage:[],_3D:[],Report:[]};for(const t of e)t._id="a"+Math.random().toString(36),r[t.objectType]?r[t.objectType].push(t):console.log("Unknown objectType:",t.objectType);r.Bit.length>0&&await t.save(d.BitEntity,r.Bit),r.CameraStream.length>0&&await t.save(u.CameraStreamEntity,r.CameraStream),r.Chart.length>0&&await t.save(p.ChartEntity,r.Chart),r.DateTimePicker.length>0&&await t.save(y.DateTimePickerEntity,r.DateTimePicker),r.Design.length>0&&await t.save(g.DesignEntity,r.Design),r.DesignTable.length>0&&await t.save(f.DesignTableEntity,r.DesignTable),r.Element.length>0&&await t.save(m.ElementEntity,r.Element),r.Gauge.length>0&&await t.save(h.GaugeEntity,r.Gauge),r.ProgressBar.length>0&&await t.save(v.ProgressBarEntity,r.ProgressBar),r.Slider.length>0&&await t.save(b.SliderEntity,r.Slider),r.GridView.length>0&&await t.save(S.GridViewEntity,r.GridView),r.Label.length>0&&await t.save(D.LabelEntity,r.Label),r.Line.length>0&&await t.save(_.LineEntity,r.Line),r.Map.length>0&&await t.save(I.MapEntity,r.Map),r.Navigate.length>0&&await t.save(C.NavigateEntity,r.Navigate),r.Number.length>0&&await t.save(R.NumberEntity,r.Number),r.Panel.length>0&&await t.save(j.PanelEntity,r.Panel),r.Popup.length>0&&await t.save(P.PopupEntity,r.Popup),r.Print.length>0&&await t.save(O.PrintEntity,r.Print),r.Select.length>0&&await t.save(w.SelectEntity,r.Select),r.SetupAlarm.length>0&&await t.save(A.SetupAlarmEntity,r.SetupAlarm),r.String.length>0&&await t.save(B.StringEntity,r.String),r.TextField.length>0&&await t.save(N.TextFieldEntity,r.TextField),r.ViewImage.length>0&&await t.save(M.ViewImageEntity,r.ViewImage),r._3D.length>0&&await t.save(L._3DEntity,r._3D),r.Report.length>0&&await t.save(E.ReportEntity,r.Report),c.refreshDataBit=!0,c.refreshDataCameraStream=!0,c.refreshDataChart=!0,c.refreshDataDateTimePicker=!0,c.refreshDataDesign=!0,c.refreshDataDesignTable=!0,c.refreshDataElement=!0,c.refreshDataGauge=!0,c.refreshDataProgressBar=!0,c.refreshDataSlider=!0,c.refreshDataGridView=!0,c.refreshDataLabel=!0,c.refreshDataLine=!0,c.refreshDataMap=!0,c.refreshDataNavigate=!0,c.refreshDataNumber=!0,c.refreshDataPanel=!0,c.refreshDataPopup=!0,c.refreshDataPrint=!0,c.refreshDataSelect=!0,c.refreshDataSetupAlarm=!0,c.refreshDataString=!0,c.refreshDataTextField=!0,c.refreshDataViewImage=!0,c.refreshData3D=!0,c.refreshDataReport=!0})),{result:"success",message:"Upload Total Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async delete(e){if(!Array.isArray(e))return{result:"error",message:"Invalid data format"};try{return await this.entityManager.transaction((async t=>{const r=e.reduce(((e,t)=>(e[t.objectType]||(e[t.objectType]=[]),e[t.objectType].push(t.id),e)),{});r.Bit?.length&&await t.delete(d.BitEntity,r.Bit),r.CameraStream?.length&&await t.delete(u.CameraStreamEntity,r.CameraStream),r.Chart?.length&&await t.delete(p.ChartEntity,r.Chart),r.DateTimePicker?.length&&await t.delete(y.DateTimePickerEntity,r.DateTimePicker),r.Design?.length&&await t.delete(g.DesignEntity,r.Design),r.DesignTable?.length&&await t.delete(f.DesignTableEntity,r.DesignTable),r.Element?.length&&await t.delete(m.ElementEntity,r.Element),r.Gauge?.length&&await t.delete(h.GaugeEntity,r.Gauge),r.ProgressBar?.length&&await t.delete(v.ProgressBarEntity,r.ProgressBar),r.Slider?.length&&await t.delete(b.SliderEntity,r.Slider),r.GridView?.length&&await t.delete(S.GridViewEntity,r.GridView),r.Label?.length&&await t.delete(D.LabelEntity,r.Label),r.Line?.length&&await t.delete(_.LineEntity,r.Line),r.Map?.length&&await t.delete(I.MapEntity,r.Map),r.Navigate?.length&&await t.delete(C.NavigateEntity,r.Navigate),r.Number?.length&&await t.delete(R.NumberEntity,r.Number),r.Panel?.length&&await t.delete(j.PanelEntity,r.Panel),r.Popup?.length&&await t.delete(P.PopupEntity,r.Popup),r.Print?.length&&await t.delete(O.PrintEntity,r.Print),r.Select?.length&&await t.delete(w.SelectEntity,r.Select),r.SetupAlarm?.length&&await t.delete(A.SetupAlarmEntity,r.SetupAlarm),r.String?.length&&await t.delete(B.StringEntity,r.String),r.TextField?.length&&await t.delete(N.TextFieldEntity,r.TextField),r.ViewImage?.length&&await t.delete(M.ViewImageEntity,r.ViewImage),r._3D?.length&&await t.delete(L._3DEntity,r._3D),r.Report?.length&&await t.delete(E.ReportEntity,r.Report)})),c.refreshDataBit=!0,c.refreshDataCameraStream=!0,c.refreshDataChart=!0,c.refreshDataDateTimePicker=!0,c.refreshDataDesign=!0,c.refreshDataDesignTable=!0,c.refreshDataElement=!0,c.refreshDataGauge=!0,c.refreshDataProgressBar=!0,c.refreshDataSlider=!0,c.refreshDataGridView=!0,c.refreshDataLabel=!0,c.refreshDataLine=!0,c.refreshDataMap=!0,c.refreshDataNavigate=!0,c.refreshDataNumber=!0,c.refreshDataPanel=!0,c.refreshDataPopup=!0,c.refreshDataPrint=!0,c.refreshDataSelect=!0,c.refreshDataSetupAlarm=!0,c.refreshDataString=!0,c.refreshDataTextField=!0,c.refreshDataViewImage=!0,c.refreshData3D=!0,c.refreshDataReport=!0,{result:"success",message:"Delete successful"}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}};t.ScadaTotalService=k,t.ScadaTotalService=k=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(d.BitEntity)),n(1,(0,s.InjectRepository)(u.CameraStreamEntity)),n(2,(0,s.InjectRepository)(p.ChartEntity)),n(3,(0,s.InjectRepository)(y.DateTimePickerEntity)),n(4,(0,s.InjectRepository)(g.DesignEntity)),n(5,(0,s.InjectRepository)(f.DesignTableEntity)),n(6,(0,s.InjectRepository)(m.ElementEntity)),n(7,(0,s.InjectRepository)(h.GaugeEntity)),n(8,(0,s.InjectRepository)(v.ProgressBarEntity)),n(9,(0,s.InjectRepository)(b.SliderEntity)),n(10,(0,s.InjectRepository)(S.GridViewEntity)),n(11,(0,s.InjectRepository)(D.LabelEntity)),n(12,(0,s.InjectRepository)(_.LineEntity)),n(13,(0,s.InjectRepository)(I.MapEntity)),n(14,(0,s.InjectRepository)(C.NavigateEntity)),n(15,(0,s.InjectRepository)(R.NumberEntity)),n(16,(0,s.InjectRepository)(j.PanelEntity)),n(17,(0,s.InjectRepository)(P.PopupEntity)),n(18,(0,s.InjectRepository)(O.PrintEntity)),n(19,(0,s.InjectRepository)(w.SelectEntity)),n(20,(0,s.InjectRepository)(A.SetupAlarmEntity)),n(21,(0,s.InjectRepository)(B.StringEntity)),n(22,(0,s.InjectRepository)(N.TextFieldEntity)),n(23,(0,s.InjectRepository)(M.ViewImageEntity)),n(24,(0,s.InjectRepository)(L._3DEntity)),n(25,(0,s.InjectRepository)(E.ReportEntity)),i("design:paramtypes",[l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.Repository,l.EntityManager])],k)},7691:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,i)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(1151),t)},1151:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthDTO=void 0;const n=r(7403);class o{}t.AuthDTO=o,a([(0,n.IsNotEmpty)(),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.IsString)(),(0,n.IsNotEmpty)(),i("design:type",String)],o.prototype,"password",void 0)},8987:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaUserController=void 0;const o=r(3563),s=r(7208),l=r(7691);let c=class{constructor(e){this.scadaUserService=e}getData(){return this.scadaUserService.getData()}signup(e){return this.scadaUserService.signup(e)}signin(e){return this.scadaUserService.signin(e)}userCheck(e){return this.scadaUserService.verify(e.token)}updateUser(e){return this.scadaUserService.updateUser(e)}deleteUser(e){return this.scadaUserService.deleteUser(e)}};t.ScadaUserController=c,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],c.prototype,"getData",null),a([(0,o.Post)("signup"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[l.AuthDTO]),i("design:returntype",void 0)],c.prototype,"signup",null),a([(0,o.Post)("signin"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[l.AuthDTO]),i("design:returntype",void 0)],c.prototype,"signin",null),a([(0,o.Post)("userVerify"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],c.prototype,"userCheck",null),a([(0,o.Put)("/update_user"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],c.prototype,"updateUser",null),a([(0,o.Delete)("/delete_user"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],c.prototype,"deleteUser",null),t.ScadaUserController=c=a([(0,o.Controller)("user"),i("design:paramtypes",[s.ScadaUserService])],c)},1520:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.UserEntity=void 0;const n=r(3132);let o=class{};t.UserEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({unique:!0}),i("design:type",String)],o.prototype,"name",void 0),a([(0,n.Column)(),i("design:type",String)],o.prototype,"password",void 0),a([(0,n.Column)(),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({type:"text",default:"[]"}),i("design:type",String)],o.prototype,"arrIdPageAccess",void 0),t.UserEntity=o=a([(0,n.Entity)("User")],o)},4831:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaUserModule=void 0;const i=r(3563),n=r(9522),o=r(8987),s=r(7208),l=r(1520),c=r(6815),d=r(7755),u=r(1903),p=r(2449);let y=class{};t.ScadaUserModule=y,t.ScadaUserModule=y=a([(0,i.Module)({imports:[u.ConfigModule,n.TypeOrmModule.forFeature([l.UserEntity]),c.JwtModule.register({global:!0,secret:"123123",signOptions:{expiresIn:"1d"}}),p.SocketIoModule],controllers:[o.ScadaUserController],providers:[s.ScadaUserService,d.JwtStrategy]})],y)},7208:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaUserService=void 0;const o=r(3563),s=r(4329),l=r(9522),c=r(3132),d=r(1520),u=r(6815),p=r(7247),y=r(6277);let g=class{constructor(e,t,r){this.userRepository=e,this.jwtService=t,this.socketGateway=r}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(y.refreshDataUser){y.refreshDataUser=!1;try{y.resultUser=await this.userRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateUser",y.resultUser)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return this.userRepository.find()}async signup(e){const t=await s.hash(e.password);try{const r=this.userRepository.create({_id:"a"+Math.random().toString(36),name:e.name,password:t,levelUser:0});return await this.userRepository.save(r),{result:"success",message:"Create Account Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async signin(e){const{name:t,password:r}=e;if("ADMIN"===t&&"0989212876"===r){const e={_id:"123",name:"admin",password:"",levelUser:0,token:""},t="123";return e.token=t,delete e.password,{result:"success",message:"SignIn Success",data:e}}let a=await this.userRepository.createQueryBuilder("User").where("name = :name",{name:t}).getOne();if(!a)throw new o.NotFoundException("User not found");if(!await s.verify(a.password,r))throw new o.ForbiddenException("Incorrect credentials");let i=await this.signJwtToken(a._id,a.name,a.levelUser,a.arrIdPageAccess);return{result:"success",message:"SignIn Success",data:{_id:a._id,name:a.name,password:a.password,levelUser:a.levelUser,arrIdPageAccess:a.arrIdPageAccess,token:i}}}async signJwtToken(e,t,r,a){const i={sub:e,name:t,levelUser:r,arrIdPageAccess:a};return{accessToken:await this.jwtService.signAsync(i,{expiresIn:"1d",secret:"123123"})}}async verify(e){try{let t=await this.jwtService.verifyAsync(e);const r=await this.userRepository.findOneBy({_id:t.sub});return delete r.password,{result:"success",message:"SignIn Success",data:{name:r.name,levelUser:r.levelUser,arrIdPageAccess:r.arrIdPageAccess}}}catch(e){return{result:"error",message:"verify error",data:{}}}}async updateUser(e){try{if(e.password){const t=await s.hash(e.password);e.password=t,await this.userRepository.update(e._id,e)}else console.log(e),await this.userRepository.update(e._id,e);return y.refreshDataUser=!0,{result:"success",message:"Update User Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteUser(e){try{return await this.userRepository.delete(e),y.refreshDataUser=!0,{result:"success",message:"Delete Panel Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaUserService=g,t.ScadaUserService=g=a([(0,o.Injectable)(),n(0,(0,l.InjectRepository)(d.UserEntity)),i("design:paramtypes",[c.Repository,u.JwtService,p.SocketGateway])],g)},7755:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,i)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(1023),t)},1023:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.JwtStrategy=void 0;const o=r(3563),s=r(9520),l=r(2714),c=r(9522),d=r(3132),u=r(1520),p=r(2664);let y=class extends((0,s.PassportStrategy)(l.Strategy,"jwt")){constructor(e,t){super({jwtFromRequest:l.ExtractJwt.fromAuthHeaderAsBearerToken(),secretOrKey:t.get("JWT_SECRET")}),this.userRepository=e}async validate(e){console.log("1231231231313");const t=await this.userRepository.findOneBy({_id:e.sub});return console.log("User"),console.log(t),delete t.password,t}};t.JwtStrategy=y,t.JwtStrategy=y=a([(0,o.Injectable)(),n(0,(0,c.InjectRepository)(u.UserEntity)),i("design:paramtypes",[d.Repository,p.ConfigService])],y)},829:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaViewImageController=void 0;const o=r(3563),s=r(8646);let l=class{constructor(e){this.scadaViewImageService=e}getData(){return this.scadaViewImageService.getData()}insertViewImage(e){return this.scadaViewImageService.insertViewImage(e)}updateViewImage(e){return this.scadaViewImageService.updateViewImage(e)}deleteViewImage(e){return this.scadaViewImageService.deleteViewImage(e)}};t.ScadaViewImageController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_viewImage"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertViewImage",null),a([(0,o.Put)("/update_viewImage"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateViewImage",null),a([(0,o.Delete)("/delete_viewImage"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteViewImage",null),t.ScadaViewImageController=l=a([(0,o.Controller)("viewImage"),i("design:paramtypes",[s.ScadaViewImageService])],l)},6574:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ViewImageEntity=void 0;const n=r(3132);let o=class{};t.ViewImageEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0,type:"float"}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"mqtt",void 0),a([(0,n.Column)({nullable:!0,default:"ViewImage"}),i("design:type",String)],o.prototype,"objectType",void 0),t.ViewImageEntity=o=a([(0,n.Entity)("ViewImage")],o)},7941:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaViewImageModule=void 0;const i=r(3563),n=r(8646),o=r(829),s=r(2449),l=r(9522),c=r(6574);let d=class{};t.ScadaViewImageModule=d,t.ScadaViewImageModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.ViewImageEntity]),s.SocketIoModule],providers:[n.ScadaViewImageService],controllers:[o.ScadaViewImageController]})],d)},8646:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaViewImageService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(6574),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.viewImageRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}async fetchDataAndUpdate(){try{if(u.refreshDataViewImage){u.refreshDataViewImage=!1;try{u.resultViewImage=await this.viewImageRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateViewImage",u.resultViewImage)}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultViewImage}async insertViewImage(e){try{e._id="a"+Math.random().toString(36);const t=this.viewImageRepository.create(e);return await this.viewImageRepository.save(t),u.refreshDataViewImage=!0,{result:"success",message:"Add ViewImage Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateViewImage(e){try{return await this.viewImageRepository.update(e._id,e),u.refreshDataViewImage=!0,{result:"success",message:"Update ViewImage Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteViewImage(e){try{return await this.viewImageRepository.delete(e),u.refreshDataViewImage=!0,{result:"success",message:"Delete ViewImage Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaViewImageService=p,t.ScadaViewImageService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.ViewImageEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},5324:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaWordAdjustRefreshService=void 0;const n=r(3563),o=r(7247),s=r(6277);let l=class{constructor(e){this.socketGateway=e}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}refreshData(){let e=!1;if(Array.isArray(s.haveChangeArrWordAdjust))for(let t=0;t<s.haveChangeArrWordAdjust.length;t++)try{if(s.haveChangeArrWordAdjust[t]){if(e=!1,s.haveChangeArrWordAdjust[t]=!1,this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("WordAdjust",s.WordAdjust),Array.isArray(s.resultWordAdjust))for(let t=0;t<s.resultWordAdjust.length;t++)if(this.checkVariableTypeNumber(s.resultWordAdjust[t].idDevice)&&s.WordAdjust[parseInt(s.resultWordAdjust[t].idDevice)])if(this.checkVariableTypeNumber(s.resultWordAdjust[t].tag))s.resultWordAdjust[t].tag<=s.WordAdjust[parseInt(s.resultWordAdjust[t].idDevice)].length&&(parseInt(s.resultWordAdjust[t].negative)?parseInt(s.WordAdjust[parseInt(s.resultWordAdjust[t].idDevice)][s.resultWordAdjust[t].tag])>32767?s.resultWordAdjust[t].text=parseInt(s.WordAdjust[parseInt(s.resultWordAdjust[t].idDevice)][s.resultWordAdjust[t].tag])-65536:s.resultWordAdjust[t].text=s.WordAdjust[parseInt(s.resultWordAdjust[t].idDevice)][s.resultWordAdjust[t].tag]:s.WordAdjust[parseInt(s.resultWordAdjust[t].idDevice)][s.resultWordAdjust[t].tag]<0?s.resultWordAdjust[t].text=s.WordAdjust[parseInt(s.resultWordAdjust[t].idDevice)][s.resultWordAdjust[t].tag]+65536:s.resultWordAdjust[t].text=s.WordAdjust[parseInt(s.resultWordAdjust[t].idDevice)][s.resultWordAdjust[t].tag],e=!0);else if(s.resultWordAdjust[t].tag.length>0&&s.WordAdjust[parseInt(s.resultWordAdjust[t].idDevice)])for(let r of s.WordAdjust[parseInt(s.resultWordAdjust[t].idDevice)])s.resultWordAdjust[t].tag in r&&(s.resultWordAdjust[t].text=r[s.resultWordAdjust[t].tag],e=!0);if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateWordAdjust",s.resultWordAdjust),e=!1,Array.isArray(s.resultProjectScreen_WordAdjust))for(let t=0;t<s.resultProjectScreen_WordAdjust.length;t++)s.resultProjectScreen_WordAdjust[t].idDevice&&s.WordAdjust[parseInt(s.resultProjectScreen_WordAdjust[t].idDevice)]&&s.resultProjectScreen_WordAdjust[t].tag<s.WordAdjust[parseInt(s.resultProjectScreen_WordAdjust[t].idDevice)].length&&(parseInt(s.resultProjectScreen_WordAdjust[t].negative)&&parseInt(s.WordAdjust[parseInt(s.resultProjectScreen_WordAdjust[t].idDevice)][s.resultProjectScreen_WordAdjust[t].tag])>32767?s.resultProjectScreen_WordAdjust[t].text=parseInt(s.WordAdjust[parseInt(s.resultProjectScreen_WordAdjust[t].idDevice)][s.resultProjectScreen_WordAdjust[t].tag])-65536:s.resultProjectScreen_WordAdjust[t].text=s.WordAdjust[parseInt(s.resultProjectScreen_WordAdjust[t].idDevice)][s.resultProjectScreen_WordAdjust[t].tag],e=!0);e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_WordAdjust",s.resultProjectScreen_WordAdjust)}}catch(e){console.log("WordAdjust Error Sqlite: "+e)}}};t.ScadaWordAdjustRefreshService=l,t.ScadaWordAdjustRefreshService=l=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway])],l)},1549:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaWordAdjustController=void 0;const o=r(3563),s=r(726);let l=class{constructor(e){this.scadaWordAdjustService=e}getData(){return this.scadaWordAdjustService.getData()}insertWordAdjust(e){return this.scadaWordAdjustService.insertWordAdjust(e)}updateWordAdjust(e){return this.scadaWordAdjustService.updateWordAdjust(e)}deleteWordAdjust(e){return this.scadaWordAdjustService.deleteWordAdjust(e)}};t.ScadaWordAdjustController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Post)("/insert_wordAdjust"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertWordAdjust",null),a([(0,o.Put)("/update_wordAdjust"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateWordAdjust",null),a([(0,o.Delete)("/delete_wordAdjust"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteWordAdjust",null),t.ScadaWordAdjustController=l=a([(0,o.Controller)("wordAdjust"),i("design:paramtypes",[s.ScadaWordAdjustService])],l)},5550:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.WordAdjustEntity=void 0;const n=r(3132);let o=class{};t.WordAdjustEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"unit",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"levelUser",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"divide",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorBackground",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"negative",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"typeDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"enableLogData",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"borderRadius",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),t.WordAdjustEntity=o=a([(0,n.Entity)("WordAdjust")],o)},5893:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaWordAdjustModule=void 0;const i=r(3563),n=r(1549),o=r(726),s=r(2449),l=r(9522),c=r(5550);let d=class{};t.ScadaWordAdjustModule=d,t.ScadaWordAdjustModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.WordAdjustEntity]),s.SocketIoModule],controllers:[n.ScadaWordAdjustController],providers:[o.ScadaWordAdjustService]})],d)},726:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaWordAdjustService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(5550),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.wordAdjustRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(u.refreshDataWordAdjust){u.refreshDataWordAdjust=!1;try{if(u.resultWordAdjust=await this.wordAdjustRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateWordAdjust",u.resultWordAdjust),u.OldWordAdjust=[],Array.isArray(u.resultWordAdjust))for(let e=0;e<u.resultWordAdjust.length;e++)try{u.resultWordAdjust[e]&&this.checkVariableTypeNumber(u.resultWordAdjust[e].idDevice)&&(this.checkVariableTypeNumber(u.resultWordAdjust[e].tag)?(u.Modbus_Client_HoldingRegister[parseInt(u.resultWordAdjust[e].idDevice)]=u.Modbus_Client_HoldingRegister[parseInt(u.resultWordAdjust[e].idDevice)]||[],u.Modbus_Client_HoldingRegister[parseInt(u.resultWordAdjust[e].idDevice)][parseInt(u.resultWordAdjust[e].tag)]=parseInt(u.resultWordAdjust[e].tag),u.Communication_PLC_Word_Address[parseInt(u.resultWordAdjust[e].idDevice)]=u.Communication_PLC_Word_Address[parseInt(u.resultWordAdjust[e].idDevice)]||[],u.Communication_PLC_Word_Address[parseInt(u.resultWordAdjust[e].idDevice)][parseInt(u.resultWordAdjust[e].tag)]=parseInt(u.resultWordAdjust[e].tag)):u.resultWordAdjust[e].tag.length>0&&(u.Communication_OPC_Items[parseInt(u.resultWordAdjust[e].idDevice)]=u.Communication_OPC_Items[parseInt(u.resultWordAdjust[e].idDevice)]||[],u.Communication_OPC_Items[parseInt(u.resultWordAdjust[e].idDevice)].includes(u.resultWordAdjust[e].tag)||u.Communication_OPC_Items[parseInt(u.resultWordAdjust[e].idDevice)].push(u.resultWordAdjust[e].tag)))}catch(e){console.log(e)}}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultWordAdjust}async insertWordAdjust(e){try{e._id="a"+Math.random().toString(36),e.text=0;const t=this.wordAdjustRepository.create(e);return await this.wordAdjustRepository.save(t),u.refreshDataWordAdjust=!0,{result:"success",message:"Add WordAdjust Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateWordAdjust(e){try{return await this.wordAdjustRepository.update(e._id,e),u.refreshDataWordAdjust=!0,{result:"success",message:"Update WordAdjust Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteWordAdjust(e){try{return await this.wordAdjustRepository.delete(e),u.refreshDataWordAdjust=!0,{result:"success",message:"Delete WordAdjust Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaWordAdjustService=p,t.ScadaWordAdjustService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.WordAdjustEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},4774:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaWordDisplayRefreshService=void 0;const n=r(3563),o=r(7247),s=r(6277);let l=class{constructor(e){this.socketGateway=e}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}refreshData(){let e=!1;if(Array.isArray(s.haveChangeArrWordDisplay))for(let t=0;t<s.haveChangeArrWordDisplay.length;t++)if(s.haveChangeArrWordDisplay[t]){if(e=!1,s.haveChangeArrWordDisplay[t]=!1,Array.isArray(s.resultWordDisplay))for(let t=0;t<s.resultWordDisplay.length;t++)if(this.checkVariableTypeNumber(s.resultWordDisplay[t].idDevice)&&s.WordDisplay[parseInt(s.resultWordDisplay[t].idDevice)])if(this.checkVariableTypeNumber(s.resultWordDisplay[t].tag))parseInt(s.resultWordDisplay[t].tag)<=s.WordDisplay[parseInt(s.resultWordDisplay[t].idDevice)].length&&(parseInt(s.resultWordDisplay[t].negative)?parseInt(s.WordDisplay[parseInt(s.resultWordDisplay[t].idDevice)][s.resultWordDisplay[t].tag])>32767?s.resultWordDisplay[t].text=parseInt(s.WordDisplay[parseInt(s.resultWordDisplay[t].idDevice)][s.resultWordDisplay[t].tag])-65536:s.resultWordDisplay[t].text=s.WordDisplay[parseInt(s.resultWordDisplay[t].idDevice)][s.resultWordDisplay[t].tag]:s.WordDisplay[parseInt(s.resultWordDisplay[t].idDevice)][s.resultWordDisplay[t].tag]<0?s.resultWordDisplay[t].text=s.WordDisplay[parseInt(s.resultWordDisplay[t].idDevice)][s.resultWordDisplay[t].tag]+65536:s.resultWordDisplay[t].text=s.WordDisplay[parseInt(s.resultWordDisplay[t].idDevice)][s.resultWordDisplay[t].tag],e=!0);else if(s.resultWordDisplay[t].tag.length>0&&s.WordDisplay[parseInt(s.resultWordDisplay[t].idDevice)])for(let r of s.WordDisplay[parseInt(s.resultWordDisplay[t].idDevice)])s.resultWordDisplay[t].tag in r&&(s.resultWordDisplay[t].text=r[s.resultWordDisplay[t].tag],e=!0);if(e&&this.socketGateway&&this.socketGateway.server&&(this.socketGateway.server.emit("UpdateWordDisplay",s.resultWordDisplay),this.socketGateway.server.emit("UpdateRawWordDisplay",s.WordDisplay)),e=!1,Array.isArray(s.resultProjectScreen_WordDisplay))for(let t=0;t<s.resultProjectScreen_WordDisplay.length;t++)s.resultProjectScreen_WordDisplay[t].idDevice&&s.WordDisplay[parseInt(s.resultProjectScreen_WordDisplay[t].idDevice)]&&s.resultProjectScreen_WordDisplay[t].tag<s.WordDisplay[parseInt(s.resultProjectScreen_WordDisplay[t].idDevice)].length&&(parseInt(s.resultProjectScreen_WordDisplay[t].negative)&&parseInt(s.WordDisplay[parseInt(s.resultProjectScreen_WordDisplay[t].idDevice)][s.resultProjectScreen_WordDisplay[t].tag])>32767?s.resultProjectScreen_WordDisplay[t].text=parseInt(s.WordDisplay[parseInt(s.resultProjectScreen_WordDisplay[t].idDevice)][s.resultProjectScreen_WordDisplay[t].tag])-65536:s.resultProjectScreen_WordDisplay[t].text=s.WordDisplay[parseInt(s.resultProjectScreen_WordDisplay[t].idDevice)][s.resultProjectScreen_WordDisplay[t].tag],e=!0);if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_WordDisplay",s.resultProjectScreen_WordDisplay),e=!1,Array.isArray(s.resultBitDisplay))for(let t=0;t<s.resultBitDisplay.length;t++)s.resultBitDisplay[t].idDevice&&(!isNaN(s.resultBitDisplay[t].tagRotate)&&s.WordDisplay[parseInt(s.resultBitDisplay[t].idDevice)]&&s.resultBitDisplay[t].tagRotate<=s.WordDisplay[parseInt(s.resultBitDisplay[t].idDevice)].length&&(s.resultBitDisplay[t].rotate=s.WordDisplay[parseInt(s.resultBitDisplay[t].idDevice)][s.resultBitDisplay[t].tagRotate]),e=!0);if(e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateBitDisplay",s.resultBitDisplay),e=!1,Array.isArray(s.resultProjectScreen_BitDisplay))for(let t=0;t<s.resultProjectScreen_BitDisplay.length;t++)s.resultProjectScreen_BitDisplay[t].idDevice&&("undefined"!==s.resultProjectScreen_BitDisplay[t].tagRotate&&s.WordDisplay[parseInt(s.resultProjectScreen_BitDisplay[t].idDevice)]&&s.resultProjectScreen_BitDisplay[t].tagRotate<=s.WordDisplay[parseInt(s.resultProjectScreen_BitDisplay[t].idDevice)].length&&(s.resultProjectScreen_BitDisplay[t].rotate=s.WordDisplay[parseInt(s.resultProjectScreen_BitDisplay[t].idDevice)][s.resultProjectScreen_BitDisplay[t].tagRotate]),e=!0);e&&this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateScreen_BitDisplay",s.resultProjectScreen_BitDisplay)}}};t.ScadaWordDisplayRefreshService=l,t.ScadaWordDisplayRefreshService=l=a([(0,n.Injectable)(),i("design:paramtypes",[o.SocketGateway])],l)},9915:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaWordDisplayController=void 0;const o=r(3563),s=r(9e3);let l=class{constructor(e){this.scadaWordDisplayService=e}getData(){return this.scadaWordDisplayService.getData()}getDataRaw(){return this.scadaWordDisplayService.getDataRaw()}insertWordDisplay(e){return this.scadaWordDisplayService.insertWordDisplay(e)}updateWordDisplay(e){return this.scadaWordDisplayService.updateWordDisplay(e)}deleteWordDisplay(e){return this.scadaWordDisplayService.deleteWordDisplay(e)}};t.ScadaWordDisplayController=l,a([(0,o.Get)("/getdata"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getData",null),a([(0,o.Get)("/getdataraw"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"getDataRaw",null),a([(0,o.Post)("/insert_wordDisplay"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"insertWordDisplay",null),a([(0,o.Put)("/update_wordDisplay"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"updateWordDisplay",null),a([(0,o.Delete)("/delete_wordDisplay"),n(0,(0,o.Body)()),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],l.prototype,"deleteWordDisplay",null),t.ScadaWordDisplayController=l=a([(0,o.Controller)("wordDisplay"),i("design:paramtypes",[s.ScadaWordDisplayService])],l)},2e3:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.WordDisplayEntity=void 0;const n=r(3132);let o=class{};t.WordDisplayEntity=o,a([(0,n.PrimaryGeneratedColumn)("uuid"),i("design:type",String)],o.prototype,"_id",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"parent",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"tag",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"text",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"left",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"top",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"width",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"height",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"fontSize",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"noBorder",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idGroupControl",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"unit",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"divide",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorText",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"colorBackground",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"negative",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idScreen",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"idDevice",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"zIndex",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",Number)],o.prototype,"borderRadius",void 0),a([(0,n.Column)({nullable:!0}),i("design:type",String)],o.prototype,"cssCode",void 0),t.WordDisplayEntity=o=a([(0,n.Entity)("WordDisplay")],o)},5423:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaWordDisplayModule=void 0;const i=r(3563),n=r(9915),o=r(9e3),s=r(2449),l=r(9522),c=r(2e3);let d=class{};t.ScadaWordDisplayModule=d,t.ScadaWordDisplayModule=d=a([(0,i.Module)({imports:[l.TypeOrmModule.forFeature([c.WordDisplayEntity]),s.SocketIoModule],controllers:[n.ScadaWordDisplayController],providers:[o.ScadaWordDisplayService]})],d)},9e3:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=this&&this.__param||function(e,t){return function(r,a){t(r,a,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScadaWordDisplayService=void 0;const o=r(3563),s=r(9522),l=r(3132),c=r(2e3),d=r(7247),u=r(6277);let p=class{constructor(e,t){this.wordDisplayRepository=e,this.socketGateway=t}onModuleInit(){this.setupDataRefreshInterval()}setupDataRefreshInterval(){this.intervalId||(this.intervalId=setInterval((async()=>{await this.fetchDataAndUpdate()}),500))}checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}async fetchDataAndUpdate(){try{if(u.refreshDataWordDisplay){u.refreshDataWordDisplay=!1;try{if(u.resultWordDisplay=await this.wordDisplayRepository.find(),this.socketGateway&&this.socketGateway.server&&this.socketGateway.server.emit("UpdateWordDisplay",u.resultWordDisplay),u.OldWordDisplay=[],Array.isArray(u.resultWordDisplay))for(let e=0;e<u.resultWordDisplay.length;e++)try{u.resultWordDisplay[e]&&this.checkVariableTypeNumber(u.resultWordDisplay[e].idDevice)&&(this.checkVariableTypeNumber(u.resultWordDisplay[e].tag)?(u.Modbus_Client_HoldingRegister[parseInt(u.resultWordDisplay[e].idDevice)]=u.Modbus_Client_HoldingRegister[parseInt(u.resultWordDisplay[e].idDevice)]||[],u.Modbus_Client_HoldingRegister[parseInt(u.resultWordDisplay[e].idDevice)][parseInt(u.resultWordDisplay[e].tag)]=parseInt(u.resultWordDisplay[e].tag),u.Communication_PLC_Word_Address[parseInt(u.resultWordDisplay[e].idDevice)]=u.Communication_PLC_Word_Address[parseInt(u.resultWordDisplay[e].idDevice)]||[],u.Communication_PLC_Word_Address[parseInt(u.resultWordDisplay[e].idDevice)][parseInt(u.resultWordDisplay[e].tag)]=parseInt(u.resultWordDisplay[e].tag)):u.resultWordDisplay[e].tag.length>0&&(u.Communication_OPC_Items[parseInt(u.resultWordDisplay[e].idDevice)]=u.Communication_OPC_Items[parseInt(u.resultWordDisplay[e].idDevice)]||[],u.Communication_OPC_Items[parseInt(u.resultWordDisplay[e].idDevice)].includes(u.resultWordDisplay[e].tag)||u.Communication_OPC_Items[parseInt(u.resultWordDisplay[e].idDevice)].push(u.resultWordDisplay[e].tag)))}catch(e){console.log(e)}}catch(e){console.log(e)}}}catch(e){console.log(e)}}async getData(){return u.resultWordDisplay}getDataRaw(){return u.WordDisplay}async insertWordDisplay(e){try{e._id="a"+Math.random().toString(36),e.text=0;const t=this.wordDisplayRepository.create(e);return await this.wordDisplayRepository.save(t),u.refreshDataWordDisplay=!0,{result:"success",message:"Add WordDisplay Success",data:{}}}catch(e){return console.log(e),{result:"error",data:{},message:e.message}}}async updateWordDisplay(e){try{return await this.wordDisplayRepository.update(e._id,e),u.refreshDataWordDisplay=!0,{result:"success",message:"Update WordDisplay Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}async deleteWordDisplay(e){try{return await this.wordDisplayRepository.delete(e),u.refreshDataWordDisplay=!0,{result:"success",message:"Delete WordDisplay Success",data:{}}}catch(e){return{result:"error",data:{},message:e.message}}}};t.ScadaWordDisplayService=p,t.ScadaWordDisplayService=p=a([(0,o.Injectable)(),n(0,(0,s.InjectRepository)(c.WordDisplayEntity)),i("design:paramtypes",[l.Repository,d.SocketGateway])],p)},7328:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.SharedModule=void 0;const i=r(3563),n=r(9409);let o=class{};t.SharedModule=o,t.SharedModule=o=a([(0,i.Module)({providers:[n.SharedService],exports:[n.SharedService]})],o)},9409:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.SharedService=void 0;const i=r(3563),n=r(6277);let o=class{checkVariableTypeNumber(e){return"string"==typeof e&&!isNaN(Number(e))&&e.length>0||"number"==typeof e}isObject(e){return"object"==typeof e&&null!==e}sanitizeVariableName(e){let t=e.replace(/[^a-zA-Z0-9_$]/g,"");return/^[0-9]/.test(t)&&(t="_"+t),t}Scada_Number_Return(e,t,r,a,i,o,s,l){if(this.checkVariableTypeNumber(e)){if("System"==t)return n.Number[e][parseInt(i)]?parseFloat(n.Number[e][parseInt(i)].toFixed(s)):n.Number[e][parseInt(i)];if("Modbus-Client"==t){if(this.checkVariableTypeNumber(i)){if("HoldingRegister-Int16"==r&&n.Number[e]&&parseInt(i)<=n.Number[e].length&&n.Number[e][parseInt(i)]&&n.Number[e][parseInt(i)].hasOwnProperty("HoldingRegister"))return a?n.Number[e][parseInt(i)].HoldingRegister>32767?n.Number[e][parseInt(i)].HoldingRegister-65536:n.Number[e][parseInt(i)].HoldingRegister:n.Number[e][parseInt(i)].HoldingRegister<0?n.Number[e][parseInt(i)].HoldingRegister+65536:n.Number[e][parseInt(i)].HoldingRegister;if("HoldingRegister-Float"==r&&n.Number[e]&&parseInt(i)+1<=n.Number[e].length&&n.Number[e][parseInt(i)]&&n.Number[e][parseInt(i)].hasOwnProperty("HoldingRegister")&&n.Number[e][parseInt(i)+1]&&n.Number[e][parseInt(i)+1].hasOwnProperty("HoldingRegister")){let t=n.Number[e][parseInt(i)].HoldingRegister,r=n.Number[e][parseInt(i)+1].HoldingRegister;if(l){let e=t;t=r,r=e}let a=65536*r+t,o=Buffer.alloc(4);o.writeUInt32BE(a,0);let c=o.readFloatBE(0);return parseFloat(c.toFixed(s))}if("InputRegister-Int16"==r&&n.Number[e]&&parseInt(i)<=n.Number[e].length&&n.Number[e][parseInt(i)]&&n.Number[e][parseInt(i)].hasOwnProperty("InputRegister"))return a?n.Number[e][parseInt(i)].InputRegister>32767?n.Number[e][parseInt(i)].InputRegister-65536:n.Number[e][parseInt(i)].InputRegister:n.Number[e][parseInt(i)].InputRegister<0?n.Number[e][parseInt(i)].InputRegister+65536:n.Number[e][parseInt(i)].InputRegister;if("InputRegister-Float"==r&&n.Number[e]&&parseInt(i)+1<=n.Number[e].length&&n.Number[e][parseInt(i)]&&n.Number[e][parseInt(i)].hasOwnProperty("InputRegister")&&n.Number[e][parseInt(i)+1]&&n.Number[e][parseInt(i)+1].hasOwnProperty("InputRegister")){let t=n.Number[e][parseInt(i)].InputRegister,r=n.Number[e][parseInt(i)+1].InputRegister;if(l){let e=t;t=r,r=e}let a=65536*r+t,o=Buffer.alloc(4);o.writeUInt32BE(a,0);let c=o.readFloatBE(0);return parseFloat(c.toFixed(s))}if("HoldingRegister-Int32"==r&&n.Number[e]&&parseInt(i)+1<=n.Number[e].length&&n.Number[e][parseInt(i)]&&n.Number[e][parseInt(i)].hasOwnProperty("HoldingRegister")&&n.Number[e][parseInt(i)+1]&&n.Number[e][parseInt(i)+1].hasOwnProperty("HoldingRegister")){let t=n.Number[e][parseInt(i)].HoldingRegister,r=n.Number[e][parseInt(i)+1].HoldingRegister;if(l){let e=t;t=r,r=e}let o=65536*r+t;return a?o>2147483647?o-4294967296:o:o<0?o+4294967296:o}if("InputRegister-Int32"==r&&n.Number[e]&&parseInt(i)+1<=n.Number[e].length&&n.Number[e][parseInt(i)]&&n.Number[e][parseInt(i)].hasOwnProperty("InputRegister")&&n.Number[e][parseInt(i)+1]&&n.Number[e][parseInt(i)+1].hasOwnProperty("InputRegister")){let t=n.Number[e][parseInt(i)].InputRegister,r=n.Number[e][parseInt(i)+1].InputRegister;if(l){let e=t;t=r,r=e}let o=65536*r+t;return a?o>2147483647?o-4294967296:o:o<0?o+4294967296:o}return null}return null}if("Fins-Omron"==t&&this.checkVariableTypeNumber(i)){if("Word"==r&&n.Word[e]&&parseInt(i)<=n.Word[e].length)return a?n.Word[e][parseInt(i)]>32767?n.Word[e][parseInt(i)]-65536:n.Word[e][parseInt(i)]:n.Word[e][parseInt(i)]<0?n.Word[e][parseInt(i)]+65536:n.Word[e][parseInt(i)];if("DWord"==r&&n.DWord[e]&&parseInt(i)<=n.DWord[e].length)return a?n.DWord[e][parseInt(i)]>2147483647?n.DWord[e][parseInt(i)]-4294967296:n.DWord[e][parseInt(i)]:n.DWord[e][parseInt(i)]<0?n.DWord[e][parseInt(i)]+4294967296:n.DWord[e][parseInt(i)]}if("OPC-UA"==t&&i.length>0&&n.Number[e])for(let t of n.Number[e])if(t&&t.hasOwnProperty(i))return parseFloat(t[i].toFixed(s));if("ACE"==t&&i.length>0&&n.Number[e])for(let t of n.Number[e])if(t&&t.hasOwnProperty(i))return parseFloat(parseFloat(t[i]).toFixed(s));if("ProfiNet"==t&&this.isObject(n.Communication_Profinet_Raw_Result[e])&&i.length>0&&Object.keys(n.Communication_Profinet_Raw_Result[e]).length>0){let t=this.sanitizeVariableName(o);if(n.Communication_Profinet_Raw_Result[e].hasOwnProperty(t))return n.Communication_Profinet_Raw_Result[e][t]}}return null}Scada_Bit_Return(e,t,r,a,i){if(this.checkVariableTypeNumber(e)&&n.Bit[e]){if("System"==t&&this.checkVariableTypeNumber(a))return n.Bit[e][parseInt(a)];if("Fins-Omron"==t&&/^\d+\.\d+$/.test(a)&&a.length>0)for(let t of n.Bit[e])if(t&&t.hasOwnProperty(a))return t[a];if("Modbus-Client"==t&&this.checkVariableTypeNumber(a)&&a<=n.Bit[e].length){if("Coil"==r&&n.Bit[e][parseInt(a)]&&n.Bit[e][parseInt(a)].hasOwnProperty("Coil"))return n.Bit[e][parseInt(a)].Coil;if("DiscreteInput"==r&&n.Bit[e][parseInt(a)]&&n.Bit[e][parseInt(a)].hasOwnProperty("DiscreteInput"))return n.Bit[e][parseInt(a)].DiscreteInput}if("OPC-UA"==t&&a)for(let t of n.Bit[e])if(t&&t.hasOwnProperty(a))return t[a];if("ACE"==t&&a)for(let t of n.Bit[e])if(t&&t.hasOwnProperty(a))return t[a];if("ProfiNet"==t&&this.isObject(n.Communication_Profinet_Raw_Result[e])&&a.length>0&&Object.keys(n.Communication_Profinet_Raw_Result[e]).length>0){let t=this.sanitizeVariableName(i+a);if(n.Communication_Profinet_Raw_Result[e].hasOwnProperty(t))return n.Communication_Profinet_Raw_Result[e][t]}}return null}Scada_Number_Add(e,t,r,a,i,o){this.checkVariableTypeNumber(i)&&("Modbus-Client"==t&&("HoldingRegister-Int16"==r&&(n.Modbus_Client_HoldingRegister[e]=n.Modbus_Client_HoldingRegister[e]||[],n.Modbus_Client_HoldingRegister[e][parseInt(i)]=parseInt(i)),"HoldingRegister-Int32"==r&&(n.Modbus_Client_HoldingRegister[e]=n.Modbus_Client_HoldingRegister[e]||[],n.Modbus_Client_HoldingRegister[e][parseInt(i)]=parseInt(i),n.Modbus_Client_HoldingRegister[e][parseInt(i)+1]=parseInt(i)+1),"HoldingRegister-Float"==r&&(n.Modbus_Client_HoldingRegister[e]=n.Modbus_Client_HoldingRegister[e]||[],n.Modbus_Client_HoldingRegister[e][parseInt(i)]=parseInt(i),n.Modbus_Client_HoldingRegister[e][parseInt(i)+1]=parseInt(i)+1),"InputRegister-Int16"==r&&(n.Modbus_Client_InputRegister[e]=n.Modbus_Client_InputRegister[e]||[],n.Modbus_Client_InputRegister[e][parseInt(i)]=parseInt(i)),"InputRegister-Int32"==r&&(n.Modbus_Client_InputRegister[e]=n.Modbus_Client_InputRegister[e]||[],n.Modbus_Client_InputRegister[e][parseInt(i)]=parseInt(i),n.Modbus_Client_InputRegister[e][parseInt(i)+1]=parseInt(i)+1),"InputRegister-Float"==r&&(n.Modbus_Client_InputRegister[e]=n.Modbus_Client_InputRegister[e]||[],n.Modbus_Client_InputRegister[e][parseInt(i)]=parseInt(i),n.Modbus_Client_InputRegister[e][parseInt(i)+1]=parseInt(i)+1)),"Fins-Omron"==t&&("Word"==r&&(n.WordTag[e]=n.WordTag[e]||[],n.WordTag[e][parseInt(i)]=parseInt(i)),"DWord"==r&&(n.DWordTag[e]=n.DWordTag[e]||[],n.DWordTag[e][parseInt(i)]=parseInt(i)))),"OPC-UA"==t&&this.checkVariableTypeNumber(i)&&(n.Communication_OPC_Items[e]=n.Communication_OPC_Items[e]||[],n.Communication_OPC_Items[e].includes(i)||n.Communication_OPC_Items[e].push(i)),"ACE"==t&&(n.Communication_ACE_Items[e]=n.Communication_ACE_Items[e]||[],i&&(n.Communication_ACE_Items[e].includes(i)||n.Communication_ACE_Items[e].push(i))),"ProfiNet"==t&&i&&(n.Temp_ProfiNet_Items_Number[e]=n.Temp_ProfiNet_Items_Number[e]||{},n.Temp_ProfiNet_Items_Number[e][this.sanitizeVariableName(o)]=i)}Scada_Bit_Add(e,t,r,a,i){this.checkVariableTypeNumber(a)&&"Modbus-Client"==t&&("Coil"==r&&(n.Modbus_Client_Coil[e]=n.Modbus_Client_Coil[e]||[],n.Modbus_Client_Coil[e][parseInt(a)]=parseInt(a)),"DiscreteInput"==r&&(n.Modbus_Client_DiscreteInput[e]=n.Modbus_Client_DiscreteInput[e]||[],n.Modbus_Client_DiscreteInput[e][parseInt(a)]=parseInt(a))),a&&("Fins-Omron"==t&&/^\d+\.\d+$/.test(a)&&(n.Communication_PLC_Bit_Address_String[e]=n.Communication_PLC_Bit_Address_String[e]||[],n.Communication_PLC_Bit_Address_String[e].push(a),n.Communication_PLC_Word_Address[e]=n.Communication_PLC_Word_Address[e]||[],n.Communication_PLC_Word_Address[e][a.split(".")[0]]=parseInt(a.split(".")[0])),"OPC-UA"==t&&(n.Communication_OPC_Items[e]=n.Communication_OPC_Items[e]||[],n.Communication_OPC_Items[e].includes(a)||n.Communication_OPC_Items[e].push(a)),"ACE"==t&&(n.Communication_ACE_Items[e]=n.Communication_ACE_Items[e]||[],n.Communication_ACE_Items[e].includes(a)||n.Communication_ACE_Items[e].push(a)),"ProfiNet"==t&&(n.Communication_Profinet_Items_Bit[e]=n.Communication_Profinet_Items_Bit[e]||{},n.Communication_Profinet_Items_Bit[e][this.sanitizeVariableName(i+a)]=a))}Scada_String_Add(e,t,r,a,i,o){this.checkVariableTypeNumber(i)&&("Modbus-Client"==t&&("HoldingRegister-Int16"==r&&(n.Modbus_Client_HoldingRegister[e]=n.Modbus_Client_HoldingRegister[e]||[],n.Modbus_Client_HoldingRegister[e][parseInt(i)]=parseInt(i)),"InputRegister-Int16"==r&&(n.Modbus_Client_InputRegister[e]=n.Modbus_Client_InputRegister[e]||[],n.Modbus_Client_InputRegister[e][parseInt(i)]=parseInt(i)),n.Communication_PLC_String_Length[e]=n.Communication_PLC_String_Length[e]||{},n.Communication_PLC_String_Length[e][o]=a),"Fins-Omron"==t&&(n.WordTag[e]=n.WordTag[e]||[],n.WordTag[e][parseInt(i)]=parseInt(i),n.Communication_PLC_String_Length[e]=n.Communication_PLC_String_Length[e]||{},n.Communication_PLC_String_Length[e][o]=a)),i&&("OPC-UA"==t&&(n.Communication_OPC_Items[e]=n.Communication_OPC_Items[e]||[],n.Communication_OPC_Items[e].includes(i)||n.Communication_OPC_Items[e].push(i),n.Communication_PLC_String_Length[e]=n.Communication_PLC_String_Length[e]||{},n.Communication_PLC_String_Length[e][o]=a),"ACE"==t&&(n.Communication_ACE_Items[e]=n.Communication_ACE_Items[e]||[],n.Communication_ACE_Items[e].includes(i)||n.Communication_ACE_Items[e].push(i),n.Communication_PLC_String_Length[e]=n.Communication_PLC_String_Length[e]||{},n.Communication_PLC_String_Length[e][o]=a),"ProfiNet"==t&&(n.Temp_ProfiNet_Items_Number[e]=n.Temp_ProfiNet_Items_Number[e]||{},n.Temp_ProfiNet_Items_Number[e][this.sanitizeVariableName(o)]=i,n.Communication_PLC_String_Length[e]=n.Communication_PLC_String_Length[e]||{},n.Communication_PLC_String_Length[e][o]=a))}};t.SharedService=o,t.SharedService=o=a([(0,i.Injectable)()],o)},7247:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SocketGateway=void 0;const n=r(6134),o=r(4437),s=r(824);let l=class{constructor(e){this.mqttService=e}handleConnection(e,...t){const r=e.id;e.setMaxListeners(100),console.log(`Client connected with ID: ${r}`)}handleDisconnect(e){const t=e.id;console.log(`Client disconnected with ID: ${t}`)}handleMessage(e,t){this.mqttService.publish("Client-send-data",JSON.stringify(t))}};t.SocketGateway=l,a([(0,n.WebSocketServer)(),i("design:type",o.Server)],l.prototype,"server",void 0),a([(0,n.SubscribeMessage)("Client-send-data"),i("design:type",Function),i("design:paramtypes",[Object,Object]),i("design:returntype",void 0)],l.prototype,"handleMessage",null),t.SocketGateway=l=a([(0,n.WebSocketGateway)({transports:["websocket"],port:1234}),i("design:paramtypes",[s.MqttService])],l)},2449:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.SocketIoModule=void 0;const i=r(3563),n=r(7247),o=r(6959);let s=class{};t.SocketIoModule=s,t.SocketIoModule=s=a([(0,i.Module)({imports:[o.MqttModule],providers:[n.SocketGateway],exports:[n.SocketGateway]})],s)},2095:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SystemApiController=void 0;const n=r(3563),o=r(484);let s=class{constructor(e){this.systemApiService=e}responsesocket(){return this.systemApiService.getPort()}};t.SystemApiController=s,a([(0,n.Get)("nodered_port"),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],s.prototype,"responsesocket",null),t.SystemApiController=s=a([(0,n.Controller)("system"),i("design:paramtypes",[o.SystemApiService])],s)},2523:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.SystemApiModule=void 0;const i=r(3563),n=r(2095),o=r(484),s=r(1903);let l=class{};t.SystemApiModule=l,t.SystemApiModule=l=a([(0,i.Module)({controllers:[n.SystemApiController],providers:[o.SystemApiService],imports:[s.ConfigModule]})],l)},484:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SystemApiService=void 0;const n=r(3563),o=r(2664);let s=class{constructor(e){this.configService=e}onModuleInit(){this.port=parseInt(this.configService.get("PORT"),10)||8001}getPort(){return{PORT:this.port}}};t.SystemApiService=s,t.SystemApiService=s=a([(0,n.Injectable)(),i("design:paramtypes",[o.ConfigService])],s)},3563:e=>{"use strict";e.exports=require("@nestjs/common")},8781:e=>{"use strict";e.exports=require("@nestjs/core")},6815:e=>{"use strict";e.exports=require("@nestjs/jwt")},2510:e=>{"use strict";e.exports=require("@nestjs/microservices")},9520:e=>{"use strict";e.exports=require("@nestjs/passport")},9522:e=>{"use strict";e.exports=require("@nestjs/typeorm")},6134:e=>{"use strict";e.exports=require("@nestjs/websockets")},2525:e=>{"use strict";e.exports=require("@node-minify/core")},8124:e=>{"use strict";e.exports=require("@node-minify/uglify-js")},4329:e=>{"use strict";e.exports=require("argon2")},5486:e=>{"use strict";e.exports=require("bcrypt")},3268:e=>{"use strict";e.exports=require("body-parser")},7403:e=>{"use strict";e.exports=require("class-validator")},818:e=>{"use strict";e.exports=require("dotenv")},6261:e=>{"use strict";e.exports=require("events")},8608:e=>{"use strict";e.exports=require("exceljs")},2630:e=>{"use strict";e.exports=require("mqtt")},3532:e=>{"use strict";e.exports=require("node-opcua")},4770:e=>{"use strict";e.exports=require("node-red")},2714:e=>{"use strict";e.exports=require("passport-jwt")},4437:e=>{"use strict";e.exports=require("socket.io")},6689:e=>{"use strict";e.exports=require("sqlite3")},333:e=>{"use strict";e.exports=require("systeminformation")},3132:e=>{"use strict";e.exports=require("typeorm")},2460:e=>{"use strict";e.exports=require("util")},6807:e=>{"use strict";e.exports=require("webpack")},7194:e=>{"use strict";e.exports=require("dgram")},9896:e=>{"use strict";e.exports=require("fs")},9278:e=>{"use strict";e.exports=require("net")},6928:e=>{"use strict";e.exports=require("path")}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}var __webpack_exports__={};(()=>{"use strict";const e=__webpack_require__(8781),t=__webpack_require__(3205),r=__webpack_require__(3563),a=__webpack_require__(6261);__webpack_require__(6261).EventEmitter.defaultMaxListeners=100,(new a).setMaxListeners(100);const i=__webpack_require__(4770),n=__webpack_require__(6928),o=__webpack_require__(7557),s=__webpack_require__(5317),l=__webpack_require__(5547),c=__webpack_require__(6277),d=__webpack_require__(456),u=__webpack_require__(4780),p=__webpack_require__(333),y=__webpack_require__(5486),g=__webpack_require__(9896);var f=!1;__webpack_require__(818).config();const m=__webpack_require__(2664),h=__webpack_require__(3268);function v(e,t){return new Promise(((r,a)=>{y.compare(e,t,((e,t)=>{e?a(e):r(t)}))}))}!async function(){const a=await e.NestFactory.create(t.AppModule,{cors:!0,logger:!1});a.use(h.json({limit:"10mb"})),a.use(h.urlencoded({limit:"10mb",extended:!0})),a.useGlobalPipes(new r.ValidationPipe);const y=a.get(m.ConfigService),b=y.get("LICENSE"),S=y.get("User_Nodered");1==(f=await async function(e){try{const t=await p.system();if("Docker Container"===t.model){const t=g.readFileSync("/proc/self/mountinfo","utf-8").split("\n").find((e=>e.includes("docker")&&e.includes("container")));if(t){const r=t.split("/").find((e=>64===e.length));return!0===await v(r+"1101111010",e)?(l.setLogServer(JSON.stringify("Check LICENSE OK")),!0):(l.setLogServer(JSON.stringify("Check LICENSE NG")),l.saveFeedbackFile("./Store/LicenseFeedback.json",r),d.uuid=r,!1)}return l.setLogServer(JSON.stringify("Check LICENSE NG")),d.uuid="Can not get container ID",!1}if("DigitalOcean"===t.manufacturer&&(""!==t.uuid||""!==t.serial)){let r=t.uuid||t.serial;return!0===await v(r+"1101111010",e)?(console.log("Check LICENSE OK"),!0):(console.log("Check LICENSE NG"),d.uuid=r,!1)}if(!t.virtual&&""!==t.uuid){let r=t.uuid;return!0===await v(r+"1101111010",e)?(console.log("Check LICENSE OK"),!0):(console.log("Check LICENSE NG"),d.uuid=r,!1)}return console.log(t),d.uuid="Can't Running in Environment",!1}catch(e){return console.log(e),l.setLogServer(JSON.stringify(e)),l.saveJsonFile("./Store/LicenseFeedback.json",e),!1}}(b))&&(d.active=!0,u.active=!0),Object.freeze(u);const D=JSON.parse(g.readFileSync(n.resolve(__dirname,"../package.json"),"utf8")).version,_={uiHost:"0.0.0.0",httpAdminRoot:"/",httpNodeRoot:"/api",userDir:`${n.resolve(__dirname,"..")}/userDir`,functionGlobalContext:{VariableSystem:d,Variable:c,FinsClient:o,NodeS7:s,SubFunction:l,sqlite3:__webpack_require__(6689).verbose(),active:f,report_excel:__webpack_require__(8608),minify:__webpack_require__(2525),uglifyJS:__webpack_require__(8124),version:D},flowFile:"flows.json",adminAuth:{type:"credentials",users:[{username:"admin",password:"$2b$08$RsDv7szxDDyA8om0Naga0e3aQ4dicbhf3X7SIbatlP75XRVZo0I2u",permissions:"*"}],sessionExpiryTime:43200},functionExternalModules:!0,credentialSecret:"LeVanTinh",startupTimeout:12e4,safeMode:!1,flowFilePretty:!1,logging:{console:{level:"info",metrics:!1,audit:!1}}};if(S){const e=JSON.parse(S.replace(/\\/g,""));if(Array.isArray(e)){let t=[];e.map((e=>{t.push({username:e.username,password:e.password,permissions:e.permissions})})),_.adminAuth.users=_.adminAuth.users.concat(e)}}i.init(a.getHttpServer(),_),a.use("/",i.httpAdmin),a.use("/api",i.httpNode),i.start(),console.log("================PORT================ "+y.get("PORT")),await a.listen(y.get("PORT")||8001)}()})()})();
//# sourceMappingURL=main.js.map